<!DOCTYPE html>
<html lang="en" class="">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=5.0, user-scalable=yes">
    <title>PostgreSQL DB Knowledge Base</title>
    <meta name="theme-color" content="#0284c7">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="mobile-web-app-capable" content="yes">
    <meta name="format-detection" content="telephone=no">
    <meta name="apple-touch-fullscreen" content="yes">
    <meta name="HandheldFriendly" content="true">
    <link rel="manifest" href="manifest.json">
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <style>
        /* Enhanced dark mode with better contrast and improved transitions */
        .dark { 
            background: linear-gradient(135deg, #0f172a 0%, #1e293b 100%); 
            color: #f1f5f9; 
        }
        
        .dark .content-section:hover {
            box-shadow: 
                0 16px 48px rgba(0, 0, 0, 0.6),
                0 8px 24px rgba(0, 0, 0, 0.3),
                inset 0 1px 0 rgba(255, 255, 255, 0.08);
        }
        
        /* Enhanced section titles with gradient text */
        .section-title {
            font-size: 1.75rem;
            font-weight: 700;
            margin-bottom: 1.5rem;
            display: flex;
            align-items: center;
            gap: 0.75rem;
            background: linear-gradient(135deg, #1e293b 0%, #0f172a 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            letter-spacing: -0.025em;
        }
        
        .dark .section-title {
            background: linear-gradient(135deg, #f8fafc 0%, #e2e8f0 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }
        
        /* Icon styling for section titles */
        .section-title i {
            background: linear-gradient(135deg, #0ea5e9 0%, #0284c7 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            filter: drop-shadow(0 2px 4px rgba(0, 0, 0, 0.1));
        }
        
        .dark .section-title i {
            background: linear-gradient(135deg, #38bdf8 0%, #0ea5e9 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            filter: drop-shadow(0 2px 4px rgba(0, 0, 0, 0.3));
        }
        
        /* Enhanced code blocks with modern styling */
        pre {
            background: linear-gradient(135deg, #f8fafc 0%, #f1f5f9 100%);
            border: 2px solid rgba(226, 232, 240, 0.8);
            padding: 1.5rem;
            border-radius: 0.75rem;
            overflow-x: auto;
            font-size: 0.875rem;
            line-height: 1.6;
            color: #1e293b;
            position: relative;
            box-shadow: 
                0 4px 16px rgba(0, 0, 0, 0.05),
                inset 0 1px 0 rgba(255, 255, 255, 0.2);
        }
        
        .dark pre {
            background: linear-gradient(135deg, #0f172a 0%, #1e293b 100%);
            border: 2px solid rgba(71, 85, 105, 0.3);
            color: #f1f5f9;
            box-shadow: 
                0 4px 16px rgba(0, 0, 0, 0.3),
                inset 0 1px 0 rgba(255, 255, 255, 0.05);
        }
        
        /* Add copy button to code blocks */
        pre::before {
            content: attr(data-lang);
            position: absolute;
            top: 0.5rem;
            right: 0.5rem;
            background: rgba(148, 163, 184, 0.2);
            padding: 0.25rem 0.5rem;
            border-radius: 0.25rem;
            font-size: 0.75rem;
            color: #64748b;
            text-transform: uppercase;
            letter-spacing: 0.05em;
        }
        
        .dark pre::before {
            background: rgba(71, 85, 105, 0.3);
            color: #94a3b8;
        }
        
        code {
            font-family: 'JetBrains Mono', 'Fira Code', 'Monaco', 'Consolas', monospace;
            font-size: 0.875rem;
            color: #1e293b;
            font-weight: 500;
        }
        
        .dark code {
            color: #f1f5f9;
        }
        
        /* Enhanced inline code styling */
        :not(pre) > code {
            background: linear-gradient(135deg, #f1f5f9 0%, #e2e8f0 100%);
            padding: 0.125rem 0.375rem;
            border-radius: 0.375rem;
            font-size: 0.8rem;
            border: 1px solid rgba(226, 232, 240, 0.6);
            font-weight: 600;
            box-shadow: 0 1px 2px rgba(0, 0, 0, 0.05);
        }
        
        .dark :not(pre) > code {
            background: linear-gradient(135deg, #334155 0%, #475569 100%);
            border: 1px solid rgba(71, 85, 105, 0.6);
            color: #e2e8f0;
            box-shadow: 0 1px 2px rgba(0, 0, 0, 0.2);
        }
        
        /* Enhanced error cards with modern design */
        .error-card {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(10px);
            border-radius: 0.75rem;
            padding: 1.5rem;
            margin-bottom: 1.5rem;
            border: 1px solid rgba(226, 232, 240, 0.3);
            box-shadow: 
                0 4px 16px rgba(0, 0, 0, 0.05),
                0 2px 8px rgba(0, 0, 0, 0.03);
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            position: relative;
            overflow: hidden;
        }
        
        .dark .error-card {
            background: rgba(30, 41, 59, 0.8);
            backdrop-filter: blur(16px);
            border: 1px solid rgba(71, 85, 105, 0.2);
            box-shadow: 
                0 4px 16px rgba(0, 0, 0, 0.2),
                0 2px 8px rgba(0, 0, 0, 0.1);
        }
        
        .error-card:hover {
            transform: translateY(-1px);
            box-shadow: 
                0 8px 24px rgba(0, 0, 0, 0.08),
                0 4px 12px rgba(0, 0, 0, 0.05);
        }
        
        .dark .error-card:hover {
            box-shadow: 
                0 8px 24px rgba(0, 0, 0, 0.3),
                0 4px 12px rgba(0, 0, 0, 0.2);
        }
        
        .error-title {
            font-weight: 700;
            font-size: 1.1rem;
            color: #dc2626;
            margin-bottom: 0.5rem;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }
        
        .dark .error-title {
            color: #fca5a5;
        }
        
        /* Enhanced severity badges with modern pill design */
        .severity-Critical { 
            color: #ffffff; 
            background: linear-gradient(135deg, #dc2626 0%, #b91c1c 100%);
            padding: 0.375rem 0.75rem;
            border-radius: 9999px;
            font-weight: 600;
            font-size: 0.8rem;
            text-transform: uppercase;
            letter-spacing: 0.05em;
            box-shadow: 0 2px 8px rgba(220, 38, 38, 0.3);
            border: 1px solid rgba(220, 38, 38, 0.2);
        }
        .severity-High { 
            color: #ffffff; 
            background: linear-gradient(135deg, #ea580c 0%, #c2410c 100%);
            padding: 0.375rem 0.75rem;
            border-radius: 9999px;
            font-weight: 600;
            font-size: 0.8rem;
            text-transform: uppercase;
            letter-spacing: 0.05em;
            box-shadow: 0 2px 8px rgba(234, 88, 12, 0.3);
            border: 1px solid rgba(234, 88, 12, 0.2);
        }
        .severity-Medium { 
            color: #ffffff; 
            background: linear-gradient(135deg, #d97706 0%, #b45309 100%);
            padding: 0.375rem 0.75rem;
            border-radius: 9999px;
            font-weight: 600;
            font-size: 0.8rem;
            text-transform: uppercase;
            letter-spacing: 0.05em;
            box-shadow: 0 2px 8px rgba(217, 119, 6, 0.3);
            border: 1px solid rgba(217, 119, 6, 0.2);
        }
        .severity-Low { 
            color: #ffffff; 
            background: linear-gradient(135deg, #16a34a 0%, #15803d 100%);
            padding: 0.375rem 0.75rem;
            border-radius: 9999px;
            font-weight: 600;
            font-size: 0.8rem;
            text-transform: uppercase;
            letter-spacing: 0.05em;
            box-shadow: 0 2px 8px rgba(22, 163, 74, 0.3);
            border: 1px solid rgba(22, 163, 74, 0.2);
        }
        
        .dark .severity-Critical { 
            background: linear-gradient(135deg, #fca5a5 0%, #f87171 100%);
            color: #7f1d1d;
            box-shadow: 0 2px 8px rgba(252, 165, 165, 0.3);
        }
        .dark .severity-High { 
            background: linear-gradient(135deg, #fdba74 0%, #fb923c 100%);
            color: #7c2d12;
            box-shadow: 0 2px 8px rgba(253, 186, 116, 0.3);
        }
        .dark .severity-Medium { 
            background: linear-gradient(135deg, #fde68a 0%, #facc15 100%);
            color: #78350f;
            box-shadow: 0 2px 8px rgba(253, 230, 138, 0.3);
        }
        .dark .severity-Low { 
            background: linear-gradient(135deg, #86efac 0%, #4ade80 100%);
            color: #14532d;
            box-shadow: 0 2px 8px rgba(134, 239, 172, 0.3);
        }
        
        .remediation-list {
            list-style-type: none;
            padding-left: 0;
            color: #475569;
        }
        
        .remediation-list li {
            position: relative;
            padding-left: 2rem;
            margin-bottom: 0.75rem;
            line-height: 1.6;
        }
        
        .remediation-list li::before {
            content: "âœ“";
            position: absolute;
            left: 0;
            top: 0;
            color: #22c55e;
            font-weight: bold;
            font-size: 1.1rem;
        }
        
        .dark .remediation-list {
            color: #cbd5e1;
        }
        
        .dark .remediation-list li::before {
            color: #4ade80;
        }
        
        /* Enhanced UI elements styling */
        .modern-card {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(10px);
            border-radius: 1rem;
            padding: 1.5rem;
            border: 1px solid rgba(226, 232, 240, 0.3);
            box-shadow: 
                0 4px 16px rgba(0, 0, 0, 0.05),
                0 2px 8px rgba(0, 0, 0, 0.03);
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
        }
        
        .dark .modern-card {
            background: rgba(30, 41, 59, 0.8);
            backdrop-filter: blur(16px);
            border: 1px solid rgba(71, 85, 105, 0.2);
            box-shadow: 
                0 4px 16px rgba(0, 0, 0, 0.2),
                0 2px 8px rgba(0, 0, 0, 0.1);
        }
        
        .modern-card:hover {
            transform: translateY(-2px);
            box-shadow: 
                0 8px 24px rgba(0, 0, 0, 0.08),
                0 4px 12px rgba(0, 0, 0, 0.05);
        }
        
        .dark .modern-card:hover {
            box-shadow: 
                0 8px 24px rgba(0, 0, 0, 0.3),
                0 4px 12px rgba(0, 0, 0, 0.2);
        }
        
        /* Enhanced buttons */
        .modern-button {
            background: linear-gradient(135deg, #0ea5e9 0%, #0284c7 100%);
            border: none;
            border-radius: 0.75rem;
            padding: 0.75rem 1.5rem;
            color: white;
            font-weight: 600;
            font-size: 0.875rem;
            letter-spacing: 0.025em;
            cursor: pointer;
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            box-shadow: 0 4px 12px rgba(14, 165, 233, 0.3);
        }
        
        .modern-button:hover {
            transform: translateY(-1px);
            box-shadow: 0 8px 20px rgba(14, 165, 233, 0.4);
            background: linear-gradient(135deg, #38bdf8 0%, #0ea5e9 100%);
        }
        
        .dark .modern-button {
            box-shadow: 0 4px 12px rgba(14, 165, 233, 0.2);
        }
        
        .dark .modern-button:hover {
            box-shadow: 0 8px 20px rgba(14, 165, 233, 0.3);
        }

        /* Search Highlighting */
        mark {
            background-color: #fef08a;
            color: #374151;
            padding: 0.125rem 0.25rem;
            border-radius: 0.25rem;
            font-weight: 500;
        }
        
        .dark mark {
            background-color: #ca8a04;
            color: #f9fafb;
        }

        /* Search loading animation */
        .search-loading {
            position: relative;
        }
        
        .search-loading::after {
            content: '';
            position: absolute;
            right: 0.75rem;
            top: 50%;
            transform: translateY(-50%);
            width: 1rem;
            height: 1rem;
            border: 2px solid #e5e7eb;
            border-top: 2px solid #3b82f6;
            border-radius: 50%;
            animation: spin 1s linear infinite;
        }
        
        @keyframes spin {
            0% { transform: translateY(-50%) rotate(0deg); }
            100% { transform: translateY(-50%) rotate(360deg); }
        }
    </style>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800&family=JetBrains+Mono:wght@400;500;600&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.2/css/all.min.css" integrity="sha512-SnH5WK+bZxgPHs44uWIX+LLJAJ9/2PkPKZ5QiAj6Ta86w+fsb2TkcmfRyVX3pBnMFcV7oQPJkl9QevSCWr3W6A==" crossorigin="anonymous" referrerpolicy="no-referrer" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism-tomorrow.min.css" />
    <script>
        // Tailwind CSS configuration for dark mode and custom primary colors
        tailwind.config = {
            darkMode: 'class',
            theme: {
                extend: {
                    colors: {
                        // Enhanced primary color palette with better contrast
                        'primary': { 
                            '50': '#eff9ff', 
                            '100': '#def2ff', 
                            '200': '#b6e8ff', 
                            '300': '#75d7ff', 
                            '400': '#2cc4ff', 
                            '500': '#00a8f0', 
                            '600': '#0090d1', 
                            '700': '#0074aa', 
                            '800': '#005f8c', 
                            '900': '#064e73' 
                        },
                        // Enhanced base color palette for better readability
                        'base': { 
                            '50': '#f8fafc', 
                            '100': '#f1f5f9', 
                            '200': '#e2e8f0', 
                            '300': '#cbd5e1', 
                            '400': '#94a3b8', 
                            '500': '#64748b', 
                            '600': '#475569', 
                            '700': '#334155', 
                            '800': '#1e293b', 
                            '900': '#0f172a' 
                        },
                        // Enhanced semantic colors for better UX
                        'success': {
                            '50': '#f0fdf4',
                            '100': '#dcfce7',
                            '200': '#bbf7d0',
                            '300': '#86efac',
                            '400': '#4ade80',
                            '500': '#22c55e',
                            '600': '#16a34a',
                            '700': '#15803d',
                            '800': '#166534',
                            '900': '#14532d'
                        },
                        'warning': {
                            '50': '#fffbeb',
                            '100': '#fef3c7',
                            '200': '#fde68a',
                            '300': '#fcd34d',
                            '400': '#fbbf24',
                            '500': '#f59e0b',
                            '600': '#d97706',
                            '700': '#b45309',
                            '800': '#92400e',
                            '900': '#78350f'
                        },
                        'danger': {
                            '50': '#fef2f2',
                            '100': '#fee2e2',
                            '200': '#fecaca',
                            '300': '#fca5a5',
                            '400': '#f87171',
                            '500': '#ef4444',
                            '600': '#dc2626',
                            '700': '#b91c1c',
                            '800': '#991b1b',
                            '900': '#7f1d1d'
                        }
                    }
                }
            }
        }
    </script>
    <style>
        body { 
            font-family: 'Inter', sans-serif; 
            -webkit-font-smoothing: antialiased; 
            -moz-osx-font-smoothing: grayscale;
            background-color: #f8fafc;
            transition: background-color 0.3s ease;
        }
        
        .dark body {
            background-color: #0f172a;
        }
        
        .solution { 
            max-height: 0; 
            overflow: hidden; 
            transition: max-height 0.5s ease-in-out; 
        }
        .solution.open { 
            max-height: 3000px; 
        }
        
        /* Enhanced sidebar active state */
        .sidebar-item.active { 
            background: linear-gradient(135deg, #e0f2fe 0%, #bae6fd 100%);
            color: #0074aa; 
            font-weight: 600;
            border-left: 4px solid #0074aa;
            box-shadow: 0 2px 4px rgba(0, 116, 170, 0.1);
        }
        .dark .sidebar-item.active { 
            background: linear-gradient(135deg, #1e293b 0%, #334155 100%);
            color: #75d7ff;
            border-left: 4px solid #75d7ff;
            box-shadow: 0 2px 4px rgba(117, 215, 255, 0.1);
        }
        
        /* Enhanced sidebar hover states */
        .sidebar-item:hover {
            background-color: #f1f5f9;
            transform: translateX(2px);
            transition: all 0.2s ease-in-out;
        }
        
        .dark .sidebar-item:hover {
            background-color: #1e293b;
        }
        
        .accordion-icon { 
            transition: transform 0.3s ease-in-out; 
        }
        
        /* Enhanced code block container */
        .code-block-container { 
            position: relative; 
            margin-top: 1rem;
            border-radius: 0.5rem;
            overflow: hidden;
        }
        
        .copy-btn { 
            position: absolute; 
            top: 0.5rem; 
            right: 0.5rem; 
            background: linear-gradient(135deg, #475569 0%, #334155 100%);
            color: #e2e8f0; 
            padding: 0.375rem 0.75rem;
            border-radius: 0.375rem;
            font-size: 0.75rem; 
            cursor: pointer; 
            opacity: 0; 
            transition: all 0.2s ease-in-out;
            border: 1px solid rgba(255, 255, 255, 0.1);
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
        }
        
        .copy-btn:hover {
            background: linear-gradient(135deg, #334155 0%, #1e293b 100%);
            transform: translateY(-1px);
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.15);
        }
        
        .code-block-container:hover .copy-btn { 
            opacity: 1; 
        }
        
        @keyframes fadeInUp { 
            from { 
                opacity: 0; 
                transform: translateY(10px); 
            } 
            to { 
                opacity: 1; 
                transform: translateY(0); 
            } 
        }
        
        /* Optimized loading animations */
        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }
        
        @keyframes slideIn {
            from { 
                opacity: 0; 
                transform: translateX(-20px); 
            }
            to { 
                opacity: 1; 
                transform: translateX(0); 
            }
        }
        
        /* Loading states */
        .search-loading {
            background-image: linear-gradient(90deg, transparent, rgba(59, 130, 246, 0.1), transparent);
            background-size: 200px 100%;
            background-repeat: no-repeat;
            animation: loading 1.5s infinite;
        }
        
        @keyframes loading {
            0% { background-position: -200px 0; }
            100% { background-position: calc(200px + 100%) 0; }
        }
        
        /* Loading spinner */
        .loading-spinner {
            display: inline-block;
            width: 20px;
            height: 20px;
            border: 3px solid rgba(59, 130, 246, 0.3);
            border-radius: 50%;
            border-top-color: #3b82f6;
            animation: spin 1s ease-in-out infinite;
        }
        
        @keyframes spin {
            to { transform: rotate(360deg); }
        }
        
        /* Search loading state */
        .search-loading::after {
            content: '';
            position: absolute;
            right: 12px;
            top: 50%;
            transform: translateY(-50%);
            width: 16px;
            height: 16px;
            border: 2px solid rgba(59, 130, 246, 0.3);
            border-radius: 50%;
            border-top-color: #3b82f6;
            animation: spin 1s linear infinite;
        }
        
        /* Performance optimizations */
        .gpu-accelerated {
            transform: translateZ(0);
            will-change: transform;
        }
        
        /* Touch improvements for mobile */
        @media (hover: none) and (pointer: coarse) {
            .accordion-item:hover {
                transform: none;
                box-shadow: 0 4px 16px rgba(0, 0, 0, 0.05), 0 2px 8px rgba(0, 0, 0, 0.03);
            }
            
            .modern-button:hover {
                transform: none;
            }
            
            button, .button, .sidebar-item {
                min-height: 44px; /* Minimum touch target size */
                min-width: 44px;
            }
        }
        
        .accordion-item, .stat-card { 
            animation: fadeInUp 0.5s ease-out forwards; 
            animation-delay: var(--delay, 0s);
            will-change: transform, opacity;
        }
        
        /* Enhanced accordion items with modern glassmorphism design */
        .accordion-item { 
            border: 1px solid rgba(226, 232, 240, 0.3);
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(10px);
            border-radius: 1rem;
            box-shadow: 
                0 4px 16px rgba(0, 0, 0, 0.05),
                0 2px 8px rgba(0, 0, 0, 0.03);
            contain: layout style paint;
        }
        
        .dark .accordion-item { 
            border: 1px solid rgba(71, 85, 105, 0.2);
            background: rgba(30, 41, 59, 0.8);
            backdrop-filter: blur(16px);
            box-shadow: 
                0 4px 16px rgba(0, 0, 0, 0.2),
                0 2px 8px rgba(0, 0, 0, 0.1);
        }
        
        .accordion-item:hover { 
            transform: translateY(-2px) scale(1.001);
            border-color: #0ea5e9;
            box-shadow: 
                0 8px 24px rgba(0, 0, 0, 0.08),
                0 4px 12px rgba(0, 0, 0, 0.05);
        }
        
        .dark .accordion-item:hover { 
            border-color: #38bdf8;
            box-shadow: 
                0 8px 24px rgba(0, 0, 0, 0.3),
                0 4px 12px rgba(0, 0, 0, 0.2);
        }
        
        /* Enhanced stat cards with gradient backgrounds */
        .stat-card {
            background: linear-gradient(135deg, #ffffff 0%, #f8fafc 100%);
            border: 1px solid rgba(226, 232, 240, 0.3);
            border-radius: 1rem;
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            box-shadow: 
                0 4px 16px rgba(0, 0, 0, 0.05),
                0 2px 8px rgba(0, 0, 0, 0.03);
        }
        
        .dark .stat-card {
            background: linear-gradient(135deg, #1e293b 0%, #334155 100%);
            border: 1px solid rgba(71, 85, 105, 0.2);
            box-shadow: 
                0 4px 16px rgba(0, 0, 0, 0.2),
                0 2px 8px rgba(0, 0, 0, 0.1);
        }
        
        .stat-card:hover {
            transform: translateY(-4px) scale(1.005);
            box-shadow: 
                0 12px 32px rgba(0, 0, 0, 0.1),
                0 6px 16px rgba(0, 0, 0, 0.05);
        }
        
        .dark .stat-card:hover {
            box-shadow: 
                0 12px 32px rgba(0, 0, 0, 0.4),
                0 6px 16px rgba(0, 0, 0, 0.25);
        }
        
        .modal-overlay { 
            transition: opacity 0.3s ease-in-out; 
        }
        .modal-container { 
            transition: transform 0.3s ease-in-out; 
        }
        
        pre[class*="language-"] { 
            border-radius: 0.5rem;
            border: 1px solid #e2e8f0;
        }
        
        .dark pre[class*="language-"] {
            border: 1px solid #334155;
        }
        /* Enhanced typing indicator */
        .typing-indicator span {
            height: 8px;
            width: 8px;
            float: left;
            margin: 0 1px;
            background-color: #64748b;
            display: block;
            border-radius: 50%;
            opacity: 0.4;
            animation: 1s blink infinite;
        }
        
        .dark .typing-indicator span {
            background-color: #94a3b8;
        }
        
        .typing-indicator span:nth-child(2) { animation-delay: .2s; }
        .typing-indicator span:nth-child(3) { animation-delay: .4s; }
        
        @keyframes blink {
            50% { opacity: 1; }
        }
        
        /* Enhanced content cards with modern design system */
        .glossary-term, .catalog-table, .error-guide-item, .extension-guide-item, 
        .cheatsheet-category, .tuning-parameter, .monitoring-template, 
        .version-table, .acid-property {
            border-left: 4px solid transparent;
            background: linear-gradient(135deg, rgba(255, 255, 255, 0.95) 0%, rgba(248, 250, 252, 0.95) 100%);
            backdrop-filter: blur(10px);
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            border-radius: 0.75rem;
            box-shadow: 
                0 4px 16px rgba(0, 0, 0, 0.05),
                0 2px 8px rgba(0, 0, 0, 0.03);
            position: relative;
            overflow: hidden;
        }
        
        .glossary-term::before, .catalog-table::before, .error-guide-item::before, 
        .extension-guide-item::before, .cheatsheet-category::before, 
        .tuning-parameter::before, .monitoring-template::before, 
        .version-table::before, .acid-property::before {
            content: '';
            position: absolute;
            left: 0;
            top: 0;
            width: 4px;
            height: 100%;
            background: linear-gradient(135deg, #0ea5e9 0%, #0284c7 100%);
            transition: all 0.3s ease;
        }
        
        .dark .glossary-term, .dark .catalog-table, .dark .error-guide-item, 
        .dark .extension-guide-item, .dark .cheatsheet-category, 
        .dark .tuning-parameter, .dark .monitoring-template, 
        .dark .version-table, .dark .acid-property {
            background: linear-gradient(135deg, rgba(30, 41, 59, 0.8) 0%, rgba(51, 65, 85, 0.8) 100%);
            backdrop-filter: blur(16px);
            box-shadow: 
                0 4px 16px rgba(0, 0, 0, 0.2),
                0 2px 8px rgba(0, 0, 0, 0.1);
        }
        
        .dark .glossary-term::before, .dark .catalog-table::before, .dark .error-guide-item::before, 
        .dark .extension-guide-item::before, .dark .cheatsheet-category::before, 
        .dark .tuning-parameter::before, .dark .monitoring-template::before, 
        .dark .version-table::before, .dark .acid-property::before {
            background: linear-gradient(135deg, #38bdf8 0%, #0ea5e9 100%);
        }
        
        .glossary-term:hover, .catalog-table:hover, .error-guide-item:hover, 
        .extension-guide-item:hover, .cheatsheet-category:hover, 
        .tuning-parameter:hover, .monitoring-template:hover, 
        .version-table:hover, .acid-property:hover {
            transform: translateY(-2px) scale(1.001);
            box-shadow: 
                0 8px 24px rgba(0, 0, 0, 0.08),
                0 4px 12px rgba(0, 0, 0, 0.05);
        }
        
        .glossary-term:hover::before, .catalog-table:hover::before, .error-guide-item:hover::before, 
        .extension-guide-item:hover::before, .cheatsheet-category:hover::before, 
        .tuning-parameter:hover::before, .monitoring-template:hover::before, 
        .version-table:hover::before, .acid-property:hover::before {
            width: 6px;
            background: linear-gradient(135deg, #3b82f6 0%, #1d4ed8 100%);
        }
        
        .dark .glossary-term:hover, .dark .catalog-table:hover, 
        .dark .error-guide-item:hover, .dark .extension-guide-item:hover, 
        .dark .cheatsheet-category:hover, .dark .tuning-parameter:hover, 
        .dark .monitoring-template:hover, .dark .version-table:hover, 
        .dark .acid-property:hover {
            box-shadow: 
                0 8px 24px rgba(0, 0, 0, 0.3),
                0 4px 12px rgba(0, 0, 0, 0.2);
        }
        
        .dark .glossary-term:hover::before, .dark .catalog-table:hover::before, 
        .dark .error-guide-item:hover::before, .dark .extension-guide-item:hover::before, 
        .dark .cheatsheet-category:hover::before, .dark .tuning-parameter:hover::before, 
        .dark .monitoring-template:hover::before, .dark .version-table:hover::before, 
        .dark .acid-property:hover::before {
            background: linear-gradient(135deg, #60a5fa 0%, #3b82f6 100%);
        }
        
        /* Enhanced back to top button */
        #back-to-top-btn {
            background: linear-gradient(135deg, #00a8f0 0%, #0074aa 100%);
            transition: all 0.3s ease-in-out;
            box-shadow: 0 4px 6px rgba(0, 168, 240, 0.3);
        }
        
        #back-to-top-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 12px rgba(0, 168, 240, 0.4);
            background: linear-gradient(135deg, #0074aa 0%, #005f8c 100%);
        }
        
        /* Enhanced form elements */
        input, textarea, select {
            transition: all 0.2s ease-in-out;
            border: 1px solid #e2e8f0;
        }
        
        input:focus, textarea:focus, select:focus {
            border-color: #00a8f0;
            box-shadow: 0 0 0 3px rgba(0, 168, 240, 0.1);
            outline: none;
        }
        
        .dark input, .dark textarea, .dark select {
            border: 1px solid #334155;
            background-color: #1e293b;
            color: #e2e8f0;
        }
        
        .dark input:focus, .dark textarea:focus, .dark select:focus {
            border-color: #75d7ff;
            box-shadow: 0 0 0 3px rgba(117, 215, 255, 0.1);
        }
        
        /* Enhanced buttons */
        .btn-primary {
            background: linear-gradient(135deg, #00a8f0 0%, #0074aa 100%);
            transition: all 0.2s ease-in-out;
            box-shadow: 0 2px 4px rgba(0, 168, 240, 0.2);
        }
        
        .btn-primary:hover {
            transform: translateY(-1px);
            box-shadow: 0 4px 8px rgba(0, 168, 240, 0.3);
            background: linear-gradient(135deg, #0074aa 0%, #005f8c 100%);
        }
        
        /* Enhanced scrollbar */
        ::-webkit-scrollbar {
            width: 8px;
            height: 8px;
        }
        
        ::-webkit-scrollbar-track {
            background: #f1f5f9;
        }
        
        .dark ::-webkit-scrollbar-track {
            background: #1e293b;
        }
        
        ::-webkit-scrollbar-thumb {
            background: linear-gradient(135deg, #cbd5e1 0%, #94a3b8 100%);
            border-radius: 4px;
        }
        
        ::-webkit-scrollbar-thumb:hover {
            background: linear-gradient(135deg, #94a3b8 0%, #64748b 100%);
        }
        
        .dark ::-webkit-scrollbar-thumb {
            background: linear-gradient(135deg, #475569 0%, #334155 100%);
        }
        
        .dark ::-webkit-scrollbar-thumb:hover {
            background: linear-gradient(135deg, #64748b 0%, #475569 100%);
        }
        
        /* Enhanced table styling */
        table {
            border-collapse: separate;
            border-spacing: 0;
        }
        
        table th {
            background-color: #f1f5f9;
            font-weight: 600;
        }
        
        .dark table th {
            background-color: #334155;
            color: #f1f5f9;
        }
        
        table td, table th {
            border-right: 1px solid #e2e8f0;
        }
        
        .dark table td, .dark table th {
            border-right: 1px solid #475569;
        }
        
        table tr:last-child td {
            border-bottom: none;
        }
        
        table th:last-child, table td:last-child {
            border-right: none;
        }
        
        /* Enhanced visual content styling */
        .visual-content, .diagram-container {
            background-color: #ffffff;
            border: 2px solid #e2e8f0;
            border-radius: 0.75rem;
            padding: 1.5rem;
            margin: 1.5rem 0;
            position: relative;
            overflow: hidden;
        }
        
        .dark .visual-content, .dark .diagram-container {
            background-color: #0f172a;
            border: 2px solid #334155;
            color: #f8fafc;
        }

        /* Typography improvements for diagrams */
        .visual-content pre, .diagram-container pre {
            background-color: #f8fafc;
            color: #1e293b;
            border: 1px solid #cbd5e1;
            border-radius: 0.5rem;
            padding: 1rem;
            font-family: 'JetBrains Mono', monospace;
            font-size: 0.875rem;
            line-height: 1.4;
            overflow-x: auto;
        }

        .dark .visual-content pre, .dark .diagram-container pre {
            background-color: #1e293b;
            color: #e2e8f0;
            border: 1px solid #475569;
        }

        /* ASCII Art and Diagram Styling */
        .visual-content .ascii-art, .diagram-container .ascii-art {
            font-family: 'JetBrains Mono', monospace;
            font-size: 0.75rem;
            line-height: 1.2;
            white-space: pre;
            color: #374151;
            background-color: #f9fafb;
            padding: 1.5rem;
            border-radius: 0.5rem;
            border: 1px solid #d1d5db;
            overflow-x: auto;
        }

        .dark .visual-content .ascii-art, .dark .diagram-container .ascii-art {
            color: #d1d5db;
            background-color: #111827;
            border: 1px solid #374151;
        }

        /* Box elements in diagrams */
        .visual-content .box, .diagram-container .box {
            background-color: #dbeafe;
            border: 2px solid #3b82f6;
            color: #1e40af;
            padding: 0.5rem 1rem;
            border-radius: 0.375rem;
            display: inline-block;
            margin: 0.25rem;
            font-weight: 600;
        }

        .dark .visual-content .box, .dark .diagram-container .box {
            background-color: #1e3a8a;
            border: 2px solid #60a5fa;
            color: #dbeafe;
        }

        /* Arrow and connector styling */
        .visual-content .arrow, .diagram-container .arrow {
            color: #6366f1;
            font-weight: bold;
        }

        .dark .visual-content .arrow, .dark .diagram-container .arrow {
            color: #a5b4fc;
        }

        /* SVG diagram styling for better dark mode visibility */
        svg {
            background-color: transparent;
            max-width: 100%;
            height: auto;
        }
        
        .dark svg text, .dark svg .txt {
            fill: #f1f5f9 !important;
        }
        
        .dark svg line, .dark svg .line {
            stroke: #94a3b8 !important;
        }
        
        .dark svg rect, .dark svg .box {
            stroke: #64748b !important;
            fill: #1e293b !important;
        }

        .dark svg path {
            stroke: #94a3b8 !important;
        }

        /* Enhanced contrast for readability */
        .visual-content h4, .diagram-container h4 {
            color: #1f2937;
            font-weight: 700;
            margin-bottom: 0.75rem;
        }

        .dark .visual-content h4, .dark .diagram-container h4 {
            color: #f9fafb;
        }

        /* Special styling for PostgreSQL architecture diagrams */
        .postgres-architecture {
            background: linear-gradient(135deg, #f0f9ff 0%, #e0f2fe 100%);
            border: 2px solid #0ea5e9;
        }

        .dark .postgres-architecture {
            background: linear-gradient(135deg, #0c4a6e 0%, #075985 100%);
            border: 2px solid #0284c7;
        }
        
        /* Enhanced tab navigation system */
        .tab-navigation {
            display: flex;
            flex-wrap: wrap;
            gap: 0.5rem;
            margin-bottom: 2rem;
            border-bottom: 2px solid #e2e8f0;
            padding-bottom: 0.5rem;
        }

        .dark .tab-navigation {
            border-bottom-color: #475569;
        }

        .tab-button {
            padding: 0.75rem 1.5rem;
            background: transparent;
            border: 1px solid #e2e8f0;
            border-radius: 0.5rem 0.5rem 0 0;
            color: #64748b;
            font-weight: 500;
            transition: all 0.3s ease;
            cursor: pointer;
            position: relative;
            overflow: hidden;
        }

        .tab-button:hover {
            background: #f8fafc;
            color: #334155;
            border-color: #cbd5e1;
            transform: translateY(-1px);
        }

        .tab-button.active {
            background: linear-gradient(135deg, #0ea5e9 0%, #0284c7 100%);
            color: white;
            border-color: #0284c7;
            box-shadow: 0 4px 12px rgba(2, 132, 199, 0.3);
        }

        .dark .tab-button {
            border-color: #475569;
            color: #94a3b8;
        }

        .dark .tab-button:hover {
            background: #1e293b;
            color: #e2e8f0;
            border-color: #64748b;
        }

        .dark .tab-button.active {
            background: linear-gradient(135deg, #0ea5e9 0%, #0284c7 100%);
            color: white;
            border-color: #38bdf8;
        }

        .tab-content {
            display: none;
            animation: fadeInUp 0.5s ease-out;
        }

        .tab-content.active {
            display: block;
        }

        /* Enhanced category cards with improved visual hierarchy */
        .category-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(350px, 1fr));
            gap: 1.5rem;
            margin: 2rem 0;
        }

        .category-card {
            background: linear-gradient(135deg, rgba(255, 255, 255, 0.9) 0%, rgba(248, 250, 252, 0.9) 100%);
            backdrop-filter: blur(10px);
            border: 1px solid rgba(226, 232, 240, 0.5);
            border-radius: 1rem;
            padding: 1.5rem;
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            cursor: pointer;
            position: relative;
            overflow: hidden;
        }

        .dark .category-card {
            background: linear-gradient(135deg, rgba(30, 41, 59, 0.8) 0%, rgba(51, 65, 85, 0.8) 100%);
            border-color: rgba(148, 163, 184, 0.2);
        }

        .category-card:hover {
            transform: translateY(-4px) scale(1.02);
            box-shadow: 
                0 20px 40px rgba(0, 0, 0, 0.1),
                0 8px 16px rgba(0, 0, 0, 0.06);
            border-color: #0ea5e9;
        }

        .dark .category-card:hover {
            box-shadow: 
                0 20px 40px rgba(0, 0, 0, 0.3),
                0 8px 16px rgba(0, 0, 0, 0.2);
            border-color: #38bdf8;
        }

        .category-icon {
            width: 3rem;
            height: 3rem;
            background: linear-gradient(135deg, #0ea5e9 0%, #0284c7 100%);
            border-radius: 0.75rem;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-size: 1.25rem;
            margin-bottom: 1rem;
        }

        .category-title {
            font-size: 1.25rem;
            font-weight: 700;
            color: #1f2937;
            margin-bottom: 0.5rem;
        }

        .dark .category-title {
            color: #f9fafb;
        }

        .category-description {
            color: #6b7280;
            font-size: 0.875rem;
            line-height: 1.5;
            margin-bottom: 1rem;
        }

        .dark .category-description {
            color: #d1d5db;
        }

        .category-stats {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding-top: 1rem;
            border-top: 1px solid #e5e7eb;
        }

        .dark .category-stats {
            border-top-color: #374151;
        }

        /* Quick action buttons */
        .quick-actions {
            display: flex;
            gap: 0.75rem;
            margin: 2rem 0;
            flex-wrap: wrap;
        }

        .quick-action-btn {
            background: linear-gradient(135deg, #f3f4f6 0%, #e5e7eb 100%);
            border: 1px solid #d1d5db;
            color: #374151;
            padding: 0.75rem 1.5rem;
            border-radius: 0.75rem;
            font-weight: 500;
            transition: all 0.3s ease;
            cursor: pointer;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .quick-action-btn:hover {
            background: linear-gradient(135deg, #0ea5e9 0%, #0284c7 100%);
            color: white;
            border-color: #0284c7;
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(2, 132, 199, 0.3);
        }

        .dark .quick-action-btn {
            background: linear-gradient(135deg, #374151 0%, #4b5563 100%);
            border-color: #6b7280;
            color: #d1d5db;
        }

        /* Keyboard shortcuts indicator */
        .keyboard-shortcut {
            position: fixed;
            bottom: 1rem;
            left: 1rem;
            background: rgba(0, 0, 0, 0.8);
            color: white;
            padding: 0.5rem 1rem;
            border-radius: 0.5rem;
            font-size: 0.75rem;
            backdrop-filter: blur(10px);
            opacity: 0;
            transform: translateY(1rem);
            transition: all 0.3s ease;
            z-index: 1000;
        }

        .keyboard-shortcut.show {
            opacity: 1;
            transform: translateY(0);
        }

        /* Enhanced search results */
        .search-result-highlight {
            background-color: #fef3cd;
            color: #856404;
            padding: 0.125rem 0.25rem;
            border-radius: 0.25rem;
        }

        .dark .search-result-highlight {
            background-color: #451a03;
            color: #fbbf24;
        }

        /* Progress indicators */
        .progress-bar {
            width: 100%;
            height: 0.25rem;
            background-color: #e5e7eb;
            border-radius: 0.125rem;
            overflow: hidden;
        }

        .dark .progress-bar {
            background-color: #374151;
        }

        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, #0ea5e9, #3b82f6);
            border-radius: 0.125rem;
            transition: width 0.3s ease;
        }

        /* Enhanced tooltips */
        .tooltip {
            position: relative;
        }

        .tooltip::before {
            content: attr(data-tooltip);
            position: absolute;
            bottom: 100%;
            left: 50%;
            transform: translateX(-50%);
            background: rgba(0, 0, 0, 0.9);
            color: white;
            padding: 0.5rem;
            border-radius: 0.25rem;
            font-size: 0.75rem;
            white-space: nowrap;
            opacity: 0;
            pointer-events: none;
            transition: opacity 0.3s ease;
            margin-bottom: 0.25rem;
        }

        .tooltip:hover::before {
            opacity: 1;
        }
        
        /* Better list styling */
        ul, ol {
            color: #374151;
        }
        
        .dark ul, .dark ol {
            color: #d1d5db;
        }
        
        li {
            margin-bottom: 0.25rem;
        }
        
        /* Enhanced strong/bold text visibility */
        strong, b {
            color: #111827;
            font-weight: 600;
        }
        
        .dark strong, .dark b {
            color: #f9fafb;
            font-weight: 600;
        }
        
        .pro-tip-tag {
            font-size: 0.7rem;
            font-weight: 700;
            padding: 0.1rem 0.4rem;
            border-radius: 0.25rem;
            margin-right: 0.75rem;
            color: white;
            display: inline-block;
            vertical-align: middle;
        }
        .tag-error { background-color: #ef4444; } /* red-500 */
        /* Accessibility improvements */
        .visually-hidden {
            position: absolute !important;
            width: 1px !important;
            height: 1px !important;
            padding: 0 !important;
            margin: -1px !important;
            overflow: hidden !important;
            clip: rect(0, 0, 0, 0) !important;
            white-space: nowrap !important;
            border: 0 !important;
        }
        
        /* Focus styles */
        button:focus-visible,
        input:focus-visible,
        select:focus-visible,
        textarea:focus-visible,
        .sidebar-item:focus-visible {
            outline: 2px solid #0ea5e9;
            outline-offset: 2px;
            border-radius: 0.375rem;
        }
        
        /* Skip link */
        .skip-link {
            position: absolute;
            top: -40px;
            left: 6px;
            background: #0ea5e9;
            color: white;
            padding: 8px;
            text-decoration: none;
            z-index: 1000;
            border-radius: 4px;
        }
        
        .skip-link:focus {
            top: 6px;
        }
        
        /* Reduced motion */
        @media (prefers-reduced-motion: reduce) {
            *, *::before, *::after {
                animation-duration: 0.01ms !important;
                animation-iteration-count: 1 !important;
                transition-duration: 0.01ms !important;
                scroll-behavior: auto !important;
            }
        }
        
        /* High contrast mode */
        @media (prefers-contrast: high) {
            .accordion-item {
                border: 2px solid;
            }
            
            .modern-button {
                border: 2px solid;
            }
        }
        
        .tag-fix { background-color: #22c55e; }   /* green-500 */
        .tag-tune { background-color: #3b82f6; }   /* blue-500 */

        /* Prevent animation issues during orientation changes */
        .orientation-change * {
            transition: none !important;
            animation: none !important;
        }
        
        /* ===== MOBILE RESPONSIVENESS FIXES ===== */
        @media (max-width: 640px) {
            /* Better handling of code blocks on mobile */
            pre {
                font-size: 12px !important;
                padding: 0.75rem !important;
                max-width: 100%;
                overflow-x: auto;
                white-space: pre-wrap;
                word-break: break-word;
            }
            
            /* Improve form elements on small screens */
            input, select, textarea {
                font-size: 16px !important; /* Prevents iOS zoom on focus */
                max-width: 100%;
                box-sizing: border-box;
            }
            
            /* Adjust copy button positioning */
            .copy-btn {
                padding: 0.25rem 0.5rem;
                font-size: 0.75rem;
                right: 0.25rem;
                top: 0.25rem;
            }
            
            /* Improve mobile touch targets */
            button, .sidebar-item, .tab-button, a {
                min-height: 44px; /* Apple recommended minimum */
                min-width: 44px;
                display: inline-flex;
                align-items: center;
                justify-content: center;
            }
            
            /* Fix overflow issues */
            body, html {
                overflow-x: hidden;
                width: 100%;
                position: relative;
            }
            
            /* Improve readability of table on mobile */
            table {
                font-size: 0.875rem;
                display: block;
                overflow-x: auto;
                -webkit-overflow-scrolling: touch;
            }
            
            /* Adjust image sizes */
            img:not(.h-8) {
                max-width: 100% !important;
                height: auto !important;
            }
            
            /* Improve list readability */
            ul, ol {
                padding-left: 1.5rem;
            }
            
            /* Ensure content doesn't overflow horizontally */
            .container, .content-section, .modern-card {
                max-width: 100% !important;
                width: 100% !important;
                box-sizing: border-box;
                overflow-wrap: break-word;
            }
            
            /* Fix any absolute positioning that might cause layout issues */
            .tooltip::before {
                max-width: 200px;
            }
            
            /* Fix any SVG or diagram overflows */
            svg {
                max-width: 100%;
                height: auto;
            }
            
            /* Make font sizes more readable on mobile */
            h1 { font-size: 1.5rem !important; }
            h2 { font-size: 1.25rem !important; }
            h3 { font-size: 1.125rem !important; }
            p, li { font-size: 0.9375rem !important; }
            
            /* Improve search experience */
            #search-input, #mobile-search-input {
                height: 40px;
                font-size: 16px;
            }
            
            /* Ensure sidebar is properly sized */
            #sidebar {
                width: 85%;
                max-width: 300px;
            }
        }
        
        /* Additional breakpoint for very small screens */
        @media (max-width: 350px) {
            /* Further adjustments for very small screens */
            .p-4, .px-4, .py-4, .pt-4, .pb-4, .pl-4, .pr-4 {
                padding: 0.5rem !important;
            }
            
            h1 { font-size: 1.25rem !important; }
            h2 { font-size: 1.125rem !important; }
            h3 { font-size: 1rem !important; }
            
            /* Stack action buttons on very small screens */
            .fixed-action-buttons {
                display: flex;
                flex-direction: column;
                gap: 0.5rem;
            }
        }

        /* ===== PRINT OPTIMIZATION STYLES ===== */
        @media print {
            /* General print settings */
            * {
                -webkit-print-color-adjust: exact !important;
                print-color-adjust: exact !important;
            }
            
            body {
                background: white !important;
                color: black !important;
                font-size: 12pt !important;
                line-height: 1.4 !important;
            }
            
            /* Hide navigation and UI elements */
            #sidebar,
            header,
            #chat-widget,
            #chat-toggle-button,
            #back-to-top-btn,
            .feedback-section,
            .modern-button,
            .export-solution-btn,
            #filter-container,
            .keyboard-shortcut {
                display: none !important;
            }
            
            /* Adjust main content for print */
            main {
                margin: 0 !important;
                padding: 0 !important;
                width: 100% !important;
                height: auto !important;
                overflow: visible !important;
            }
            
            #content-area {
                margin: 0 !important;
                padding: 1cm !important;
                width: 100% !important;
                height: auto !important;
                overflow: visible !important;
            }
            
            /* Optimize accordion/solution layouts */
            .accordion-item {
                page-break-inside: avoid;
                margin-bottom: 1cm !important;
                border: 1px solid #ccc !important;
                border-radius: 0 !important;
                background: white !important;
                box-shadow: none !important;
            }
            
            .accordion-header {
                background: #f5f5f5 !important;
                color: black !important;
                border-bottom: 1px solid #ccc !important;
                padding: 0.5cm !important;
                page-break-after: avoid;
            }
            
            .solution {
                display: block !important;
                background: white !important;
                color: black !important;
                padding: 0.5cm !important;
            }
            
            /* Ensure solutions are always expanded in print */
            .solution.open,
            .solution {
                display: block !important;
                height: auto !important;
                overflow: visible !important;
            }
            
            /* Code blocks optimization */
            pre, code {
                background: #f8f8f8 !important;
                border: 1px solid #ccc !important;
                padding: 0.3cm !important;
                font-family: "Courier New", monospace !important;
                font-size: 10pt !important;
                white-space: pre-wrap !important;
                word-wrap: break-word !important;
                page-break-inside: avoid;
            }
            
            /* Typography optimization */
            h1, h2, h3, h4, h5, h6 {
                color: black !important;
                font-weight: bold !important;
                page-break-after: avoid;
                margin-top: 0.5cm !important;
                margin-bottom: 0.3cm !important;
            }
            
            h1 { font-size: 18pt !important; }
            h2 { font-size: 16pt !important; }
            h3 { font-size: 14pt !important; }
            h4 { font-size: 13pt !important; }
            
            /* Links */
            a {
                color: black !important;
                text-decoration: underline !important;
            }
            
            a:after {
                content: " (" attr(href) ")" !important;
                font-size: 10pt !important;
                color: #666 !important;
            }
            
            /* Tables */
            table {
                border-collapse: collapse !important;
                width: 100% !important;
                margin: 0.5cm 0 !important;
                page-break-inside: avoid;
            }
            
            th, td {
                border: 1px solid #ccc !important;
                padding: 0.2cm !important;
                text-align: left !important;
            }
            
            th {
                background: #f0f0f0 !important;
                font-weight: bold !important;
            }
            
            /* Architecture diagrams */
            .diagram-container {
                page-break-inside: avoid;
                margin: 0.5cm 0 !important;
                padding: 0.3cm !important;
                border: 1px solid #ccc !important;
                background: white !important;
            }
            
            .diagram-container h4 {
                text-align: center !important;
                margin-bottom: 0.3cm !important;
                border-bottom: 1px solid #ccc !important;
                padding-bottom: 0.2cm !important;
            }
            
            svg {
                max-width: 100% !important;
                height: auto !important;
                background: white !important;
            }
            
            /* Page headers and footers */
            @page {
                margin: 2cm;
                @top-center {
                    content: "PostgreSQL Knowledge Base";
                    font-size: 10pt;
                    color: #666;
                }
                @bottom-center {
                    content: "Page " counter(page) " of " counter(pages);
                    font-size: 10pt;
                    color: #666;
                }
                @bottom-right {
                    content: "Generated: " date();
                    font-size: 8pt;
                    color: #999;
                }
            }
            
            /* Page breaks */
            .page-break {
                page-break-before: always;
            }
            
            .no-break {
                page-break-inside: avoid;
            }
            
            /* Severity indicators */
            .severity-badge {
                padding: 0.1cm 0.2cm !important;
                border: 1px solid #ccc !important;
                border-radius: 0 !important;
                font-weight: bold !important;
                font-size: 10pt !important;
            }
            
            /* Issue metadata */
            .issue-meta {
                border: 1px solid #ccc !important;
                padding: 0.3cm !important;
                margin: 0.3cm 0 !important;
                background: #f9f9f9 !important;
            }
            
            /* Statistics and charts - convert to text */
            .stat-card, .chart-container {
                border: 1px solid #ccc !important;
                padding: 0.3cm !important;
                margin: 0.3cm 0 !important;
                background: #f9f9f9 !important;
            }
            
            canvas {
                display: none !important;
            }
            
            /* Error codes and technical details */
            .error-code {
                font-family: "Courier New", monospace !important;
                background: #f0f0f0 !important;
                padding: 0.1cm 0.2cm !important;
                border: 1px solid #ccc !important;
                font-weight: bold !important;
            }
            
            /* Remediation steps */
            .remediation-steps {
                margin: 0.5cm 0 !important;
                padding: 0.3cm !important;
                border-left: 3px solid #333 !important;
                background: #f9f9f9 !important;
            }
            
            .remediation-steps h5 {
                margin-top: 0 !important;
                color: black !important;
                font-weight: bold !important;
            }
            
            /* Troubleshooting code blocks */
            .troubleshooting-code {
                page-break-inside: avoid;
                margin: 0.5cm 0 !important;
                padding: 0.3cm !important;
                background: #f8f8f8 !important;
                border: 1px solid #ccc !important;
                font-family: "Courier New", monospace !important;
                font-size: 10pt !important;
            }
            
            /* Comments section - simplified for print */
            .comments-section {
                border-top: 1px solid #ccc !important;
                padding-top: 0.3cm !important;
                margin-top: 0.5cm !important;
            }
            
            .comment {
                margin: 0.3cm 0 !important;
                padding: 0.2cm !important;
                border: 1px solid #ddd !important;
                background: #fafafa !important;
            }
            
            /* Remove animations and transitions */
            * {
                animation: none !important;
                transition: none !important;
                transform: none !important;
            }
            
            /* Ensure good contrast for all text */
            .text-primary-600,
            .text-blue-600,
            .text-green-600,
            .text-red-600,
            .text-yellow-600 {
                color: black !important;
            }
            
            /* Background colors to white */
            .bg-primary-600,
            .bg-blue-600,
            .bg-green-600,
            .bg-red-600,
            .bg-yellow-600,
            .bg-base-100,
            .bg-base-200,
            .bg-base-800,
            .bg-base-900 {
                background: white !important;
                color: black !important;
            }
        }
    </style>
</head>
<body class="bg-base-50 dark:bg-base-900 text-base-800 dark:text-base-200">
    
    <!-- Skip Navigation Link -->
    <a href="#main-content" class="skip-link">Skip to main content</a>

    <!-- Mobile Menu Toggle Button (only visible on small screens) -->
    <button id="mobile-menu-toggle" class="fixed top-4 left-4 z-50 p-3 rounded-full bg-primary-600 text-white shadow-lg block sm:hidden focus:outline-none focus:ring-2 focus:ring-primary-500 focus:ring-offset-2">
        <i class="fa-solid fa-bars text-xl"></i>
    </button>
    
    <!-- Mobile Menu Overlay (only visible when menu is open) -->
    <div id="mobile-menu-overlay" class="fixed inset-0 bg-black bg-opacity-50 z-40 hidden"></div>

    <div class="flex h-screen bg-base-50 dark:bg-base-900">
        <!-- Sidebar Navigation -->
        <aside id="sidebar" class="w-72 bg-white dark:bg-base-800 border-r border-base-200 dark:border-base-700 flex flex-col transition-transform -translate-x-full sm:translate-x-0 sm:flex">
            <div class="p-4 border-b border-base-200 dark:border-base-700 flex items-center space-x-3">
                <img src="https://upload.wikimedia.org/wikipedia/commons/2/29/Postgresql_elephant.svg" alt="PostgreSQL Logo" class="h-8 w-8">
                <h1 class="text-xl font-bold text-base-900 dark:text-white">PostgreSQL Knowledge Base</h1>
            </div>
            <nav id="main-nav" class="flex-1 p-2 space-y-1 overflow-y-auto">
                <!-- Navigation items will be dynamically injected by JavaScript -->
            </nav>
            <div class="p-4 border-t border-base-200 dark:border-base-700">
                 <button id="report-issue-btn" class="w-full flex items-center justify-center p-2 mb-2 rounded-lg text-white bg-primary-600 hover:bg-primary-700 focus:outline-none text-sm font-semibold transition-colors">
                    <i class="fa-solid fa-flag mr-2"></i> Report an Issue
                </button>
                 <button id="theme-toggle" aria-label="Toggle theme" class="w-full flex items-center justify-center p-2 rounded-lg text-base-500 dark:text-base-400 hover:bg-base-100 dark:hover:bg-base-700 focus:outline-none text-xl transition-colors">
                    <i id="theme-toggle-dark-icon" class="fa-solid fa-moon hidden" aria-hidden="true"></i>
                    <i id="theme-toggle-light-icon" class="fa-solid fa-sun hidden" aria-hidden="true"></i>
                    <span class="ml-2 text-sm">Toggle Theme</span>
                </button>
            </div>
            <div class="p-4 border-t border-base-200 dark:border-base-700 text-center text-xs text-base-500 dark:text-base-400">
                <p>Â© 2025 PostgreSQL DB Knowledge Base. All rights reserved.</p>
            </div>
        </aside>

        <!-- Main Content Area -->
        <main class="flex-1 flex flex-col overflow-hidden">
            <!-- Mobile Header (only visible on small screens) -->
            <header class="bg-white dark:bg-base-800 border-b border-base-200 dark:border-base-700 p-4 sm:hidden flex items-center justify-between sticky top-0 z-30">
                <div class="flex items-center">
                    <button id="mobile-menu-toggle-header" class="mr-3 text-base-600 dark:text-base-300">
                        <i class="fa-solid fa-bars text-xl"></i>
                    </button>
                    <h1 class="text-lg font-bold text-primary-600 dark:text-primary-400">PostgreSQL KB</h1>
                </div>
                <div class="flex items-center space-x-2">
                    <button id="mobile-search-toggle" class="p-2 text-base-600 dark:text-base-300 hover:text-primary-600 dark:hover:text-primary-400 focus:outline-none">
                        <i class="fa-solid fa-search"></i>
                    </button>
                    <button id="mobile-theme-toggle" class="p-2 text-base-600 dark:text-base-300 hover:text-primary-600 dark:hover:text-primary-400 focus:outline-none">
                        <i class="fa-solid fa-moon dark:hidden"></i>
                        <i class="fa-solid fa-sun hidden dark:block"></i>
                    </button>
                </div>
            </header>
            
            <!-- Mobile Search Bar (hidden by default) -->
            <div id="mobile-search-container" class="bg-white dark:bg-base-800 p-4 border-b border-base-200 dark:border-base-700 hidden sm:hidden">
                <div class="relative">
                    <input type="text" id="mobile-search-input" placeholder="Search knowledge base..." class="w-full p-2 pl-10 border border-base-300 dark:border-base-600 rounded-lg">
                    <i class="fa-solid fa-search absolute left-3 top-1/2 transform -translate-y-1/2 text-base-400"></i>
                </div>
            </div>
            
            <!-- Desktop Header (hidden on small screens) -->
            <header class="bg-white dark:bg-base-800 border-b border-base-200 dark:border-base-700 p-4 hidden sm:flex justify-between items-center shadow-sm">
                <div class="flex items-center">
                    <button id="menu-toggle" class="sm:hidden p-2 text-base-600 dark:text-base-300 hover:bg-base-100 dark:hover:bg-base-700 rounded-lg mr-2">
                        <i class="fa-solid fa-bars text-xl"></i>
                    </button>
                    <div id="breadcrumb" class="text-sm text-base-500 dark:text-base-400"></div>
                </div>
                <div id="filter-container" class="hidden sm:flex items-center gap-4 w-full max-w-md">
                    <div class="relative flex-grow">
                         <div class="absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none">
                            <i class="fa-solid fa-search text-base-400"></i>
                        </div>
                        <input type="text" id="search-input" placeholder="Search issues in this category... (Ctrl+K)" class="block w-full pl-10 pr-16 py-2 border border-base-300 dark:border-base-600 rounded-md leading-5 bg-white dark:bg-base-700 placeholder-base-500 dark:placeholder-base-400 focus:outline-none focus:ring-1 focus:ring-primary-500 focus:border-primary-500 sm:text-sm" autocomplete="off">
                        <div class="absolute inset-y-0 right-8 pr-3 flex items-center">
                            <span class="text-xs text-base-400 bg-base-100 dark:bg-base-600 px-1.5 py-0.5 rounded border text-center">âŒ˜K</span>
                        </div>
                        <button id="clear-search" class="absolute inset-y-0 right-0 pr-3 flex items-center text-base-400 hover:text-base-600 dark:hover:text-base-300 transition-colors hidden" aria-label="Clear search">
                            <i class="fa-solid fa-times"></i>
                        </button>
                    </div>
                    <select id="severityFilter" class="w-48 p-2 border border-base-300 dark:border-base-600 rounded-md bg-white dark:bg-base-700 focus:ring-2 focus:ring-primary-500 focus:border-primary-500 transition">
                        <option value="all">All Severities</option>
                        <option value="Critical">Critical</option>
                        <option value="High">High</option>
                        <option value="Medium">Medium</option>
                        <option value="Low">Low</option>
                    </select>
                </div>
            </header>

            <div id="content-area" class="flex-1 overflow-y-auto p-4 sm:p-6 lg:p-8" role="main" id="main-content" aria-label="Main content area">
                <!-- Content is rendered here by startApp() -->
            </div>
        </main>
    </div>
    
    <!-- Keyboard Shortcuts Indicator -->
    <div id="keyboard-shortcuts" class="keyboard-shortcut">
        Press <kbd>?</kbd> to see keyboard shortcuts
    </div>

    <!-- Fixed Action Buttons Group -->
    <div class="fixed-action-buttons fixed bottom-4 sm:bottom-6 right-4 sm:right-6 flex flex-col sm:flex-row gap-2 sm:gap-3 z-40">
        <!-- Back to Top Button -->
        <button id="back-to-top-btn" class="bg-primary-600 text-white p-2 sm:p-3 rounded-full shadow-lg hover:bg-primary-700 focus:outline-none focus:ring-2 focus:ring-primary-500 focus:ring-offset-2 transition-transform transform hover:scale-110 opacity-0 translate-y-4 tooltip order-2 sm:order-1" aria-label="Back to top" data-tooltip="Back to top (Ctrl+Home)">
          <i class="fa-solid fa-arrow-up text-lg sm:text-xl"></i>
        </button>

        <!-- Print Page Button -->
        <button id="print-page-btn" class="bg-green-600 text-white p-2 sm:p-3 rounded-full shadow-lg hover:bg-green-700 focus:outline-none focus:ring-2 focus:ring-green-500 focus:ring-offset-2 transition-transform transform hover:scale-110 tooltip order-3 sm:order-2" aria-label="Print current page" data-tooltip="Print Page (Ctrl+P)" onclick="window.print()">
          <i class="fa-solid fa-print text-lg sm:text-xl"></i>
        </button>

        <!-- Chatbot Toggle Button -->
        <button id="chat-toggle-button" class="bg-primary-600 text-white p-3 sm:p-4 rounded-full shadow-lg hover:bg-primary-700 focus:outline-none focus:ring-2 focus:ring-primary-500 focus:ring-offset-2 transition-transform transform hover:scale-110 tooltip order-1 sm:order-3" aria-label="Open chat" data-tooltip="Chat Assistant (Ctrl+?)">
            <i class="fa-solid fa-comments text-xl sm:text-2xl"></i>
        </button>
    </div>

    <!-- Enhanced Chatbot Widget -->
    <div id="chat-widget" class="fixed bottom-16 sm:bottom-24 right-2 sm:right-6 w-[95%] sm:w-full max-w-md h-[80vh] sm:h-auto max-h-[80vh] bg-white dark:bg-base-800 rounded-xl shadow-2xl flex flex-col transform translate-y-8 opacity-0 hidden border border-base-200 dark:border-base-700 z-50">
        <header class="flex items-center justify-between p-4 border-b border-base-200 dark:border-base-700 bg-gradient-to-r from-primary-600 to-blue-600 text-white rounded-t-xl">
            <div class="flex items-center space-x-3">
                <div class="w-8 h-8 bg-white bg-opacity-20 rounded-full flex items-center justify-center">
                    <i class="fa-solid fa-robot text-sm"></i>
                </div>
                <div>
                    <h3 class="font-semibold text-sm">PostgreSQL Assistant</h3>
                    <p class="text-xs text-primary-100" id="chat-status">AI-powered database help</p>
                </div>
            </div>
            <div class="flex items-center space-x-2">
                <button id="chat-settings-btn" class="text-primary-200 hover:text-white p-1 rounded transition-colors" aria-label="Chat settings">
                    <i class="fa-solid fa-cog text-sm"></i>
                </button>
                <button id="chat-minimize-btn" class="text-primary-200 hover:text-white p-1 rounded transition-colors" aria-label="Minimize chat">
                    <i class="fa-solid fa-minus text-sm"></i>
                </button>
                <button id="chat-close-button" class="text-primary-200 hover:text-white p-1 rounded transition-colors" aria-label="Close chat">
                    <i class="fa-solid fa-times text-sm"></i>
                </button>
            </div>
        </header>
        
        <!-- Enhanced Messages Area -->
        <div id="chat-messages" class="flex-1 p-4 overflow-y-auto space-y-4 min-h-[300px] max-h-[400px]"></div>
        
        <!-- Enhanced Quick Actions -->
        <div id="chat-quick-actions" class="px-4 py-2 border-t border-base-200 dark:border-base-700 bg-base-50 dark:bg-base-900">
            <div class="flex flex-wrap gap-2 mb-2">
                <button class="quick-action-btn text-xs bg-blue-100 dark:bg-blue-900 text-blue-700 dark:text-blue-300 px-2 py-1 rounded-full hover:bg-blue-200 dark:hover:bg-blue-800 transition-colors" data-action="diagnose">
                    <i class="fa-solid fa-stethoscope mr-1"></i>Diagnose Error
                </button>
                <button class="quick-action-btn text-xs bg-green-100 dark:bg-green-900 text-green-700 dark:text-green-300 px-2 py-1 rounded-full hover:bg-green-200 dark:hover:bg-green-800 transition-colors" data-action="optimize">
                    <i class="fa-solid fa-rocket mr-1"></i>Optimize Query
                </button>
                <button class="quick-action-btn text-xs bg-purple-100 dark:bg-purple-900 text-purple-700 dark:text-purple-300 px-2 py-1 rounded-full hover:bg-purple-200 dark:hover:bg-purple-800 transition-colors" data-action="explain">
                    <i class="fa-solid fa-book mr-1"></i>Explain Concept
                </button>
            </div>
        </div>
        
        <!-- Enhanced Quick Replies -->
        <div id="chat-quick-replies" class="px-4 py-2 border-t border-base-200 dark:border-base-700 flex flex-wrap gap-2"></div>
        
        <!-- Enhanced Input Form -->
        <form id="chat-form" class="p-4 border-t border-base-200 dark:border-base-700 bg-white dark:bg-base-800 rounded-b-xl">
            <div class="flex items-center space-x-2">
                <div class="flex-1 relative">
                    <input 
                        type="text" 
                        id="chat-input" 
                        placeholder="Ask about PostgreSQL errors, performance, or concepts..." 
                        class="w-full p-3 border border-base-300 dark:border-base-600 rounded-lg bg-white dark:bg-base-700 focus:ring-2 focus:ring-primary-500 focus:border-primary-500 transition-colors text-sm pr-12" 
                        autocomplete="off"
                        maxlength="500"
                    >
                    <div id="chat-input-counter" class="absolute right-3 top-1/2 transform -translate-y-1/2 text-xs text-base-400">0/500</div>
                </div>
                <button 
                    type="submit" 
                    id="chat-send-btn"
                    class="bg-primary-600 hover:bg-primary-700 disabled:bg-base-300 disabled:cursor-not-allowed text-white p-3 rounded-lg transition-colors flex items-center justify-center"
                    disabled
                >
                    <i class="fa-solid fa-paper-plane text-sm"></i>
                </button>
                <button 
                    type="button" 
                    id="chat-voice-btn"
                    class="bg-base-200 hover:bg-base-300 dark:bg-base-700 dark:hover:bg-base-600 text-base-600 dark:text-base-300 p-3 rounded-lg transition-colors"
                    title="Voice input (experimental)"
                >
                    <i class="fa-solid fa-microphone text-sm"></i>
                </button>
            </div>
            <div class="mt-2 flex items-center justify-between text-xs text-base-500">
                <span id="chat-suggestion">Try asking: "Why is my query slow?" or "How to backup PostgreSQL?"</span>
                <span id="chat-ai-indicator" class="flex items-center space-x-1 opacity-0 transition-opacity">
                    <div class="w-2 h-2 bg-green-400 rounded-full animate-pulse"></div>
                    <span>AI thinking...</span>
                </span>
            </div>
        </form>
    </div>

    <!-- Report Issue Modal -->
    <div id="report-issue-modal" class="fixed inset-0 z-50 hidden items-center justify-center">
        <div class="modal-overlay absolute inset-0 bg-black/50"></div>
        <div class="modal-container bg-white dark:bg-base-800 w-11/12 md:max-w-md mx-auto rounded-lg shadow-lg z-50 overflow-y-auto transform scale-95">
            <div class="py-4 text-left px-6">
                <div class="flex justify-between items-center pb-3">
                    <p class="text-2xl font-bold text-base-900 dark:text-white">Report a New Issue</p>
                    <button id="close-modal-btn" class="modal-close cursor-pointer z-50">
                        <i class="fa-solid fa-times text-2xl text-base-500 hover:text-base-800 dark:hover:text-white"></i>
                    </button>
                </div>
                <div id="report-form-content">
                    <p class="text-sm text-base-600 dark:text-base-300 mb-4">Encountered an error not in our database? Please provide the details below. Your feedback helps us improve this resource for everyone.</p>
                    <form id="issue-report-form">
                        <div class="space-y-4">
                            <div>
                                <label for="error-title" class="block text-sm font-medium text-base-700 dark:text-base-300">Error Title / Message</label>
                                <input type="text" id="error-title" required class="mt-1 block w-full border-base-300 dark:border-base-600 rounded-md shadow-sm focus:border-primary-500 focus:ring-primary-500 sm:text-sm bg-white dark:bg-base-700">
                            </div>
                            <div class="grid grid-cols-2 gap-4">
                                <div>
                                    <label for="error-code" class="block text-sm font-medium text-base-700 dark:text-base-300">Error Code (optional)</label>
                                    <input type="text" id="error-code" class="mt-1 block w-full border-base-300 dark:border-base-600 rounded-md shadow-sm focus:border-primary-500 focus:ring-primary-500 sm:text-sm bg-white dark:bg-base-700">
                                </div>
                                <div>
                                    <label for="error-severity" class="block text-sm font-medium text-base-700 dark:text-base-300">Severity</label>
                                    <select id="error-severity" required class="mt-1 block w-full border-base-300 dark:border-base-600 rounded-md shadow-sm focus:border-primary-500 focus:ring-primary-500 sm:text-sm bg-white dark:bg-base-700">
                                        <option>Low</option>
                                        <option>Medium</option>
                                        <option>High</option>
                                        <option>Critical</option>
                                    </select>
                                </div>
                            </div>
                            <div>
                                <label for="error-description" class="block text-sm font-medium text-base-700 dark:text-base-300">Description</label>
                                <textarea id="error-description" rows="3" required class="mt-1 block w-full border-base-300 dark:border-base-600 rounded-md shadow-sm focus:border-primary-500 focus:ring-primary-500 sm:text-sm bg-white dark:bg-base-700"></textarea>
                            </div>
                             <div>
                                <label for="error-reproduce" class="block text-sm font-medium text-base-700 dark:text-base-300">Steps to Reproduce (optional)</label>
                                <textarea id="error-reproduce" rows="3" class="mt-1 block w-full border-base-300 dark:border-base-600 rounded-md shadow-sm focus:border-primary-500 focus:ring-primary-500 sm:text-sm bg-white dark:bg-base-700"></textarea>
                            </div>
                        </div>
                        <div class="pt-4 flex justify-end">
                            <button type="submit" class="bg-primary-600 text-white font-bold py-2 px-4 rounded-lg hover:bg-primary-700 transition-colors">Submit Report</button>
                        </div>
                    </form>
                </div>
                <div id="report-success-message" class="hidden text-center py-8">
                    <i class="fa-solid fa-check-circle text-5xl text-green-500 mb-4"></i>
                    <h3 class="text-xl font-bold text-base-900 dark:text-white">Thank You!</h3>
                    <p class="text-base-600 dark:text-base-300 mt-2">Your issue has been reported successfully. We will review it and update the knowledge base accordingly.</p>
                     <button id="close-success-modal-btn" class="mt-6 bg-primary-600 text-white font-bold py-2 px-4 rounded-lg hover:bg-primary-700 transition-colors">Close</button>
                </div>
            </div>
        </div>
    </div>
    
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-sql.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-bash.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.6.2/fuse.min.js"></script>

    <script>
        // Utility and Error Handling Functions
        const utils = {
            handleError: (error, context = '') => {
                console.error(`Error ${context}:`, error);
                const errorMessage = document.createElement('div');
                errorMessage.className = 'fixed top-4 right-4 bg-red-500 text-white px-6 py-3 rounded-lg shadow-lg z-50 animate-fade-in';
                errorMessage.textContent = `An error occurred${context ? ` while ${context}` : ''}. Please try again.`;
                document.body.appendChild(errorMessage);
                setTimeout(() => errorMessage.remove(), 5000);
            },
            debounce: (func, wait) => {
                let timeout;
                return function executedFunction(...args) {
                    const later = () => {
                        clearTimeout(timeout);
                        func(...args);
                    };
                    clearTimeout(timeout);
                    timeout = setTimeout(later, wait);
                };
            },
            escapeHtml: (unsafe) => {
                return unsafe
                    .replace(/&/g, "&amp;")
                    .replace(/</g, "&lt;")
                    .replace(/>/g, "&gt;")
                    .replace(/"/g, "&quot;")
                    .replace(/'/g, "&#039;");
            }
        };

        // Search and Filter Engine
        class SearchEngine {
            constructor(data) {
                this.data = data;
                this.fuse = new Fuse(this.getAllSearchableItems(), {
                    keys: ['title', 'content', 'tags'],
                    threshold: 0.4,
                    includeMatches: true
                });
            }

            getAllSearchableItems() {
                return Object.entries(this.data).flatMap(([section, content]) => {
                    if (Array.isArray(content.items)) {
                        return content.items.map(item => ({
                            ...item,
                            section,
                            searchableContent: this.extractSearchableContent(item)
                        }));
                    }
                    return [];
                });
            }

            extractSearchableContent(item) {
                return Object.values(item)
                    .filter(value => typeof value === 'string')
                    .join(' ');
            }

            search(query, filters = {}) {
                if (!query && Object.keys(filters).length === 0) return [];
                
                let results = query 
                    ? this.fuse.search(query) 
                    : this.getAllSearchableItems();

                // Apply filters
                Object.entries(filters).forEach(([key, value]) => {
                    if (value && value !== 'all') {
                        results = results.filter(item => 
                            item.item ? item.item[key] === value : item[key] === value
                        );
                    }
                });

                return results;
            }
        }

        // Navigation Manager
        class NavigationManager {
            constructor() {
                this.currentPath = [];
                this.listeners = new Set();
                this.initFromUrl();
                this.setupEventListeners();
            }

            initFromUrl() {
                const params = new URLSearchParams(window.location.search);
                const path = params.get('path');
                if (path) {
                    this.navigate(path.split('/'), false);
                }
            }

            setupEventListeners() {
                window.addEventListener('popstate', () => this.handlePopState());
                document.getElementById('breadcrumb')?.addEventListener('click', (e) => {
                    const pathBtn = e.target.closest('[data-path]');
                    if (pathBtn) {
                        const path = pathBtn.dataset.path;
                        const index = this.currentPath.indexOf(path);
                        if (index !== -1) {
                            this.navigate(this.currentPath.slice(0, index + 1));
                        }
                    }
                });
            }

            navigate(path, updateHistory = true) {
                this.currentPath = Array.isArray(path) ? path : [path];
                this.notifyListeners();
                this.updateBreadcrumbs();
                if (updateHistory) {
                    this.updateUrl();
                }
            }

            addListener(listener) {
                this.listeners.add(listener);
            }

            notifyListeners() {
                this.listeners.forEach(listener => listener(this.currentPath));
            }

            updateBreadcrumbs() {
                const breadcrumbEl = document.getElementById('breadcrumb');
                if (!breadcrumbEl) return;

                breadcrumbEl.innerHTML = this.currentPath
                    .map((item, index) => {
                        const isLast = index === this.currentPath.length - 1;
                        const label = item.charAt(0).toUpperCase() + item.slice(1).replace(/-/g, ' ');
                        return isLast
                            ? `<span class="text-base-900 dark:text-base-100 font-medium">${label}</span>`
                            : `<button class="text-primary-600 dark:text-primary-400 hover:underline" data-path="${item}">${label}</button>
                               <span class="mx-2 text-base-400">/</span>`;
                    })
                    .join('');
            }

            updateUrl() {
                const url = new URL(window.location);
                url.searchParams.set('path', this.currentPath.join('/'));
                window.history.pushState({}, '', url);
            }

            handlePopState() {
                this.initFromUrl();
            }
        }

        // Chat Widget
        class ChatWidget {
            constructor() {
                this.widget = document.getElementById('chat-widget');
                this.messages = document.getElementById('chat-messages');
                this.input = document.getElementById('chat-input');
                this.form = document.getElementById('chat-form');
                this.toggleButton = document.getElementById('chat-toggle-button');
                this.closeButton = document.getElementById('chat-close-button');
                this.quickReplies = document.getElementById('chat-quick-replies');
                
                if (this.widget) {
                    this.setupEventListeners();
                    this.loadQuickReplies();
                }
            }

            setupEventListeners() {
                this.toggleButton?.addEventListener('click', () => this.toggle());
                this.closeButton?.addEventListener('click', () => this.close());
                this.form?.addEventListener('submit', (e) => this.handleSubmit(e));
                this.quickReplies?.addEventListener('click', (e) => {
                    const btn = e.target.closest('button');
                    if (btn) {
                        this.input.value = btn.textContent.trim();
                        this.form.dispatchEvent(new Event('submit'));
                    }
                });
            }

            toggle() {
                this.widget.classList.toggle('hidden');
                setTimeout(() => {
                    this.widget.classList.toggle('opacity-0');
                    this.widget.classList.toggle('translate-y-8');
                }, 50);
            }

            close() {
                this.widget.classList.add('opacity-0', 'translate-y-8');
                setTimeout(() => this.widget.classList.add('hidden'), 300);
            }

            async handleSubmit(e) {
                e.preventDefault();
                const message = this.input.value.trim();
                if (!message) return;

                this.addMessage(message, 'user');
                this.input.value = '';
                this.showTypingIndicator();

                try {
                    const response = await this.getResponse(message);
                    this.removeTypingIndicator();
                    this.addMessage(response, 'bot');
                } catch (error) {
                    this.removeTypingIndicator();
                    utils.handleError(error, 'processing message');
                }
            }

            addMessage(content, type) {
                const messageEl = document.createElement('div');
                messageEl.className = `flex ${type === 'user' ? 'justify-end' : 'justify-start'} mb-4`;
                messageEl.innerHTML = `
                    <div class="${type === 'user' ? 'bg-primary-600 text-white' : 'bg-base-200 dark:bg-base-700'} 
                                rounded-lg px-4 py-2 max-w-[75%] break-words">
                        ${utils.escapeHtml(content)}
                    </div>`;
                this.messages.appendChild(messageEl);
                this.messages.scrollTop = this.messages.scrollHeight;
            }

            showTypingIndicator() {
                const indicator = document.createElement('div');
                indicator.id = 'typing-indicator';
                indicator.className = 'flex justify-start mb-4';
                indicator.innerHTML = `
                    <div class="bg-base-200 dark:bg-base-700 rounded-lg px-4 py-2">
                        <div class="typing-indicator">
                            <span></span><span></span><span></span>
                        </div>
                    </div>`;
                this.messages.appendChild(indicator);
                this.messages.scrollTop = this.messages.scrollHeight;
            }

            removeTypingIndicator() {
                document.getElementById('typing-indicator')?.remove();
            }

            loadQuickReplies() {
                const quickReplies = [
                    'How do I configure PostgreSQL?',
                    'What are common error codes?',
                    'How to optimize queries?',
                    'Show me MVCC examples'
                ];

                this.quickReplies.innerHTML = quickReplies
                    .map(reply => `
                        <button class="px-3 py-1 text-sm bg-base-200 dark:bg-base-700 rounded-full hover:bg-base-300 dark:hover:bg-base-600 transition-colors">
                            ${utils.escapeHtml(reply)}
                        </button>
                    `)
                    .join('');
            }

            async getResponse(message) {
                // Simulate AI response based on knowledge base content
                const searchEngine = new SearchEngine(window.knowledgeBaseData);
                const results = searchEngine.search(message);
                
                if (results.length > 0) {
                    const topResult = results[0].item;
                    return `I found this information that might help:\n\n${topResult.solution || topResult.description || topResult.explanation}`;
                }
                
                return "I couldn't find specific information about that. Could you try rephrasing your question?";
            }
        }

    </script>

    <script>
        // Theme Management
        class ThemeManager {
            constructor() {
                this.darkModeMediaQuery = window.matchMedia('(prefers-color-scheme: dark)');
                this.init();
                this.setupEventListeners();
            }

            init() {
                // Check localStorage first, then system preference
                // Migrate from old 'color-theme' key if it exists
                const savedTheme = localStorage.getItem('theme') || localStorage.getItem('color-theme');
                if (savedTheme) {
                    this.setTheme(savedTheme);
                    // If we found the old key, migrate to new key and remove old one
                    if (localStorage.getItem('color-theme') && !localStorage.getItem('theme')) {
                        localStorage.setItem('theme', savedTheme);
                        localStorage.removeItem('color-theme');
                    }
                } else {
                    this.setTheme(this.darkModeMediaQuery.matches ? 'dark' : 'light');
                }
            }

            setupEventListeners() {
                // Listen for system theme changes
                this.darkModeMediaQuery.addEventListener('change', (e) => {
                    if (!localStorage.getItem('theme')) {
                        this.setTheme(e.matches ? 'dark' : 'light');
                    }
                });

                // Theme toggle button
                const themeToggle = document.getElementById('theme-toggle');
                if (themeToggle) {
                    themeToggle.addEventListener('click', () => this.toggleTheme());
                }
            }

            // Store theme change callbacks
            themeChangeCallbacks = [];

            // Register callback to run when theme changes
            onThemeChange(callback) {
                if (typeof callback === 'function') {
                    this.themeChangeCallbacks.push(callback);
                }
            }

            setTheme(theme) {
                if (theme === 'dark') {
                    document.documentElement.classList.add('dark');
                    document.getElementById('theme-toggle-dark-icon')?.classList.add('hidden');
                    document.getElementById('theme-toggle-light-icon')?.classList.remove('hidden');
                    document.documentElement.setAttribute('data-theme', 'dark');
                } else {
                    document.documentElement.classList.remove('dark');
                    document.getElementById('theme-toggle-dark-icon')?.classList.remove('hidden');
                    document.getElementById('theme-toggle-light-icon')?.classList.add('hidden');
                    document.documentElement.setAttribute('data-theme', 'light');
                }
                localStorage.setItem('theme', theme);
                
                // Trigger theme change callbacks
                this.themeChangeCallbacks.forEach(callback => {
                    try {
                        callback(theme);
                    } catch (error) {
                        console.warn('Error in theme change callback:', error);
                    }
                });
                
                // Ensure we completely destroy and recreate the chart to avoid theme inconsistencies
                requestAnimationFrame(() => {
                    // Force destroy any existing chart instance
                    if (window.chartInstance && typeof window.chartInstance.destroy === 'function') {
                        try {
                            window.chartInstance.destroy();
                            window.chartInstance = null;
                        } catch (error) {
                            console.warn('Error destroying chart:', error);
                        }
                    }
                    
                    // Recreate chart with new theme colors
                    if (typeof renderDashboardChart === 'function' && document.getElementById('overviewChart')) {
                        try {
                            renderDashboardChart();
                        } catch (error) {
                            console.warn('Error re-rendering chart after theme change:', error);
                        }
                    }
                });
            }

            toggleTheme() {
                const isDark = document.documentElement.classList.contains('dark');
                const newTheme = isDark ? 'light' : 'dark';
                this.setTheme(newTheme);
                
                // Add smooth transition
                document.documentElement.style.transition = 'background-color 0.3s ease, color 0.3s ease';
                setTimeout(() => {
                    document.documentElement.style.transition = '';
                }, 300);
            }
        }

        document.addEventListener('DOMContentLoaded', () => {
            // Initialize theme manager
            window.themeManager = new ThemeManager();
            
            // Register dashboard updates on theme change
            window.themeManager.onThemeChange(theme => {
                if (typeof renderDashboardSummary === 'function') {
                    renderDashboardSummary();
                }
            });

            // Add menu toggle event listener
            document.getElementById('menu-toggle')?.addEventListener('click', () => {
                const sidebar = document.getElementById('sidebar');
                sidebar.classList.toggle('-translate-x-full');
            });

            // Initialize back to top button
            const backToTopBtn = document.getElementById('back-to-top-btn');
            window.addEventListener('scroll', () => {
                if (window.scrollY > 300) {
                    backToTopBtn.classList.remove('opacity-0', 'translate-y-4');
                } else {
                    backToTopBtn.classList.add('opacity-0', 'translate-y-4');
                }
            });
            backToTopBtn.addEventListener('click', () => {
                window.scrollTo({ top: 0, behavior: 'smooth' });
            });
            // --- KNOWLEDGE BASE DATA ---
            const knowledgeBaseData = {
                dashboard: {
                    title: "Dashboard",
                    icon: "fa-solid fa-chart-pie",
                    content: `
                        <div class="space-y-8">
                            <!-- Welcome Header -->
                            <div class="bg-gradient-to-r from-blue-600 to-purple-600 text-white p-8 rounded-2xl shadow-lg">
                                <h1 class="text-3xl font-bold mb-2">Welcome to PostgreSQL Knowledge Base</h1>
                                <p class="text-blue-100 text-lg">Your comprehensive guide to PostgreSQL database management, troubleshooting, and optimization.</p>
                                <div class="mt-4 quick-actions">
                                    <button class="quick-action-btn" onclick="renderPage('getting_started')">
                                        <i class="fa-solid fa-rocket"></i> Get Started
                                    </button>
                                    <button class="quick-action-btn" onclick="renderPage('error_guide')">
                                        <i class="fa-solid fa-bug"></i> Fix Issues
                                    </button>
                                    <button class="quick-action-btn" onclick="renderPage('performance_tuning')">
                                        <i class="fa-solid fa-tachometer-alt"></i> Optimize Performance
                                    </button>
                                    <button class="quick-action-btn" onclick="renderPage('glossary')">
                                        <i class="fa-solid fa-book"></i> Learn Concepts
                                    </button>
                                </div>
                            </div>

                            <!-- Navigation Tabs -->
                            <div class="tab-navigation">
                                <button class="tab-button active" data-tab="overview">Overview</button>
                                <button class="tab-button" data-tab="categories">Categories</button>
                                <button class="tab-button" data-tab="analytics">Analytics</button>
                                <button class="tab-button" data-tab="resources">Resources</button>
                            </div>

                            <!-- Tab Content -->
                            <div id="overview-tab" class="tab-content active">
                                <div class="grid grid-cols-1 lg:grid-cols-3 gap-6" id="dashboard-stats"></div>
                                <div class="mt-8 grid grid-cols-1 lg:grid-cols-5 gap-8">
                                    <div class="lg:col-span-3 bg-white dark:bg-base-800 p-6 rounded-lg shadow-sm">
                                        <h3 class="text-lg font-semibold text-base-800 dark:text-white mb-4">Issue Distribution by Category</h3>
                                        <div class="chart-container relative mx-auto w-full h-96">
                                            <canvas id="overviewChart"></canvas>
                                        </div>
                                    </div>
                                    <div class="lg:col-span-2 bg-white dark:bg-base-800 p-6 rounded-lg shadow-sm">
                                        <div id="solution-of-the-week" class="mb-6"></div>
                                        <div id="most-viewed-container"></div>
                                    </div>
                                </div>
                            </div>

                            <div id="categories-tab" class="tab-content">
                                <div class="category-grid" id="category-overview"></div>
                            </div>

                            <div id="analytics-tab" class="tab-content">
                                <div class="bg-white dark:bg-base-800 p-6 rounded-lg shadow-sm">
                                    <h3 class="text-xl font-bold mb-4">Usage Analytics</h3>
                                    <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                                        <div class="p-4 bg-base-50 dark:bg-base-700 rounded-lg">
                                            <h4 class="font-semibold mb-2">Most Searched Topics</h4>
                                            <div class="space-y-2" id="popular-searches"></div>
                                        </div>
                                        <div class="p-4 bg-base-50 dark:bg-base-700 rounded-lg">
                                            <h4 class="font-semibold mb-2">Recent Activity</h4>
                                            <div class="space-y-2" id="recent-activity"></div>
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <div id="resources-tab" class="tab-content">
                                <div class="space-y-6">
                                    <!-- PostgreSQL Architecture Diagrams -->
                                    <div class="bg-white dark:bg-base-800 p-6 rounded-lg shadow-sm">
                                        <div class="flex justify-between items-center mb-6">
                                            <h3 class="text-xl font-bold">PostgreSQL Architecture Diagrams</h3>
                                            <button onclick="exportDiagramToPDF()" class="modern-button text-sm">
                                                <i class="fa-solid fa-file-pdf mr-2"></i>Export Diagrams as PDF
                                            </button>
                                        </div>
                                        <div class="grid grid-cols-1 lg:grid-cols-2 gap-6" id="architecture-diagrams">
                                            
                                            <!-- PostgreSQL Process Architecture -->
                                            <div class="diagram-container postgres-architecture">
                                                <h4 class="text-lg font-semibold mb-4">PostgreSQL Process Architecture</h4>
                                                <div class="visual-content">
                                                    <svg viewBox="0 0 800 600" class="w-full h-auto">
                                                        <!-- Background -->
                                                        <rect width="800" height="600" fill="#f8fafc" stroke="#e2e8f0" stroke-width="2"/>
                                                        
                                                        <!-- Postmaster Process -->
                                                        <rect x="300" y="50" width="200" height="60" fill="#3b82f6" stroke="#1e40af" stroke-width="2" rx="8"/>
                                                        <text x="400" y="75" text-anchor="middle" fill="white" font-weight="bold" font-size="14">Postmaster</text>
                                                        <text x="400" y="90" text-anchor="middle" fill="white" font-size="12">Main Process</text>
                                                        
                                                        <!-- Backend Processes -->
                                                        <rect x="50" y="170" width="120" height="50" fill="#10b981" stroke="#059669" stroke-width="2" rx="6"/>
                                                        <text x="110" y="190" text-anchor="middle" fill="white" font-weight="bold" font-size="12">Backend 1</text>
                                                        <text x="110" y="205" text-anchor="middle" fill="white" font-size="10">Client Connection</text>
                                                        
                                                        <rect x="200" y="170" width="120" height="50" fill="#10b981" stroke="#059669" stroke-width="2" rx="6"/>
                                                        <text x="260" y="190" text-anchor="middle" fill="white" font-weight="bold" font-size="12">Backend 2</text>
                                                        <text x="260" y="205" text-anchor="middle" fill="white" font-size="10">Client Connection</text>
                                                        
                                                        <rect x="350" y="170" width="120" height="50" fill="#10b981" stroke="#059669" stroke-width="2" rx="6"/>
                                                        <text x="410" y="190" text-anchor="middle" fill="white" font-weight="bold" font-size="12">Backend 3</text>
                                                        <text x="410" y="205" text-anchor="middle" fill="white" font-size="10">Client Connection</text>
                                                        
                                                        <!-- Utility Processes -->
                                                        <rect x="520" y="170" width="100" height="40" fill="#f59e0b" stroke="#d97706" stroke-width="2" rx="6"/>
                                                        <text x="570" y="188" text-anchor="middle" fill="white" font-weight="bold" font-size="11">WAL Writer</text>
                                                        <text x="570" y="202" text-anchor="middle" fill="white" font-size="9">Background</text>
                                                        
                                                        <rect x="650" y="170" width="100" height="40" fill="#f59e0b" stroke="#d97706" stroke-width="2" rx="6"/>
                                                        <text x="700" y="188" text-anchor="middle" fill="white" font-weight="bold" font-size="11">Checkpointer</text>
                                                        <text x="700" y="202" text-anchor="middle" fill="white" font-size="9">Background</text>
                                                        
                                                        <rect x="520" y="230" width="100" height="40" fill="#f59e0b" stroke="#d97706" stroke-width="2" rx="6"/>
                                                        <text x="570" y="248" text-anchor="middle" fill="white" font-weight="bold" font-size="11">Autovacuum</text>
                                                        <text x="570" y="262" text-anchor="middle" fill="white" font-size="9">Background</text>
                                                        
                                                        <rect x="650" y="230" width="100" height="40" fill="#f59e0b" stroke="#d97706" stroke-width="2" rx="6"/>
                                                        <text x="700" y="248" text-anchor="middle" fill="white" font-weight="bold" font-size="11">Stats Collector</text>
                                                        <text x="700" y="262" text-anchor="middle" fill="white" font-size="9">Background</text>
                                                        
                                                        <!-- Shared Memory -->
                                                        <rect x="150" y="320" width="500" height="80" fill="#8b5cf6" stroke="#7c3aed" stroke-width="2" rx="8"/>
                                                        <text x="400" y="340" text-anchor="middle" fill="white" font-weight="bold" font-size="16">Shared Memory</text>
                                                        <text x="250" y="365" text-anchor="middle" fill="white" font-size="12">Shared Buffers</text>
                                                        <text x="400" y="365" text-anchor="middle" fill="white" font-size="12">WAL Buffers</text>
                                                        <text x="550" y="365" text-anchor="middle" fill="white" font-size="12">Lock Tables</text>
                                                        <text x="250" y="385" text-anchor="middle" fill="white" font-size="12">Caches</text>
                                                        <text x="400" y="385" text-anchor="middle" fill="white" font-size="12">Control Info</text>
                                                        <text x="550" y="385" text-anchor="middle" fill="white" font-size="12">Process Arrays</text>
                                                        
                                                        <!-- Storage -->
                                                        <rect x="50" y="450" width="150" height="60" fill="#ef4444" stroke="#dc2626" stroke-width="2" rx="6"/>
                                                        <text x="125" y="470" text-anchor="middle" fill="white" font-weight="bold" font-size="14">Data Files</text>
                                                        <text x="125" y="485" text-anchor="middle" fill="white" font-size="11">Tables, Indexes</text>
                                                        <text x="125" y="500" text-anchor="middle" fill="white" font-size="11">Tablespaces</text>
                                                        
                                                        <rect x="250" y="450" width="150" height="60" fill="#ef4444" stroke="#dc2626" stroke-width="2" rx="6"/>
                                                        <text x="325" y="470" text-anchor="middle" fill="white" font-weight="bold" font-size="14">WAL Files</text>
                                                        <text x="325" y="485" text-anchor="middle" fill="white" font-size="11">Transaction Logs</text>
                                                        <text x="325" y="500" text-anchor="middle" fill="white" font-size="11">pg_wal/</text>
                                                        
                                                        <rect x="450" y="450" width="150" height="60" fill="#ef4444" stroke="#dc2626" stroke-width="2" rx="6"/>
                                                        <text x="525" y="470" text-anchor="middle" fill="white" font-weight="bold" font-size="14">Config Files</text>
                                                        <text x="525" y="485" text-anchor="middle" fill="white" font-size="11">postgresql.conf</text>
                                                        <text x="525" y="500" text-anchor="middle" fill="white" font-size="11">pg_hba.conf</text>
                                                        
                                                        <rect x="600" y="450" width="150" height="60" fill="#ef4444" stroke="#dc2626" stroke-width="2" rx="6"/>
                                                        <text x="675" y="470" text-anchor="middle" fill="white" font-weight="bold" font-size="14">Log Files</text>
                                                        <text x="675" y="485" text-anchor="middle" fill="white" font-size="11">Server Logs</text>
                                                        <text x="675" y="500" text-anchor="middle" fill="white" font-size="11">pg_log/</text>
                                                        
                                                        <!-- Connection Lines -->
                                                        <line x1="400" y1="110" x2="110" y2="170" stroke="#374151" stroke-width="2"/>
                                                        <line x1="400" y1="110" x2="260" y2="170" stroke="#374151" stroke-width="2"/>
                                                        <line x1="400" y1="110" x2="410" y2="170" stroke="#374151" stroke-width="2"/>
                                                        <line x1="400" y1="110" x2="570" y2="170" stroke="#374151" stroke-width="2"/>
                                                        <line x1="400" y1="110" x2="700" y2="170" stroke="#374151" stroke-width="2"/>
                                                        
                                                        <!-- Memory connections -->
                                                        <line x1="260" y1="220" x2="300" y2="320" stroke="#374151" stroke-width="2" stroke-dasharray="5,5"/>
                                                        <line x1="410" y1="220" x2="450" y2="320" stroke="#374151" stroke-width="2" stroke-dasharray="5,5"/>
                                                        
                                                        <!-- Storage connections -->
                                                        <line x1="300" y1="400" x2="125" y2="450" stroke="#374151" stroke-width="2" stroke-dasharray="5,5"/>
                                                        <line x1="400" y1="400" x2="325" y2="450" stroke="#374151" stroke-width="2" stroke-dasharray="5,5"/>
                                                        <line x1="500" y1="400" x2="525" y2="450" stroke="#374151" stroke-width="2" stroke-dasharray="5,5"/>
                                                        <line x1="500" y1="400" x2="675" y2="450" stroke="#374151" stroke-width="2" stroke-dasharray="5,5"/>
                                                    </svg>
                                                </div>
                                            </div>

                                            <!-- PostgreSQL Memory Architecture -->
                                            <div class="diagram-container postgres-architecture">
                                                <h4 class="text-lg font-semibold mb-4">PostgreSQL Memory Architecture</h4>
                                                <div class="visual-content">
                                                    <svg viewBox="0 0 800 600" class="w-full h-auto">
                                                        <!-- Background -->
                                                        <rect width="800" height="600" fill="#f8fafc" stroke="#e2e8f0" stroke-width="2"/>
                                                        
                                                        <!-- Shared Memory Pool -->
                                                        <rect x="50" y="50" width="700" height="300" fill="#3b82f6" stroke="#1e40af" stroke-width="3" rx="10"/>
                                                        <text x="400" y="80" text-anchor="middle" fill="white" font-weight="bold" font-size="18">Shared Memory Pool</text>
                                                        
                                                        <!-- Shared Buffers -->
                                                        <rect x="80" y="100" width="200" height="120" fill="#10b981" stroke="#059669" stroke-width="2" rx="6"/>
                                                        <text x="180" y="125" text-anchor="middle" fill="white" font-weight="bold" font-size="14">Shared Buffers</text>
                                                        <text x="180" y="145" text-anchor="middle" fill="white" font-size="11">Data Pages Cache</text>
                                                        <text x="180" y="160" text-anchor="middle" fill="white" font-size="11">Buffer Pool</text>
                                                        <text x="180" y="175" text-anchor="middle" fill="white" font-size="11">Dirty Pages</text>
                                                        <text x="180" y="190" text-anchor="middle" fill="white" font-size="11">Clean Pages</text>
                                                        <text x="180" y="205" text-anchor="middle" fill="white" font-size="10">(shared_buffers)</text>
                                                        
                                                        <!-- WAL Buffers -->
                                                        <rect x="300" y="100" width="150" height="120" fill="#f59e0b" stroke="#d97706" stroke-width="2" rx="6"/>
                                                        <text x="375" y="125" text-anchor="middle" fill="white" font-weight="bold" font-size="14">WAL Buffers</text>
                                                        <text x="375" y="145" text-anchor="middle" fill="white" font-size="11">Transaction Log</text>
                                                        <text x="375" y="160" text-anchor="middle" fill="white" font-size="11">Write Ahead Log</text>
                                                        <text x="375" y="175" text-anchor="middle" fill="white" font-size="11">Commit Records</text>
                                                        <text x="375" y="190" text-anchor="middle" fill="white" font-size="11">Checkpoint Data</text>
                                                        <text x="375" y="205" text-anchor="middle" fill="white" font-size="10">(wal_buffers)</text>
                                                        
                                                        <!-- Lock Tables -->
                                                        <rect x="470" y="100" width="120" height="120" fill="#8b5cf6" stroke="#7c3aed" stroke-width="2" rx="6"/>
                                                        <text x="530" y="125" text-anchor="middle" fill="white" font-weight="bold" font-size="14">Lock Tables</text>
                                                        <text x="530" y="145" text-anchor="middle" fill="white" font-size="11">Row Locks</text>
                                                        <text x="530" y="160" text-anchor="middle" fill="white" font-size="11">Table Locks</text>
                                                        <text x="530" y="175" text-anchor="middle" fill="white" font-size="11">Advisory Locks</text>
                                                        <text x="530" y="190" text-anchor="middle" fill="white" font-size="11">Deadlock Detection</text>
                                                        <text x="530" y="205" text-anchor="middle" fill="white" font-size="10">(max_locks_per_xact)</text>
                                                        
                                                        <!-- Process Array -->
                                                        <rect x="610" y="100" width="120" height="120" fill="#ef4444" stroke="#dc2626" stroke-width="2" rx="6"/>
                                                        <text x="670" y="125" text-anchor="middle" fill="white" font-weight="bold" font-size="14">Process Array</text>
                                                        <text x="670" y="145" text-anchor="middle" fill="white" font-size="11">Active Processes</text>
                                                        <text x="670" y="160" text-anchor="middle" fill="white" font-size="11">Connection Info</text>
                                                        <text x="670" y="175" text-anchor="middle" fill="white" font-size="11">Session State</text>
                                                        <text x="670" y="190" text-anchor="middle" fill="white" font-size="11">Statistics</text>
                                                        <text x="670" y="205" text-anchor="middle" fill="white" font-size="10">(max_connections)</text>
                                                        
                                                        <!-- Additional Shared Structures -->
                                                        <rect x="80" y="240" width="300" height="80" fill="#06b6d4" stroke="#0891b2" stroke-width="2" rx="6"/>
                                                        <text x="230" y="265" text-anchor="middle" fill="white" font-weight="bold" font-size="14">Control Information</text>
                                                        <text x="150" y="285" text-anchor="middle" fill="white" font-size="11">System Catalogs</text>
                                                        <text x="230" y="285" text-anchor="middle" fill="white" font-size="11">Transaction State</text>
                                                        <text x="310" y="285" text-anchor="middle" fill="white" font-size="11">Checkpoint Info</text>
                                                        <text x="150" y="305" text-anchor="middle" fill="white" font-size="11">Background Tasks</text>
                                                        <text x="230" y="305" text-anchor="middle" fill="white" font-size="11">Statistics</text>
                                                        <text x="310" y="305" text-anchor="middle" fill="white" font-size="11">Free Space Map</text>
                                                        
                                                        <rect x="400" y="240" width="330" height="80" fill="#06b6d4" stroke="#0891b2" stroke-width="2" rx="6"/>
                                                        <text x="565" y="265" text-anchor="middle" fill="white" font-weight="bold" font-size="14">Caches & Buffers</text>
                                                        <text x="480" y="285" text-anchor="middle" fill="white" font-size="11">Plan Cache</text>
                                                        <text x="565" y="285" text-anchor="middle" fill="white" font-size="11">Catalog Cache</text>
                                                        <text x="650" y="285" text-anchor="middle" fill="white" font-size="11">Relation Cache</text>
                                                        <text x="480" y="305" text-anchor="middle" fill="white" font-size="11">Function Cache</text>
                                                        <text x="565" y="305" text-anchor="middle" fill="white" font-size="11">Type Cache</text>
                                                        <text x="650" y="305" text-anchor="middle" fill="white" font-size="11">Prepared Statements</text>
                                                        
                                                        <!-- Process Local Memory -->
                                                        <rect x="50" y="400" width="700" height="150" fill="#64748b" stroke="#475569" stroke-width="3" rx="10"/>
                                                        <text x="400" y="430" text-anchor="middle" fill="white" font-weight="bold" font-size="18">Process Local Memory (Per Backend)</text>
                                                        
                                                        <!-- Work Memory -->
                                                        <rect x="80" y="450" width="140" height="80" fill="#84cc16" stroke="#65a30d" stroke-width="2" rx="6"/>
                                                        <text x="150" y="475" text-anchor="middle" fill="white" font-weight="bold" font-size="12">Work Memory</text>
                                                        <text x="150" y="490" text-anchor="middle" fill="white" font-size="10">Sort Operations</text>
                                                        <text x="150" y="505" text-anchor="middle" fill="white" font-size="10">Hash Tables</text>
                                                        <text x="150" y="520" text-anchor="middle" fill="white" font-size="9">(work_mem)</text>
                                                        
                                                        <!-- Maintenance Work Memory -->
                                                        <rect x="240" y="450" width="140" height="80" fill="#84cc16" stroke="#65a30d" stroke-width="2" rx="6"/>
                                                        <text x="310" y="475" text-anchor="middle" fill="white" font-weight="bold" font-size="12">Maintenance Memory</text>
                                                        <text x="310" y="490" text-anchor="middle" fill="white" font-size="10">VACUUM</text>
                                                        <text x="310" y="505" text-anchor="middle" fill="white" font-size="10">CREATE INDEX</text>
                                                        <text x="310" y="520" text-anchor="middle" fill="white" font-size="9">(maintenance_work_mem)</text>
                                                        
                                                        <!-- Temp Buffers -->
                                                        <rect x="400" y="450" width="140" height="80" fill="#84cc16" stroke="#65a30d" stroke-width="2" rx="6"/>
                                                        <text x="470" y="475" text-anchor="middle" fill="white" font-weight="bold" font-size="12">Temp Buffers</text>
                                                        <text x="470" y="490" text-anchor="middle" fill="white" font-size="10">Temporary Tables</text>
                                                        <text x="470" y="505" text-anchor="middle" fill="white" font-size="10">Local Cache</text>
                                                        <text x="470" y="520" text-anchor="middle" fill="white" font-size="9">(temp_buffers)</text>
                                                        
                                                        <!-- Connection Memory -->
                                                        <rect x="560" y="450" width="140" height="80" fill="#84cc16" stroke="#65a30d" stroke-width="2" rx="6"/>
                                                        <text x="630" y="475" text-anchor="middle" fill="white" font-weight="bold" font-size="12">Connection Memory</text>
                                                        <text x="630" y="490" text-anchor="middle" fill="white" font-size="10">Session Variables</text>
                                                        <text x="630" y="505" text-anchor="middle" fill="white" font-size="10">Query Context</text>
                                                        <text x="630" y="520" text-anchor="middle" fill="white" font-size="9">Per Session</text>
                                                    </svg>
                                                </div>
                                            </div>

                                        </div>
                                    </div>
                                    
                                    <!-- Original Resources -->
                                    <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
                                        <div class="bg-white dark:bg-base-800 p-6 rounded-lg shadow-sm">
                                            <div class="category-icon">
                                                <i class="fa-solid fa-external-link-alt"></i>
                                            </div>
                                            <h3 class="category-title">Official Documentation</h3>
                                            <p class="category-description">Access the complete PostgreSQL documentation</p>
                                            <a href="https://www.postgresql.org/docs/" target="_blank" class="text-primary-600 dark:text-primary-400 hover:underline">Visit Docs â†’</a>
                                        </div>
                                        <div class="bg-white dark:bg-base-800 p-6 rounded-lg shadow-sm">
                                            <div class="category-icon">
                                                <i class="fa-solid fa-users"></i>
                                            </div>
                                            <h3 class="category-title">Community</h3>
                                            <p class="category-description">Join the PostgreSQL community forums</p>
                                            <a href="https://www.postgresql.org/community/" target="_blank" class="text-primary-600 dark:text-primary-400 hover:underline">Join Community â†’</a>
                                        </div>
                                        <div class="bg-white dark:bg-base-800 p-6 rounded-lg shadow-sm">
                                            <div class="category-icon">
                                                <i class="fa-solid fa-download"></i>
                                            </div>
                                            <h3 class="category-title">Downloads</h3>
                                            <p class="category-description">Get the latest PostgreSQL releases</p>
                                            <a href="https://www.postgresql.org/download/" target="_blank" class="text-primary-600 dark:text-primary-400 hover:underline">Download â†’</a>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>`
                },
                getting_started: {
                    title: "Getting Started",
                    icon: "fa-solid fa-rocket",
                    content: `<div class="prose dark:prose-invert max-w-none"><h2>What is PostgreSQL?</h2><p>PostgreSQL is a powerful, open-source object-relational database system with over 30 years of active development that has earned it a strong reputation for reliability, feature robustness, and performance.</p><h2>Installation</h2><p>The best way to install PostgreSQL is through your operating system's package manager or by using the official installers. Refer to the <a href="https://www.postgresql.org/download/" target="_blank" rel="noopener noreferrer">official documentation</a> for detailed instructions for your OS.</p><h3>First Connection</h3><p>Once installed, you can connect to your database using the <code>psql</code> command-line tool.</p><pre><code class="language-bash">psql -U your_user -d your_database -h localhost</code></pre><h3>Creating Your First Database and Table</h3><p>Use these SQL commands to create a new database and a simple table within it.</p><pre><code class="language-sql">CREATE DATABASE my_first_db;\n\\c my_first_db;\n\nCREATE TABLE employees (\n    id SERIAL PRIMARY KEY,\n    first_name VARCHAR(50),\n    last_name VARCHAR(50),\n    hire_date DATE\n);</code></pre><h3>Basic SQL Commands</h3><p>Here are the fundamental commands for interacting with your data:</p><pre><code class="language-sql">-- Insert data\nINSERT INTO employees (first_name, last_name, hire_date) VALUES ('John', 'Doe', '2025-01-15');\n\n-- Select data\nSELECT * FROM employees;\n\n-- Update data\nUPDATE employees SET last_name = 'Smith' WHERE first_name = 'John';\n\n-- Delete data\nDELETE FROM employees WHERE first_name = 'John';</code></pre></div>`
                },
                architecture: {
                    title: "PostgreSQL Architecture",
                    icon: "fa-solid fa-sitemap",
                    content: `<div class="prose dark:prose-invert max-w-none space-y-12">
                        <div class="p-4 bg-base-100 dark:bg-base-800 rounded-lg">
                            <h3 class="text-lg font-semibold">Table of Contents</h3>
                            <ul class="mt-2 list-disc list-inside">
                                <li><a href="#logical-architecture" class="text-primary-600 dark:text-primary-400 hover:underline">Logical Architecture: The Query Lifecycle</a></li>
                                <li><a href="#physical-storage" class="text-primary-600 dark:text-primary-400 hover:underline">Physical Storage</a></li>
                                <li><a href="#background-processes" class="text-primary-600 dark:text-primary-400 hover:underline">Background Processes</a></li>
                                <li><a href="#concurrency" class="text-primary-600 dark:text-primary-400 hover:underline">Concurrency Control</a></li>
                            </ul>
                        </div>

                        <div id="logical-architecture">
                            <h2 class="text-2xl font-bold border-b pb-2 mb-4">Logical Architecture: The Query Lifecycle</h2>
                            <p>When you send a SQL query to PostgreSQL, it goes through a three-stage lifecycle to produce a result. This ensures the query is valid, efficient, and correctly executed.</p>
                            <div class="postgres-architecture my-6">
                                <h4>Query Processing Pipeline</h4>
                                <svg width="100%" viewBox="0 0 500 120" xmlns="http://www.w3.org/2000/svg"><style>.txt{font-family:Inter,sans-serif;font-size:10px;}.dark .txt{fill:white;} .dark .line{stroke:white;} .dark .box{stroke:white;}</style><rect x="20" y="40" width="100" height="40" rx="5" fill="#e0f2fe" class="box" stroke="#38bdf8"/><text x="70" y="65" text-anchor="middle" class="txt">Parser</text><rect x="190" y="40" width="100" height="40" rx="5" fill="#e0f2fe" class="box" stroke="#38bdf8"/><text x="240" y="65" text-anchor="middle" class="txt">Planner/Optimizer</text><rect x="360" y="40" width="100" height="40" rx="5" fill="#e0f2fe" class="box" stroke="#38bdf8"/><text x="410" y="65" text-anchor="middle" class="txt">Executor</text><path d="M 120 60 h 70" stroke="#64748b" class="line" stroke-width="2" marker-end="url(#arrow)"/><path d="M 290 60 h 70" stroke="#64748b" class="line" stroke-width="2" marker-end="url(#arrow)"/><text x="70" y="25" text-anchor="middle" class="txt font-bold">1. Syntax Check</text><text x="240" y="25" text-anchor="middle" class="txt font-bold">2. Create Query Plan</text><text x="410" y="25" text-anchor="middle" class="txt font-bold">3. Fetch Data</text><defs><marker id="arrow" viewBox="0 0 10 10" refX="5" refY="5" markerWidth="6" markerHeight="6" orient="auto-start-reverse"><path d="M 0 0 L 10 5 L 0 10 z" fill="#64748b"/></marker></defs></svg>
                            </div>
                            <ol class="list-decimal list-inside space-y-2">
                                <li><strong>Parser:</strong> Checks the SQL query for correct syntax and creates a "parse tree," a structured representation of the query.</li>
                                <li><strong>Planner/Optimizer:</strong> Takes the parse tree and generates the most efficient "execution plan" to retrieve the data. It considers available indexes, table statistics, and join strategies.</li>
                                <li><strong>Executor:</strong> Runs the execution plan, accessing the necessary data from tables and indexes, and returns the final result set.</li>
                            </ol>
                        </div>

                        <div id="physical-storage">
                            <h2 class="text-2xl font-bold border-b pb-2 mb-4">Physical Storage</h2>
                            <p>PostgreSQL organizes data on disk in a dedicated data directory. Key components include:</p>
                             <ul class="mt-2 list-disc list-inside space-y-2">
                                <li><strong>Data Directory (PGDATA):</strong> The root directory containing all database files, configuration, and WAL segments.</li>
                                <li><strong>Heap Files:</strong> The actual tables where row data (tuples) is stored, organized into 8KB pages/blocks.</li>
                                <li><strong>pg_wal:</strong> The directory containing Write-Ahead Log files. These files record every change to the database for crash recovery and replication.</li>
                                <li><strong>Visibility Map (VM):</strong> A bitmap that tracks which pages in a table contain only tuples visible to all active transactions, allowing for index-only scans and speeding up VACUUM.</li>
                            </ul>
                        </div>

                        <div id="background-processes">
                            <h2 class="text-2xl font-bold border-b pb-2 mb-4">Background Processes</h2>
                            <p>Several vital background processes run continuously to manage the database system:</p>
                            <ul class="mt-2 list-disc list-inside space-y-2">
                                <li><strong>Checkpointer:</strong> Periodically writes "dirty" (modified) data from shared memory to the data files on disk, creating a "checkpoint" for recovery.</li>
                                <li><strong>WAL Writer:</strong> Writes WAL records from memory buffers to the permanent WAL files in the <code>pg_wal</code> directory.</li>
                                <li><strong>Autovacuum:</strong> The automated process that reclaims storage from dead tuples and updates table statistics for the planner.</li>
                                <li><strong>Archiver:</strong> When enabled, this process copies completed WAL files to a separate, safe location for point-in-time recovery and replication.</li>
                            </ul>
                            <p class="mt-4">You can observe these and other active processes using the <code>pg_stat_activity</code> view:</p>
                            <pre><code class="language-sql">SELECT pid, usename, application_name, state, query FROM pg_stat_activity;</code></pre>
                        </div>

                        <div id="concurrency">
                            <h2 class="text-2xl font-bold border-b pb-2 mb-4">Concurrency Control</h2>
                            <p>PostgreSQL's ability to handle many simultaneous operations is built on these concepts:</p>
                             <ul class="mt-2 list-disc list-inside space-y-2">
                                <li><strong>MVCC:</strong> As described in the glossary, this is the primary mechanism that allows readers and writers not to block each other by maintaining multiple versions of rows.</li>
                                <li><strong>Row Locking:</strong> When a row is being updated (<code>UPDATE</code> or <code>DELETE</code>), PostgreSQL places an exclusive lock on that specific row version to prevent concurrent modifications, but this does not block readers.</li>
                                <li><strong>Shared Buffers:</strong> A large area in memory where data pages are cached for fast access. All backend processes share this cache to reduce disk I/O.</li>
                            </ul>
                        </div>
                    </div>`
                },
                glossary: {
                    title: "Glossary",
                    icon: "fa-solid fa-book",
                    intro: "A comprehensive glossary of common PostgreSQL terms and concepts.",
                    terms: [
                        {
                            term: "MVCC (Multi-Version Concurrency Control)",
                            explanation: "The core mechanism PostgreSQL uses to handle simultaneous access to data. Instead of using locks for reading, MVCC provides each transaction with a consistent 'snapshot' of the database. When a row is updated or deleted, PostgreSQL creates a new version of the row (a new tuple) and marks the old one as expired, ensuring readers don't block writers and vice-versa.",
                            example: "If Transaction A starts and reads a row, and then Transaction B updates that same row and commits, Transaction A will still see the original, pre-update version of the row until it completes. This prevents read phenomena like 'dirty reads'.",
                            visual: `<div class="diagram-container"><div class="ascii-art">MVCC Transaction Timeline:

Transaction A: â”€â”€â”€â”€â”€â”€ Read v1 â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ Read v1 â”€â”€â”€â”€â”€â”€
                      â”‚                     â”‚
Transaction B: â”€â”€â”€â”€â”€â”€ Write v2 â”€â”€â”€â”€â”€â”€ Commit â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
                                       â”‚
New Transactions: â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ Read v2 â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

Legend: v1 = Row Version 1, v2 = Row Version 2</div></div>`,
                            version_impact: "Fundamental to PostgreSQL since its early versions. Performance and efficiency, especially around freezing and anti-wraparound mechanisms, have been improved in newer versions (9.6+).",
                            link: "https://www.postgresql.org/docs/current/mvcc-intro.html"
                        },
                        {
                            term: "WAL (Write-Ahead Logging)",
                            explanation: "A standard method for ensuring data integrity and durability. Before any changes are made to the actual data files (heap), PostgreSQL writes a record of the change to a separate log file on diskâ€”the WAL. This ensures that even if the server crashes before the main data files are updated, the database can be recovered by 'replaying' the WAL records.",
                            example: "When you run an `INSERT` command, the new data is first written to a WAL record and flushed to disk. Only after that is it written to the table's data file in memory. This guarantees that no committed transaction is ever lost.",
                            version_impact: "Core feature. Enhancements like WAL compression (v9.5+), parallel recovery, and improved management tools have been added over time.",
                            link: "https://www.postgresql.org/docs/current/wal.html"
                        },
                        {
                            term: "TOAST (The Oversized-Attribute Storage Technique)",
                            explanation: "An automatic mechanism for storing large field values (like `text`, `jsonb`, or large `varchar` columns) out of line. When a row's total size exceeds a certain threshold (typically 2KB), PostgreSQL compresses and/or moves large attributes to a separate 'TOAST table', leaving only a small pointer in the main table. This keeps the main table lean and fast to scan.",
                            example: "A `products` table has a `description` column of type `text`. If you insert a product with a 10KB description, the main row will store the `id` and `name`, while the 10KB text is moved to the TOAST table associated with `products`.",
                            visual: `<div class="diagram-container"><div class="ascii-art">TOAST Storage Structure:

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   Main Table Row    â”‚    â”‚      TOAST Table         â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤    â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ id: 123            â”‚    â”‚ [Large Text Data...]     â”‚
â”‚ name: "Product"    â”‚â”€â”€â”€â”€â–¶â”‚ [Compressed/Chunked]     â”‚
â”‚ description: ptr   â”‚    â”‚ [Multiple Chunks...]     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

Benefits:
â€¢ Keeps main table rows small
â€¢ Improves scan performance
â€¢ Automatic compression
â€¢ Transparent to queries</div></div>`,
                            version_impact: "A long-standing feature. Default compression method changed to LZ4 in PostgreSQL 14 for better performance.",
                            link: "https://www.postgresql.org/docs/current/storage-toast.html"
                        },
                        {
                            term: "FSM (Free Space Map)",
                            explanation: "A set of data structures that PostgreSQL uses to keep track of available free space within each table and index file (heap and index pages). When new data needs to be inserted, PostgreSQL consults the FSM to quickly find a page with enough space, avoiding a slow sequential scan of the table.",
                            example: "After a `DELETE` or `VACUUM` operation, space within data pages becomes available. The FSM is updated to record this, so the next `INSERT` can efficiently reuse that empty slot.",
                            version_impact: "The FSM was significantly redesigned in PostgreSQL 8.4 for better performance and to remove previous limitations. It is now a standard, robust feature.",
                            link: "https://www.postgresql.org/docs/current/storage-fsm.html"
                        },
                        {
                            term: "CTID (Tuple Identifier)",
                            explanation: "A system column present in every PostgreSQL table that uniquely identifies the physical location of a row version (tuple) within its table. It is represented as a pair of numbers `(page, item)`, where `page` is the block number on disk and `item` is the item number within that page. CTIDs are used internally by indexes to point to the actual row data.",
                            example: "A CTID of `(0,42)` means the row is the 42nd item on the very first page (page 0) of the table's data file. You can select it directly: `SELECT ctid, * FROM my_table LIMIT 1;`.",
                            version_impact: "CTIDs are fundamental but should not be used as stable, long-term identifiers in applications because they can change after operations like `VACUUM FULL` or `UPDATE`.",
                            link: "https://www.postgresql.org/docs/current/ddl-system-columns.html"
                        },
                        {
                            term: "GUC (Grand Unified Configuration)",
                            explanation: "The name for PostgreSQL's extensive system of runtime configuration parameters. These settings, found in `postgresql.conf`, control server behavior, resource usage, and performance. They can be set at various levels, including for the entire cluster, per-database, per-user, or even per-session.",
                            example: "Setting `work_mem = '128MB'` in `postgresql.conf` increases the memory available for sorting operations for all connections. Alternatively, `SET work_mem = '256MB';` will change it only for the current session.",
                            version_impact: "New GUCs are added with almost every major PostgreSQL release, offering finer-grained control over new features.",
                            link: "https://www.postgresql.org/docs/current/runtime-config.html"
                        },
                        {
                            term: "HOT (Heap-Only Tuples) Update",
                            explanation: "A performance optimization for `UPDATE` operations. If an update does not modify any columns that are part of an index, PostgreSQL can create the new row version on the same data page as the old one without needing to create new entries in any of the table's indexes. This significantly reduces write amplification and index bloat.",
                            example: "Updating a `last_login` timestamp on a `users` table, where `last_login` is not an indexed column, is a perfect candidate for a HOT update.",
                            version_impact: "Introduced in PostgreSQL 8.3. The effectiveness of HOT updates can be monitored via the `n_tup_hot_upd` column in `pg_stat_user_tables`.",
                            link: "https://www.postgresql.org/docs/current/storage-hot.html"
                        }
                    ]
                },
                system_catalogs: {
                    title: "System Catalog Explorer",
                    icon: "fa-solid fa-database",
                    intro: "A comprehensive guide to PostgreSQL's system catalog tables for database introspection and monitoring.",
                    categories: [
                        {
                            category: "Core Table Metadata",
                            description: "Essential system catalogs for understanding table structure and properties",
                            tables: [
                                {
                                    name: "pg_class",
                                    purpose: "Stores metadata about tables, indexes, sequences, and views (collectively known as relations).",
                                    importance: "Critical",
                                    columns: [
                                        { name: "relname", desc: "The name of the relation.", datatype: "name" },
                                        { name: "reltuples", desc: "Estimated number of rows in the table (updated by ANALYZE).", datatype: "real" },
                                        { name: "relkind", desc: "'r' for table, 'i' for index, 'S' for sequence, 'v' for view, 'm' for materialized view.", datatype: "char" },
                                        { name: "relpages", desc: "Size of the on-disk representation in pages (typically 8KB each).", datatype: "integer" },
                                        { name: "relowner", desc: "OID of the role that owns this relation.", datatype: "oid" },
                                        { name: "relam", desc: "Access method for indexes (0 for non-indexes).", datatype: "oid" },
                                        { name: "relfilenode", desc: "Name of the on-disk file storing this relation (usually same as OID).", datatype: "oid" },
                                        { name: "reltablespace", desc: "OID of the tablespace containing this relation (0 = default).", datatype: "oid" }
                                    ],
                                    practical_queries: [
                                        {
                                            title: "Find Largest Tables by Size",
                                            query: "SELECT relname, pg_size_pretty(pg_total_relation_size(oid)) as size FROM pg_class WHERE relkind = 'r' ORDER BY pg_total_relation_size(oid) DESC LIMIT 10;",
                                            use_case: "Identifying storage usage patterns and planning capacity"
                                        },
                                        {
                                            title: "List All Indexes with Their Methods",
                                            query: "SELECT i.relname as index_name, t.relname as table_name, am.amname as access_method FROM pg_class i JOIN pg_class t ON i.relnamespace = t.relnamespace JOIN pg_am am ON i.relam = am.oid WHERE i.relkind = 'i';",
                                            use_case: "Auditing index types and access methods"
                                        }
                                    ],
                                    monitoring_queries: [
                                        {
                                            name: "Table Size Distribution",
                                            query: "SELECT CASE WHEN pg_total_relation_size(oid) < 1024*1024 THEN '<1MB' WHEN pg_total_relation_size(oid) < 1024*1024*10 THEN '1-10MB' WHEN pg_total_relation_size(oid) < 1024*1024*100 THEN '10-100MB' ELSE '>100MB' END as size_range, COUNT(*) FROM pg_class WHERE relkind = 'r' GROUP BY 1 ORDER BY 1;"
                                        }
                                    ],
                                    tips: [
                                        "Use pg_total_relation_size() for total size including indexes and TOAST tables",
                                        "reltuples is an estimate - run ANALYZE to update it",
                                        "Check relkind to distinguish between different object types"
                                    ]
                                },
                                {
                                    name: "pg_attribute",
                                    purpose: "Stores metadata about the columns of tables and other relations.",
                                    importance: "Critical",
                                    columns: [
                                        { name: "attrelid", desc: "The OID of the table this column belongs to (links to pg_class.oid).", datatype: "oid" },
                                        { name: "attname", desc: "The name of the column.", datatype: "name" },
                                        { name: "atttypid", desc: "The OID of the data type of this column (links to pg_type.oid).", datatype: "oid" },
                                        { name: "attnotnull", desc: "True if the column has a NOT NULL constraint.", datatype: "boolean" },
                                        { name: "attnum", desc: "The column position (1, 2, 3...). Negative numbers are system columns.", datatype: "smallint" },
                                        { name: "attlen", desc: "Length of the data type (-1 for variable-length types).", datatype: "smallint" },
                                        { name: "attndims", desc: "Number of array dimensions (0 for non-arrays).", datatype: "integer" },
                                        { name: "atthasdef", desc: "True if the column has a default value.", datatype: "boolean" }
                                    ],
                                    practical_queries: [
                                        {
                                            title: "Analyze Column Data Types Across Schema",
                                            query: "SELECT t.typname, COUNT(*) as usage_count FROM pg_attribute a JOIN pg_type t ON a.atttypid = t.oid JOIN pg_class c ON a.attrelid = c.oid WHERE c.relkind = 'r' AND a.attnum > 0 GROUP BY t.typname ORDER BY usage_count DESC;",
                                            use_case: "Understanding data type usage patterns in your schema"
                                        },
                                        {
                                            title: "Find Tables with Many Columns",
                                            query: "SELECT c.relname, COUNT(a.attname) as column_count FROM pg_class c JOIN pg_attribute a ON c.oid = a.attrelid WHERE c.relkind = 'r' AND a.attnum > 0 GROUP BY c.relname HAVING COUNT(a.attname) > 20 ORDER BY column_count DESC;",
                                            use_case: "Identifying potentially over-normalized or wide tables"
                                        }
                                    ],
                                    monitoring_queries: [
                                        {
                                            name: "NOT NULL Constraint Coverage",
                                            query: "SELECT c.relname, COUNT(CASE WHEN a.attnotnull THEN 1 END)::float / COUNT(*)::float * 100 as notnull_percentage FROM pg_class c JOIN pg_attribute a ON c.oid = a.attrelid WHERE c.relkind = 'r' AND a.attnum > 0 GROUP BY c.relname ORDER BY notnull_percentage;"
                                        }
                                    ],
                                    tips: [
                                        "Filter attnum > 0 to exclude system columns (ctid, oid, etc.)",
                                        "Use attisdropped = false to exclude dropped columns",
                                        "Join with pg_type to get human-readable data type names"
                                    ]
                                }
                            ]
                        },
                        {
                            category: "Performance & Activity Monitoring",
                            description: "System catalogs and views for monitoring database activity and performance",
                            tables: [
                                {
                                    name: "pg_stat_activity",
                                    purpose: "Provides a real-time snapshot of all active sessions and backend processes.",
                                    importance: "Critical",
                                    columns: [
                                        { name: "pid", desc: "The process ID of the backend.", datatype: "integer" },
                                        { name: "usename", desc: "The name of the user connected.", datatype: "name" },
                                        { name: "application_name", desc: "Name of the application connected to this backend.", datatype: "text" },
                                        { name: "client_addr", desc: "IP address of the client connected to this backend.", datatype: "inet" },
                                        { name: "state", desc: "'active', 'idle', 'idle in transaction', 'idle in transaction (aborted)'.", datatype: "text" },
                                        { name: "query", desc: "The text of the currently executing query.", datatype: "text" },
                                        { name: "query_start", desc: "Time when the currently active query was started.", datatype: "timestamp" },
                                        { name: "backend_start", desc: "Time when this process was started.", datatype: "timestamp" },
                                        { name: "wait_event_type", desc: "Type of event the backend is waiting for (Lock, IO, etc.).", datatype: "text" },
                                        { name: "wait_event", desc: "Specific wait event name.", datatype: "text" }
                                    ],
                                    practical_queries: [
                                        {
                                            title: "Find Long-Running Transactions",
                                            query: "SELECT pid, usename, state, age(now(), xact_start) as transaction_age, age(now(), query_start) as query_age, query FROM pg_stat_activity WHERE state IN ('idle in transaction', 'active') AND xact_start < now() - interval '1 hour' ORDER BY xact_start;",
                                            use_case: "Identifying transactions that may be blocking others or holding locks too long"
                                        },
                                        {
                                            title: "Active Queries by Wait Events",
                                            query: "SELECT wait_event_type, wait_event, COUNT(*), array_agg(DISTINCT usename) as users FROM pg_stat_activity WHERE state = 'active' AND wait_event IS NOT NULL GROUP BY wait_event_type, wait_event ORDER BY count DESC;",
                                            use_case: "Understanding what resources are causing bottlenecks"
                                        }
                                    ],
                                    monitoring_queries: [
                                        {
                                            name: "Connection Pool Health",
                                            query: "SELECT state, COUNT(*) FROM pg_stat_activity GROUP BY state ORDER BY count DESC;"
                                        },
                                        {
                                            name: "Top Applications by Connection Count",
                                            query: "SELECT application_name, COUNT(*) as connections FROM pg_stat_activity WHERE state != '' GROUP BY application_name ORDER BY connections DESC;"
                                        }
                                    ],
                                    tips: [
                                        "Use WHERE pid <> pg_backend_pid() to exclude your own session",
                                        "Monitor 'idle in transaction' connections - they can block autovacuum",
                                        "wait_event information is crucial for performance troubleshooting"
                                    ]
                                },
                                {
                                    name: "pg_stat_user_tables",
                                    purpose: "Contains statistics about user table activity including reads, writes, and vacuum information.",
                                    importance: "High",
                                    columns: [
                                        { name: "schemaname", desc: "Name of the schema containing this table.", datatype: "name" },
                                        { name: "relname", desc: "Name of this table.", datatype: "name" },
                                        { name: "seq_scan", desc: "Number of sequential scans initiated on this table.", datatype: "bigint" },
                                        { name: "seq_tup_read", desc: "Number of live rows fetched by sequential scans.", datatype: "bigint" },
                                        { name: "idx_scan", desc: "Number of index scans initiated on this table.", datatype: "bigint" },
                                        { name: "idx_tup_fetch", desc: "Number of live rows fetched by index scans.", datatype: "bigint" },
                                        { name: "n_tup_ins", desc: "Number of rows inserted.", datatype: "bigint" },
                                        { name: "n_tup_upd", desc: "Number of rows updated (including HOT updates).", datatype: "bigint" },
                                        { name: "n_tup_del", desc: "Number of rows deleted.", datatype: "bigint" },
                                        { name: "n_tup_hot_upd", desc: "Number of rows HOT updated.", datatype: "bigint" },
                                        { name: "n_live_tup", desc: "Estimated number of live rows.", datatype: "bigint" },
                                        { name: "n_dead_tup", desc: "Estimated number of dead rows.", datatype: "bigint" },
                                        { name: "last_vacuum", desc: "Last time this table was manually vacuumed.", datatype: "timestamp" },
                                        { name: "last_autovacuum", desc: "Last time this table was vacuumed by autovacuum.", datatype: "timestamp" },
                                        { name: "vacuum_count", desc: "Number of times this table has been manually vacuumed.", datatype: "bigint" },
                                        { name: "autovacuum_count", desc: "Number of times this table has been vacuumed by autovacuum.", datatype: "bigint" }
                                    ],
                                    practical_queries: [
                                        {
                                            title: "Tables with High Sequential Scan Ratio",
                                            query: "SELECT schemaname, relname, seq_scan, idx_scan, CASE WHEN seq_scan + idx_scan = 0 THEN 0 ELSE seq_scan::float / (seq_scan + idx_scan)::float * 100 END as seq_scan_pct FROM pg_stat_user_tables WHERE seq_scan + idx_scan > 1000 ORDER BY seq_scan_pct DESC;",
                                            use_case: "Finding tables that might benefit from better indexing"
                                        },
                                        {
                                            title: "Table Bloat Analysis",
                                            query: "SELECT schemaname, relname, n_live_tup, n_dead_tup, CASE WHEN n_live_tup + n_dead_tup = 0 THEN 0 ELSE n_dead_tup::float / (n_live_tup + n_dead_tup)::float * 100 END as bloat_pct, last_vacuum, last_autovacuum FROM pg_stat_user_tables WHERE n_dead_tup > 1000 ORDER BY bloat_pct DESC;",
                                            use_case: "Identifying tables that need vacuum attention"
                                        }
                                    ],
                                    monitoring_queries: [
                                        {
                                            name: "HOT Update Efficiency",
                                            query: "SELECT schemaname, relname, n_tup_upd, n_tup_hot_upd, CASE WHEN n_tup_upd = 0 THEN 0 ELSE n_tup_hot_upd::float / n_tup_upd::float * 100 END as hot_update_pct FROM pg_stat_user_tables WHERE n_tup_upd > 1000 ORDER BY hot_update_pct;"
                                        }
                                    ],
                                    tips: [
                                        "High seq_scan values might indicate missing indexes",
                                        "Monitor n_dead_tup to ensure autovacuum is working effectively",
                                        "HOT update percentage indicates index update efficiency"
                                    ]
                                }
                            ]
                        },
                        {
                            category: "Index & Query Performance",
                            description: "System catalogs for analyzing index usage and query performance",
                            tables: [
                                {
                                    name: "pg_stat_user_indexes",
                                    purpose: "Statistics about index usage and performance for user-defined indexes.",
                                    importance: "High",
                                    columns: [
                                        { name: "schemaname", desc: "Name of the schema containing this index.", datatype: "name" },
                                        { name: "relname", desc: "Name of the table for this index.", datatype: "name" },
                                        { name: "indexrelname", desc: "Name of this index.", datatype: "name" },
                                        { name: "idx_scan", desc: "Number of index scans initiated on this index.", datatype: "bigint" },
                                        { name: "idx_tup_read", desc: "Number of index entries returned by scans on this index.", datatype: "bigint" },
                                        { name: "idx_tup_fetch", desc: "Number of live table rows fetched by simple index scans.", datatype: "bigint" }
                                    ],
                                    practical_queries: [
                                        {
                                            title: "Unused Indexes (Potential for Removal)",
                                            query: "SELECT schemaname, relname, indexrelname, pg_size_pretty(pg_relation_size(indexrelname::regclass)) as size FROM pg_stat_user_indexes WHERE idx_scan < 10 ORDER BY pg_relation_size(indexrelname::regclass) DESC;",
                                            use_case: "Finding indexes that consume space but aren't used for queries"
                                        },
                                        {
                                            title: "Index Efficiency Analysis",
                                            query: "SELECT schemaname, relname, indexrelname, idx_scan, idx_tup_read, CASE WHEN idx_scan = 0 THEN 0 ELSE idx_tup_read::float / idx_scan::float END as avg_tuples_per_scan FROM pg_stat_user_indexes WHERE idx_scan > 0 ORDER BY avg_tuples_per_scan DESC;",
                                            use_case: "Understanding index selectivity and efficiency"
                                        }
                                    ],
                                    monitoring_queries: [
                                        {
                                            name: "Index Usage Summary",
                                            query: "SELECT COUNT(*) as total_indexes, SUM(CASE WHEN idx_scan = 0 THEN 1 ELSE 0 END) as unused_indexes, SUM(CASE WHEN idx_scan > 0 THEN 1 ELSE 0 END) as used_indexes FROM pg_stat_user_indexes;"
                                        }
                                    ],
                                    tips: [
                                        "Zero idx_scan doesn't always mean unused - consider unique constraints",
                                        "High idx_tup_read with low idx_tup_fetch might indicate poor selectivity",
                                        "Compare with pg_indexes for complete index information"
                                    ]
                                },
                                {
                                    name: "pg_indexes",
                                    purpose: "A user-friendly view showing index definitions and metadata.",
                                    importance: "Medium",
                                    columns: [
                                        { name: "schemaname", desc: "Name of the schema containing the index.", datatype: "name" },
                                        { name: "tablename", desc: "Name of the table the index is on.", datatype: "name" },
                                        { name: "indexname", desc: "Name of the index.", datatype: "name" },
                                        { name: "tablespace", desc: "Name of the tablespace containing the index.", datatype: "name" },
                                        { name: "indexdef", desc: "The CREATE INDEX command for this index.", datatype: "text" }
                                    ],
                                    practical_queries: [
                                        {
                                            title: "Find Duplicate or Similar Indexes",
                                            query: "SELECT tablename, array_agg(indexname) as similar_indexes, array_agg(indexdef) FROM pg_indexes WHERE schemaname = 'public' GROUP BY tablename, regexp_replace(indexdef, 'CREATE .*? INDEX .*? ON .*?\\((.*)\\)', '\\1') HAVING COUNT(*) > 1;",
                                            use_case: "Identifying redundant indexes that could be consolidated"
                                        },
                                        {
                                            title: "Indexes by Access Method",
                                            query: "SELECT CASE WHEN indexdef LIKE '%USING btree%' THEN 'btree' WHEN indexdef LIKE '%USING hash%' THEN 'hash' WHEN indexdef LIKE '%USING gin%' THEN 'gin' WHEN indexdef LIKE '%USING gist%' THEN 'gist' ELSE 'other' END as access_method, COUNT(*) FROM pg_indexes GROUP BY 1 ORDER BY count DESC;",
                                            use_case: "Understanding the distribution of index types in your database"
                                        }
                                    ],
                                    monitoring_queries: [
                                        {
                                            name: "Index Size by Table",
                                            query: "SELECT schemaname, tablename, COUNT(*) as index_count, pg_size_pretty(SUM(pg_relation_size(indexname::regclass))) as total_index_size FROM pg_indexes GROUP BY schemaname, tablename ORDER BY SUM(pg_relation_size(indexname::regclass)) DESC;"
                                        }
                                    ],
                                    tips: [
                                        "Use indexdef to understand the exact index definition",
                                        "Combine with pg_stat_user_indexes for usage statistics",
                                        "Regular expression parsing of indexdef can help find patterns"
                                    ]
                                }
                            ]
                        },
                        {
                            category: "Security & Permissions",
                            description: "System catalogs for managing database security and user permissions",
                            tables: [
                                {
                                    name: "pg_roles",
                                    purpose: "Information about database roles (users and groups).",
                                    importance: "High",
                                    columns: [
                                        { name: "rolname", desc: "Role name.", datatype: "name" },
                                        { name: "rolsuper", desc: "Role has superuser privileges.", datatype: "boolean" },
                                        { name: "rolinherit", desc: "Role automatically inherits privileges of roles it is a member of.", datatype: "boolean" },
                                        { name: "rolcreaterole", desc: "Role can create roles.", datatype: "boolean" },
                                        { name: "rolcreatedb", desc: "Role can create databases.", datatype: "boolean" },
                                        { name: "rolcanlogin", desc: "Role can log in (i.e., role can be given as initial session authorization name).", datatype: "boolean" },
                                        { name: "rolreplication", desc: "Role is a replication role.", datatype: "boolean" },
                                        { name: "rolconnlimit", desc: "Maximum connections for role (-1 = no limit).", datatype: "integer" },
                                        { name: "rolvaliduntil", desc: "Password expiry time (NULL = no expiry).", datatype: "timestamp" }
                                    ],
                                    practical_queries: [
                                        {
                                            title: "Security Audit - Privileged Roles",
                                            query: "SELECT rolname, rolsuper, rolcreaterole, rolcreatedb, rolreplication, rolcanlogin FROM pg_roles WHERE rolsuper OR rolcreaterole OR rolcreatedb OR rolreplication ORDER BY rolsuper DESC, rolcreaterole DESC;",
                                            use_case: "Auditing users with elevated privileges"
                                        },
                                        {
                                            title: "Password Expiry Monitoring",
                                            query: "SELECT rolname, rolvaliduntil, CASE WHEN rolvaliduntil IS NULL THEN 'Never expires' WHEN rolvaliduntil < now() THEN 'Expired' WHEN rolvaliduntil < now() + interval '30 days' THEN 'Expires soon' ELSE 'Valid' END as status FROM pg_roles WHERE rolcanlogin ORDER BY rolvaliduntil NULLS LAST;",
                                            use_case: "Monitoring password expiration status"
                                        }
                                    ],
                                    monitoring_queries: [
                                        {
                                            name: "Role Distribution",
                                            query: "SELECT COUNT(*) as total_roles, SUM(CASE WHEN rolcanlogin THEN 1 ELSE 0 END) as login_roles, SUM(CASE WHEN rolsuper THEN 1 ELSE 0 END) as superuser_roles FROM pg_roles;"
                                        }
                                    ],
                                    tips: [
                                        "Regularly audit superuser roles - they have unrestricted access",
                                        "Monitor rolconnlimit to prevent connection exhaustion",
                                        "Use rolvaliduntil to implement password rotation policies"
                                    ]
                                }
                            ]
                        }
                    ]
                },
                error_guide: {
                    title: "PostgreSQL Error Guide",
                    icon: "fa-solid fa-life-ring",
                    intro: "A comprehensive troubleshooting guide for PostgreSQL errors, organized by category for quick diagnosis and resolution.",
                    categories: [
                        {
                            name: "Connection & Authentication Errors",
                            icon: "fa-solid fa-plug-circle-exclamation",
                            description: "Issues related to establishing connections and user authentication",
                            errors: [
                                {
                                    message: "FATAL: Peer authentication failed for user \"username\"",
                                    errorCode: "28000",
                                    severity: "Medium",
                                    cause: "This occurs when the authentication method in `pg_hba.conf` is set to `peer`, but the operating system user running the client does not match the PostgreSQL user being connected to.",
                                    resolution: "Edit the `pg_hba.conf` file to change the authentication method for the user/database combination to `scram-sha-256`, `md5`, or `trust` (less secure). After editing, reload the PostgreSQL configuration: `SELECT pg_reload_conf();`.",
                                    parameters: "pg_hba.conf",
                                    tip: "Use `scram-sha-256` for new setups. For local connections, explicitly specify the user with `psql -U username` to avoid ambiguity.",
                                    troubleshooting: [
                                        "Check current authentication method: `SELECT * FROM pg_hba_file_rules;`",
                                        "Verify user exists: `SELECT rolname FROM pg_roles WHERE rolname = 'username';`",
                                        "Test connection with explicit host: `psql -h localhost -U username`"
                                    ]
                                },
                                {
                                    message: "FATAL: sorry, too many clients already",
                                    errorCode: "53300",
                                    severity: "High",
                                    cause: "The number of active connections to the database has reached the limit defined by the `max_connections` parameter.",
                                    resolution: "Increase the `max_connections` value in `postgresql.conf` and restart the server. Be aware that each connection consumes memory, so do not set this value excessively high without sufficient RAM.",
                                    parameters: "max_connections, superuser_reserved_connections",
                                    tip: "Use a connection pooler like PgBouncer or the one built into your application framework. This reuses a smaller number of database connections to serve a much larger number of application clients, which is far more efficient.",
                                    troubleshooting: [
                                        "Check current connections: `SELECT count(*) FROM pg_stat_activity;`",
                                        "Find long-running queries: `SELECT pid, query_start, state, query FROM pg_stat_activity WHERE state = 'active' ORDER BY query_start;`",
                                        "Terminate specific connections: `SELECT pg_terminate_backend(pid);`"
                                    ]
                                },
                                {
                                    message: "FATAL: database \"dbname\" does not exist",
                                    errorCode: "3D000",
                                    severity: "Medium",
                                    cause: "The specified database name does not exist in the PostgreSQL cluster.",
                                    resolution: "Verify the database name is correct, or create the database if it doesn't exist using `CREATE DATABASE dbname;`",
                                    parameters: "N/A",
                                    tip: "List all databases with `\\l` in psql or query `pg_database` to see available databases.",
                                    troubleshooting: [
                                        "List databases: `SELECT datname FROM pg_database;`",
                                        "Check current database: `SELECT current_database();`",
                                        "Create database: `CREATE DATABASE new_db_name;`"
                                    ]
                                },
                                {
                                    message: "FATAL: no pg_hba.conf entry for host",
                                    errorCode: "28000",
                                    severity: "High",
                                    cause: "The client's IP address is not allowed to connect according to the `pg_hba.conf` configuration file.",
                                    resolution: "Add an appropriate entry to `pg_hba.conf` for the client's IP address and reload configuration with `SELECT pg_reload_conf();`",
                                    parameters: "pg_hba.conf",
                                    tip: "Use specific IP ranges instead of 0.0.0.0/0 in production for security.",
                                    troubleshooting: [
                                        "Check pg_hba.conf rules: `SELECT * FROM pg_hba_file_rules;`",
                                        "Verify client IP: `SELECT inet_client_addr(), inet_client_port();`",
                                        "Test from specific host: `psql -h server_ip -U username -d dbname`"
                                    ]
                                },
                                {
                                    message: "FATAL: password authentication failed for user \"username\"",
                                    errorCode: "28P01",
                                    severity: "Medium",
                                    cause: "The password provided for the user is incorrect or the user doesn't exist.",
                                    resolution: "Verify the username and password are correct. Reset the password if necessary using ALTER ROLE.",
                                    parameters: "N/A",
                                    tip: "Check for typos in username and ensure the user exists in the database.",
                                    troubleshooting: [
                                        "Check if user exists: `SELECT rolname FROM pg_roles WHERE rolname = 'username';`",
                                        "Reset password: `ALTER ROLE username WITH PASSWORD 'new_password';`",
                                        "Test connection: `psql -h host -U username -d dbname`"
                                    ]
                                },
                                {
                                    message: "FATAL: role \"username\" does not exist",
                                    errorCode: "28000",
                                    severity: "Medium",
                                    cause: "The specified user role does not exist in the PostgreSQL cluster.",
                                    resolution: "Create the user role or verify the correct username is being used.",
                                    parameters: "N/A",
                                    tip: "List all roles with \\du in psql to see available users.",
                                    troubleshooting: [
                                        "List all roles: `SELECT rolname FROM pg_roles;`",
                                        "Create role: `CREATE ROLE username WITH LOGIN PASSWORD 'password';`",
                                        "Check role attributes: `\\du username`"
                                    ]
                                },
                                {
                                    message: "FATAL: role \"username\" is not permitted to log in",
                                    errorCode: "28000",
                                    severity: "Medium",
                                    cause: "The role exists but does not have the LOGIN privilege.",
                                    resolution: "Grant LOGIN privilege to the role using ALTER ROLE username WITH LOGIN.",
                                    parameters: "N/A",
                                    tip: "Roles created without LOGIN are group roles and cannot connect directly.",
                                    troubleshooting: [
                                        "Check login privilege: `SELECT rolname, rolcanlogin FROM pg_roles WHERE rolname = 'username';`",
                                        "Grant login: `ALTER ROLE username WITH LOGIN;`",
                                        "Verify change: `SELECT rolcanlogin FROM pg_roles WHERE rolname = 'username';`"
                                    ]
                                },
                                {
                                    message: "FATAL: connection limit exceeded for non-superusers",
                                    errorCode: "53300",
                                    severity: "High",
                                    cause: "All connection slots are occupied and the connecting user is not a superuser.",
                                    resolution: "Terminate idle connections or increase max_connections. Reserve connections for superusers.",
                                    parameters: "max_connections, superuser_reserved_connections",
                                    tip: "Always reserve some connections for superusers to perform maintenance.",
                                    troubleshooting: [
                                        "Check connections: `SELECT count(*), usename FROM pg_stat_activity GROUP BY usename;`",
                                        "Find idle connections: `SELECT pid, usename, state FROM pg_stat_activity WHERE state = 'idle';`",
                                        "Terminate idle: `SELECT pg_terminate_backend(pid) FROM pg_stat_activity WHERE state = 'idle';`"
                                    ]
                                },
                                {
                                    message: "FATAL: unsupported frontend protocol",
                                    errorCode: "0A000",
                                    severity: "Medium",
                                    cause: "The client is using an incompatible protocol version with the PostgreSQL server.",
                                    resolution: "Update the client library or PostgreSQL server to compatible versions.",
                                    parameters: "N/A",
                                    tip: "Check PostgreSQL and client library versions for compatibility.",
                                    troubleshooting: [
                                        "Check server version: `SELECT version();`",
                                        "Check client version: Use appropriate client command",
                                        "Update client libraries to match server version"
                                    ]
                                },
                                {
                                    message: "FATAL: terminating connection due to administrator command",
                                    errorCode: "57P01",
                                    severity: "Medium",
                                    cause: "An administrator manually terminated the connection using pg_terminate_backend().",
                                    resolution: "This is typically intentional. Check with database administrators about the termination reason.",
                                    parameters: "N/A",
                                    tip: "Check PostgreSQL logs for context about why the connection was terminated.",
                                    troubleshooting: [
                                        "Check logs for termination reason",
                                        "Contact database administrator",
                                        "Review current connections: `SELECT * FROM pg_stat_activity;`"
                                    ]
                                },
                                {
                                    message: "FATAL: the database system is starting up",
                                    errorCode: "57P03",
                                    severity: "High",
                                    cause: "PostgreSQL server is in the process of starting up and not yet ready to accept connections.",
                                    resolution: "Wait for the server to complete startup process before attempting connections.",
                                    parameters: "N/A",
                                    tip: "Use pg_isready to check when the server is ready to accept connections.",
                                    troubleshooting: [
                                        "Check server status: `pg_isready -h host -p port`",
                                        "Monitor startup: Check PostgreSQL logs",
                                        "Wait and retry connection"
                                    ]
                                },
                                {
                                    message: "FATAL: the database system is shutting down",
                                    errorCode: "57P03",
                                    severity: "High",
                                    cause: "PostgreSQL server is in the process of shutting down and no longer accepting new connections.",
                                    resolution: "Wait for shutdown to complete and restart the server if needed.",
                                    parameters: "N/A",
                                    tip: "Check if shutdown was planned or if there's an issue requiring investigation.",
                                    troubleshooting: [
                                        "Check server process: `ps aux | grep postgres`",
                                        "Review shutdown logs",
                                        "Restart server if needed: `pg_ctl start`"
                                    ]
                                },
                                {
                                    message: "FATAL: could not open file \"pg_hba.conf\"",
                                    errorCode: "XX000",
                                    severity: "Critical",
                                    cause: "PostgreSQL cannot read the pg_hba.conf file due to missing file or permission issues.",
                                    resolution: "Check file existence and permissions. Ensure PostgreSQL user can read the file.",
                                    parameters: "hba_file",
                                    tip: "pg_hba.conf should be readable by the postgres user and located in the data directory.",
                                    troubleshooting: [
                                        "Check file exists: `ls -la $PGDATA/pg_hba.conf`",
                                        "Check permissions: `ls -la $PGDATA/pg_hba.conf`",
                                        "Fix permissions: `chown postgres:postgres $PGDATA/pg_hba.conf`"
                                    ]
                                }
                            ]
                        },
                        {
                            name: "System Resource Errors",
                            icon: "fa-solid fa-memory",
                            description: "Issues related to memory, disk space, and system resources",
                            errors: [
                                {
                                    message: "ERROR: could not extend file \"base/.../filenumber\": No space left on device",
                                    errorCode: "53100",
                                    severity: "Critical",
                                    cause: "The disk partition where the PostgreSQL data directory resides has run out of physical storage space.",
                                    resolution: "Free up disk space on the relevant partition by deleting unnecessary files, or add more storage to the volume. You can find the data directory path with `SHOW data_directory;`.",
                                    parameters: "N/A",
                                    tip: "Set up disk space monitoring (e.g., with Nagios, Zabbix, or a cloud provider's tools) to get alerts before the disk is completely full.",
                                    troubleshooting: [
                                        "Check disk usage: `SELECT pg_size_pretty(pg_database_size(current_database()));`",
                                        "Find largest tables: `SELECT schemaname, tablename, pg_size_pretty(pg_total_relation_size(schemaname||'.'||tablename)) FROM pg_tables ORDER BY pg_total_relation_size(schemaname||'.'||tablename) DESC LIMIT 10;`",
                                        "Check data directory: `SHOW data_directory;`"
                                    ]
                                },
                                {
                                    message: "ERROR: out of shared memory",
                                    errorCode: "53200",
                                    severity: "High",
                                    cause: "PostgreSQL is unable to allocate enough shared memory for its operations, often due to insufficient shared_buffers or system limits.",
                                    resolution: "Adjust `shared_buffers` and `work_mem` in `postgresql.conf` to lower values, or increase system shared memory limits if the server has enough RAM.",
                                    parameters: "shared_buffers, work_mem, max_connections",
                                    tip: "For Linux, increase `kernel.shmmax` and `kernel.shmall` in `/etc/sysctl.conf` and apply with `sudo sysctl -p`.",
                                    troubleshooting: [
                                        "Check memory settings: `SHOW shared_buffers; SHOW work_mem;`",
                                        "Monitor memory usage: `SELECT * FROM pg_stat_activity;`",
                                        "Check system limits: `cat /proc/sys/kernel/shmmax`"
                                    ]
                                },
                                {
                                    message: "ERROR: could not allocate memory for buffer",
                                    errorCode: "53200",
                                    severity: "High",
                                    cause: "The system is unable to allocate memory for PostgreSQL operations, typically due to memory pressure or configuration issues.",
                                    resolution: "Reduce memory-intensive operations, decrease `work_mem`, or add more system RAM. Consider using connection pooling to reduce memory overhead.",
                                    parameters: "work_mem, maintenance_work_mem, max_connections",
                                    tip: "Monitor system memory usage and adjust PostgreSQL memory parameters based on available RAM.",
                                    troubleshooting: [
                                        "Check memory settings: `SHOW work_mem; SHOW maintenance_work_mem;`",
                                        "Monitor connections: `SELECT count(*) FROM pg_stat_activity;`",
                                        "Check system memory: Review system logs for OOM killer activity"
                                    ]
                                },
                                {
                                    message: "ERROR: could not write to file: No space left on device",
                                    errorCode: "53100",
                                    severity: "Critical",
                                    cause: "Disk space exhausted while trying to write data, often during large operations or log file growth.",
                                    resolution: "Free up disk space immediately. Check temp directories, logs, and consider moving files to other partitions.",
                                    parameters: "N/A",
                                    tip: "Monitor disk space regularly and set up alerts before reaching capacity.",
                                    troubleshooting: [
                                        "Check disk space: `df -h`",
                                        "Find large files: `find /var/lib/postgresql -type f -size +100M`",
                                        "Clean temp files: Check and clean temporary directories"
                                    ]
                                },
                                {
                                    message: "ERROR: temporary file size exceeds temp_file_limit",
                                    errorCode: "53400",
                                    severity: "Medium",
                                    cause: "A query exceeded the allowed temporary file size limit defined by temp_file_limit parameter.",
                                    resolution: "Increase temp_file_limit, optimize the query to use less memory, or increase work_mem.",
                                    parameters: "temp_file_limit, work_mem",
                                    tip: "Large temporary files often indicate queries that need optimization or more memory.",
                                    troubleshooting: [
                                        "Check limit: `SHOW temp_file_limit;`",
                                        "Monitor temp files: `SELECT * FROM pg_stat_database;`",
                                        "Optimize query: Use EXPLAIN to analyze query plan"
                                    ]
                                },
                                {
                                    message: "ERROR: could not resize shared memory segment: Cannot allocate memory",
                                    errorCode: "53200",
                                    severity: "High",
                                    cause: "System cannot allocate additional shared memory when PostgreSQL tries to expand shared memory segments.",
                                    resolution: "Increase system shared memory limits or reduce PostgreSQL memory usage.",
                                    parameters: "shared_buffers, max_connections",
                                    tip: "This often occurs on systems with limited RAM or restrictive kernel settings.",
                                    troubleshooting: [
                                        "Check system memory: `free -h`",
                                        "Check kernel limits: `cat /proc/sys/kernel/shmmax`",
                                        "Adjust PostgreSQL memory: Reduce shared_buffers or max_connections"
                                    ]
                                },
                                {
                                    message: "ERROR: could not open temporary statistics file: Too many open files",
                                    errorCode: "53000",
                                    severity: "Medium",
                                    cause: "PostgreSQL has reached the system limit for open file descriptors.",
                                    resolution: "Increase the file descriptor limit for the PostgreSQL process or system-wide.",
                                    parameters: "N/A",
                                    tip: "This often occurs with many concurrent connections or partitioned tables.",
                                    troubleshooting: [
                                        "Check current limit: `ulimit -n`",
                                        "Check PostgreSQL usage: `lsof -p postgres_pid | wc -l`",
                                        "Increase limit: Edit /etc/security/limits.conf"
                                    ]
                                },
                                {
                                    message: "ERROR: insufficient disk space for WAL files",
                                    errorCode: "53100",
                                    severity: "Critical",
                                    cause: "Not enough disk space to create new WAL (Write-Ahead Log) files.",
                                    resolution: "Free up disk space immediately, especially in the pg_wal directory. Consider WAL archiving.",
                                    parameters: "wal_segment_size, max_wal_size",
                                    tip: "WAL files are critical for data consistency - never delete them manually.",
                                    troubleshooting: [
                                        "Check WAL directory: `du -sh $PGDATA/pg_wal`",
                                        "Monitor WAL usage: `SELECT * FROM pg_stat_archiver;`",
                                        "Configure archiving: Set up WAL archiving to remove old files"
                                    ]
                                },
                                {
                                    message: "ERROR: could not create lock file: No space left on device",
                                    errorCode: "53100",
                                    severity: "Critical",
                                    cause: "Cannot create lock files due to disk space exhaustion.",
                                    resolution: "Free up disk space immediately. Check /tmp and PostgreSQL data directory.",
                                    parameters: "N/A",
                                    tip: "Lock files are essential for preventing multiple PostgreSQL instances.",
                                    troubleshooting: [
                                        "Check /tmp space: `df -h /tmp`",
                                        "Check data directory: `df -h $PGDATA`",
                                        "Clean temporary files: `find /tmp -name '.s.PGSQL.*' -delete`"
                                    ]
                                },
                                {
                                    message: "ERROR: out of memory for query result",
                                    errorCode: "53200",
                                    severity: "High",
                                    cause: "Query result set is too large to fit in available memory.",
                                    resolution: "Use LIMIT/OFFSET for pagination, increase memory, or process results in smaller chunks.",
                                    parameters: "work_mem, temp_buffers",
                                    tip: "Consider using cursors for very large result sets.",
                                    troubleshooting: [
                                        "Add LIMIT: `SELECT * FROM large_table LIMIT 1000;`",
                                        "Use cursors: `DECLARE cursor_name CURSOR FOR SELECT ...`",
                                        "Check memory: Monitor system memory usage"
                                    ]
                                },
                                {
                                    message: "ERROR: could not write to tuplestore temporary file: No space left on device",
                                    errorCode: "53100",
                                    severity: "High",
                                    cause: "Temporary file for storing intermediate query results cannot be written due to disk space.",
                                    resolution: "Free up disk space, especially in the temporary directory used by PostgreSQL.",
                                    parameters: "temp_tablespaces",
                                    tip: "Consider setting temp_tablespaces to use a different disk with more space.",
                                    troubleshooting: [
                                        "Check temp space: `SHOW temp_tablespaces;`",
                                        "Monitor temp files: `SELECT * FROM pg_stat_database WHERE datname = current_database();`",
                                        "Set temp tablespace: `SET temp_tablespaces = 'temp_tablespace';`"
                                    ]
                                },
                                {
                                    message: "ERROR: could not fork new process: Cannot allocate memory",
                                    errorCode: "53200",
                                    severity: "Critical",
                                    cause: "System cannot create new processes due to memory exhaustion.",
                                    resolution: "Add more system memory, reduce PostgreSQL memory usage, or kill unnecessary processes.",
                                    parameters: "max_connections, shared_buffers",
                                    tip: "This indicates severe system memory pressure requiring immediate attention.",
                                    troubleshooting: [
                                        "Check system memory: `free -h`",
                                        "Check PostgreSQL processes: `ps aux | grep postgres`",
                                        "Reduce connections: Lower max_connections temporarily"
                                    ]
                                }
                            ]
                        },
                        {
                            name: "Lock & Concurrency Errors",
                            icon: "fa-solid fa-lock",
                            description: "Issues related to locking, deadlocks, and concurrent access",
                            errors: [
                                {
                                    message: "ERROR: deadlock detected",
                                    errorCode: "40P01",
                                    severity: "Medium",
                                    cause: "Two or more transactions are waiting for each other in a circular chain to release locks. For example, Transaction A locks Table 1 and waits for Table 2, while Transaction B locks Table 2 and waits for Table 1.",
                                    resolution: "PostgreSQL automatically resolves this by aborting one of the transactions. The application should be designed to catch this specific error and retry the transaction. Analyze the application logic to ensure resources are always locked in a consistent order.",
                                    parameters: "deadlock_timeout, log_lock_waits",
                                    tip: "Keep transactions as short as possible and access shared resources in a consistent, predefined order across all parts of your application.",
                                    troubleshooting: [
                                        "Enable lock logging: `SET log_lock_waits = on;`",
                                        "Check current locks: `SELECT * FROM pg_locks WHERE NOT granted;`",
                                        "Monitor lock waits: `SELECT * FROM pg_stat_activity WHERE wait_event_type = 'Lock';`"
                                    ]
                                },
                                {
                                    message: "ERROR: canceling statement due to lock timeout",
                                    errorCode: "57014",
                                    severity: "Medium",
                                    cause: "A statement was canceled because it waited too long for a lock to be released.",
                                    resolution: "Increase `lock_timeout` if appropriate, or optimize transactions to reduce lock contention. Consider breaking large transactions into smaller ones.",
                                    parameters: "lock_timeout, statement_timeout",
                                    tip: "Identify and optimize long-running queries that hold locks for extended periods.",
                                    troubleshooting: [
                                        "Check timeout settings: `SHOW lock_timeout; SHOW statement_timeout;`",
                                        "Find blocking queries: `SELECT * FROM pg_blocking_pids(pid);`",
                                        "Monitor lock waits: `SELECT locktype, mode, granted FROM pg_locks WHERE pid = blocked_pid;`"
                                    ]
                                },
                                {
                                    message: "ERROR: tuple to be locked was already moved to another partition",
                                    errorCode: "55000",
                                    severity: "Medium",
                                    cause: "Concurrent UPDATE moved a row to a different partition while another transaction was trying to lock it.",
                                    resolution: "Retry the operation. Consider using appropriate isolation levels or row-level locking strategies.",
                                    parameters: "default_transaction_isolation",
                                    tip: "This can occur with partitioned tables when partition keys are updated.",
                                    troubleshooting: [
                                        "Check isolation level: `SHOW transaction_isolation;`",
                                        "Use explicit locking: `SELECT ... FOR UPDATE;`",
                                        "Retry transaction with proper error handling"
                                    ]
                                },
                                {
                                    message: "ERROR: could not serialize access due to concurrent update",
                                    errorCode: "40001",
                                    severity: "Medium",
                                    cause: "Serialization failure due to concurrent modifications in SERIALIZABLE isolation level.",
                                    resolution: "Retry the transaction with exponential backoff. Consider using lower isolation level if appropriate.",
                                    parameters: "default_transaction_isolation",
                                    tip: "Implement retry logic with exponential backoff for handling serialization failures.",
                                    troubleshooting: [
                                        "Check conflicts: `SELECT * FROM pg_stat_database_conflicts;`",
                                        "Monitor serialization failures: Track error frequency",
                                        "Consider READ COMMITTED: Use lower isolation if acceptable"
                                    ]
                                },
                                {
                                    message: "ERROR: could not obtain lock on row in relation \"table_name\"",
                                    errorCode: "55P03",
                                    severity: "Medium",
                                    cause: "Cannot acquire a row-level lock because another transaction holds a conflicting lock.",
                                    resolution: "Wait for the conflicting transaction to complete or increase lock_timeout.",
                                    parameters: "lock_timeout",
                                    tip: "Use SELECT ... FOR UPDATE NOWAIT to avoid waiting for locks.",
                                    troubleshooting: [
                                        "Find blocking process: `SELECT * FROM pg_blocking_pids(current_backend_pid);`",
                                        "Check lock modes: `SELECT mode, granted FROM pg_locks WHERE relation = 'table_name'::regclass;`",
                                        "Use NOWAIT: `SELECT ... FOR UPDATE NOWAIT;`"
                                    ]
                                },
                                {
                                    message: "ERROR: tuple to be updated was already modified by an operation",
                                    errorCode: "40001",
                                    severity: "Medium",
                                    cause: "Row was modified by another transaction between the time it was read and when update was attempted.",
                                    resolution: "Retry the operation or handle the concurrent modification in application logic.",
                                    parameters: "N/A",
                                    tip: "This is normal in multi-user environments and should be handled gracefully.",
                                    troubleshooting: [
                                        "Implement retry logic in application",
                                        "Use optimistic locking patterns",
                                        "Check for concurrent processes modifying the same data"
                                    ]
                                },
                                {
                                    message: "ERROR: could not serialize access due to read/write dependencies",
                                    errorCode: "40001",
                                    severity: "Medium",
                                    cause: "SERIALIZABLE transaction detected read/write dependencies that would violate serializability.",
                                    resolution: "Retry the transaction or consider using a lower isolation level.",
                                    parameters: "default_transaction_isolation",
                                    tip: "SERIALIZABLE isolation provides the strongest consistency but may require more retries.",
                                    troubleshooting: [
                                        "Monitor serializable conflicts: `SELECT * FROM pg_stat_database_conflicts;`",
                                        "Implement retry with backoff",
                                        "Consider REPEATABLE READ for less strict requirements"
                                    ]
                                },
                                {
                                    message: "ERROR: relation \"table_name\" does not exist",
                                    errorCode: "42P01",
                                    severity: "Medium",
                                    cause: "Another transaction dropped the table while this transaction was trying to access it.",
                                    resolution: "Handle the case where tables might be dropped concurrently or coordinate DDL operations.",
                                    parameters: "N/A",
                                    tip: "Use IF EXISTS clauses and proper error handling for DDL operations.",
                                    troubleshooting: [
                                        "Check if table exists: `SELECT * FROM pg_tables WHERE tablename = 'table_name';`",
                                        "Use IF EXISTS: `DROP TABLE IF EXISTS table_name;`",
                                        "Coordinate DDL operations to avoid conflicts"
                                    ]
                                },
                                {
                                    message: "ERROR: canceling statement due to statement timeout",
                                    errorCode: "57014",
                                    severity: "Medium",
                                    cause: "Statement exceeded the time limit defined by statement_timeout parameter.",
                                    resolution: "Optimize the query, increase statement_timeout, or break the operation into smaller chunks.",
                                    parameters: "statement_timeout",
                                    tip: "Long-running statements can hold locks and impact concurrency.",
                                    troubleshooting: [
                                        "Check timeout: `SHOW statement_timeout;`",
                                        "Optimize query: Use EXPLAIN to analyze performance",
                                        "Increase timeout: `SET statement_timeout = '10min';`"
                                    ]
                                },
                                {
                                    message: "ERROR: lock timeout exceeded",
                                    errorCode: "55P03",
                                    severity: "Medium",
                                    cause: "Could not acquire a lock within the time specified by lock_timeout.",
                                    resolution: "Increase lock_timeout, optimize transactions to reduce lock duration, or retry later.",
                                    parameters: "lock_timeout",
                                    tip: "Identify and optimize transactions that hold locks for extended periods.",
                                    troubleshooting: [
                                        "Check lock timeout: `SHOW lock_timeout;`",
                                        "Find long transactions: `SELECT * FROM pg_stat_activity WHERE state = 'active' ORDER BY query_start;`",
                                        "Monitor lock waits: Enable log_lock_waits"
                                    ]
                                },
                                {
                                    message: "ERROR: shared lock queue is full",
                                    errorCode: "55P03",
                                    severity: "High",
                                    cause: "Too many processes are waiting for locks, exceeding the system's lock queue capacity.",
                                    resolution: "Optimize transactions to reduce lock contention and duration. Consider connection pooling.",
                                    parameters: "max_locks_per_transaction, max_connections",
                                    tip: "This indicates high lock contention and may require application design changes.",
                                    troubleshooting: [
                                        "Check lock settings: `SHOW max_locks_per_transaction;`",
                                        "Monitor active locks: `SELECT count(*) FROM pg_locks;`",
                                        "Analyze lock contention patterns"
                                    ]
                                }
                            ]
                        },
                        {
                            name: "SQL Syntax & Query Errors",
                            icon: "fa-solid fa-code",
                            description: "Issues related to SQL syntax, invalid queries, and data type problems",
                            errors: [
                                {
                                    message: "ERROR: syntax error at or near \"keyword\"",
                                    errorCode: "42601",
                                    severity: "Low",
                                    cause: "A SQL syntax error has occurred, preventing the query from being parsed and executed.",
                                    resolution: "Review the SQL syntax around the error location. Check for unmatched parentheses, brackets, or quotes. Verify all keywords are spelled correctly.",
                                    parameters: "N/A",
                                    tip: "Use a SQL formatter or IDE with syntax highlighting to identify syntax issues early.",
                                    troubleshooting: [
                                        "Check SQL standards compliance",
                                        "Verify keyword spelling and placement",
                                        "Look for unmatched quotes or parentheses"
                                    ]
                                },
                                {
                                    message: "ERROR: column \"column_name\" does not exist",
                                    errorCode: "42703",
                                    severity: "Medium",
                                    cause: "The specified column name does not exist in the referenced table or view.",
                                    resolution: "Verify the column name is spelled correctly and exists in the table. Check for case sensitivity issues or use table aliases appropriately.",
                                    parameters: "N/A",
                                    tip: "Use `\\d table_name` in psql to see the table structure and available columns.",
                                    troubleshooting: [
                                        "List table columns: `SELECT column_name FROM information_schema.columns WHERE table_name = 'your_table';`",
                                        "Check table structure: `\\d table_name`",
                                        "Verify case sensitivity with double quotes if needed"
                                    ]
                                },
                                {
                                    message: "ERROR: function \"function_name\" does not exist",
                                    errorCode: "42883",
                                    severity: "Medium",
                                    cause: "The query references a function that does not exist or is not visible in the current search path.",
                                    resolution: "Check the function name and argument types. Ensure the function is created in the correct schema or adjust the search path.",
                                    parameters: "search_path",
                                    tip: "Use schema-qualified function names (schema.function_name) to avoid search path issues.",
                                    troubleshooting: [
                                        "List functions: `SELECT proname, proargtypes FROM pg_proc WHERE proname LIKE '%function_name%';`",
                                        "Check search path: `SHOW search_path;`",
                                        "Verify function arguments match the call"
                                    ]
                                },
                                {
                                    message: "ERROR: relation \"table_name\" does not exist",
                                    errorCode: "42P01",
                                    severity: "Medium",
                                    cause: "The specified table or view name does not exist in the current schema or database.",
                                    resolution: "Verify the table name is correct, check the schema, or create the table if needed.",
                                    parameters: "search_path",
                                    tip: "Use schema-qualified names (schema.table) to avoid search path issues.",
                                    troubleshooting: [
                                        "List tables: `SELECT tablename FROM pg_tables WHERE schemaname = 'public';`",
                                        "Check all schemas: `SELECT schemaname, tablename FROM pg_tables WHERE tablename = 'table_name';`",
                                        "Verify search path: `SHOW search_path;`"
                                    ]
                                },
                                {
                                    message: "ERROR: operator does not exist",
                                    errorCode: "42883",
                                    severity: "Medium",
                                    cause: "PostgreSQL cannot find an operator for the given data types in the operation.",
                                    resolution: "Check data types and cast them appropriately, or use a different operator.",
                                    parameters: "N/A",
                                    tip: "Use explicit casting (::datatype) to ensure compatible data types.",
                                    troubleshooting: [
                                        "Check data types: `SELECT pg_typeof(column) FROM table;`",
                                        "Cast explicitly: `SELECT column::text = 'value';`",
                                        "List operators: `SELECT * FROM pg_operator WHERE oprname = 'operator';`"
                                    ]
                                },
                                {
                                    message: "ERROR: invalid input syntax for integer",
                                    errorCode: "22P02",
                                    severity: "Low",
                                    cause: "Attempting to convert a non-numeric string to an integer data type.",
                                    resolution: "Validate input data or use appropriate casting functions like TRY_CAST or handle the conversion error.",
                                    parameters: "N/A",
                                    tip: "Use regular expressions to validate numeric strings before conversion.",
                                    troubleshooting: [
                                        "Validate input: `SELECT value WHERE value ~ '^[0-9]+$';`",
                                        "Use safe conversion: `SELECT CASE WHEN value ~ '^[0-9]+$' THEN value::integer END;`",
                                        "Filter invalid data: Clean data before conversion"
                                    ]
                                },
                                {
                                    message: "ERROR: division by zero",
                                    errorCode: "22012",
                                    severity: "Medium",
                                    cause: "Mathematical operation attempted to divide by zero.",
                                    resolution: "Add a condition to check for zero before division or use NULLIF to handle zero values.",
                                    parameters: "N/A",
                                    tip: "Use NULLIF(divisor, 0) to convert zero divisors to NULL.",
                                    troubleshooting: [
                                        "Add zero check: `SELECT CASE WHEN divisor != 0 THEN dividend/divisor END;`",
                                        "Use NULLIF: `SELECT dividend / NULLIF(divisor, 0);`",
                                        "Validate data: Check for zero values in divisor columns"
                                    ]
                                },
                                {
                                    message: "ERROR: subquery must return only one column",
                                    errorCode: "42601",
                                    severity: "Low",
                                    cause: "A subquery used in a context where only one column is expected returns multiple columns.",
                                    resolution: "Modify the subquery to return only one column or restructure the query.",
                                    parameters: "N/A",
                                    tip: "Use appropriate JOIN instead of subqueries when you need multiple columns.",
                                    troubleshooting: [
                                        "Check subquery: Ensure it returns only one column",
                                        "Use specific column: `SELECT (SELECT specific_column FROM ...);`",
                                        "Consider JOIN: Replace subquery with appropriate JOIN"
                                    ]
                                },
                                {
                                    message: "ERROR: more than one row returned by a subquery",
                                    errorCode: "21000",
                                    severity: "Medium",
                                    cause: "A subquery that should return at most one row returns multiple rows.",
                                    resolution: "Add appropriate WHERE conditions to limit the subquery to one row, or use IN/ANY instead of equals.",
                                    parameters: "N/A",
                                    tip: "Use LIMIT 1 in subqueries that should return one row, or use aggregate functions.",
                                    troubleshooting: [
                                        "Add LIMIT: `SELECT * FROM table WHERE id = (SELECT id FROM other_table LIMIT 1);`",
                                        "Use IN operator: `SELECT * FROM table WHERE id IN (SELECT id FROM other_table);`",
                                        "Add unique constraints: Ensure subquery conditions are unique"
                                    ]
                                },
                                {
                                    message: "ERROR: aggregate functions are not allowed in WHERE",
                                    errorCode: "42803",
                                    severity: "Low",
                                    cause: "Attempting to use aggregate functions like COUNT, SUM in WHERE clause instead of HAVING.",
                                    resolution: "Move aggregate functions to HAVING clause or use subqueries.",
                                    parameters: "N/A",
                                    tip: "Use HAVING for conditions on aggregate functions, WHERE for individual row conditions.",
                                    troubleshooting: [
                                        "Use HAVING: `SELECT * FROM table GROUP BY column HAVING COUNT(*) > 1;`",
                                        "Use subquery: `SELECT * FROM (SELECT *, COUNT(*) OVER() as cnt FROM table) WHERE cnt > 1;`",
                                        "Review query structure: Separate row and group conditions"
                                    ]
                                },
                                {
                                    message: "ERROR: column must appear in the GROUP BY clause",
                                    errorCode: "42803",
                                    severity: "Low",
                                    cause: "Non-aggregate columns in SELECT must be included in GROUP BY clause when using GROUP BY.",
                                    resolution: "Add the column to GROUP BY clause or use an aggregate function on it.",
                                    parameters: "N/A",
                                    tip: "All non-aggregate SELECT columns must be in GROUP BY unless using window functions.",
                                    troubleshooting: [
                                        "Add to GROUP BY: `SELECT col1, COUNT(*) FROM table GROUP BY col1;`",
                                        "Use aggregate: `SELECT MAX(col1), COUNT(*) FROM table GROUP BY col2;`",
                                        "Use window functions: `SELECT col1, COUNT(*) OVER(PARTITION BY col2) FROM table;`"
                                    ]
                                },
                                {
                                    message: "ERROR: invalid reference to FROM-clause entry",
                                    errorCode: "42P01",
                                    severity: "Medium",
                                    cause: "Referencing a table alias or column that is not available in the current query scope.",
                                    resolution: "Check table aliases and ensure proper scoping of column references.",
                                    parameters: "N/A",
                                    tip: "Use correlation names consistently and check subquery scoping rules.",
                                    troubleshooting: [
                                        "Check aliases: Ensure table aliases are defined and used correctly",
                                        "Verify scope: Check if columns are accessible in the current query level",
                                        "Use qualified names: Use table.column format for clarity"
                                    ]
                                },
                                {
                                    message: "ERROR: argument of WHERE must be type boolean",
                                    errorCode: "42804",
                                    severity: "Low",
                                    cause: "WHERE clause condition does not evaluate to a boolean value.",
                                    resolution: "Modify the WHERE condition to return a boolean result using comparison operators.",
                                    parameters: "N/A",
                                    tip: "WHERE clause needs comparison operators like =, >, <, IS NULL, etc.",
                                    troubleshooting: [
                                        "Add comparison: `WHERE column = value` instead of `WHERE column`",
                                        "Check for NULL: `WHERE column IS NOT NULL`",
                                        "Use boolean operators: =, !=, >, <, IN, EXISTS, etc."
                                    ]
                                },
                                {
                                    message: "ERROR: window function call requires an OVER clause",
                                    errorCode: "42809",
                                    severity: "Low",
                                    cause: "Using a window function without the required OVER clause.",
                                    resolution: "Add an OVER clause to define the window specification for the function.",
                                    parameters: "N/A",
                                    tip: "Window functions like ROW_NUMBER, RANK always need OVER() clause.",
                                    troubleshooting: [
                                        "Add OVER: `SELECT ROW_NUMBER() OVER(ORDER BY column) FROM table;`",
                                        "Use partition: `SELECT SUM(amount) OVER(PARTITION BY category) FROM table;`",
                                        "Check function type: Verify if function is a window function"
                                    ]
                                },
                                {
                                    message: "ERROR: invalid ORDER BY in aggregate function",
                                    errorCode: "42P20",
                                    severity: "Low",
                                    cause: "Using ORDER BY within an aggregate function that doesn't support it.",
                                    resolution: "Remove ORDER BY from the aggregate function or use a different aggregate function that supports ordering.",
                                    parameters: "N/A",
                                    tip: "Only certain aggregates like STRING_AGG support ORDER BY within the function.",
                                    troubleshooting: [
                                        "Check aggregate support: Verify if the aggregate function supports ORDER BY",
                                        "Use STRING_AGG: `SELECT STRING_AGG(column, ',' ORDER BY column);`",
                                        "Order outside: `SELECT SUM(column) FROM (SELECT * FROM table ORDER BY column) t;`"
                                    ]
                                }
                            ]
                        },
                        {
                            name: "Backup & Recovery Errors",
                            icon: "fa-solid fa-hard-drive",
                            description: "Issues related to backup operations and recovery procedures",
                            errors: [
                                {
                                    message: "pg_dump: error: could not connect to database",
                                    errorCode: "N/A",
                                    severity: "High",
                                    cause: "pg_dump cannot establish a connection to the PostgreSQL server.",
                                    resolution: "Verify the database server is running, check connection parameters (host, port, username), and ensure network connectivity.",
                                    parameters: "N/A",
                                    tip: "Test connectivity with psql before running pg_dump to isolate connection issues.",
                                    troubleshooting: [
                                        "Test connection: `psql -h host -p port -U username -d dbname`",
                                        "Check server status: `pg_isready -h host -p port`",
                                        "Verify pg_hba.conf allows connections from backup host"
                                    ]
                                },
                                {
                                    message: "ERROR: archive command failed",
                                    errorCode: "XX000",
                                    severity: "High",
                                    cause: "The WAL archive command specified in postgresql.conf failed to execute successfully.",
                                    resolution: "Check the `archive_command` configuration, verify the archive destination is accessible and has sufficient space, and test the archive command manually.",
                                    parameters: "archive_command, archive_mode",
                                    tip: "Always test your archive command manually before putting it into production.",
                                    troubleshooting: [
                                        "Check archiving status: `SELECT * FROM pg_stat_archiver;`",
                                        "Test archive command manually",
                                        "Verify archive destination permissions and space"
                                    ]
                                },
                                {
                                    message: "pg_dump: error: query failed: server closed the connection",
                                    errorCode: "N/A",
                                    severity: "High",
                                    cause: "Connection lost during pg_dump operation, possibly due to network issues or server problems.",
                                    resolution: "Check network stability, server logs, and consider using connection keep-alive options.",
                                    parameters: "N/A",
                                    tip: "Use --verbose flag to see where the dump failed and resume from that point.",
                                    troubleshooting: [
                                        "Check server logs for errors during dump time",
                                        "Test network stability: `ping -c 100 server_host`",
                                        "Use keep-alive: Add TCP keepalive settings"
                                    ]
                                },
                                {
                                    message: "pg_restore: error: could not read from input file",
                                    errorCode: "N/A",
                                    severity: "Medium",
                                    cause: "pg_restore cannot read the backup file due to corruption, permissions, or incomplete backup.",
                                    resolution: "Verify backup file integrity, check file permissions, and ensure the backup completed successfully.",
                                    parameters: "N/A",
                                    tip: "Always verify backup integrity immediately after creation.",
                                    troubleshooting: [
                                        "Check file integrity: `pg_restore --list backup_file`",
                                        "Verify permissions: `ls -la backup_file`",
                                        "Test file readability: `file backup_file`"
                                    ]
                                },
                                {
                                    message: "ERROR: base backup could not be completed",
                                    errorCode: "XX000",
                                    severity: "High",
                                    cause: "pg_basebackup failed due to insufficient permissions, disk space, or WAL archiving issues.",
                                    resolution: "Check replication user permissions, disk space, and ensure WAL archiving is properly configured.",
                                    parameters: "max_wal_senders, wal_level",
                                    tip: "Ensure the user has REPLICATION privilege and pg_hba.conf allows replication connections.",
                                    troubleshooting: [
                                        "Check replication role: `SELECT rolreplication FROM pg_roles WHERE rolname = 'backup_user';`",
                                        "Verify WAL level: `SHOW wal_level;`",
                                        "Check pg_hba.conf for replication entries"
                                    ]
                                },
                                {
                                    message: "ERROR: could not receive data from WAL stream",
                                    errorCode: "XX000",
                                    severity: "High",
                                    cause: "Streaming backup interrupted due to network issues or WAL segment removal.",
                                    resolution: "Check network connectivity, increase wal_keep_segments, or use replication slots.",
                                    parameters: "wal_keep_segments, max_replication_slots",
                                    tip: "Use replication slots to prevent WAL segments from being removed during backup.",
                                    troubleshooting: [
                                        "Check WAL retention: `SHOW wal_keep_segments;`",
                                        "Create replication slot: `SELECT pg_create_physical_replication_slot('backup_slot');`",
                                        "Monitor WAL segments: `SELECT * FROM pg_stat_replication;`"
                                    ]
                                },
                                {
                                    message: "pg_dump: error: Dumping the contents of table failed",
                                    errorCode: "N/A",
                                    severity: "Medium",
                                    cause: "Error occurred while dumping specific table data, possibly due to data corruption or constraints.",
                                    resolution: "Check the specific table for corruption, verify data integrity, and consider dumping schema and data separately.",
                                    parameters: "N/A",
                                    tip: "Use --schema-only and --data-only options to isolate the problem.",
                                    troubleshooting: [
                                        "Check table integrity: `SELECT * FROM problematic_table LIMIT 1;`",
                                        "Dump schema only: `pg_dump --schema-only -t table_name`",
                                        "Check for constraint violations or data issues"
                                    ]
                                },
                                {
                                    message: "ERROR: recovery is still in progress, cannot accept connections",
                                    errorCode: "57P03",
                                    severity: "High",
                                    cause: "Attempting to connect to a standby server that is still in recovery mode.",
                                    resolution: "Wait for recovery to complete or connect to the primary server instead.",
                                    parameters: "hot_standby",
                                    tip: "Enable hot_standby to allow read-only connections during recovery.",
                                    troubleshooting: [
                                        "Check recovery status: `SELECT pg_is_in_recovery();`",
                                        "Enable hot standby: Set hot_standby = on in postgresql.conf",
                                        "Monitor recovery progress: Check PostgreSQL logs"
                                    ]
                                },
                                {
                                    message: "ERROR: requested WAL segment has already been removed",
                                    errorCode: "XX000",
                                    severity: "High",
                                    cause: "Required WAL segment for recovery has been recycled or archived.",
                                    resolution: "Restore WAL segment from archive or restart recovery from a more recent backup.",
                                    parameters: "wal_keep_segments, archive_command",
                                    tip: "Increase wal_keep_segments or use replication slots to prevent premature WAL removal.",
                                    troubleshooting: [
                                        "Check WAL archiving: `SELECT * FROM pg_stat_archiver;`",
                                        "Restore from archive: Check archive_command configuration",
                                        "Use newer backup: Start recovery from more recent base backup"
                                    ]
                                },
                                {
                                    message: "ERROR: backup label file missing or corrupt",
                                    errorCode: "XX000",
                                    severity: "Critical",
                                    cause: "The backup_label file is missing or corrupted, preventing proper recovery.",
                                    resolution: "Do not manually remove backup_label file. Restore from a different backup or recreate if absolutely necessary.",
                                    parameters: "N/A",
                                    tip: "Never manually delete backup_label file - it's critical for recovery.",
                                    troubleshooting: [
                                        "Check for backup_label: `ls -la $PGDATA/backup_label`",
                                        "Verify backup procedure: Ensure pg_start_backup() and pg_stop_backup() were used correctly",
                                        "Use alternative backup if available"
                                    ]
                                },
                                {
                                    message: "ERROR: timeline ID mismatch",
                                    errorCode: "XX000",
                                    severity: "High",
                                    cause: "WAL timeline doesn't match the backup, indicating potential backup/recovery inconsistency.",
                                    resolution: "Verify backup and WAL files are from the same timeline or use recovery.conf with appropriate timeline setting.",
                                    parameters: "recovery_target_timeline",
                                    tip: "Timeline mismatches usually indicate mixing backups and WAL files from different recovery cycles.",
                                    troubleshooting: [
                                        "Check timeline: Look at pg_control and WAL file names",
                                        "Set recovery target: `recovery_target_timeline = 'latest'`",
                                        "Verify backup consistency: Ensure backup and WAL files match"
                                    ]
                                },
                                {
                                    message: "pg_dump: error: too many command-line arguments",
                                    errorCode: "N/A",
                                    severity: "Low",
                                    cause: "Invalid command-line syntax for pg_dump command.",
                                    resolution: "Check pg_dump command syntax and ensure proper quoting of arguments.",
                                    parameters: "N/A",
                                    tip: "Use quotes around database names and table names that contain special characters.",
                                    troubleshooting: [
                                        "Check command syntax: `pg_dump --help`",
                                        "Quote special names: `pg_dump \"database name\"`",
                                        "Verify argument order and format"
                                    ]
                                },
                                {
                                    message: "ERROR: could not open recovery command file",
                                    errorCode: "XX000",
                                    severity: "High",
                                    cause: "Cannot read recovery.conf or recovery.signal file during recovery process.",
                                    resolution: "Check file permissions and ensure recovery configuration files exist and are readable.",
                                    parameters: "N/A",
                                    tip: "In PostgreSQL 12+, use recovery.signal file and postgresql.conf for recovery parameters.",
                                    troubleshooting: [
                                        "Check file permissions: `ls -la $PGDATA/recovery.*`",
                                        "For PG 12+: Create recovery.signal and set parameters in postgresql.conf",
                                        "Verify file syntax and parameter names"
                                    ]
                                }
                            ]
                        },
                        {
                            name: "Performance & Index Errors",
                            icon: "fa-solid fa-gauge-high",
                            description: "Issues related to query performance, indexing, and optimization",
                            errors: [
                                {
                                    message: "ERROR: index \"index_name\" is not a btree",
                                    errorCode: "XX000",
                                    severity: "Low",
                                    cause: "The operation requires a btree index, but the specified index is of a different type (GIN, GiST, etc.).",
                                    resolution: "Use a btree index for operations that require it, or create a new btree index if necessary.",
                                    parameters: "N/A",
                                    tip: "Different index types support different operations - choose the appropriate type for your use case.",
                                    troubleshooting: [
                                        "Check index types: `SELECT indexname, indexdef FROM pg_indexes WHERE tablename = 'your_table';`",
                                        "Create btree index: `CREATE INDEX idx_name ON table_name USING btree (column);`",
                                        "Review supported operations for each index type"
                                    ]
                                },
                                {
                                    message: "ERROR: could not create unique index due to duplicate values",
                                    errorCode: "23505",
                                    severity: "Medium",
                                    cause: "Attempting to create a unique index on a column that contains duplicate values.",
                                    resolution: "Remove duplicate values from the column before creating the unique index, or modify the data to ensure uniqueness.",
                                    parameters: "N/A",
                                    tip: "Use a SELECT query to identify duplicate values before creating the unique constraint.",
                                    troubleshooting: [
                                        "Find duplicates: `SELECT column_name, COUNT(*) FROM table_name GROUP BY column_name HAVING COUNT(*) > 1;`",
                                        "Remove duplicates using window functions or manual cleanup",
                                        "Consider partial unique indexes if appropriate"
                                    ]
                                },
                                {
                                    message: "ERROR: index row size exceeds btree version 4 maximum",
                                    errorCode: "54000",
                                    severity: "Medium",
                                    cause: "Index key size exceeds PostgreSQL's btree index limit (approximately 2712 bytes).",
                                    resolution: "Reduce index key size by using hash indexes, partial indexes, or indexing only parts of large columns.",
                                    parameters: "N/A",
                                    tip: "Consider using hash indexes for equality searches on large text columns.",
                                    troubleshooting: [
                                        "Check key size: Calculate total size of indexed columns",
                                        "Use partial index: `CREATE INDEX ON table (column) WHERE condition;`",
                                        "Consider hash index: `CREATE INDEX ON table USING hash (large_column);`"
                                    ]
                                },
                                {
                                    message: "ERROR: could not read block in file: Bad address",
                                    errorCode: "XX001",
                                    severity: "Critical",
                                    cause: "Index corruption or hardware issues causing read failures.",
                                    resolution: "REINDEX the affected index and check for hardware problems.",
                                    parameters: "N/A",
                                    tip: "Regular REINDEX operations can prevent and fix minor index corruption.",
                                    troubleshooting: [
                                        "Reindex table: `REINDEX TABLE table_name;`",
                                        "Check hardware: Run disk diagnostics",
                                        "Verify checksums: Enable data_checksums for corruption detection"
                                    ]
                                },
                                {
                                    message: "ERROR: operator class does not exist",
                                    errorCode: "42704",
                                    severity: "Medium",
                                    cause: "Specified operator class for index creation does not exist for the given data type.",
                                    resolution: "Use a valid operator class for the data type or create the index without specifying operator class.",
                                    parameters: "N/A",
                                    tip: "List available operator classes with \\dAo in psql.",
                                    troubleshooting: [
                                        "List operator classes: `SELECT opcname FROM pg_opclass;`",
                                        "Check for data type: `SELECT opcname FROM pg_opclass WHERE opcintype = 'text'::regtype;`",
                                        "Use default: Create index without specifying operator class"
                                    ]
                                },
                                {
                                    message: "ERROR: functions in index expression must be marked IMMUTABLE",
                                    errorCode: "42P17",
                                    severity: "Medium",
                                    cause: "Attempting to create functional index using non-immutable functions.",
                                    resolution: "Use only immutable functions in index expressions or create the function as immutable if appropriate.",
                                    parameters: "N/A",
                                    tip: "Functions that depend on database state or configuration cannot be used in indexes.",
                                    troubleshooting: [
                                        "Check function volatility: `SELECT proname, provolatile FROM pg_proc WHERE proname = 'function_name';`",
                                        "Mark immutable: `ALTER FUNCTION function_name IMMUTABLE;` (only if truly immutable)",
                                        "Use immutable alternative: Find or create immutable version of function"
                                    ]
                                },
                                {
                                    message: "ERROR: index is not a btree",
                                    errorCode: "XX000",
                                    severity: "Low",
                                    cause: "Operation requires btree index but a different index type (GIN, GiST, etc.) was provided.",
                                    resolution: "Create a btree index for the operation or use operations supported by the existing index type.",
                                    parameters: "N/A",
                                    tip: "Different index types support different operations - btree for ranges, GIN for arrays/JSON.",
                                    troubleshooting: [
                                        "Check index type: `SELECT indexname, indexdef FROM pg_indexes WHERE tablename = 'table_name';`",
                                        "Create btree: `CREATE INDEX ON table_name (column);` (btree is default)",
                                        "Use appropriate operations for index type"
                                    ]
                                },
                                {
                                    message: "ERROR: cannot use subquery in index expression",
                                    errorCode: "0A000",
                                    severity: "Low",
                                    cause: "Attempting to use subquery in functional index expression, which is not supported.",
                                    resolution: "Rewrite the index expression without subqueries or use a different indexing strategy.",
                                    parameters: "N/A",
                                    tip: "Use computed columns or materialized views for complex index expressions.",
                                    troubleshooting: [
                                        "Simplify expression: Remove subqueries from index expression",
                                        "Use computed column: Add calculated column to table",
                                        "Consider partial index: Use WHERE clause instead of complex expression"
                                    ]
                                },
                                {
                                    message: "ERROR: index row requires bytes, maximum size is bytes",
                                    errorCode: "54000",
                                    severity: "Medium",
                                    cause: "Index entry size exceeds the maximum allowed size for the index type.",
                                    resolution: "Reduce the size of indexed data or use different index type or strategy.",
                                    parameters: "N/A",
                                    tip: "Consider indexing only a prefix of large text columns using substring.",
                                    troubleshooting: [
                                        "Index prefix: `CREATE INDEX ON table (substring(large_column, 1, 100));`",
                                        "Use hash index: `CREATE INDEX ON table USING hash (column);`",
                                        "Split large columns: Normalize data to reduce column size"
                                    ]
                                },
                                {
                                    message: "ERROR: concurrent index creation on system catalogs is not supported",
                                    errorCode: "0A000",
                                    severity: "Low",
                                    cause: "Attempting to create concurrent index on PostgreSQL system catalog tables.",
                                    resolution: "Use regular index creation (without CONCURRENTLY) for system catalog modifications.",
                                    parameters: "N/A",
                                    tip: "System catalog modifications should be done during maintenance windows.",
                                    troubleshooting: [
                                        "Use regular CREATE INDEX without CONCURRENTLY",
                                        "Plan maintenance window for system catalog changes",
                                        "Consider if index on system catalog is really necessary"
                                    ]
                                },
                                {
                                    message: "ERROR: index cannot have duplicate column names",
                                    errorCode: "42701",
                                    severity: "Low",
                                    cause: "Attempting to create index with the same column listed multiple times.",
                                    resolution: "Remove duplicate column references from the index definition.",
                                    parameters: "N/A",
                                    tip: "Check for typos in column names that might appear as duplicates.",
                                    troubleshooting: [
                                        "Review index definition: Check for repeated column names",
                                        "Check for aliases: Ensure column aliases don't create duplicates",
                                        "Verify column names: Use \\d table_name to see actual column names"
                                    ]
                                },
                                {
                                    message: "ERROR: access method does not support unique indexes",
                                    errorCode: "0A000",
                                    severity: "Medium",
                                    cause: "Attempting to create unique index using access method that doesn't support uniqueness (like GIN).",
                                    resolution: "Use btree index for unique constraints or choose appropriate access method.",
                                    parameters: "N/A",
                                    tip: "Only btree and hash indexes support unique constraints.",
                                    troubleshooting: [
                                        "Use btree: `CREATE UNIQUE INDEX ON table (column);` (btree is default)",
                                        "Check requirements: Determine if uniqueness is actually needed",
                                        "Consider exclusion constraints: For complex uniqueness requirements"
                                    ]
                                },
                                {
                                    message: "ERROR: index cannot be created on inherited column",
                                    errorCode: "42P16",
                                    severity: "Medium",
                                    cause: "Attempting to create index on inherited column directly instead of on the parent table.",
                                    resolution: "Create the index on the parent table, which will apply to all child tables.",
                                    parameters: "N/A",
                                    tip: "Indexes on parent tables automatically apply to child tables in inheritance.",
                                    troubleshooting: [
                                        "Create on parent: `CREATE INDEX ON parent_table (column);`",
                                        "Check inheritance: `SELECT * FROM pg_inherits;`",
                                        "Verify column inheritance: Ensure column exists in parent table"
                                    ]
                                },
                                {
                                    message: "NOTICE: relation \"table_name\" already exists, skipping",
                                    errorCode: "42P07",
                                    severity: "Low",
                                    cause: "Index creation with IF NOT EXISTS clause when index already exists.",
                                    resolution: "This is informational - the existing index was preserved as intended.",
                                    parameters: "N/A",
                                    tip: "Use IF NOT EXISTS to avoid errors when index might already exist.",
                                    troubleshooting: [
                                        "Check existing indexes: `\\d table_name` or `SELECT * FROM pg_indexes;`",
                                        "Verify index definition matches requirements",
                                        "Consider dropping and recreating if definition differs"
                                    ]
                                },
                                {
                                    message: "ERROR: column used in index must be NOT NULL",
                                    errorCode: "42804",
                                    severity: "Medium",
                                    cause: "Attempting to create unique index on column(s) that allow NULL values.",
                                    resolution: "Add NOT NULL constraint to the column before creating unique index.",
                                    parameters: "N/A",
                                    tip: "PostgreSQL allows multiple NULL values even in unique indexes.",
                                    troubleshooting: [
                                        "Add NOT NULL: `ALTER TABLE table_name ALTER COLUMN column_name SET NOT NULL;`",
                                        "Handle existing NULLs: Update or remove rows with NULL values first",
                                        "Use partial index: `CREATE UNIQUE INDEX ON table (col) WHERE col IS NOT NULL;`"
                                    ]
                                },
                                {
                                    message: "ERROR: index scan does not support partial indexes",
                                    errorCode: "XX000",
                                    severity: "Low",
                                    cause: "Query planner cannot use partial index for the current query conditions.",
                                    resolution: "Ensure query WHERE clause matches the partial index predicate exactly.",
                                    parameters: "N/A",
                                    tip: "Partial index conditions must be explicitly matched in query WHERE clauses.",
                                    troubleshooting: [
                                        "Check index predicate: `SELECT indexname, indexdef FROM pg_indexes WHERE indexname = 'index_name';`",
                                        "Match WHERE clause: Ensure query conditions include index predicate",
                                        "Use EXPLAIN: Check if index is being used in query plan"
                                    ]
                                },
                                {
                                    message: "ERROR: cache lookup failed for index",
                                    errorCode: "XX000",
                                    severity: "Critical",
                                    cause: "Internal error indicating index corruption or system catalog inconsistency.",
                                    resolution: "REINDEX the affected index and check for system catalog corruption.",
                                    parameters: "N/A",
                                    tip: "This often indicates serious database corruption requiring immediate attention.",
                                    troubleshooting: [
                                        "Reindex: `REINDEX INDEX index_name;`",
                                        "Check pg_index: `SELECT * FROM pg_index WHERE indexrelid = 'index_name'::regclass;`",
                                        "Run VACUUM on system catalogs: `VACUUM pg_index, pg_class;`"
                                    ]
                                },
                                {
                                    message: "ERROR: index has wrong number of columns",
                                    errorCode: "XX000",
                                    severity: "Critical",
                                    cause: "Index metadata corruption - stored column count doesn't match actual index definition.",
                                    resolution: "REINDEX the corrupted index to rebuild with correct metadata.",
                                    parameters: "N/A",
                                    tip: "This indicates serious index corruption requiring immediate reindexing.",
                                    troubleshooting: [
                                        "Reindex immediately: `REINDEX INDEX index_name;`",
                                        "Check index definition: `\\d+ table_name`",
                                        "Consider full table reindex: `REINDEX TABLE table_name;`"
                                    ]
                                },
                                {
                                    message: "ERROR: operator family does not exist",
                                    errorCode: "42704",
                                    severity: "Medium",
                                    cause: "Specified operator family for index creation does not exist.",
                                    resolution: "Use existing operator family or create the index without specifying operator family.",
                                    parameters: "N/A",
                                    tip: "Operator families group related operators for index access methods.",
                                    troubleshooting: [
                                        "List operator families: `SELECT opfname FROM pg_opfamily;`",
                                        "Check for access method: `SELECT opfname FROM pg_opfamily WHERE opfmethod = (SELECT oid FROM pg_am WHERE amname = 'btree');`",
                                        "Use default: Create index without specifying operator family"
                                    ]
                                },
                                {
                                    message: "ERROR: insufficient columns in GROUP BY clause",
                                    errorCode: "42803",
                                    severity: "Medium",
                                    cause: "Query uses aggregate functions but GROUP BY doesn't include all non-aggregated columns, impacting index usage.",
                                    resolution: "Add all non-aggregated columns to GROUP BY clause or use appropriate aggregate functions.",
                                    parameters: "N/A",
                                    tip: "Proper GROUP BY usage enables better index utilization for aggregation queries.",
                                    troubleshooting: [
                                        "Add columns to GROUP BY: Include all selected non-aggregated columns",
                                        "Use aggregate functions: Wrap columns in appropriate aggregates (MIN, MAX, etc.)",
                                        "Consider window functions: Use for complex aggregation scenarios"
                                    ]
                                },
                                {
                                    message: "ERROR: btree index operator family requires different left and right types",
                                    errorCode: "22P02",
                                    severity: "Medium",
                                    cause: "Attempting comparison operations between incompatible data types in index context.",
                                    resolution: "Ensure data types are compatible or use explicit casting in index expressions.",
                                    parameters: "N/A",
                                    tip: "Create composite indexes with compatible data types for multi-column operations.",
                                    troubleshooting: [
                                        "Check data types: `\\d+ table_name` to see column types",
                                        "Use explicit casting: `CREATE INDEX ON table (column::target_type);`",
                                        "Create separate indexes: One for each data type if necessary"
                                    ]
                                },
                                {
                                    message: "ERROR: could not determine which collation to use for index expression",
                                    errorCode: "42P22",
                                    severity: "Medium",
                                    cause: "Ambiguous collation in index expression with multiple text columns having different collations.",
                                    resolution: "Explicitly specify collation in the index expression using COLLATE clause.",
                                    parameters: "N/A",
                                    tip: "Consistent collation across indexed text columns improves performance.",
                                    troubleshooting: [
                                        "Specify collation: `CREATE INDEX ON table (column COLLATE \"C\");`",
                                        "Check column collations: `SELECT column_name, collation_name FROM information_schema.columns;`",
                                        "Use database default: `CREATE INDEX ON table (column COLLATE pg_catalog.default);`"
                                    ]
                                },
                                {
                                    message: "ERROR: index access method cannot handle NaN values",
                                    errorCode: "22P02",
                                    severity: "Medium",
                                    cause: "Attempting to index floating-point columns containing NaN (Not a Number) values with incompatible access method.",
                                    resolution: "Use btree index (default) which handles NaN, or filter out NaN values in partial index.",
                                    parameters: "N/A",
                                    tip: "Btree indexes handle NaN values by treating them as equal and greater than all other values.",
                                    troubleshooting: [
                                        "Use btree: `CREATE INDEX ON table (float_column);` (btree is default)",
                                        "Filter NaN: `CREATE INDEX ON table (float_column) WHERE float_column IS NOT NULL AND NOT (float_column = 'NaN'::float);`",
                                        "Check for NaN: `SELECT * FROM table WHERE float_column = 'NaN'::float;`"
                                    ]
                                },
                                {
                                    message: "ERROR: operator class does not accept data type",
                                    errorCode: "42804",
                                    severity: "Medium",
                                    cause: "Specified operator class is not compatible with the column's data type.",
                                    resolution: "Use appropriate operator class for the data type or let PostgreSQL choose automatically.",
                                    parameters: "N/A",
                                    tip: "PostgreSQL automatically selects appropriate operator classes based on data types.",
                                    troubleshooting: [
                                        "Check compatible operator classes: `SELECT opcname, opcintype::regtype FROM pg_opclass WHERE opcintype = 'your_type'::regtype;`",
                                        "Use default: Create index without specifying operator class",
                                        "Cast data type: Modify column type if appropriate operator class exists"
                                    ]
                                },
                                {
                                    message: "ERROR: index cannot be used in recursive query",
                                    errorCode: "0A000",
                                    severity: "Low",
                                    cause: "PostgreSQL cannot use certain indexes within recursive CTE queries.",
                                    resolution: "Restructure query to avoid index dependencies in recursive part or use different query approach.",
                                    parameters: "N/A",
                                    tip: "Recursive queries have limitations on index usage to prevent infinite loops.",
                                    troubleshooting: [
                                        "Simplify recursive part: Remove complex index dependencies",
                                        "Use non-recursive alternative: Consider iterative approaches",
                                        "Split query: Separate recursive and non-recursive parts"
                                    ]
                                },
                                {
                                    message: "ERROR: index scan direction not supported",
                                    errorCode: "XX000",
                                    severity: "Low",
                                    cause: "Requested scan direction (forward/backward) not supported by the index type.",
                                    resolution: "Use appropriate ORDER BY clause or different index type that supports required scan direction.",
                                    parameters: "N/A",
                                    tip: "Btree indexes support both forward and backward scans, while other types may have limitations.",
                                    troubleshooting: [
                                        "Check index type: `SELECT indexname, indexdef FROM pg_indexes WHERE tablename = 'table_name';`",
                                        "Use btree for bidirectional scans",
                                        "Adjust ORDER BY: Use supported scan direction"
                                    ]
                                }
                            ]
                        }
                    ]
                },
                extensions_guide: {
                    title: "PostgreSQL Extensions Guide",
                    icon: "fa-solid fa-puzzle-piece",
                    intro: "A comprehensive guide to PostgreSQL extensions, organized by category to help you find the right tools for your specific needs.",
                    categories: [
                        {
                            name: "Performance & Monitoring",
                            icon: "fa-solid fa-chart-line",
                            description: "Extensions for monitoring query performance, tracking statistics, and optimizing database operations",
                            extensions: [
                                {
                                    name: "pg_stat_statements",
                                    use_case: "Query Performance Monitoring",
                                    installation: "CREATE EXTENSION pg_stat_statements;",
                                    prerequisites: "Add 'pg_stat_statements' to shared_preload_libraries in postgresql.conf and restart",
                                    sample_use: "-- Top 10 slowest queries by total time\nSELECT query, calls, total_exec_time, mean_exec_time, rows FROM pg_stat_statements ORDER BY total_exec_time DESC LIMIT 10;\n\n-- Reset statistics\nSELECT pg_stat_statements_reset();",
                                    monitoring_views: "pg_stat_statements",
                                    performance_notes: "Adds minimal overhead (~5%) to query execution. Configure pg_stat_statements.max appropriately for your workload (default 5000).",
                                    configuration: {
                                        "pg_stat_statements.max": "Maximum number of statements tracked",
                                        "pg_stat_statements.track": "Controls which statements are tracked (all, top, none)",
                                        "pg_stat_statements.save": "Whether to save statistics across server restarts"
                                    },
                                    tips: [
                                        "Regularly reset statistics to focus on recent performance",
                                        "Use with pg_stat_user_tables for comprehensive monitoring",
                                        "Consider third-party tools like pgBadger for enhanced analysis"
                                    ]
                                },
                                {
                                    name: "auto_explain",
                                    use_case: "Automatic Query Plan Logging",
                                    installation: "Already built-in, configure in postgresql.conf",
                                    prerequisites: "Add 'auto_explain' to shared_preload_libraries and configure parameters",
                                    sample_use: "-- Configuration in postgresql.conf:\n-- auto_explain.log_min_duration = 1000\n-- auto_explain.log_analyze = on\n-- auto_explain.log_buffers = on",
                                    monitoring_views: "PostgreSQL logs",
                                    performance_notes: "Only logs plans for queries exceeding log_min_duration threshold. Minimal impact when properly configured.",
                                    configuration: {
                                        "auto_explain.log_min_duration": "Minimum execution time to log (milliseconds)",
                                        "auto_explain.log_analyze": "Include actual run times and row counts",
                                        "auto_explain.log_buffers": "Include buffer usage statistics"
                                    },
                                    tips: [
                                        "Start with a high log_min_duration to avoid log spam",
                                        "Use with log rotation to manage log file size",
                                        "Combine with pg_stat_statements for complete performance picture"
                                    ]
                                },
                                {
                                    name: "hypopg",
                                    use_case: "Hypothetical Index Testing",
                                    installation: "CREATE EXTENSION hypopg;",
                                    prerequisites: "Extension must be installed from source or package manager",
                                    sample_use: "-- Create hypothetical index\nSELECT * FROM hypopg_create_index('CREATE INDEX ON my_table(my_column)');\n\n-- Test query performance\nEXPLAIN SELECT * FROM my_table WHERE my_column = 1;\n\n-- List hypothetical indexes\nSELECT * FROM hypopg_list_indexes();\n\n-- Drop all hypothetical indexes\nSELECT hypopg_reset();",
                                    monitoring_views: "hypopg_list_indexes()",
                                    performance_notes: "Zero overhead on actual queries - only affects EXPLAIN plans. Perfect for testing index effectiveness before creation.",
                                    tips: [
                                        "Test multiple index combinations to find optimal strategy",
                                        "Use EXPLAIN (ANALYZE, BUFFERS) for realistic estimates",
                                        "Remember to reset hypothetical indexes between tests"
                                    ]
                                }
                            ]
                        },
                        {
                            name: "AI/ML & Advanced Analytics",
                            icon: "fa-solid fa-brain",
                            description: "Extensions for artificial intelligence, machine learning, and advanced analytical operations",
                            extensions: [
                                {
                                    name: "pgvector",
                                    use_case: "Vector Similarity Search for AI/ML",
                                    installation: "CREATE EXTENSION vector;",
                                    prerequisites: "Install from source or package manager (not included with PostgreSQL)",
                                    sample_use: "-- Create table with vector column\nCREATE TABLE items (id bigserial PRIMARY KEY, embedding vector(1536));\n\n-- Insert vector data\nINSERT INTO items (embedding) VALUES ('[1,2,3,...]'), ('[4,5,6,...]');\n\n-- Create HNSW index for fast similarity search\nCREATE INDEX ON items USING hnsw (embedding vector_cosine_ops);\n\n-- Find similar vectors\nSELECT id, embedding <=> '[1,1,1,...]' AS distance FROM items ORDER BY embedding <=> '[1,1,1,...]' LIMIT 10;",
                                    monitoring_views: "Standard pg_stat_user_indexes for index usage",
                                    performance_notes: "Index performance depends on dimensionality and data distribution. HNSW generally faster than IVFFlat for most use cases.",
                                    configuration: {
                                        "Distance operators": "<-> (L2), <#> (inner product), <=> (cosine)",
                                        "Index types": "ivfflat for smaller datasets, hnsw for larger datasets",
                                        "Vector dimensions": "Up to 16,000 dimensions supported"
                                    },
                                    tips: [
                                        "Choose appropriate distance function for your ML model",
                                        "HNSW index build time scales with data size - build during maintenance",
                                        "Consider normalization for cosine similarity operations"
                                    ]
                                },
                                {
                                    name: "pg_ml",
                                    use_case: "Machine Learning in PostgreSQL",
                                    installation: "CREATE EXTENSION pgml;",
                                    prerequisites: "Requires PostgresML installation (separate package)",
                                    sample_use: "-- Train a model\nSELECT pgml.train('my_model', 'classification', 'my_table', 'target_column');\n\n-- Make predictions\nSELECT pgml.predict('my_model', ARRAY[feature1, feature2, feature3]) FROM new_data;",
                                    monitoring_views: "pgml.models, pgml.deployments",
                                    performance_notes: "Enables training and inference directly in PostgreSQL. GPU acceleration available for supported algorithms.",
                                    tips: [
                                        "Start with simple models before moving to complex ones",
                                        "Monitor model performance over time",
                                        "Consider data preprocessing within PostgreSQL"
                                    ]
                                }
                            ]
                        },
                        {
                            name: "Full-Text Search & Text Processing",
                            icon: "fa-solid fa-magnifying-glass",
                            description: "Extensions for enhanced text search capabilities and string processing",
                            extensions: [
                                {
                                    name: "pg_trgm",
                                    use_case: "Trigram-based Fuzzy Text Search",
                                    installation: "CREATE EXTENSION pg_trgm;",
                                    prerequisites: "Usually included with PostgreSQL installation",
                                    sample_use: "-- Create GIN index for fast similarity search\nCREATE INDEX idx_name_trgm ON users USING GIN (name gin_trgm_ops);\n\n-- Fuzzy search with similarity operator\nSELECT name, similarity(name, 'John') FROM users WHERE name % 'John' ORDER BY similarity(name, 'John') DESC;\n\n-- Flexible LIKE queries\nSELECT * FROM products WHERE name ILIKE '%widget%';\n\n-- Word distance\nSELECT word_similarity('PostgreSQL', 'PostreSQL');",
                                    monitoring_views: "Standard index usage views",
                                    performance_notes: "GIN indexes provide excellent performance for similarity searches. Index size typically 20-30% of text data size.",
                                    configuration: {
                                        "pg_trgm.similarity_threshold": "Minimum similarity for % operator (default 0.3)",
                                        "pg_trgm.word_similarity_threshold": "Threshold for word similarity operator"
                                    },
                                    tips: [
                                        "Adjust similarity threshold based on your data characteristics",
                                        "Use GIN for read-heavy workloads, GiST for mixed workloads",
                                        "Combine with full-text search for comprehensive text queries"
                                    ]
                                },
                                {
                                    name: "unaccent",
                                    use_case: "Accent-insensitive Text Search",
                                    installation: "CREATE EXTENSION unaccent;",
                                    prerequisites: "Usually included with PostgreSQL installation",
                                    sample_use: "-- Remove accents from text\nSELECT unaccent('CafÃ© rÃ©sumÃ© naÃ¯ve');\n-- Result: 'Cafe resume naive'\n\n-- Create functional index for accent-insensitive search\nCREATE INDEX idx_name_unaccent ON users (unaccent(name));\n\n-- Search without accent sensitivity\nSELECT * FROM users WHERE unaccent(name) ILIKE unaccent('%josÃ©%');",
                                    monitoring_views: "Standard index usage views",
                                    performance_notes: "Functional indexes on unaccent() provide good performance for accent-insensitive searches.",
                                    tips: [
                                        "Create functional indexes for frequently searched columns",
                                        "Combine with pg_trgm for powerful fuzzy search capabilities",
                                        "Consider locale settings for proper character handling"
                                    ]
                                }
                            ]
                        },
                        {
                            name: "Data Management & Partitioning",
                            icon: "fa-solid fa-table",
                            description: "Extensions for managing large datasets, partitioning, and data lifecycle",
                            extensions: [
                                {
                                    name: "pg_partman",
                                    use_case: "Automated Partition Management",
                                    installation: "CREATE EXTENSION pg_partman;",
                                    prerequisites: "Add pg_partman_bgw to shared_preload_libraries for background worker",
                                    sample_use: "-- Create partitioned table with daily partitions\nSELECT partman.create_parent(\n    p_parent_table => 'public.log_table',\n    p_control => 'created_at',\n    p_type => 'native',\n    p_interval => 'daily',\n    p_premake => 7\n);\n\n-- Run partition maintenance\nSELECT partman.run_maintenance('public.log_table');\n\n-- Check partition status\nSELECT * FROM partman.part_config WHERE parent_table = 'public.log_table';",
                                    monitoring_views: "partman.part_config, partman.part_config_sub",
                                    performance_notes: "Automated partition creation and deletion. Background worker ensures maintenance runs automatically.",
                                    configuration: {
                                        "premake": "Number of future partitions to create in advance",
                                        "retention": "How long to keep old partitions",
                                        "retention_keep_table": "Whether to keep table structure when dropping partitions"
                                    },
                                    tips: [
                                        "Configure retention policies to automatically drop old partitions",
                                        "Monitor partition creation to ensure adequate premake setting",
                                        "Use native partitioning for PostgreSQL 10+ for better performance"
                                    ]
                                },
                                {
                                    name: "pg_cron",
                                    use_case: "Database Job Scheduling",
                                    installation: "CREATE EXTENSION pg_cron;",
                                    prerequisites: "Add pg_cron to shared_preload_libraries and configure cron.database_name",
                                    sample_use: "-- Schedule daily vacuum\nSELECT cron.schedule('daily-vacuum', '0 2 * * *', 'VACUUM ANALYZE;');\n\n-- Schedule partition maintenance\nSELECT cron.schedule('partition-maintenance', '0 1 * * *', 'SELECT partman.run_maintenance_proc();');\n\n-- List scheduled jobs\nSELECT * FROM cron.job;\n\n-- View job run history\nSELECT * FROM cron.job_run_details ORDER BY start_time DESC;",
                                    monitoring_views: "cron.job, cron.job_run_details",
                                    performance_notes: "Lightweight job scheduler. Jobs run in separate connections to avoid blocking.",
                                    tips: [
                                        "Schedule maintenance tasks during low-activity periods",
                                        "Monitor job execution history for failures",
                                        "Use appropriate database connections for scheduled jobs"
                                    ]
                                }
                            ]
                        },
                        {
                            name: "Data Types & Functions",
                            icon: "fa-solid fa-code",
                            description: "Extensions providing additional data types, functions, and utilities",
                            extensions: [
                                {
                                    name: "hstore",
                                    use_case: "Key-Value Storage in Columns",
                                    installation: "CREATE EXTENSION hstore;",
                                    prerequisites: "Usually included with PostgreSQL installation",
                                    sample_use: "-- Create table with hstore column\nCREATE TABLE products (id serial, attributes hstore);\n\n-- Insert key-value data\nINSERT INTO products (attributes) VALUES ('color=>red, size=>large, weight=>5.2');\n\n-- Query hstore data\nSELECT * FROM products WHERE attributes -> 'color' = 'red';\nSELECT * FROM products WHERE attributes ? 'weight';\n\n-- Create GIN index for fast searches\nCREATE INDEX idx_attributes ON products USING GIN (attributes);",
                                    monitoring_views: "Standard index usage views",
                                    performance_notes: "GIN indexes provide excellent performance for hstore queries. Consider JSONB for new applications.",
                                    tips: [
                                        "Use GIN indexes for complex hstore queries",
                                        "Consider JSONB for new developments - better performance and features",
                                        "Validate hstore data structure in application logic"
                                    ]
                                },
                                {
                                    name: "uuid-ossp",
                                    use_case: "UUID Generation Functions",
                                    installation: "CREATE EXTENSION \"uuid-ossp\";",
                                    prerequisites: "Usually included with PostgreSQL installation",
                                    sample_use: "-- Generate various UUID types\nSELECT uuid_generate_v1();  -- MAC address based\nSELECT uuid_generate_v4();  -- Random\n\n-- Use in table creation\nCREATE TABLE users (\n    id UUID PRIMARY KEY DEFAULT uuid_generate_v4(),\n    username TEXT NOT NULL\n);",
                                    monitoring_views: "N/A",
                                    performance_notes: "UUID generation is fast. Consider storage implications (16 bytes vs 4-8 for integers).",
                                    tips: [
                                        "Use uuid_generate_v4() for most applications (random)",
                                        "Consider performance implications of UUID primary keys",
                                        "UUIDs are globally unique - useful for distributed systems"
                                    ]
                                }
                            ]
                        },
                        {
                            name: "Foreign Data & Connectivity",
                            icon: "fa-solid fa-globe",
                            description: "Extensions for connecting to external data sources and systems",
                            extensions: [
                                {
                                    name: "postgres_fdw",
                                    use_case: "Foreign PostgreSQL Database Access",
                                    installation: "CREATE EXTENSION postgres_fdw;",
                                    prerequisites: "Usually included with PostgreSQL installation",
                                    sample_use: "-- Create foreign server\nCREATE SERVER foreign_server FOREIGN DATA WRAPPER postgres_fdw\nOPTIONS (host 'remote_host', port '5432', dbname 'remote_db');\n\n-- Create user mapping\nCREATE USER MAPPING FOR local_user SERVER foreign_server\nOPTIONS (user 'remote_user', password 'remote_password');\n\n-- Create foreign table\nCREATE FOREIGN TABLE foreign_table (\n    id integer,\n    name text\n) SERVER foreign_server OPTIONS (schema_name 'public', table_name 'remote_table');\n\n-- Query foreign data\nSELECT * FROM foreign_table WHERE id > 100;",
                                    monitoring_views: "pg_stat_user_tables (for foreign tables)",
                                    performance_notes: "Network latency affects performance. Use WHERE clauses to minimize data transfer.",
                                    tips: [
                                        "Push down WHERE clauses to reduce network traffic",
                                        "Use IMPORT FOREIGN SCHEMA for easier setup",
                                        "Monitor network connectivity and performance"
                                    ]
                                },
                                {
                                    name: "file_fdw",
                                    use_case: "File-based Data Access",
                                    installation: "CREATE EXTENSION file_fdw;",
                                    prerequisites: "Usually included with PostgreSQL installation",
                                    sample_use: "-- Create foreign table for CSV file\nCREATE FOREIGN TABLE csv_data (\n    id integer,\n    name text,\n    value numeric\n) SERVER file_server\nOPTIONS (filename '/path/to/data.csv', format 'csv', header 'true');\n\n-- Query CSV data\nSELECT * FROM csv_data WHERE value > 100;",
                                    monitoring_views: "pg_stat_user_tables (for foreign tables)",
                                    performance_notes: "File access performance depends on file system and file size. Not suitable for frequently changing data.",
                                    tips: [
                                        "Ensure PostgreSQL has read access to files",
                                        "Use absolute paths for file locations",
                                        "Consider data import for frequently accessed data"
                                    ]
                                }
                            ]
                        }
                    ]
                },
                dba_cheatsheet: {
                    title: "DBA Cheatsheet",
                    icon: "fa-solid fa-clipboard-list",
                    intro: "A comprehensive quick reference for PostgreSQL administrative commands and operations.",
                    categories: [
                        {
                            category: "User Management",
                            tasks: [
                                { task: "Create DB User", cli: "createuser --interactive", gui: "Login/Group Roles -> Create", sql: "CREATE ROLE new_user WITH LOGIN PASSWORD 'strong_password';" },
                                { task: "Create Superuser", cli: "createuser --superuser username", gui: "Login/Group Roles -> Create -> Superuser", sql: "CREATE ROLE admin_user WITH SUPERUSER LOGIN PASSWORD 'secure_pass';" },
                                { task: "Assign Privilege", cli: "N/A", gui: "Select Object -> Properties -> Security", sql: "GRANT SELECT ON my_table TO new_user;" },
                                { task: "Grant All Privileges", cli: "N/A", gui: "Database -> Properties -> Security", sql: "GRANT ALL PRIVILEGES ON DATABASE dbname TO username;" },
                                { task: "Revoke Privileges", cli: "N/A", gui: "Object -> Properties -> Security -> Remove", sql: "REVOKE SELECT ON my_table FROM username;" },
                                { task: "List Users", cli: "\\du", gui: "Login/Group Roles list", sql: "SELECT rolname, rolsuper, rolcreatedb, rolcanlogin FROM pg_roles;" },
                                { task: "Drop User", cli: "dropuser username", gui: "Right-click Role -> Delete", sql: "DROP ROLE IF EXISTS username;" },
                                { task: "Change Password", cli: "N/A", gui: "Role -> Properties -> Definition", sql: "ALTER ROLE username WITH PASSWORD 'new_password';" }
                            ]
                        },
                        {
                            category: "Database Management",
                            tasks: [
                                { task: "Create Database", cli: "createdb -O owner dbname", gui: "Databases -> Create", sql: "CREATE DATABASE dbname WITH OWNER username ENCODING 'UTF8';" },
                                { task: "Drop Database", cli: "dropdb dbname", gui: "Right-click Database -> Delete", sql: "DROP DATABASE IF EXISTS dbname;" },
                                { task: "List Databases", cli: "\\l", gui: "Databases tree view", sql: "SELECT datname, datowner, encoding FROM pg_database;" },
                                { task: "Connect to Database", cli: "\\c dbname", gui: "Double-click Database", sql: "-- Use psql: \\c dbname" },
                                { task: "Database Size", cli: "N/A", gui: "Database -> Properties -> Statistics", sql: "SELECT pg_size_pretty(pg_database_size('dbname'));" },
                                { task: "Rename Database", cli: "N/A", gui: "Database -> Properties -> General", sql: "ALTER DATABASE old_name RENAME TO new_name;" }
                            ]
                        },
                        {
                            category: "Backup & Restore",
                            tasks: [
                                { task: "Logical Backup (Single DB)", cli: "pg_dump -U user -d dbname -f backup.sql", gui: "Right-click DB -> Backup", sql: "-- Check backup progress:\nSELECT pid, application_name, state FROM pg_stat_activity WHERE application_name LIKE '%pg_dump%';" },
                                { task: "Compressed Backup", cli: "pg_dump -U user -d dbname -Fc -f backup.custom", gui: "Backup -> Format: Custom", sql: "-- Verify backup file:\nSELECT pg_size_pretty(pg_database_size('dbname')) AS db_size;" },
                                { task: "Backup with Data Only", cli: "pg_dump -U user -d dbname --data-only -f data.sql", gui: "Backup -> Data Options -> Data only", sql: "-- Check table row counts:\nSELECT schemaname, tablename, n_tup_ins FROM pg_stat_user_tables;" },
                                { task: "Backup Schema Only", cli: "pg_dump -U user -d dbname --schema-only -f schema.sql", gui: "Backup -> Data Options -> Schema only", sql: "-- List all tables:\nSELECT table_name FROM information_schema.tables WHERE table_schema = 'public';" },
                                { task: "Parallel Backup", cli: "pg_dump -U user -d dbname -Fd -j 4 -f backup_dir/", gui: "Backup -> Options -> Jobs: 4", sql: "-- Monitor parallel workers:\nSELECT count(*) FROM pg_stat_activity WHERE application_name LIKE '%pg_dump%';" },
                                { task: "Logical Restore", cli: "psql -U user -d dbname < backup.sql", gui: "Right-click DB -> Restore", sql: "-- Check restore progress:\nSELECT pid, application_name, state, query FROM pg_stat_activity WHERE application_name LIKE '%psql%';" },
                                { task: "Custom Format Restore", cli: "pg_restore -U user -d dbname backup.custom", gui: "Restore -> Format: Custom", sql: "-- Verify restored data:\nSELECT COUNT(*) FROM information_schema.tables WHERE table_schema = 'public';" },
                                { task: "Parallel Restore", cli: "pg_restore -U user -d dbname -j 4 backup_dir/", gui: "Restore -> Options -> Jobs: 4", sql: "-- Monitor parallel restore:\nSELECT count(*) FROM pg_stat_activity WHERE application_name LIKE '%pg_restore%';" },
                                { task: "Physical Backup", cli: "pg_basebackup -D /backup/dir -h host -p port -U user", gui: "N/A", sql: "-- Check WAL archiving status:\nSELECT archived_count, failed_count FROM pg_stat_archiver;" },
                                { task: "Point-in-Time Recovery", cli: "pg_ctl start -D /recovery/dir", gui: "N/A", sql: "-- Check recovery status:\nSELECT pg_is_in_recovery(), pg_last_wal_receive_lsn(), pg_last_wal_replay_lsn();" }
                            ]
                        },
                        {
                            category: "Monitoring & Maintenance",
                            tasks: [
                                { task: "Monitor Locks", cli: "N/A", gui: "Dashboard -> Server Activity -> Locks", sql: "SELECT pid, mode, granted, query FROM pg_locks l JOIN pg_stat_activity a ON l.pid = a.pid;" },
                                { task: "Monitor Active Queries", cli: "N/A", gui: "Dashboard -> Server Activity", sql: "SELECT pid, usename, state, query_start, query FROM pg_stat_activity WHERE state = 'active';" },
                                { task: "Monitor Connections", cli: "N/A", gui: "Dashboard -> Sessions", sql: "SELECT count(*), state FROM pg_stat_activity GROUP BY state;" },
                                { task: "Vacuum Table", cli: "vacuumdb -d dbname -t tablename -v", gui: "Right-click Table -> Maintenance -> VACUUM", sql: "VACUUM (VERBOSE, ANALYZE) my_table;" },
                                { task: "Vacuum All Tables", cli: "vacuumdb -d dbname -v", gui: "Right-click DB -> Maintenance -> VACUUM", sql: "VACUUM (VERBOSE, ANALYZE);" },
                                { task: "Reindex Table", cli: "reindexdb -d dbname -t tablename", gui: "Right-click Table -> Maintenance -> REINDEX", sql: "REINDEX TABLE my_table;" },
                                { task: "Analyze Query Plan", cli: "\\h EXPLAIN", gui: "Query Tool -> Explain", sql: "EXPLAIN (ANALYZE, BUFFERS, VERBOSE) SELECT * FROM my_table;" },
                                { task: "Check Table Statistics", cli: "N/A", gui: "Table -> Properties -> Statistics", sql: "SELECT last_vacuum, last_autovacuum, last_analyze FROM pg_stat_user_tables WHERE relname = 'my_table';" },
                                { task: "Monitor Disk Usage", cli: "N/A", gui: "Dashboard -> System Statistics", sql: "SELECT schemaname, tablename, pg_size_pretty(pg_total_relation_size(schemaname||'.'||tablename)) FROM pg_tables ORDER BY pg_total_relation_size(schemaname||'.'||tablename) DESC;" }
                            ]
                        },
                        {
                            category: "Performance & Optimization",
                            tasks: [
                                { task: "Find Slow Queries", cli: "N/A", gui: "Tools -> Server Status -> Locks", sql: "SELECT query, calls, total_exec_time, mean_exec_time FROM pg_stat_statements ORDER BY mean_exec_time DESC LIMIT 10;" },
                                { task: "Check Index Usage", cli: "N/A", gui: "Table -> Properties -> Statistics", sql: "SELECT schemaname, tablename, indexname, idx_scan, idx_tup_read FROM pg_stat_user_indexes WHERE idx_scan = 0;" },
                                { task: "Cache Hit Ratio", cli: "N/A", gui: "Dashboard -> System Statistics", sql: "SELECT datname, round(blks_hit*100.0/(blks_hit+blks_read), 2) AS hit_ratio FROM pg_stat_database;" },
                                { task: "Table Bloat Analysis", cli: "N/A", gui: "Table -> Properties -> Statistics", sql: "SELECT schemaname, tablename, n_dead_tup, n_live_tup, round(n_dead_tup*100.0/NULLIF(n_live_tup+n_dead_tup,0), 2) AS bloat_pct FROM pg_stat_user_tables;" },
                                { task: "Connection Limits", cli: "N/A", gui: "Dashboard -> Server Status", sql: "SELECT setting AS max_connections, count(*) AS current_connections FROM pg_settings, pg_stat_activity WHERE name = 'max_connections' GROUP BY setting;" },
                                { task: "WAL Generation Rate", cli: "N/A", gui: "Dashboard -> System Statistics", sql: "SELECT pg_size_pretty(pg_wal_lsn_diff(pg_current_wal_lsn(), '0/0')) AS wal_generated;" }
                            ]
                        }
                    ]
                },
                performance_tuning: {
                    title: "Performance Tuning",
                    icon: "fa-solid fa-tachometer-alt",
                    intro: "Comprehensive guide to PostgreSQL performance optimization, covering configuration, indexing strategies, and query optimization.",
                    categories: [
                        {
                            name: "Memory Configuration",
                            icon: "fa-solid fa-microchip",
                            description: "Critical memory settings that significantly impact PostgreSQL performance",
                            parameters: [
                                {
                                    name: "shared_buffers",
                                    description: "The most important memory setting. Determines how much memory PostgreSQL uses for caching data blocks. Setting this correctly can dramatically reduce disk I/O.",
                                    query: "SHOW shared_buffers;",
                                    current_value_query: "SELECT setting, unit, current_setting('shared_buffers') FROM pg_settings WHERE name = 'shared_buffers';",
                                    formula: "Typically 25% of the machine's total RAM for dedicated database servers",
                                    default_value: "128MB",
                                    recommended_range: "1GB - 8GB for most systems",
                                    enterprise_values: "For a server with 64GB RAM, a value of 16GB is a common starting point",
                                    tuning_tips: [
                                        "Start with 25% of RAM, adjust based on workload",
                                        "Monitor buffer hit ratio with pg_stat_database",
                                        "Values over 40% of RAM rarely provide additional benefit",
                                        "Requires PostgreSQL restart to change"
                                    ],
                                    monitoring: "SELECT datname, round(blks_hit*100.0/(blks_hit+blks_read), 2) AS hit_ratio FROM pg_stat_database WHERE datname = current_database();"
                                },
                                {
                                    name: "work_mem",
                                    description: "Memory used by each individual query for sort operations and hash tables before writing to temporary disk files. This is per-operation, per-session.",
                                    query: "SHOW work_mem;",
                                    current_value_query: "SELECT setting, unit, current_setting('work_mem') FROM pg_settings WHERE name = 'work_mem';",
                                    formula: "(Total RAM - shared_buffers) / max_connections / 4",
                                    default_value: "4MB",
                                    recommended_range: "32MB - 512MB depending on workload",
                                    enterprise_values: "Often starts around 32MB to 128MB. Can be set higher for analytical workloads",
                                    tuning_tips: [
                                        "Start conservatively - multiple operations can use this memory simultaneously",
                                        "Increase for complex analytical queries with large sorts",
                                        "Can be set per-session for specific heavy queries",
                                        "Monitor temp file usage to determine if increase is needed"
                                    ],
                                    monitoring: "SELECT temp_files, temp_bytes FROM pg_stat_database WHERE datname = current_database();"
                                },
                                {
                                    name: "maintenance_work_mem",
                                    description: "Memory used for maintenance operations like VACUUM, CREATE INDEX, and ALTER TABLE ADD FOREIGN KEY. Higher values can significantly speed up these operations.",
                                    query: "SHOW maintenance_work_mem;",
                                    current_value_query: "SELECT setting, unit FROM pg_settings WHERE name = 'maintenance_work_mem';",
                                    formula: "10-20% of total RAM, up to 2GB",
                                    default_value: "64MB",
                                    recommended_range: "256MB - 2GB",
                                    enterprise_values: "1GB - 2GB for systems with sufficient RAM",
                                    tuning_tips: [
                                        "Higher values speed up VACUUM and index creation",
                                        "Not used concurrently like work_mem",
                                        "Can be set higher during maintenance windows",
                                        "Limited effectiveness above 2GB for most operations"
                                    ],
                                    monitoring: "-- Monitor index creation time and VACUUM performance"
                                },
                                {
                                    name: "effective_cache_size",
                                    description: "Hint to the query planner about total memory available for disk caching by PostgreSQL and the operating system. Influences query plan choices.",
                                    query: "SHOW effective_cache_size;",
                                    current_value_query: "SELECT setting, unit FROM pg_settings WHERE name = 'effective_cache_size';",
                                    formula: "50-75% of total system RAM",
                                    default_value: "4GB",
                                    recommended_range: "50-75% of total RAM",
                                    enterprise_values: "For a server with 64GB RAM, 48GB is reasonable",
                                    tuning_tips: [
                                        "This is only a hint - doesn't allocate memory",
                                        "Higher values favor index scans over sequential scans",
                                        "Consider OS cache, shared_buffers, and other applications",
                                        "Can be adjusted without restart"
                                    ],
                                    monitoring: "-- Use EXPLAIN to see if query plans are using appropriate scan types"
                                }
                            ]
                        },
                        {
                            name: "Connection & Concurrency",
                            icon: "fa-solid fa-users",
                            description: "Settings that control connection limits and concurrent operation behavior",
                            parameters: [
                                {
                                    name: "max_connections",
                                    description: "Maximum number of concurrent connections to the database. Each connection consumes memory and resources.",
                                    query: "SHOW max_connections;",
                                    current_value_query: "SELECT setting, current_setting('max_connections') FROM pg_settings WHERE name = 'max_connections';",
                                    formula: "Based on application requirements and available memory",
                                    default_value: "100",
                                    recommended_range: "100-500 for most applications",
                                    enterprise_values: "Consider connection pooling instead of high values (200-500 max)",
                                    tuning_tips: [
                                        "Each connection uses ~10MB of memory minimum",
                                        "Use connection pooling (PgBouncer) for web applications",
                                        "Monitor actual concurrent connections vs limit",
                                        "Higher values require more shared memory"
                                    ],
                                    monitoring: "SELECT count(*), state FROM pg_stat_activity GROUP BY state;"
                                },
                                {
                                    name: "max_worker_processes",
                                    description: "Maximum number of background worker processes that can be started by the system.",
                                    query: "SHOW max_worker_processes;",
                                    current_value_query: "SELECT setting FROM pg_settings WHERE name = 'max_worker_processes';",
                                    formula: "Based on CPU cores and workload requirements",
                                    default_value: "8",
                                    recommended_range: "CPU cores * 2 to CPU cores * 4",
                                    enterprise_values: "16-32 for multi-core systems with parallel workloads",
                                    tuning_tips: [
                                        "Affects parallel query execution",
                                        "Include space for maintenance workers",
                                        "Consider background extensions like pg_cron",
                                        "Restart required to change"
                                    ],
                                    monitoring: "SELECT count(*) FROM pg_stat_activity WHERE backend_type = 'parallel worker';"
                                },
                                {
                                    name: "max_parallel_workers_per_gather",
                                    description: "Maximum number of parallel worker processes that can be started by a single Gather node.",
                                    query: "SHOW max_parallel_workers_per_gather;",
                                    current_value_query: "SELECT setting FROM pg_settings WHERE name = 'max_parallel_workers_per_gather';",
                                    formula: "2-4 for most systems, based on CPU cores",
                                    default_value: "2",
                                    recommended_range: "2-8 depending on CPU cores",
                                    enterprise_values: "4-8 for systems with 8+ cores and analytical workloads",
                                    tuning_tips: [
                                        "Limited by max_worker_processes",
                                        "Useful for large table scans and aggregations",
                                        "Consider work_mem impact with multiple workers",
                                        "Monitor parallel query effectiveness"
                                    ],
                                    monitoring: "SELECT query, workers_planned, workers_launched FROM pg_stat_statements WHERE workers_planned > 0;"
                                }
                            ]
                        },
                        {
                            name: "Storage & I/O Optimization",
                            icon: "fa-solid fa-hard-drive",
                            description: "Settings that control disk I/O behavior and storage efficiency",
                            parameters: [
                                {
                                    name: "checkpoint_timeout",
                                    description: "Maximum time between automatic WAL checkpoints. Affects recovery time and I/O distribution.",
                                    query: "SHOW checkpoint_timeout;",
                                    current_value_query: "SELECT setting, unit FROM pg_settings WHERE name = 'checkpoint_timeout';",
                                    formula: "Balance between recovery time and checkpoint frequency",
                                    default_value: "5min",
                                    recommended_range: "5min - 30min",
                                    enterprise_values: "15-30 minutes for systems with good storage",
                                    tuning_tips: [
                                        "Longer intervals reduce checkpoint I/O overhead",
                                        "Shorter intervals reduce recovery time after crash",
                                        "Monitor checkpoint frequency and duration",
                                        "Coordinate with checkpoint_completion_target"
                                    ],
                                    monitoring: "SELECT checkpoints_timed, checkpoints_req, checkpoint_write_time, checkpoint_sync_time FROM pg_stat_bgwriter;"
                                },
                                {
                                    name: "checkpoint_completion_target",
                                    description: "Target completion time for checkpoints as a fraction of checkpoint_timeout. Spreads checkpoint I/O over time.",
                                    query: "SHOW checkpoint_completion_target;",
                                    current_value_query: "SELECT setting FROM pg_settings WHERE name = 'checkpoint_completion_target';",
                                    formula: "0.7-0.9 to spread I/O over 70-90% of checkpoint interval",
                                    default_value: "0.5",
                                    recommended_range: "0.7-0.9",
                                    enterprise_values: "0.8-0.9 for steady I/O distribution",
                                    tuning_tips: [
                                        "Higher values spread checkpoint I/O more evenly",
                                        "Reduces I/O spikes but may delay completion",
                                        "Monitor checkpoint statistics for optimization",
                                        "Consider storage system characteristics"
                                    ],
                                    monitoring: "SELECT checkpoint_write_time, checkpoint_sync_time FROM pg_stat_bgwriter;"
                                },
                                {
                                    name: "random_page_cost",
                                    description: "Cost estimate for non-sequentially-fetched disk pages. Influences query planner decisions between index and sequential scans.",
                                    query: "SHOW random_page_cost;",
                                    current_value_query: "SELECT setting FROM pg_settings WHERE name = 'random_page_cost';",
                                    formula: "1.1-2.0 for SSDs, 4.0 for traditional hard drives",
                                    default_value: "4.0",
                                    recommended_range: "1.1-2.0 for SSDs, 2.0-4.0 for HDDs",
                                    enterprise_values: "1.1-1.5 for high-performance SSDs",
                                    tuning_tips: [
                                        "Lower values favor index scans",
                                        "Adjust based on actual storage performance",
                                        "Test impact on query plans with EXPLAIN",
                                        "Consider workload characteristics"
                                    ],
                                    monitoring: "-- Use EXPLAIN to analyze scan type choices in query plans"
                                }
                            ]
                        },
                        {
                            name: "Query Optimization",
                            icon: "fa-solid fa-search",
                            description: "Settings and techniques for optimizing query performance",
                            parameters: [
                                {
                                    name: "default_statistics_target",
                                    description: "Default amount of information stored in pg_statistic for table columns. Affects query planner accuracy.",
                                    query: "SHOW default_statistics_target;",
                                    current_value_query: "SELECT setting FROM pg_settings WHERE name = 'default_statistics_target';",
                                    formula: "100-1000 based on data complexity and planning time tolerance",
                                    default_value: "100",
                                    recommended_range: "100-1000",
                                    enterprise_values: "500-1000 for complex analytical workloads",
                                    tuning_tips: [
                                        "Higher values improve plan accuracy but slow ANALYZE",
                                        "Set per-column for important predicates",
                                        "Monitor planning time vs execution time",
                                        "Essential for columns with skewed data distribution"
                                    ],
                                    monitoring: "SELECT schemaname, tablename, attname, n_distinct, correlation FROM pg_stats WHERE tablename = 'your_table';"
                                },
                                {
                                    name: "from_collapse_limit",
                                    description: "Controls when the planner will merge sub-queries into the upper query. Affects optimization of complex queries.",
                                    query: "SHOW from_collapse_limit;",
                                    current_value_query: "SELECT setting FROM pg_settings WHERE name = 'from_collapse_limit';",
                                    formula: "8-20 depending on query complexity tolerance",
                                    default_value: "8",
                                    recommended_range: "8-20",
                                    enterprise_values: "12-20 for complex analytical queries",
                                    tuning_tips: [
                                        "Higher values allow more aggressive optimization",
                                        "May increase planning time significantly",
                                        "Test with representative complex queries",
                                        "Balance planning time vs execution time"
                                    ],
                                    monitoring: "-- Monitor query planning time with auto_explain or pg_stat_statements"
                                }
                            ]
                        },
                        {
                            name: "Maintenance & Autovacuum",
                            icon: "fa-solid fa-broom",
                            description: "Settings that control automatic maintenance operations",
                            parameters: [
                                {
                                    name: "autovacuum_vacuum_threshold",
                                    description: "Minimum number of updated or deleted tuples needed to trigger VACUUM on a table.",
                                    query: "SHOW autovacuum_vacuum_threshold;",
                                    current_value_query: "SELECT setting FROM pg_settings WHERE name = 'autovacuum_vacuum_threshold';",
                                    formula: "50 + (table_size * autovacuum_vacuum_scale_factor)",
                                    default_value: "50",
                                    recommended_range: "50-10000 depending on table size",
                                    enterprise_values: "1000-10000 for very large tables to prevent frequent vacuuming",
                                    tuning_tips: [
                                        "Lower values for heavily updated small tables",
                                        "Higher values for large tables with infrequent updates",
                                        "Combine with scale_factor for proportional thresholds",
                                        "Monitor table bloat and vacuum frequency"
                                    ],
                                    monitoring: "SELECT schemaname, tablename, n_dead_tup, last_vacuum, last_autovacuum FROM pg_stat_user_tables ORDER BY n_dead_tup DESC;"
                                },
                                {
                                    name: "autovacuum_vacuum_scale_factor",
                                    description: "Fraction of table size added to autovacuum_vacuum_threshold for VACUUM triggering.",
                                    query: "SHOW autovacuum_vacuum_scale_factor;",
                                    current_value_query: "SELECT setting FROM pg_settings WHERE name = 'autovacuum_vacuum_scale_factor';",
                                    formula: "Percentage of table size (0.01 = 1%)",
                                    default_value: "0.2 (20%)",
                                    recommended_range: "0.01-0.2 (1%-20%)",
                                    enterprise_values: "0.01-0.05 (1%-5%) for large tables",
                                    tuning_tips: [
                                        "Lower values trigger vacuum more frequently",
                                        "Essential for large tables to prevent excessive bloat",
                                        "Can be set per-table for fine control",
                                        "Balance vacuum frequency with system load"
                                    ],
                                    monitoring: "-- Calculate effective threshold: threshold + (table_size * scale_factor)"
                                },
                                {
                                    name: "autovacuum_max_workers",
                                    description: "Maximum number of autovacuum worker processes that can run simultaneously.",
                                    query: "SHOW autovacuum_max_workers;",
                                    current_value_query: "SELECT setting FROM pg_settings WHERE name = 'autovacuum_max_workers';",
                                    formula: "1-8 based on I/O capacity and number of active databases",
                                    default_value: "3",
                                    recommended_range: "3-8",
                                    enterprise_values: "6-8 for systems with multiple busy databases",
                                    tuning_tips: [
                                        "More workers reduce vacuum lag but increase I/O",
                                        "Consider storage system capabilities",
                                        "Monitor worker utilization and queue length",
                                        "Requires restart to change"
                                    ],
                                    monitoring: "SELECT count(*) FROM pg_stat_activity WHERE query LIKE 'autovacuum:%';"
                                }
                            ]
                        }
                    ],
                    optimization_strategies: [
                        {
                            name: "Index Optimization",
                            description: "Strategies for creating and maintaining effective indexes",
                            techniques: [
                                {
                                    technique: "Composite Index Order",
                                    description: "Order columns in composite indexes by selectivity (most selective first) and query patterns",
                                    example: "-- Good: High selectivity column first\nCREATE INDEX idx_user_status_date ON users (status, created_date) WHERE status = 'active';\n\n-- Consider query patterns:\n-- SELECT * FROM users WHERE status = 'active' AND created_date > '2023-01-01';"
                                },
                                {
                                    technique: "Partial Indexes",
                                    description: "Create indexes only on subset of data that's frequently queried",
                                    example: "-- Index only active users\nCREATE INDEX idx_active_users_email ON users (email) WHERE status = 'active';\n\n-- Index only recent orders\nCREATE INDEX idx_recent_orders ON orders (customer_id) WHERE created_date > '2023-01-01';"
                                },
                                {
                                    technique: "Expression Indexes",
                                    description: "Index computed expressions or function results",
                                    example: "-- Index for case-insensitive searches\nCREATE INDEX idx_users_lower_email ON users (lower(email));\n\n-- Index for date part queries\nCREATE INDEX idx_orders_month ON orders (EXTRACT(month FROM order_date));"
                                },
                                {
                                    technique: "Index Maintenance",
                                    description: "Regular monitoring and maintenance of index effectiveness",
                                    example: "-- Find unused indexes\nSELECT schemaname, tablename, indexname, idx_scan FROM pg_stat_user_indexes WHERE idx_scan = 0;\n\n-- Find duplicate indexes\nSELECT * FROM pg_index WHERE indrelid = 'your_table'::regclass;"
                                }
                            ]
                        },
                        {
                            name: "Query Optimization",
                            description: "Techniques for writing efficient queries and analyzing performance",
                            techniques: [
                                {
                                    technique: "Effective WHERE Clauses",
                                    description: "Write selective WHERE clauses that can use indexes effectively",
                                    example: "-- Good: Uses index on status column\nSELECT * FROM users WHERE status = 'active' AND created_date > '2023-01-01';\n\n-- Bad: Function on indexed column prevents index use\nSELECT * FROM users WHERE UPPER(status) = 'ACTIVE';"
                                },
                                {
                                    technique: "JOIN Optimization",
                                    description: "Optimize JOIN operations for better performance",
                                    example: "-- Use explicit JOINs for clarity\nSELECT u.name, o.total FROM users u JOIN orders o ON u.id = o.user_id WHERE u.status = 'active';\n\n-- Consider JOIN order in complex queries\n-- Join smaller result sets first"
                                },
                                {
                                    technique: "LIMIT with ORDER BY",
                                    description: "Use appropriate indexes for ORDER BY clauses with LIMIT",
                                    example: "-- Ensure index exists for ORDER BY column\nCREATE INDEX idx_orders_date_desc ON orders (order_date DESC);\nSELECT * FROM orders ORDER BY order_date DESC LIMIT 10;"
                                },
                                {
                                    technique: "Subquery vs JOIN",
                                    description: "Choose between subqueries and JOINs based on data distribution",
                                    example: "-- EXISTS often better than IN for large datasets\nSELECT * FROM users u WHERE EXISTS (SELECT 1 FROM orders o WHERE o.user_id = u.id);\n\n-- vs\nSELECT DISTINCT u.* FROM users u JOIN orders o ON u.id = o.user_id;"
                                }
                            ]
                        }
                    ]
                },
                full_text_search: {
                    title: "Full Text Search (FTS)",
                    icon: "fa-solid fa-magnifying-glass",
                    intro: "Complete guide to PostgreSQL Full Text Search capabilities, query types, and optimization techniques.",
                    content: `
                    <div class="prose dark:prose-invert max-w-none space-y-8">
                        <!-- Query Types Reference Table -->
                        <div class="bg-gradient-to-r from-blue-50 to-purple-50 dark:from-blue-900/20 dark:to-purple-900/20 p-6 rounded-lg border border-blue-200 dark:border-blue-700">
                            <h3 class="text-xl font-bold text-blue-800 dark:text-blue-200 mb-4">
                                <i class="fa-solid fa-table mr-2"></i>PostgreSQL Query Types Reference
                            </h3>
                            <div class="overflow-x-auto">
                                <table class="w-full text-sm border-collapse border border-gray-300 dark:border-gray-600">
                                    <thead class="bg-gray-100 dark:bg-gray-700">
                                        <tr>
                                            <th class="border border-gray-300 dark:border-gray-600 px-4 py-3 text-left font-semibold">Query Type</th>
                                            <th class="border border-gray-300 dark:border-gray-600 px-4 py-3 text-left font-semibold">Example</th>
                                            <th class="border border-gray-300 dark:border-gray-600 px-4 py-3 text-left font-semibold">Description</th>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        <tr class="hover:bg-gray-50 dark:hover:bg-gray-800">
                                            <td class="border border-gray-300 dark:border-gray-600 px-4 py-3 font-mono bg-green-50 dark:bg-green-900/20">AND Search</td>
                                            <td class="border border-gray-300 dark:border-gray-600 px-4 py-3 font-mono">'tax & budget'</td>
                                            <td class="border border-gray-300 dark:border-gray-600 px-4 py-3">Must have both words</td>
                                        </tr>
                                        <tr class="hover:bg-gray-50 dark:hover:bg-gray-800">
                                            <td class="border border-gray-300 dark:border-gray-600 px-4 py-3 font-mono bg-blue-50 dark:bg-blue-900/20">OR Search</td>
                                            <td class="border border-gray-300 dark:border-gray-600 px-4 py-3 font-mono">'tax | budget'</td>
                                            <td class="border border-gray-300 dark:border-gray-600 px-4 py-3">Has "tax" OR "budget"</td>
                                        </tr>
                                        <tr class="hover:bg-gray-50 dark:hover:bg-gray-800">
                                            <td class="border border-gray-300 dark:border-gray-600 px-4 py-3 font-mono bg-red-50 dark:bg-red-900/20">NOT Search</td>
                                            <td class="border border-gray-300 dark:border-gray-600 px-4 py-3 font-mono">'tax & !gst'</td>
                                            <td class="border border-gray-300 dark:border-gray-600 px-4 py-3">Has "tax" but not "gst"</td>
                                        </tr>
                                        <tr class="hover:bg-gray-50 dark:hover:bg-gray-800">
                                            <td class="border border-gray-300 dark:border-gray-600 px-4 py-3 font-mono bg-purple-50 dark:bg-purple-900/20">Phrase Search</td>
                                            <td class="border border-gray-300 dark:border-gray-600 px-4 py-3 font-mono">'new &lt;2&gt; policy'</td>
                                            <td class="border border-gray-300 dark:border-gray-600 px-4 py-3">"new" within 2 words of "policy"</td>
                                        </tr>
                                        <tr class="hover:bg-gray-50 dark:hover:bg-gray-800">
                                            <td class="border border-gray-300 dark:border-gray-600 px-4 py-3 font-mono bg-yellow-50 dark:bg-yellow-900/20">Prefix Search</td>
                                            <td class="border border-gray-300 dark:border-gray-600 px-4 py-3 font-mono">'crick:*'</td>
                                            <td class="border border-gray-300 dark:border-gray-600 px-4 py-3">Matches "cricket", "cricketer"</td>
                                        </tr>
                                    </tbody>
                                </table>
                            </div>
                        </div>

                        <!-- GIN Index Optimization -->
                        <div class="bg-gradient-to-r from-green-50 to-teal-50 dark:from-green-900/20 dark:to-teal-900/20 p-6 rounded-lg border border-green-200 dark:border-green-700">
                            <h3 class="text-xl font-bold text-green-800 dark:text-green-200 mb-4">
                                <i class="fa-solid fa-rocket mr-2"></i>Bonus: Make It Fast with an Index
                            </h3>
                            <p class="text-gray-700 dark:text-gray-300 mb-4">
                                PostgreSQL supports <strong>GIN (Generalized Inverted Index)</strong> for Full Text Search optimization:
                            </p>
                            <div class="bg-gray-900 dark:bg-gray-800 rounded-lg p-4 font-mono text-sm">
                                <div class="text-green-400 mb-2">-- Create GIN Index for Fast Full Text Search</div>
                                <div class="text-blue-300">CREATE INDEX</div>
                                <div class="text-white ml-4">idx_articles_content</div>
                                <div class="text-blue-300">ON</div>
                                <div class="text-white ml-4">articles</div>
                                <div class="text-blue-300">USING GIN</div>
                                <div class="text-white ml-4">(to_tsvector('english', content));</div>
                            </div>
                        </div>

                        <!-- Practical Examples -->
                        <div class="grid grid-cols-1 lg:grid-cols-2 gap-6">
                            <div class="bg-white dark:bg-gray-800 rounded-lg border border-gray-200 dark:border-gray-700 p-6">
                                <h4 class="text-lg font-semibold text-gray-800 dark:text-gray-200 mb-4">
                                    <i class="fa-solid fa-code mr-2 text-blue-500"></i>Basic Full Text Search
                                </h4>
                                <pre class="bg-gray-100 dark:bg-gray-900 rounded p-4 text-sm overflow-x-auto"><code class="language-sql">-- Search for documents containing 'postgresql'
SELECT title, content 
FROM articles 
WHERE to_tsvector('english', content) @@ to_tsquery('postgresql');

-- Search with ranking
SELECT title, 
       ts_rank(to_tsvector('english', content), query) as rank
FROM articles, to_tsquery('postgresql & database') query
WHERE to_tsvector('english', content) @@ query
ORDER BY rank DESC;</code></pre>
                            </div>

                            <div class="bg-white dark:bg-gray-800 rounded-lg border border-gray-200 dark:border-gray-700 p-6">
                                <h4 class="text-lg font-semibold text-gray-800 dark:text-gray-200 mb-4">
                                    <i class="fa-solid fa-search mr-2 text-purple-500"></i>Advanced Query Operators
                                </h4>
                                <pre class="bg-gray-100 dark:bg-gray-900 rounded p-4 text-sm overflow-x-auto"><code class="language-sql">-- Phrase search: words within 2 positions
SELECT * FROM articles 
WHERE content @@ to_tsquery('new <2> feature');

-- Prefix search
SELECT * FROM articles 
WHERE content @@ to_tsquery('postgr:*');

-- Complex boolean queries
SELECT * FROM articles 
WHERE content @@ to_tsquery('(postgresql | mysql) & !oracle');</code></pre>
                            </div>
                        </div>

                        <!-- Performance Tips -->
                        <div class="bg-amber-50 dark:bg-amber-900/20 border-l-4 border-amber-400 p-6">
                            <h4 class="text-lg font-semibold text-amber-800 dark:text-amber-200 mb-3">
                                <i class="fa-solid fa-lightbulb mr-2"></i>Performance Optimization Tips
                            </h4>
                            <ul class="space-y-2 text-gray-700 dark:text-gray-300">
                                <li>â€¢ <strong>Use GIN indexes</strong> for frequently searched columns</li>
                                <li>â€¢ <strong>Choose appropriate language</strong> for text processing (english, simple, etc.)</li>
                                <li>â€¢ <strong>Store tsvector columns</strong> to avoid repeated computation</li>
                                <li>â€¢ <strong>Use ts_rank()</strong> for relevance scoring</li>
                                <li>â€¢ <strong>Consider materialized views</strong> for complex search scenarios</li>
                            </ul>
                        </div>

                        <!-- Configuration Example -->
                        <div class="bg-white dark:bg-gray-800 rounded-lg border border-gray-200 dark:border-gray-700 p-6">
                            <h4 class="text-lg font-semibold text-gray-800 dark:text-gray-200 mb-4">
                                <i class="fa-solid fa-database mr-2 text-indigo-500"></i>Complete Setup Example
                            </h4>
                            <pre class="bg-gray-900 dark:bg-gray-800 rounded p-4 text-sm overflow-x-auto"><code class="language-sql">-- 1. Create table with text content
CREATE TABLE documents (
    id SERIAL PRIMARY KEY,
    title TEXT NOT NULL,
    content TEXT NOT NULL,
    search_vector TSVECTOR
);

-- 2. Create GIN index for fast searching
CREATE INDEX idx_documents_search 
ON documents USING GIN(search_vector);

-- 3. Create trigger to automatically update search vector
CREATE OR REPLACE FUNCTION update_search_vector()
RETURNS TRIGGER AS $$
BEGIN
    NEW.search_vector := 
        setweight(to_tsvector('english', COALESCE(NEW.title, '')), 'A') ||
        setweight(to_tsvector('english', COALESCE(NEW.content, '')), 'B');
    RETURN NEW;
END;
$$ LANGUAGE plpgsql;

CREATE TRIGGER trig_update_search_vector
    BEFORE INSERT OR UPDATE ON documents
    FOR EACH ROW EXECUTE FUNCTION update_search_vector();

-- 4. Sample searches
-- Simple search
SELECT title, ts_rank(search_vector, query) AS rank
FROM documents, to_tsquery('english', 'postgresql & performance') query
WHERE search_vector @@ query
ORDER BY rank DESC;

-- Headline generation (snippet with highlights)
SELECT title,
       ts_headline('english', content, query, 
                  'MaxWords=20, MinWords=5') AS snippet
FROM documents, to_tsquery('english', 'postgresql') query
WHERE search_vector @@ query;</code></pre>
                        </div>

                        <!-- Language Support -->
                        <div class="bg-blue-50 dark:bg-blue-900/20 border border-blue-200 dark:border-blue-700 rounded-lg p-6">
                            <h4 class="text-lg font-semibold text-blue-800 dark:text-blue-200 mb-3">
                                <i class="fa-solid fa-globe mr-2"></i>Multi-Language Support
                            </h4>
                            <div class="grid grid-cols-1 md:grid-cols-2 gap-4 text-sm">
                                <div>
                                    <h5 class="font-semibold text-gray-800 dark:text-gray-200 mb-2">Available Languages:</h5>
                                    <ul class="text-gray-600 dark:text-gray-400 space-y-1">
                                        <li>â€¢ english (default)</li>
                                        <li>â€¢ simple (no stemming)</li>
                                        <li>â€¢ spanish, french, german</li>
                                        <li>â€¢ russian, portuguese</li>
                                        <li>â€¢ And many more...</li>
                                    </ul>
                                </div>
                                <div>
                                    <h5 class="font-semibold text-gray-800 dark:text-gray-200 mb-2">Usage Example:</h5>
                                    <pre class="bg-gray-100 dark:bg-gray-900 p-2 rounded text-xs overflow-x-auto"><code>-- Spanish text search
SELECT * FROM docs 
WHERE to_tsvector('spanish', content) 
@@ to_tsquery('spanish', 'bÃºsqueda');</code></pre>
                                </div>
                            </div>
                        </div>
                    </div>
                    `
                },
                fts_techniques: {
                    title: "Advanced FTS Techniques",
                    icon: "fa-solid fa-magic-wand-sparkles",
                    intro: "Advanced Full Text Search implementation techniques, performance optimization strategies, and real-world use cases.",
                    content: `
                    <div class="prose dark:prose-invert max-w-none space-y-8">
                        
                        <!-- Implementation Strategies -->
                        <div class="bg-gradient-to-r from-indigo-50 to-blue-50 dark:from-indigo-900/20 dark:to-blue-900/20 p-6 rounded-lg border border-indigo-200 dark:border-indigo-700">
                            <h3 class="text-xl font-bold text-indigo-800 dark:text-indigo-200 mb-4">
                                <i class="fa-solid fa-gears mr-2"></i>Implementation Strategies
                            </h3>
                            
                            <div class="grid grid-cols-1 lg:grid-cols-2 gap-6">
                                <!-- Strategy 1: Materialized TSVector -->
                                <div class="bg-white dark:bg-gray-800 rounded-lg p-4 border border-gray-200 dark:border-gray-700">
                                    <h4 class="font-semibold text-gray-800 dark:text-gray-200 mb-3">
                                        <i class="fa-solid fa-database mr-2 text-blue-500"></i>Strategy 1: Materialized TSVector
                                    </h4>
                                    <p class="text-sm text-gray-600 dark:text-gray-400 mb-3">Store pre-computed search vectors for better performance</p>
                                    <pre class="bg-gray-100 dark:bg-gray-900 rounded p-3 text-xs overflow-x-auto"><code class="language-sql">-- Add tsvector column
ALTER TABLE articles ADD COLUMN search_vector tsvector;

-- Update with weighted content
UPDATE articles SET search_vector = 
    setweight(to_tsvector('english', COALESCE(title, '')), 'A') ||
    setweight(to_tsvector('english', COALESCE(content, '')), 'B') ||
    setweight(to_tsvector('english', COALESCE(tags, '')), 'C');

-- Create GIN index
CREATE INDEX idx_articles_search 
ON articles USING GIN(search_vector);</code></pre>
                                </div>

                                <!-- Strategy 2: Trigger-Based Updates -->
                                <div class="bg-white dark:bg-gray-800 rounded-lg p-4 border border-gray-200 dark:border-gray-700">
                                    <h4 class="font-semibold text-gray-800 dark:text-gray-200 mb-3">
                                        <i class="fa-solid fa-bolt mr-2 text-yellow-500"></i>Strategy 2: Automatic Updates
                                    </h4>
                                    <p class="text-sm text-gray-600 dark:text-gray-400 mb-3">Automatically maintain search vectors with triggers</p>
                                    <pre class="bg-gray-100 dark:bg-gray-900 rounded p-3 text-xs overflow-x-auto"><code class="language-sql">-- Create update function
CREATE OR REPLACE FUNCTION update_search_vector()
RETURNS TRIGGER AS $$
BEGIN
    NEW.search_vector := 
        setweight(to_tsvector('english', COALESCE(NEW.title, '')), 'A') ||
        setweight(to_tsvector('english', COALESCE(NEW.content, '')), 'B');
    RETURN NEW;
END;
$$ LANGUAGE plpgsql;

-- Create trigger
CREATE TRIGGER trig_update_search_vector
    BEFORE INSERT OR UPDATE ON articles
    FOR EACH ROW EXECUTE FUNCTION update_search_vector();</code></pre>
                                </div>
                            </div>
                        </div>

                        <!-- Advanced Query Techniques -->
                        <div class="bg-gradient-to-r from-purple-50 to-pink-50 dark:from-purple-900/20 dark:to-pink-900/20 p-6 rounded-lg border border-purple-200 dark:border-purple-700">
                            <h3 class="text-xl font-bold text-purple-800 dark:text-purple-200 mb-4">
                                <i class="fa-solid fa-search-plus mr-2"></i>Advanced Query Techniques
                            </h3>
                            
                            <div class="grid grid-cols-1 lg:grid-cols-3 gap-4">
                                <!-- Weighted Search -->
                                <div class="bg-white dark:bg-gray-800 rounded-lg p-4 border border-gray-200 dark:border-gray-700">
                                    <h5 class="font-semibold text-gray-800 dark:text-gray-200 mb-2">Weighted Ranking</h5>
                                    <pre class="bg-gray-100 dark:bg-gray-900 rounded p-2 text-xs overflow-x-auto"><code class="language-sql">-- Weight title matches higher
SELECT title,
    ts_rank_cd(
        setweight(to_tsvector('english', title), 'A') ||
        setweight(to_tsvector('english', content), 'B'),
        query
    ) as rank
FROM articles, 
     to_tsquery('english', 'postgresql') query
WHERE search_vector @@ query
ORDER BY rank DESC;</code></pre>
                                </div>

                                <!-- Fuzzy Matching -->
                                <div class="bg-white dark:bg-gray-800 rounded-lg p-4 border border-gray-200 dark:border-gray-700">
                                    <h5 class="font-semibold text-gray-800 dark:text-gray-200 mb-2">Fuzzy Matching</h5>
                                    <pre class="bg-gray-100 dark:bg-gray-900 rounded p-2 text-xs overflow-x-auto"><code class="language-sql">-- Using similarity for fuzzy search
SELECT title,
    similarity(title, 'postgresq') as sim
FROM articles 
WHERE similarity(title, 'postgresq') > 0.3
ORDER BY sim DESC;

-- Combine with FTS
SELECT title FROM articles 
WHERE search_vector @@ to_tsquery('postgres:*')
   OR similarity(title, 'postgres') > 0.4;</code></pre>
                                </div>

                                <!-- Multi-Language -->
                                <div class="bg-white dark:bg-gray-800 rounded-lg p-4 border border-gray-200 dark:border-gray-700">
                                    <h5 class="font-semibold text-gray-800 dark:text-gray-200 mb-2">Multi-Language</h5>
                                    <pre class="bg-gray-100 dark:bg-gray-900 rounded p-2 text-xs overflow-x-auto"><code class="language-sql">-- Detect language and search
SELECT title,
    CASE 
        WHEN language = 'es' THEN 
            to_tsvector('spanish', content)
        ELSE 
            to_tsvector('english', content)
    END @@ plainto_tsquery(search_term)
FROM multilang_articles 
WHERE language IN ('en', 'es');</code></pre>
                                </div>
                            </div>
                        </div>

                        <!-- Performance Optimization -->
                        <div class="bg-gradient-to-r from-green-50 to-emerald-50 dark:from-green-900/20 dark:to-emerald-900/20 p-6 rounded-lg border border-green-200 dark:border-green-700">
                            <h3 class="text-xl font-bold text-green-800 dark:text-green-200 mb-4">
                                <i class="fa-solid fa-rocket mr-2"></i>Performance Optimization
                            </h3>
                            
                            <div class="space-y-4">
                                <!-- Index Types Comparison -->
                                <div class="bg-white dark:bg-gray-800 rounded-lg p-4 border border-gray-200 dark:border-gray-700">
                                    <h4 class="font-semibold text-gray-800 dark:text-gray-200 mb-3">Index Types Comparison</h4>
                                    <div class="overflow-x-auto">
                                        <table class="w-full text-sm border-collapse">
                                            <thead class="bg-gray-50 dark:bg-gray-700">
                                                <tr>
                                                    <th class="border border-gray-300 dark:border-gray-600 px-3 py-2 text-left">Index Type</th>
                                                    <th class="border border-gray-300 dark:border-gray-600 px-3 py-2 text-left">Best For</th>
                                                    <th class="border border-gray-300 dark:border-gray-600 px-3 py-2 text-left">Performance</th>
                                                    <th class="border border-gray-300 dark:border-gray-600 px-3 py-2 text-left">Size</th>
                                                </tr>
                                            </thead>
                                            <tbody>
                                                <tr class="hover:bg-gray-50 dark:hover:bg-gray-800">
                                                    <td class="border border-gray-300 dark:border-gray-600 px-3 py-2 font-mono">GIN</td>
                                                    <td class="border border-gray-300 dark:border-gray-600 px-3 py-2">Complex queries, multiple terms</td>
                                                    <td class="border border-gray-300 dark:border-gray-600 px-3 py-2 text-green-600">Excellent</td>
                                                    <td class="border border-gray-300 dark:border-gray-600 px-3 py-2 text-orange-600">Large</td>
                                                </tr>
                                                <tr class="hover:bg-gray-50 dark:hover:bg-gray-800">
                                                    <td class="border border-gray-300 dark:border-gray-600 px-3 py-2 font-mono">GiST</td>
                                                    <td class="border border-gray-300 dark:border-gray-600 px-3 py-2">Frequent updates, prefix search</td>
                                                    <td class="border border-gray-300 dark:border-gray-600 px-3 py-2 text-yellow-600">Good</td>
                                                    <td class="border border-gray-300 dark:border-gray-600 px-3 py-2 text-green-600">Small</td>
                                                </tr>
                                            </tbody>
                                        </table>
                                    </div>
                                </div>

                                <!-- Optimization Tips -->
                                <div class="grid grid-cols-1 lg:grid-cols-2 gap-4">
                                    <div class="bg-white dark:bg-gray-800 rounded-lg p-4 border border-gray-200 dark:border-gray-700">
                                        <h5 class="font-semibold text-gray-800 dark:text-gray-200 mb-2">Configuration Tuning</h5>
                                        <pre class="bg-gray-100 dark:bg-gray-900 rounded p-2 text-xs overflow-x-auto"><code class="language-sql">-- Optimize GIN parameters
ALTER INDEX idx_articles_search 
SET (gin_pending_list_limit = 1024);

-- Monitor index usage
SELECT schemaname, indexname, idx_scan, idx_tup_read
FROM pg_stat_user_indexes 
WHERE indexname LIKE '%search%';</code></pre>
                                    </div>

                                    <div class="bg-white dark:bg-gray-800 rounded-lg p-4 border border-gray-200 dark:border-gray-700">
                                        <h5 class="font-semibold text-gray-800 dark:text-gray-200 mb-2">Query Optimization</h5>
                                        <pre class="bg-gray-100 dark:bg-gray-900 rounded p-2 text-xs overflow-x-auto"><code class="language-sql">-- Use plainto_tsquery for user input
SELECT title FROM articles 
WHERE search_vector @@ plainto_tsquery('user search input');

-- Combine with LIMIT for pagination
SELECT title, ts_rank(search_vector, query) as rank
FROM articles, plainto_tsquery('search terms') query
WHERE search_vector @@ query
ORDER BY rank DESC LIMIT 20;</code></pre>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- Real-World Use Cases -->
                        <div class="bg-gradient-to-r from-orange-50 to-red-50 dark:from-orange-900/20 dark:to-red-900/20 p-6 rounded-lg border border-orange-200 dark:border-orange-700">
                            <h3 class="text-xl font-bold text-orange-800 dark:text-orange-200 mb-4">
                                <i class="fa-solid fa-lightbulb mr-2"></i>Real-World Use Cases
                            </h3>
                            
                            <div class="grid grid-cols-1 lg:grid-cols-2 gap-6">
                                <!-- E-commerce Search -->
                                <div class="bg-white dark:bg-gray-800 rounded-lg p-4 border border-gray-200 dark:border-gray-700">
                                    <h4 class="font-semibold text-gray-800 dark:text-gray-200 mb-3">
                                        <i class="fa-solid fa-shopping-cart mr-2 text-blue-500"></i>E-commerce Product Search
                                    </h4>
                                    <pre class="bg-gray-100 dark:bg-gray-900 rounded p-3 text-xs overflow-x-auto"><code class="language-sql">-- Product search with category boost
CREATE INDEX idx_products_search ON products USING GIN(
    (setweight(to_tsvector('english', name), 'A') ||
     setweight(to_tsvector('english', description), 'B') ||
     setweight(to_tsvector('english', category), 'C') ||
     setweight(to_tsvector('english', brand), 'D'))
);

-- Search with filters
SELECT p.name, p.price,
    ts_rank_cd(
        setweight(to_tsvector('english', p.name), 'A') ||
        setweight(to_tsvector('english', p.description), 'B'),
        query
    ) as rank
FROM products p, plainto_tsquery('wireless headphones') query
WHERE p.search_vector @@ query
  AND p.price BETWEEN 50 AND 200
  AND p.in_stock = true
ORDER BY rank DESC, p.price ASC;</code></pre>
                                </div>

                                <!-- Document Management -->
                                <div class="bg-white dark:bg-gray-800 rounded-lg p-4 border border-gray-200 dark:border-gray-700">
                                    <h4 class="font-semibold text-gray-800 dark:text-gray-200 mb-3">
                                        <i class="fa-solid fa-file-text mr-2 text-green-500"></i>Document Management System
                                    </h4>
                                    <pre class="bg-gray-100 dark:bg-gray-900 rounded p-3 text-xs overflow-x-auto"><code class="language-sql">-- Document search with metadata
CREATE TABLE documents (
    id SERIAL PRIMARY KEY,
    title TEXT,
    content TEXT,
    author TEXT,
    department TEXT,
    created_at TIMESTAMP,
    search_vector TSVECTOR
);

-- Advanced document search
SELECT d.title, d.author,
    ts_headline('english', d.content, query,
        'MaxWords=25, MinWords=5, StartSel=<mark>, StopSel=</mark>') as snippet,
    ts_rank_cd(d.search_vector, query) as rank
FROM documents d, 
     to_tsquery('english', 'project & (management | planning)') query
WHERE d.search_vector @@ query
  AND d.created_at > NOW() - INTERVAL '1 year'
ORDER BY rank DESC;</code></pre>
                                </div>
                            </div>
                        </div>

                        <!-- Troubleshooting & Monitoring -->
                        <div class="bg-gradient-to-r from-red-50 to-pink-50 dark:from-red-900/20 dark:to-pink-900/20 p-6 rounded-lg border border-red-200 dark:border-red-700">
                            <h3 class="text-xl font-bold text-red-800 dark:text-red-200 mb-4">
                                <i class="fa-solid fa-stethoscope mr-2"></i>Troubleshooting & Monitoring
                            </h3>
                            
                            <div class="grid grid-cols-1 lg:grid-cols-2 gap-4">
                                <!-- Performance Monitoring -->
                                <div class="bg-white dark:bg-gray-800 rounded-lg p-4 border border-gray-200 dark:border-gray-700">
                                    <h5 class="font-semibold text-gray-800 dark:text-gray-200 mb-2">Performance Monitoring</h5>
                                    <pre class="bg-gray-100 dark:bg-gray-900 rounded p-2 text-xs overflow-x-auto"><code class="language-sql">-- Monitor FTS query performance
SELECT query, calls, total_exec_time, mean_exec_time
FROM pg_stat_statements 
WHERE query LIKE '%@@%' OR query LIKE '%to_tsquery%'
ORDER BY mean_exec_time DESC;

-- Check index usage
SELECT schemaname, tablename, indexname, 
       idx_scan, idx_tup_read, idx_tup_fetch
FROM pg_stat_user_indexes 
WHERE indexname LIKE '%gin%';</code></pre>
                                </div>

                                <!-- Common Issues -->
                                <div class="bg-white dark:bg-gray-800 rounded-lg p-4 border border-gray-200 dark:border-gray-700">
                                    <h5 class="font-semibold text-gray-800 dark:text-gray-200 mb-2">Common Issues & Solutions</h5>
                                    <div class="space-y-2 text-sm">
                                        <div class="p-2 bg-yellow-50 dark:bg-yellow-900/20 rounded border-l-4 border-yellow-400">
                                            <strong>Slow Searches:</strong> Check if GIN index exists and is being used
                                        </div>
                                        <div class="p-2 bg-blue-50 dark:bg-blue-900/20 rounded border-l-4 border-blue-400">
                                            <strong>Large Index Size:</strong> Consider using GiST for update-heavy workloads
                                        </div>
                                        <div class="p-2 bg-green-50 dark:bg-green-900/20 rounded border-l-4 border-green-400">
                                            <strong>Poor Relevance:</strong> Implement custom ranking with ts_rank_cd()
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- Configuration Reference -->
                        <div class="bg-gray-50 dark:bg-gray-800 border border-gray-200 dark:border-gray-700 rounded-lg p-6">
                            <h3 class="text-xl font-bold text-gray-800 dark:text-gray-200 mb-4">
                                <i class="fa-solid fa-cog mr-2"></i>Configuration Reference
                            </h3>
                            <div class="grid grid-cols-1 lg:grid-cols-3 gap-4 text-sm">
                                <div>
                                    <h5 class="font-semibold mb-2">Text Search Configuration</h5>
                                    <pre class="bg-gray-100 dark:bg-gray-900 p-2 rounded text-xs"><code>default_text_search_config = 'pg_catalog.english'</code></pre>
                                </div>
                                <div>
                                    <h5 class="font-semibold mb-2">GIN Parameters</h5>
                                    <pre class="bg-gray-100 dark:bg-gray-900 p-2 rounded text-xs"><code>gin_pending_list_limit = 4MB
gin_fuzzy_search_limit = 0</code></pre>
                                </div>
                                <div>
                                    <h5 class="font-semibold mb-2">Memory Settings</h5>
                                    <pre class="bg-gray-100 dark:bg-gray-900 p-2 rounded text-xs"><code>work_mem = 32MB
maintenance_work_mem = 256MB</code></pre>
                                </div>
                            </div>
                        </div>
                    </div>
                    `
                },
                monitoring_templates: {
                    title: "Monitoring Templates",
                    icon: "fa-solid fa-chart-line",
                    intro: "A collection of useful SQL queries for monitoring PostgreSQL health and performance.",
                    templates: [
                        {
                            name: "Find Long Running Queries",
                            query: "SELECT pid, age(clock_timestamp(), query_start), usename, query \nFROM pg_stat_activity \nWHERE state != 'idle' AND query_start < now() - interval '5 minutes' \nORDER BY age(clock_timestamp(), query_start) DESC;"
                        },
                        {
                            name: "Identify Wait Events",
                            query: "SELECT wait_event_type, wait_event, count(*) \nFROM pg_stat_activity \nWHERE state = 'active' \nGROUP BY 1, 2 \nORDER BY count DESC;"
                        },
                        {
                            name: "Analyze Active Locks",
                            query: "SELECT \n  a.datname, \n  l.relation::regclass, \n  l.pid, \n  a.usename, \n  l.mode, \n  l.granted, \n  a.query, \n  age(now(), a.query_start) AS age \nFROM pg_locks l \nJOIN pg_stat_activity a ON l.pid = a.pid \nWHERE l.pid <> pg_backend_pid() \nORDER BY a.query_start;"
                        },
                        {
                            name: "Check for Dead Tuples (Bloat Estimation)",
                            query: "SELECT relname, n_live_tup, n_dead_tup, last_autovacuum, last_autoanalyze \nFROM pg_stat_user_tables \nORDER BY n_dead_tup DESC \nLIMIT 20;"
                        },
                        {
                            name: "Top 10 Largest Tables by Disk Usage",
                            query: "SELECT relname AS table, pg_size_pretty(pg_total_relation_size(relid)) AS total_size \nFROM pg_catalog.pg_statio_user_tables \nORDER BY pg_total_relation_size(relid) DESC \nLIMIT 10;"
                        }
                    ]
                },
                 version_changes: {
                    title: "Version Changes",
                    icon: "fa-solid fa-code-compare",
                    intro: "A comparison of major features introduced in recent PostgreSQL versions.",
                    versions: [
                        { version: "12", partitioning: "Improved performance, attach partitions without blocking.", jsonb_enhancements: "JSONPath support.", parallelism: "Parallelized queries for partitioned tables.", stored_procedures: "SQL-standard `MERGE` command." },
                        { version: "13", partitioning: "Logical replication from partitioned tables.", jsonb_enhancements: "Performance improvements for JSONB.", parallelism: "Parallel VACUUM for indexes.", stored_procedures: "N/A" },
                        { version: "14", partitioning: "Performance improvements for many partitions.", jsonb_enhancements: "JSONB subscripting.", parallelism: "Parallel `REINDEX`.", stored_procedures: "`OUT` parameters in stored procedures." },
                        { version: "15", partitioning: "Row/column filtering for logical replication.", jsonb_enhancements: "SQL/JSON standard functions.", parallelism: "Parallel `SELECT DISTINCT`.", stored_procedures: "`MERGE` command improvements." },
                        { version: "16", partitioning: "Logical replication from standbys.", jsonb_enhancements: "JSON_ARRAY(), JSON_OBJECT() and other standard constructors.", parallelism: "More queries can be parallelized.", stored_procedures: "N/A" }
                    ]
                },
                acid_properties: {
                    title: "ACID Properties",
                    icon: "fa-solid fa-shield-alt",
                    intro: "An explanation of the foundational ACID properties that guarantee transaction reliability in a DBMS.",
                    properties: [
                        {
                            name: "Atomicity",
                            explanation: "Ensures that each transaction is treated as a single, indivisible 'unit'. Either the entire transaction completes successfully, or none of it does. If any part of the transaction fails, the entire transaction is rolled back, leaving the database unchanged.",
                            example: "BEGIN;\n-- Transfer $100 from Account A to Account B\nUPDATE accounts SET balance = balance - 100 WHERE account_id = 'A';\nUPDATE accounts SET balance = balance + 100 WHERE account_id = 'B';\n-- If the server crashes here, the entire transaction is rolled back.\nCOMMIT;",
                            visual: `<svg width="100%" viewBox="0 0 400 150" xmlns="http://www.w3.org/2000/svg"><style>.txt{font-family:Inter,sans-serif;font-size:10px;}.dark .txt{fill:white;} .dark .line{stroke:white;} .dark .box{stroke:white;}</style><rect x="20" y="30" width="120" height="40" rx="5" fill="#e0f2fe" class="box" stroke="#38bdf8"/><text x="80" y="55" text-anchor="middle" class="txt">BEGIN Transaction</text><rect x="180" y="30" width="100" height="40" rx="5" fill="#dcfce7" class="box" stroke="#22c55e"/><text x="230" y="55" text-anchor="middle" class="txt">All Steps OK</text><rect x="180" y="90" width="100" height="40" rx="5" fill="#fee2e2" class="box" stroke="#ef4444"/><text x="230" y="115" text-anchor="middle" class="txt">Any Step Fails</text><rect x="300" y="30" width="80" height="40" rx="5" fill="#dcfce7" class="box" stroke="#22c55e"/><text x="340" y="55" text-anchor="middle" class="txt">COMMIT</text><rect x="300" y="90" width="80" height="40" rx="5" fill="#fee2e2" class="box" stroke="#ef4444"/><text x="340" y="115" text-anchor="middle" class="txt">ROLLBACK</text><path d="M 140 50 h 40" stroke="#64748b" class="line" stroke-width="2" marker-end="url(#arrow)"/><path d="M 140 70 h 40" stroke="#64748b" class="line" stroke-width="2" marker-end="url(#arrow)"/><path d="M 280 50 h 20" stroke="#64748b" class="line" stroke-width="2" marker-end="url(#arrow)"/><path d="M 280 110 h 20" stroke="#64748b" class="line" stroke-width="2" marker-end="url(#arrow)"/><defs><marker id="arrow" viewBox="0 0 10 10" refX="5" refY="5" markerWidth="6" markerHeight="6" orient="auto-start-reverse"><path d="M 0 0 L 10 5 L 0 10 z" fill="#64748b"/></marker></defs></svg>`,
                            use_case: "Critical for financial transactions, like transferring money between bank accounts. You wouldn't want to debit one account without crediting the other."
                        },
                        {
                            name: "Consistency",
                            explanation: "Guarantees that a transaction can only bring the database from one valid state to another. Any data written to the database must be valid according to all defined rules, including constraints, cascades, and triggers.",
                            example: "-- Assuming a CHECK constraint: ALTER TABLE products ADD CONSTRAINT price_check CHECK (price > 0);\n-- This transaction will fail because it violates the consistency rule.\nINSERT INTO products (id, name, price) VALUES (1, 'New Product', -50);",
                            visual: `<svg width="100%" viewBox="0 0 400 120" xmlns="http://www.w3.org/2000/svg"><style>.txt{font-family:Inter,sans-serif;font-size:10px;}.dark .txt{fill:white;} .dark .line{stroke:white;} .dark .box{stroke:white;}</style><rect x="20" y="40" width="100" height="40" rx="5" fill="#dcfce7" class="box" stroke="#22c55e"/><text x="70" y="65" text-anchor="middle" class="txt">Valid State 1</text><rect x="280" y="40" width="100" height="40" rx="5" fill="#dcfce7" class="box" stroke="#22c55e"/><text x="330" y="65" text-anchor="middle" class="txt">Valid State 2</text><rect x="150" y="10" width="100" height="30" rx="5" fill="#e0f2fe" class="box" stroke="#38bdf8"/><text x="200" y="28" text-anchor="middle" class="txt">Valid Txn</text><rect x="150" y="80" width="100" height="30" rx="5" fill="#fee2e2" class="box" stroke="#ef4444"/><text x="200" y="98" text-anchor="middle" class="txt">Invalid Txn</text><path d="M 120 60 h 30" stroke="#64748b" class="line" stroke-width="2" marker-end="url(#arrow)"/><path d="M 250 25 h 30" stroke="#64748b" class="line" stroke-width="2" marker-end="url(#arrow)"/><path d="M 120 60 q 30 40 60 40" stroke="#64748b" class="line" stroke-width="2" fill="none" marker-end="url(#arrow)"/><path d="M 250 95 q -30 -40 -60 -40" stroke="#ef4444" class="line" stroke-width="2" fill="none" marker-end="url(#arrow-red)"/><defs><marker id="arrow" viewBox="0 0 10 10" refX="5" refY="5" markerWidth="6" markerHeight="6" orient="auto-start-reverse"><path d="M 0 0 L 10 5 L 0 10 z" fill="#64748b"/></marker><marker id="arrow-red" viewBox="0 0 10 10" refX="5" refY="5" markerWidth="6" markerHeight="6" orient="auto-start-reverse"><path d="M 0 0 L 10 5 L 0 10 z" fill="#ef4444"/></marker></defs></svg>`,
                            use_case: "Essential for systems with business rules, like an inventory system where stock levels cannot be negative, or ensuring a user's email is unique."
                        },
                        {
                            name: "Isolation",
                            explanation: "Ensures that concurrent transactions do not interfere with each other. The results of a transaction are not visible to other transactions until it is committed. This prevents issues like dirty reads. PostgreSQL achieves this via its MVCC architecture.",
                            example: "-- Txn 1: BEGIN; SELECT SUM(balance) FROM accounts; -- Sees initial total\n-- Txn 2: BEGIN; UPDATE accounts SET balance = balance - 100 WHERE id=1; COMMIT;\n-- Txn 1: SELECT SUM(balance) FROM accounts; -- Still sees the same initial total until it commits or starts a new transaction.",
                            visual: `<svg width="100%" viewBox="0 0 400 120" xmlns="http://www.w3.org/2000/svg"><style>.txt{font-family:Inter,sans-serif;font-size:10px;}.dark .txt{fill:white;} .dark .line{stroke:white;} .dark .box{stroke:white;}</style><rect x="20" y="20" width="100" height="30" rx="5" fill="#e0f2fe" class="box" stroke="#38bdf8"/><text x="70" y="38" text-anchor="middle" class="txt">Transaction A</text><rect x="20" y="70" width="100" height="30" rx="5" fill="#e0f2fe" class="box" stroke="#38bdf8"/><text x="70" y="88" text-anchor="middle" class="txt">Transaction B</text><rect x="150" y="45" width="100" height="30" rx="5" fill="#f3e8ff" class="box" stroke="#8b5cf6"/><text x="200" y="63" text-anchor="middle" class="txt">Database</text><rect x="280" y="20" width="100" height="30" rx="5" fill="#dcfce7" class="box" stroke="#22c55e"/><text x="330" y="38" text-anchor="middle" class="txt">Snapshot A</text><rect x="280" y="70" width="100" height="30" rx="5" fill="#dcfce7" class="box" stroke="#22c55e"/><text x="330" y="88" text-anchor="middle" class="txt">Snapshot B</text><path d="M 120 35 h 30" stroke="#64748b" class="line" stroke-width="2" marker-end="url(#arrow)"/><path d="M 120 85 h 30" stroke="#64748b" class="line" stroke-width="2" marker-end="url(#arrow)"/><path d="M 250 35 h 30" stroke="#64748b" class="line" stroke-width="2" marker-end="url(#arrow)"/><path d="M 250 85 h 30" stroke="#64748b" class="line" stroke-width="2" marker-end="url(#arrow)"/><defs><marker id="arrow" viewBox="0 0 10 10" refX="5" refY="5" markerWidth="6" markerHeight="6" orient="auto-start-reverse"><path d="M 0 0 L 10 5 L 0 10 z" fill="#64748b"/></marker></defs></svg>`,
                            use_case: "Vital for any high-concurrency system, such as a booking website where multiple users might try to book the last available seat at the same time."
                        },
                        {
                            name: "Durability",
                            explanation: "Guarantees that once a transaction has been committed, it will remain committed even in the event of a system failure (e.g., power outage or crash). This is typically achieved by writing transaction logs (like PostgreSQL's WAL) to non-volatile storage.",
                            example: "INSERT INTO orders (product_id, quantity) VALUES (123, 1);\nCOMMIT;\n-- Once COMMIT returns success, this order is permanently saved, even if the power goes out immediately after.",
                            visual: `<svg width="100%" viewBox="0 0 400 120" xmlns="http://www.w3.org/2000/svg"><style>.txt{font-family:Inter,sans-serif;font-size:10px;}.dark .txt{fill:white;} .dark .line{stroke:white;} .dark .box{stroke:white;}</style><rect x="20" y="40" width="80" height="40" rx="5" fill="#e0f2fe" class="box" stroke="#38bdf8"/><text x="60" y="65" text-anchor="middle" class="txt">COMMIT</text><rect x="140" y="40" width="120" height="40" rx="5" fill="#dcfce7" class="box" stroke="#22c55e"/><text x="200" y="65" text-anchor="middle" class="txt">Write to WAL on Disk</text><path d="M 100 60 h 40" stroke="#64748b" class="line" stroke-width="2" marker-end="url(#arrow)"/><path d="M 260 60 h 20" stroke="#64748b" class="line" stroke-width="2" marker-end="url(#arrow)"/><g transform="translate(280, 40)"><path d="M10 0 L20 0 L20 10 L30 10 L30 20 L20 20 L20 30 L10 30 L10 20 L0 20 L0 10 L10 10 Z" fill="#fde047"/><path d="M12 12 L18 18 M12 18 L18 12" stroke="black" stroke-width="2"/></g><text x="340" y="65" text-anchor="middle" class="txt">Power Failure</text><defs><marker id="arrow" viewBox="0 0 10 10" refX="5" refY="5" markerWidth="6" markerHeight="6" orient="auto-start-reverse"><path d="M 0 0 L 10 5 L 0 10 z" fill="#64748b"/></marker></defs></svg>`,
                            use_case: "Absolutely essential for any system where data loss is unacceptable, such as e-commerce order processing, medical records, or audit logs."
                        }
                    ]
                },
                mvcc_explained: {
                    title: "MVCC Explained",
                    icon: "fa-solid fa-layer-group",
                    content: `<div class="prose dark:prose-invert max-w-none space-y-12">
                        <div class="p-4 bg-base-100 dark:bg-base-800 rounded-lg">
                            <h3 class="text-lg font-semibold">Table of Contents</h3>
                            <ul class="mt-2 list-disc list-inside space-y-1">
                                <li><a href="#what-is-mvcc" class="text-primary-600 dark:text-primary-400 hover:underline">What is PostgreSQL MVCC?</a></li>
                                <li><a href="#postgresql-implementation" class="text-primary-600 dark:text-primary-400 hover:underline">PostgreSQL's MVCC Implementation</a></li>
                                <li><a href="#transaction-snapshots" class="text-primary-600 dark:text-primary-400 hover:underline">Transaction Snapshots & Visibility</a></li>
                                <li><a href="#tuple-lifecycle" class="text-primary-600 dark:text-primary-400 hover:underline">Tuple Lifecycle & Version Management</a></li>
                                <li><a href="#vacuum-autovacuum" class="text-primary-600 dark:text-primary-400 hover:underline">VACUUM & Autovacuum Deep Dive</a></li>
                                <li><a href="#practical-implications" class="text-primary-600 dark:text-primary-400 hover:underline">Practical Implications & Best Practices</a></li>
                                <li><a href="#monitoring-mvcc" class="text-primary-600 dark:text-primary-400 hover:underline">Monitoring MVCC Performance</a></li>
                                <li><a href="#useful-resources" class="text-primary-600 dark:text-primary-400 hover:underline">Additional Resources</a></li>
                            </ul>
                        </div>

                        <div id="what-is-mvcc">
                            <h2 class="text-2xl font-bold border-b pb-2 mb-4">What is PostgreSQL MVCC?</h2>
                            <p>Multi-Version Concurrency Control (MVCC) is PostgreSQL's core concurrency mechanism that allows multiple transactions to read and write data simultaneously without blocking each other. Unlike traditional locking mechanisms, MVCC maintains multiple versions of data to ensure <strong>isolation</strong> and <strong>consistency</strong>.</p>
                            
                            <div class="bg-blue-50 dark:bg-blue-900/20 border border-blue-200 dark:border-blue-800 rounded-lg p-4 my-4">
                                <h4 class="font-semibold text-blue-800 dark:text-blue-200 mb-2">Key Benefits of PostgreSQL MVCC:</h4>
                                <ul class="list-disc list-inside space-y-1 text-blue-700 dark:text-blue-300">
                                    <li><strong>Readers never block writers</strong> - SELECT queries don't interfere with UPDATE/DELETE operations</li>
                                    <li><strong>Writers never block readers</strong> - Data modifications don't prevent SELECT queries</li>
                                    <li><strong>No read locks required</strong> - Eliminates deadlock scenarios involving read operations</li>
                                    <li><strong>Point-in-time consistency</strong> - Each transaction sees a consistent snapshot of data</li>
                                </ul>
                            </div>
                        </div>

                        <div id="postgresql-implementation">
                            <h2 class="text-2xl font-bold border-b pb-2 mb-4">PostgreSQL's MVCC Implementation</h2>
                            <p>PostgreSQL implements MVCC through a combination of transaction IDs (XIDs), tuple headers, and visibility rules. Every row (tuple) in PostgreSQL contains hidden system columns that track its lifecycle.</p>
                            
                            <h3 class="text-xl font-semibold mt-6 mb-3">Hidden System Columns</h3>
                            <div class="overflow-x-auto">
                                <table class="min-w-full border border-base-300 dark:border-base-600">
                                    <thead class="bg-base-100 dark:bg-base-800">
                                        <tr>
                                            <th class="border border-base-300 dark:border-base-600 px-4 py-2 text-left">Column</th>
                                            <th class="border border-base-300 dark:border-base-600 px-4 py-2 text-left">Purpose</th>
                                            <th class="border border-base-300 dark:border-base-600 px-4 py-2 text-left">Description</th>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        <tr>
                                            <td class="border border-base-300 dark:border-base-600 px-4 py-2 font-mono">xmin</td>
                                            <td class="border border-base-300 dark:border-base-600 px-4 py-2">Creation XID</td>
                                            <td class="border border-base-300 dark:border-base-600 px-4 py-2">Transaction ID that inserted this tuple version</td>
                                        </tr>
                                        <tr>
                                            <td class="border border-base-300 dark:border-base-600 px-4 py-2 font-mono">xmax</td>
                                            <td class="border border-base-300 dark:border-base-600 px-4 py-2">Deletion XID</td>
                                            <td class="border border-base-300 dark:border-base-600 px-4 py-2">Transaction ID that deleted/updated this tuple (0 if not deleted)</td>
                                        </tr>
                                        <tr>
                                            <td class="border border-base-300 dark:border-base-600 px-4 py-2 font-mono">cmin</td>
                                            <td class="border border-base-300 dark:border-base-600 px-4 py-2">Command ID</td>
                                            <td class="border border-base-300 dark:border-base-600 px-4 py-2">Command number within creating transaction</td>
                                        </tr>
                                        <tr>
                                            <td class="border border-base-300 dark:border-base-600 px-4 py-2 font-mono">cmax</td>
                                            <td class="border border-base-300 dark:border-base-600 px-4 py-2">Command ID</td>
                                            <td class="border border-base-300 dark:border-base-600 px-4 py-2">Command number within deleting transaction</td>
                                        </tr>
                                        <tr>
                                            <td class="border border-base-300 dark:border-base-600 px-4 py-2 font-mono">ctid</td>
                                            <td class="border border-base-300 dark:border-base-600 px-4 py-2">Physical Location</td>
                                            <td class="border border-base-300 dark:border-base-600 px-4 py-2">Physical location (page, slot) of this tuple version</td>
                                        </tr>
                                    </tbody>
                                </table>
                            </div>
                            
                            <div class="mt-4">
                                <h4 class="font-semibold mb-2">Example: Viewing Hidden Columns</h4>
                                <pre><code class="language-sql">-- Create a test table
CREATE TABLE users (id SERIAL PRIMARY KEY, name TEXT, email TEXT);
INSERT INTO users (name, email) VALUES ('Alice', 'alice@example.com');

-- View hidden system columns
SELECT xmin, xmax, cmin, cmax, ctid, * FROM users;</code></pre>
                            </div>
                        </div>

                        <div id="transaction-snapshots">
                            <h2 class="text-2xl font-bold border-b pb-2 mb-4">Transaction Snapshots & Visibility</h2>
                            <p>PostgreSQL uses transaction snapshots to determine which tuple versions are visible to each transaction. A snapshot contains information about which transactions were active when the snapshot was taken.</p>
                            
                            <h3 class="text-xl font-semibold mt-6 mb-3">Visibility Rules</h3>
                            <div class="bg-green-50 dark:bg-green-900/20 border border-green-200 dark:border-green-800 rounded-lg p-4 my-4">
                                <p class="font-semibold text-green-800 dark:text-green-200 mb-2">A tuple is visible to a transaction if:</p>
                                <ol class="list-decimal list-inside space-y-1 text-green-700 dark:text-green-300">
                                    <li>The tuple was inserted by a committed transaction that started before the current transaction's snapshot</li>
                                    <li>The tuple was not deleted, or was deleted by a transaction that either:
                                        <ul class="list-disc list-inside ml-4 mt-1">
                                            <li>Has not yet committed</li>
                                            <li>Committed after the current transaction's snapshot</li>
                                        </ul>
                                    </li>
                                </ol>
                            </div>

                            <h3 class="text-xl font-semibold mt-6 mb-3">Isolation Levels in PostgreSQL</h3>
                            <div class="overflow-x-auto">
                                <table class="min-w-full border border-base-300 dark:border-base-600">
                                    <thead class="bg-base-100 dark:bg-base-800">
                                        <tr>
                                            <th class="border border-base-300 dark:border-base-600 px-4 py-2 text-left">Isolation Level</th>
                                            <th class="border border-base-300 dark:border-base-600 px-4 py-2 text-left">Dirty Read</th>
                                            <th class="border border-base-300 dark:border-base-600 px-4 py-2 text-left">Non-Repeatable Read</th>
                                            <th class="border border-base-300 dark:border-base-600 px-4 py-2 text-left">Phantom Read</th>
                                            <th class="border border-base-300 dark:border-base-600 px-4 py-2 text-left">Serialization Anomaly</th>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        <tr>
                                            <td class="border border-base-300 dark:border-base-600 px-4 py-2 font-mono">READ UNCOMMITTED</td>
                                            <td class="border border-base-300 dark:border-base-600 px-4 py-2 text-red-600">Allowed</td>
                                            <td class="border border-base-300 dark:border-base-600 px-4 py-2 text-red-600">Possible</td>
                                            <td class="border border-base-300 dark:border-base-600 px-4 py-2 text-red-600">Possible</td>
                                            <td class="border border-base-300 dark:border-base-600 px-4 py-2 text-red-600">Possible</td>
                                        </tr>
                                        <tr>
                                            <td class="border border-base-300 dark:border-base-600 px-4 py-2 font-mono">READ COMMITTED</td>
                                            <td class="border border-base-300 dark:border-base-600 px-4 py-2 text-green-600">Not possible</td>
                                            <td class="border border-base-300 dark:border-base-600 px-4 py-2 text-red-600">Possible</td>
                                            <td class="border border-base-300 dark:border-base-600 px-4 py-2 text-red-600">Possible</td>
                                            <td class="border border-base-300 dark:border-base-600 px-4 py-2 text-red-600">Possible</td>
                                        </tr>
                                        <tr>
                                            <td class="border border-base-300 dark:border-base-600 px-4 py-2 font-mono">REPEATABLE READ</td>
                                            <td class="border border-base-300 dark:border-base-600 px-4 py-2 text-green-600">Not possible</td>
                                            <td class="border border-base-300 dark:border-base-600 px-4 py-2 text-green-600">Not possible</td>
                                            <td class="border border-base-300 dark:border-base-600 px-4 py-2 text-green-600">Not possible*</td>
                                            <td class="border border-base-300 dark:border-base-600 px-4 py-2 text-red-600">Possible</td>
                                        </tr>
                                        <tr>
                                            <td class="border border-base-300 dark:border-base-600 px-4 py-2 font-mono">SERIALIZABLE</td>
                                            <td class="border border-base-300 dark:border-base-600 px-4 py-2 text-green-600">Not possible</td>
                                            <td class="border border-base-300 dark:border-base-600 px-4 py-2 text-green-600">Not possible</td>
                                            <td class="border border-base-300 dark:border-base-600 px-4 py-2 text-green-600">Not possible</td>
                                            <td class="border border-base-300 dark:border-base-600 px-4 py-2 text-green-600">Not possible</td>
                                        </tr>
                                    </tbody>
                                </table>
                            </div>
                            <p class="text-sm text-base-600 dark:text-base-400 mt-2">* PostgreSQL's REPEATABLE READ actually provides stronger guarantees than the SQL standard requires</p>
                        </div>

                        <div id="tuple-lifecycle">
                            <h2 class="text-2xl font-bold border-b pb-2 mb-4">Tuple Lifecycle & Version Management</h2>
                            <p>Understanding how PostgreSQL manages tuple versions is crucial for optimizing database performance and storage usage.</p>
                            
                            <h3 class="text-xl font-semibold mt-6 mb-3">UPDATE Operation Example</h3>
                            <p>Let's trace through a complete UPDATE operation to see how MVCC works:</p>
                            
                            <div class="bg-base-100 dark:bg-base-800 rounded-lg p-4 my-6">
                                <pre><code class="language-sql">-- Initial state
INSERT INTO users (name, email) VALUES ('Alice', 'alice@old.com');
-- Creates tuple: (id=1, name='Alice', email='alice@old.com', xmin=100, xmax=0)

-- Later, in transaction 105
BEGIN;
UPDATE users SET email = 'alice@new.com' WHERE id = 1;
-- PostgreSQL does NOT modify the existing tuple in place
-- Instead it:
-- 1. Marks old tuple as deleted: xmax = 105
-- 2. Creates new tuple: (id=1, name='Alice', email='alice@new.com', xmin=105, xmax=0)
COMMIT;</code></pre>
                            </div>

                            <div class="my-6 p-4 border rounded-lg bg-base-100 dark:bg-base-700">
                                <h4 class="font-semibold mb-3">Visual Representation</h4>
                                <svg width="100%" viewBox="0 0 500 180" xmlns="http://www.w3.org/2000/svg">
                                    <style>.txt{font-family:Inter,sans-serif;font-size:9px;}.dark .txt{fill:white;} .dark .line{stroke:white;} .dark .box{stroke:white;}</style>
                                    <rect x="20" y="60" width="160" height="60" rx="5" fill="#e0f2fe" class="box" stroke="#38bdf8"/>
                                    <text x="100" y="78" text-anchor="middle" class="txt font-bold">Original Tuple (v1)</text>
                                    <text x="100" y="92" text-anchor="middle" class="txt">id=1, name='Alice'</text>
                                    <text x="100" y="105" text-anchor="middle" class="txt">email='alice@old.com'</text>
                                    <text x="100" y="118" text-anchor="middle" class="txt">xmin=100, xmax=0</text>
                                    
                                    <rect x="320" y="30" width="160" height="60" rx="5" fill="#fee2e2" class="box" stroke="#ef4444"/>
                                    <text x="400" y="48" text-anchor="middle" class="txt font-bold">Old Tuple (v1 - Dead)</text>
                                    <text x="400" y="62" text-anchor="middle" class="txt">id=1, name='Alice'</text>
                                    <text x="400" y="75" text-anchor="middle" class="txt">email='alice@old.com'</text>
                                    <text x="400" y="88" text-anchor="middle" class="txt">xmin=100, xmax=105</text>
                                    
                                    <rect x="320" y="100" width="160" height="60" rx="5" fill="#dcfce7" class="box" stroke="#22c55e"/>
                                    <text x="400" y="118" text-anchor="middle" class="txt font-bold">New Tuple (v2 - Live)</text>
                                    <text x="400" y="132" text-anchor="middle" class="txt">id=1, name='Alice'</text>
                                    <text x="400" y="145" text-anchor="middle" class="txt">email='alice@new.com'</text>
                                    <text x="400" y="158" text-anchor="middle" class="txt">xmin=105, xmax=0</text>
                                    
                                    <path d="M 180 90 h 140" stroke="#64748b" class="line" stroke-width="2" marker-end="url(#arrow)"/>
                                    <text x="250" y="85" text-anchor="middle" class="txt">UPDATE (Txn 105)</text>
                                    <text x="250" y="100" text-anchor="middle" class="txt">Creates new version</text>
                                    
                                    <defs>
                                        <marker id="arrow" viewBox="0 0 10 10" refX="5" refY="5" markerWidth="6" markerHeight="6" orient="auto-start-reverse">
                                            <path d="M 0 0 L 10 5 L 0 10 z" fill="#64748b"/>
                                        </marker>
                                    </defs>
                                </svg>
                            </div>

                            <h3 class="text-xl font-semibold mt-6 mb-3">Hot and Cold Data</h3>
                            <p>PostgreSQL optimizes storage through HOT (Heap-Only Tuples) updates when possible:</p>
                            <ul class="list-disc list-inside space-y-2 mt-3">
                                <li><strong>HOT Updates:</strong> When updated columns are not indexed, new tuple versions can be stored in the same page</li>
                                <li><strong>Cold Updates:</strong> When indexed columns change, index entries must be updated, preventing HOT optimization</li>
                                <li><strong>Fill Factor:</strong> Controls page space reservation for HOT updates (default 100%)</li>
                            </ul>
                        </div>

                        <div id="vacuum-autovacuum">
                            <h2 class="text-2xl font-bold border-b pb-2 mb-4">VACUUM & Autovacuum Deep Dive</h2>
                            <p>The VACUUM process is essential for maintaining PostgreSQL performance by cleaning up dead tuples and preventing transaction ID wraparound.</p>
                            
                            <h3 class="text-xl font-semibold mt-6 mb-3">VACUUM Operations</h3>
                            <div class="grid grid-cols-1 md:grid-cols-2 gap-4 my-4">
                                <div class="bg-blue-50 dark:bg-blue-900/20 border border-blue-200 dark:border-blue-800 rounded-lg p-4">
                                    <h4 class="font-semibold text-blue-800 dark:text-blue-200 mb-2">Regular VACUUM</h4>
                                    <ul class="list-disc list-inside space-y-1 text-blue-700 dark:text-blue-300 text-sm">
                                        <li>Removes dead tuples</li>
                                        <li>Updates visibility map</li>
                                        <li>Allows concurrent reads/writes</li>
                                        <li>Reclaims space for reuse</li>
                                        <li>Prevents XID wraparound</li>
                                    </ul>
                                </div>
                                <div class="bg-orange-50 dark:bg-orange-900/20 border border-orange-200 dark:border-orange-800 rounded-lg p-4">
                                    <h4 class="font-semibold text-orange-800 dark:text-orange-200 mb-2">VACUUM FULL</h4>
                                    <ul class="list-disc list-inside space-y-1 text-orange-700 dark:text-orange-300 text-sm">
                                        <li>Completely rebuilds table</li>
                                        <li>Returns space to OS</li>
                                        <li>Requires exclusive lock</li>
                                        <li>Much slower operation</li>
                                        <li>Should be used sparingly</li>
                                    </ul>
                                </div>
                            </div>

                            <h3 class="text-xl font-semibold mt-6 mb-3">Autovacuum Configuration</h3>
                            <div class="overflow-x-auto">
                                <table class="min-w-full border border-base-300 dark:border-base-600">
                                    <thead class="bg-base-100 dark:bg-base-800">
                                        <tr>
                                            <th class="border border-base-300 dark:border-base-600 px-4 py-2 text-left">Parameter</th>
                                            <th class="border border-base-300 dark:border-base-600 px-4 py-2 text-left">Default</th>
                                            <th class="border border-base-300 dark:border-base-600 px-4 py-2 text-left">Description</th>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        <tr>
                                            <td class="border border-base-300 dark:border-base-600 px-4 py-2 font-mono">autovacuum</td>
                                            <td class="border border-base-300 dark:border-base-600 px-4 py-2">on</td>
                                            <td class="border border-base-300 dark:border-base-600 px-4 py-2">Enable autovacuum daemon</td>
                                        </tr>
                                        <tr>
                                            <td class="border border-base-300 dark:border-base-600 px-4 py-2 font-mono">autovacuum_max_workers</td>
                                            <td class="border border-base-300 dark:border-base-600 px-4 py-2">3</td>
                                            <td class="border border-base-300 dark:border-base-600 px-4 py-2">Maximum autovacuum worker processes</td>
                                        </tr>
                                        <tr>
                                            <td class="border border-base-300 dark:border-base-600 px-4 py-2 font-mono">autovacuum_vacuum_threshold</td>
                                            <td class="border border-base-300 dark:border-base-600 px-4 py-2">50</td>
                                            <td class="border border-base-300 dark:border-base-600 px-4 py-2">Minimum dead tuples to trigger vacuum</td>
                                        </tr>
                                        <tr>
                                            <td class="border border-base-300 dark:border-base-600 px-4 py-2 font-mono">autovacuum_vacuum_scale_factor</td>
                                            <td class="border border-base-300 dark:border-base-600 px-4 py-2">0.2</td>
                                            <td class="border border-base-300 dark:border-base-600 px-4 py-2">Fraction of table size as dead tuple threshold</td>
                                        </tr>
                                    </tbody>
                                </table>
                            </div>

                            <div class="mt-4">
                                <h4 class="font-semibold mb-2">Monitoring VACUUM Activity</h4>
                                <pre><code class="language-sql">-- Check autovacuum activity
SELECT schemaname, tablename, last_vacuum, last_autovacuum, 
       last_analyze, last_autoanalyze, n_dead_tup, n_live_tup
FROM pg_stat_user_tables 
ORDER BY n_dead_tup DESC;

-- Monitor current autovacuum processes
SELECT pid, datname, usename, application_name, state, query
FROM pg_stat_activity 
WHERE application_name LIKE '%autovacuum%';</code></pre>
                            </div>
                        </div>

                        <div id="practical-implications">
                            <h2 class="text-2xl font-bold border-b pb-2 mb-4">Practical Implications & Best Practices</h2>
                            
                            <h3 class="text-xl font-semibold mt-6 mb-3">Performance Considerations</h3>
                            <div class="space-y-4">
                                <div class="bg-green-50 dark:bg-green-900/20 border border-green-200 dark:border-green-800 rounded-lg p-4">
                                    <h4 class="font-semibold text-green-800 dark:text-green-200 mb-2">âœ… Best Practices</h4>
                                    <ul class="list-disc list-inside space-y-1 text-green-700 dark:text-green-300">
                                        <li>Keep transactions short to minimize bloat</li>
                                        <li>Monitor and tune autovacuum settings</li>
                                        <li>Use HOT updates when possible (avoid updating indexed columns unnecessarily)</li>
                                        <li>Set appropriate fill factors for heavily updated tables</li>
                                        <li>Regular monitoring of table bloat and dead tuples</li>
                                    </ul>
                                </div>
                                
                                <div class="bg-red-50 dark:bg-red-900/20 border border-red-200 dark:border-red-800 rounded-lg p-4">
                                    <h4 class="font-semibold text-red-800 dark:text-red-200 mb-2">âŒ Common Pitfalls</h4>
                                    <ul class="list-disc list-inside space-y-1 text-red-700 dark:text-red-300">
                                        <li>Long-running transactions blocking VACUUM</li>
                                        <li>Frequent updates to indexed columns causing excessive bloat</li>
                                        <li>Insufficient autovacuum workers for high-write workloads</li>
                                        <li>Ignoring transaction ID wraparound warnings</li>
                                        <li>Using VACUUM FULL unnecessarily in production</li>
                                    </ul>
                                </div>
                            </div>

                            <h3 class="text-xl font-semibold mt-6 mb-3">Bloat Management</h3>
                            <pre><code class="language-sql">-- Estimate table bloat
SELECT schemaname, tablename, 
       round(100 * n_dead_tup / (n_live_tup + n_dead_tup), 2) AS bloat_pct,
       pg_size_pretty(pg_total_relation_size(schemaname||'.'||tablename)) AS size
FROM pg_stat_user_tables 
WHERE n_live_tup > 0 
ORDER BY bloat_pct DESC;</code></pre>
                        </div>

                        <div id="monitoring-mvcc">
                            <h2 class="text-2xl font-bold border-b pb-2 mb-4">Monitoring MVCC Performance</h2>
                            
                            <h3 class="text-xl font-semibold mt-6 mb-3">Key Metrics to Monitor</h3>
                            <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                                <div>
                                    <h4 class="font-semibold mb-2">Transaction Activity</h4>
                                    <pre><code class="language-sql">-- Current transaction IDs and age
SELECT datname, 
       age(datfrozenxid) as xid_age,
       2^31 - age(datfrozenxid) as xids_left
FROM pg_database;</code></pre>
                                </div>
                                <div>
                                    <h4 class="font-semibold mb-2">Long-Running Transactions</h4>
                                    <pre><code class="language-sql">-- Find blocking transactions
SELECT pid, usename, state,
       age(now(), xact_start) as duration,
       left(query, 50) as query
FROM pg_stat_activity 
WHERE state IN ('idle in transaction', 'active')
  AND xact_start < now() - interval '5 minutes';</code></pre>
                                </div>
                            </div>

                            <h3 class="text-xl font-semibold mt-6 mb-3">VACUUM Performance</h3>
                            <pre><code class="language-sql">-- VACUUM statistics
SELECT schemaname, tablename,
       n_tup_ins, n_tup_upd, n_tup_del,
       n_live_tup, n_dead_tup,
       last_vacuum, last_autovacuum,
       vacuum_count, autovacuum_count
FROM pg_stat_user_tables 
ORDER BY n_dead_tup DESC LIMIT 10;</code></pre>
                        </div>

                        <div id="useful-resources">
                            <h2 class="text-2xl font-bold border-b pb-2 mb-4">Additional Resources</h2>
                            
                            <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                                <div>
                                    <h3 class="text-lg font-semibold mb-3">ðŸ“š Official Documentation</h3>
                                    <ul class="space-y-2">
                                        <li><a href="https://www.postgresql.org/docs/current/mvcc.html" target="_blank" class="text-primary-600 dark:text-primary-400 hover:underline">PostgreSQL MVCC Documentation</a></li>
                                        <li><a href="https://www.postgresql.org/docs/current/routine-vacuuming.html" target="_blank" class="text-primary-600 dark:text-primary-400 hover:underline">Routine Database Maintenance Tasks</a></li>
                                        <li><a href="https://www.postgresql.org/docs/current/runtime-config-autovacuum.html" target="_blank" class="text-primary-600 dark:text-primary-400 hover:underline">Autovacuum Configuration</a></li>
                                        <li><a href="https://www.postgresql.org/docs/current/transaction-iso.html" target="_blank" class="text-primary-600 dark:text-primary-400 hover:underline">Transaction Isolation</a></li>
                                    </ul>
                                </div>
                                
                                <div>
                                    <h3 class="text-lg font-semibold mb-3">ðŸ”§ Tools & Extensions</h3>
                                    <ul class="space-y-2">
                                        <li><a href="https://github.com/ioguix/pgsql-bloat-estimation" target="_blank" class="text-primary-600 dark:text-primary-400 hover:underline">pgstattuple - Bloat Estimation</a></li>
                                        <li><a href="https://github.com/pgexperts/pgx_scripts" target="_blank" class="text-primary-600 dark:text-primary-400 hover:underline">PostgreSQL Monitoring Scripts</a></li>
                                        <li><a href="https://github.com/cybertec-postgresql/pg_squeeze" target="_blank" class="text-primary-600 dark:text-primary-400 hover:underline">pg_squeeze - Online Table Cleanup</a></li>
                                        <li><a href="https://github.com/dalibo/pg_activity" target="_blank" class="text-primary-600 dark:text-primary-400 hover:underline">pg_activity - Real-time Activity Monitor</a></li>
                                    </ul>
                                </div>
                                
                                <div>
                                    <h3 class="text-lg font-semibold mb-3">ðŸ“– In-Depth Articles</h3>
                                    <ul class="space-y-2">
                                        <li><a href="https://momjian.us/main/writings/pgsql/mvcc.pdf" target="_blank" class="text-primary-600 dark:text-primary-400 hover:underline">Bruce Momjian's MVCC Presentation</a></li>
                                        <li><a href="https://www.cybertec-postgresql.com/en/understanding-postgresql-mvcc/" target="_blank" class="text-primary-600 dark:text-primary-400 hover:underline">Cybertec MVCC Deep Dive</a></li>
                                        <li><a href="https://habr.com/en/company/postgrespro/blog/458186/" target="_blank" class="text-primary-600 dark:text-primary-400 hover:underline">PostgresPro MVCC Internals</a></li>
                                    </ul>
                                </div>
                                
                                <div>
                                    <h3 class="text-lg font-semibold mb-3">ðŸŽ¯ Performance Guides</h3>
                                    <ul class="space-y-2">
                                        <li><a href="https://wiki.postgresql.org/wiki/Tuning_Your_PostgreSQL_Server" target="_blank" class="text-primary-600 dark:text-primary-400 hover:underline">PostgreSQL Tuning Guide</a></li>
                                        <li><a href="https://pgtune.leopard.in.ua/" target="_blank" class="text-primary-600 dark:text-primary-400 hover:underline">PGTune - Configuration Generator</a></li>
                                        <li><a href="https://github.com/jfcoz/postgresqltuner" target="_blank" class="text-primary-600 dark:text-primary-400 hover:underline">PostgreSQLTuner Script</a></li>
                                    </ul>
                                </div>
                            </div>

                            <div class="mt-6 p-4 bg-yellow-50 dark:bg-yellow-900/20 border border-yellow-200 dark:border-yellow-800 rounded-lg">
                                <h4 class="font-semibold text-yellow-800 dark:text-yellow-200 mb-2">ðŸ’¡ Pro Tip</h4>
                                <p class="text-yellow-700 dark:text-yellow-300">Understanding MVCC is crucial for PostgreSQL performance. Regularly monitor your database's vacuum activity, transaction patterns, and bloat levels to maintain optimal performance.</p>
                            </div>
                        </div>
                    </div>`
                },
                conn_auth: {
                    title: "Connection & Authentication",
                    icon: "fa-solid fa-plug-circle-check",
                    intro: "Issues related to establishing a connection with the database server and authenticating users.",
                    issues: [
                        { id: "conn_critical_1", title: "FATAL: could not access server configuration file", errorCode: "58P01", severity: "Critical", solution: "<p>The server cannot start because its main configuration file (e.g., `postgresql.conf`) is unreadable or missing.</p><p><b>Common Causes:</b> Incorrect file permissions, file deletion, or disk corruption.</p>", remediation: "- Ensure the configuration file exists at the correct path.\n- Verify the file is owned by the `postgres` user and has read permissions.\n- Restore the file from a backup if it is missing or corrupt.", troubleshooting_code: "ls -l /path/to/your/postgresql.conf", views: 0, helpful_yes: 0, helpful_no: 0, comments: [] },
                        { id: "conn_18456", title: "Login failed for user 'username'", errorCode: "18456", severity: "High", solution: "<p>This is one of the most common errors, indicating a problem with the credentials provided or the user's configuration.</p>", remediation: "1. Verify Username and Password are correct.\n2. Check if the server is configured for SQL Server Authentication Mode.\n3. Confirm the user account is not locked out or disabled.", troubleshooting_code: "SELECT name, is_disabled FROM sys.sql_logins WHERE name = 'username';", views: 0, helpful_yes: 0, helpful_no: 0, comments: [] },
                        { id: "conn_various", title: "A network-related or instance-specific error occurred", errorCode: "various", severity: "High", solution: "<p>A generic network error indicating the client cannot reach the SQL Server instance.</p>", remediation: "1. Check the Server Name in the connection string.\n2. Ensure the SQL Server Service is running on the server.\n3. Check firewall rules on both the client and server machines.", troubleshooting_code: "ping <server_name>\ntelnet <server_name> 1433", views: 0, helpful_yes: 0, helpful_no: 0, comments: [] },
                        { id: "conn_auth_new_1", title: "FATAL: password authentication failed for user 'postgres'", errorCode: "N/A", severity: "High", solution: "<p>The client provided an incorrect password for the specified user during connection.</p><p><b>Common Causes:</b> Typo in password, forgotten password, incorrect password in connection string/tool configuration.</p>", remediation: "- Double-check the password.\n- If forgotten, reset it using `ALTER USER postgres WITH PASSWORD 'new_password';` (as a superuser).\n- Ensure the client application sends the correct password.", troubleshooting_code: "psql -U postgres -h localhost -d your_db -c '\\q'", views: 0, helpful_yes: 0, helpful_no: 0, comments: [] },
                        { id: "conn_auth_new_2", title: "FATAL: role 'dev_user' does not exist", errorCode: "N/A", severity: "Medium", solution: "<p>The username (role) specified in the connection attempt does not exist in the PostgreSQL database.</p><p><b>Common Causes:</b> Typo in username, user role not created yet, connecting to the wrong database/cluster.</p>", remediation: "- Verify the username.\n- Create the user role if it doesn't exist: `CREATE ROLE dev_user WITH LOGIN PASSWORD 'your_password';`.\n- Ensure you're connecting to the correct PostgreSQL instance.", troubleshooting_code: "SELECT 1 FROM pg_roles WHERE rolname='dev_user';", views: 0, helpful_yes: 0, helpful_no: 0, comments: [] },
                        { id: "conn_auth_new_3", title: "could not connect to server: Connection refused", errorCode: "N/A", severity: "High", solution: "<p>The client tried to connect, but the server actively refused the connection, indicating no process is listening on the specified port/address.</p><p><b>Common Causes:</b> PostgreSQL server is not running, firewall blocking the connection, incorrect host/port in connection string.</p>", remediation: "- Check if PostgreSQL is running (`sudo systemctl status postgresql` or similar).\n- Verify firewall rules (`ufw status`, `iptables -L`).\n- Ensure correct host and port (`-h`, `-p` in `psql`) are used in the connection string.", troubleshooting_code: "netstat -tuln | grep 5432", views: 0, helpful_yes: 0, helpful_no: 0, comments: [] },
                        { id: "conn_auth_new_4", title: "FATAL: no pg_hba.conf entry for host", errorCode: "N/A", severity: "High", solution: "<p>The client's IP address is not allowed to connect to the PostgreSQL server according to the `pg_hba.conf` configuration file.</p><p><b>Common Causes:</b> Missing or restrictive `pg_hba.conf` entry, client connecting from an unexpected IP address, incorrect authentication method specified.</p>", remediation: "- Add an appropriate entry to `pg_hba.conf` for the client's IP address.\n- Use `host all all 0.0.0.0/0 md5` for testing (not recommended for production).\n- Restart PostgreSQL or reload configuration with `SELECT pg_reload_conf();`", troubleshooting_code: "SELECT * FROM pg_hba_file_rules;", views: 0, helpful_yes: 0, helpful_no: 0, comments: [] },
                        { id: "conn_auth_new_5", title: "FATAL: database 'database_name' does not exist", errorCode: "N/A", severity: "Medium", solution: "<p>The specified database does not exist in the PostgreSQL cluster.</p><p><b>Common Causes:</b> Typo in database name, database was dropped, connecting to wrong PostgreSQL instance, database not created yet.</p>", remediation: "- Verify the database name is correct.\n- List available databases: `\\l` in psql or `SELECT datname FROM pg_database;`\n- Create the database if it doesn't exist: `CREATE DATABASE database_name;`\n- Connect to a different database first, then create the target database.", troubleshooting_code: "SELECT datname FROM pg_database WHERE datname = 'your_database';", views: 0, helpful_yes: 0, helpful_no: 0, comments: [] },
                        { id: "conn_auth_pg_101", title: "FATAL: terminating connection due to administrator command", errorCode: "57P01", severity: "High", solution: "<p>The connection was forcibly closed by an administrator command, such as <code>pg_terminate_backend</code> or a server shutdown.</p>", remediation: "- Check if the server was intentionally restarted or stopped.\n- Review logs for <code>pg_terminate_backend</code> usage.\n- Ensure no automated scripts are terminating connections unexpectedly.", troubleshooting_code: "SELECT pid, usename, application_name FROM pg_stat_activity WHERE state = 'active';", views: 0, helpful_yes: 0, helpful_no: 0, comments: [] },
                        { id: "conn_auth_pg_102", title: "FATAL: too many connections for role", errorCode: "53300", severity: "High", solution: "<p>The maximum number of allowed connections for the specified role has been reached.</p>", remediation: "- Increase the <code>CONNECTION LIMIT</code> for the role if appropriate.\n- Close unused connections.\n- Use connection pooling to manage connections efficiently.", troubleshooting_code: "SELECT rolname, rolconnlimit FROM pg_roles WHERE rolname = 'your_role';", views: 0, helpful_yes: 0, helpful_no: 0, comments: [] },
                        { id: "conn_auth_pg_103", title: "FATAL: password must be changed", errorCode: "28M01", severity: "Medium", solution: "<p>The user is required to change their password before connecting, often due to password expiration policies.</p>", remediation: "- Change the password using <code>ALTER USER username WITH PASSWORD 'new_password';</code>\n- Ensure password policies are communicated to users.", troubleshooting_code: "SELECT rolname, rolvaliduntil FROM pg_authid WHERE rolname = 'your_user';", views: 0, helpful_yes: 0, helpful_no: 0, comments: [] },
                        { id: "conn_auth_pg_104", title: "FATAL: invalid value for parameter \"TimeZone\"", errorCode: "22023", severity: "Low", solution: "<p>The <code>TimeZone</code> parameter in the connection string or server configuration is invalid.</p>", remediation: "- Use a valid time zone name (e.g., 'UTC', 'America/New_York').\n- Check the <code>postgresql.conf</code> or connection string for typos.", troubleshooting_code: "SHOW TimeZone;", views: 0, helpful_yes: 0, helpful_no: 0, comments: [] },
                        { id: "conn_auth_pg_105", title: "FATAL: invalid connection option \"application_name\"", errorCode: "42704", severity: "Low", solution: "<p>The connection string contains an invalid or unsupported option.</p>", remediation: "- Remove or correct the invalid option in the connection string.\n- Refer to the PostgreSQL documentation for valid connection parameters.", troubleshooting_code: "SHOW all;", views: 0, helpful_yes: 0, helpful_no: 0, comments: [] },
                        { id: "conn_auth_pg_106", title: "FATAL: database system is in recovery mode", errorCode: "57P03", severity: "High", solution: "<p>The server is currently in recovery mode and cannot accept connections.</p>", remediation: "- Wait for the recovery process to complete.\n- Monitor server logs for recovery progress.", troubleshooting_code: "SELECT pg_is_in_recovery();", views: 0, helpful_yes: 0, helpful_no: 0, comments: [] },
                        { id: "conn_auth_pg_107", title: "FATAL: role cannot log in", errorCode: "28000", severity: "Medium", solution: "<p>The specified role does not have login privileges.</p>", remediation: "- Grant login privilege: <code>ALTER ROLE rolename LOGIN;</code>\n- Check role attributes in <code>pg_roles</code>.", troubleshooting_code: "SELECT rolname, rolcanlogin FROM pg_roles WHERE rolname = 'your_role';", views: 0, helpful_yes: 0, helpful_no: 0, comments: [] },
                        { id: "conn_auth_pg_108", title: "FATAL: no pgpass file found", errorCode: "08001", severity: "Low", solution: "<p>The <code>.pgpass</code> file required for passwordless authentication is missing or unreadable.</p>", remediation: "- Create a valid <code>.pgpass</code> file in the user's home directory.\n- Set correct file permissions (0600).\n- Ensure the file is formatted correctly.", troubleshooting_code: "cat ~/.pgpass", views: 0, helpful_yes: 0, helpful_no: 0, comments: [] },
                        { id: "conn_auth_pg_109", title: "FATAL: invalid frontend message type", errorCode: "08P01", severity: "Medium", solution: "<p>The client sent an invalid or unexpected message type to the server.</p>", remediation: "- Ensure the client library is compatible with the server version.\n- Update or reconfigure the client if necessary.", troubleshooting_code: "SELECT version();", views: 0, helpful_yes: 0, helpful_no: 0, comments: [] },
                        { id: "conn_auth_pg_110", title: "FATAL: invalid SSL mode value", errorCode: "08P01", severity: "Medium", solution: "<p>The connection string specifies an invalid value for the <code>sslmode</code> parameter.</p>", remediation: "- Use a valid <code>sslmode</code> value (disable, allow, prefer, require, verify-ca, verify-full).\n- Check the connection string for typos.", troubleshooting_code: "SHOW ssl;", views: 0, helpful_yes: 0, helpful_no: 0, comments: [] },
                        { id: "conn_auth_pg_111", title: "FATAL: invalid client encoding", errorCode: "22021", severity: "Low", solution: "<p>The client requested an unsupported or invalid encoding.</p>", remediation: "- Use a supported encoding (e.g., UTF8, LATIN1).\n- Set the <code>client_encoding</code> parameter correctly.", troubleshooting_code: "SHOW client_encoding;", views: 0, helpful_yes: 0, helpful_no: 0, comments: [] },
                        { id: "conn_auth_pg_112", title: "FATAL: connection to server on socket failed: No such file or directory", errorCode: "08001", severity: "High", solution: "<p>The client could not connect to the server socket, possibly because the server is not running or the socket file was removed.</p>", remediation: "- Ensure the PostgreSQL server is running.\n- Check the <code>unix_socket_directories</code> setting.", troubleshooting_code: "SHOW unix_socket_directories;", views: 0, helpful_yes: 0, helpful_no: 0, comments: [] },
                        { id: "conn_auth_pg_113", title: "FATAL: role password is expired", errorCode: "28P01", severity: "Medium", solution: "<p>The password for the specified role has expired.</p>", remediation: "- Change the password using <code>ALTER ROLE rolename WITH PASSWORD 'new_password';</code>\n- Set a new expiration date if needed.", troubleshooting_code: "SELECT rolname, rolvaliduntil FROM pg_authid WHERE rolname = 'your_role';", views: 0, helpful_yes: 0, helpful_no: 0, comments: [] },
                        { id: "conn_auth_pg_114", title: "FATAL: could not load server certificate file", errorCode: "58P01", severity: "High", solution: "<p>The server could not load the SSL certificate file specified in <code>postgresql.conf</code>.</p>", remediation: "- Ensure the certificate file exists and is readable.\n- Check the <code>ssl_cert_file</code> setting.", troubleshooting_code: "SHOW ssl_cert_file;", views: 0, helpful_yes: 0, helpful_no: 0, comments: [] },
                        { id: "conn_auth_pg_115", title: "FATAL: could not load private key file", errorCode: "58P01", severity: "High", solution: "<p>The server could not load the SSL private key file specified in <code>postgresql.conf</code>.</p>", remediation: "- Ensure the private key file exists and is readable by the postgres user.\n- Check the <code>ssl_key_file</code> setting.\n- Verify file permissions (should be 600 or 400).", troubleshooting_code: "SHOW ssl_key_file; SELECT current_user;", views: 0, helpful_yes: 0, helpful_no: 0, comments: [] },
                        { id: "conn_auth_pg_116", title: "FATAL: connection limit exceeded for non-superusers", errorCode: "53300", severity: "High", solution: "<p>The maximum number of connections for non-superuser roles has been reached.</p>", remediation: "- Increase <code>max_connections</code> if system resources allow.\n- Implement connection pooling to manage connections efficiently.\n- Monitor and close idle connections.\n- Use superuser accounts sparingly for essential tasks only.", troubleshooting_code: "SELECT count(*), usename FROM pg_stat_activity GROUP BY usename;", views: 0, helpful_yes: 0, helpful_no: 0, comments: [] },
                        { id: "conn_auth_pg_117", title: "FATAL: GSSAPI authentication failed", errorCode: "28000", severity: "Medium", solution: "<p>Authentication using GSSAPI (Kerberos) failed, preventing the user from logging in.</p>", remediation: "- Verify Kerberos ticket is valid: <code>klist</code>\n- Check <code>pg_hba.conf</code> GSSAPI configuration.\n- Ensure proper hostname resolution and DNS settings.\n- Verify system time synchronization between client and server.", troubleshooting_code: "SELECT * FROM pg_hba_file_rules WHERE auth_method = 'gss';", views: 0, helpful_yes: 0, helpful_no: 0, comments: [] },
                        { id: "conn_auth_pg_118", title: "FATAL: SSPI authentication failed", errorCode: "28000", severity: "Medium", solution: "<p>Authentication using SSPI (Windows integrated authentication) failed.</p>", remediation: "- Verify Windows user account is valid and not locked.\n- Check domain trust relationships if using domain accounts.\n- Ensure PostgreSQL service is running under appropriate account.\n- Review <code>pg_hba.conf</code> SSPI configuration.", troubleshooting_code: "SELECT * FROM pg_hba_file_rules WHERE auth_method = 'sspi';", views: 0, helpful_yes: 0, helpful_no: 0, comments: [] },
                        { id: "conn_auth_pg_119", title: "FATAL: certificate authentication failed", errorCode: "28000", severity: "High", solution: "<p>Client certificate authentication failed, preventing secure connection establishment.</p>", remediation: "- Verify client certificate is valid and not expired.\n- Check certificate chain and CA trust.\n- Ensure certificate subject matches expected format.\n- Review SSL configuration in <code>postgresql.conf</code>.", troubleshooting_code: "SHOW ssl_ca_file; SHOW ssl_cert_file;", views: 0, helpful_yes: 0, helpful_no: 0, comments: [] },
                        { id: "conn_auth_pg_120", title: "FATAL: LDAP authentication failed", errorCode: "28000", severity: "Medium", solution: "<p>Authentication against LDAP server failed, preventing user login.</p>", remediation: "- Verify LDAP server is accessible and responding.\n- Check LDAP bind credentials in <code>pg_hba.conf</code>.\n- Validate user DN format and LDAP search filters.\n- Test LDAP connectivity outside PostgreSQL.", troubleshooting_code: "SELECT * FROM pg_hba_file_rules WHERE auth_method = 'ldap';", views: 0, helpful_yes: 0, helpful_no: 0, comments: [] },
                        { id: "conn_auth_pg_121", title: "FATAL: RADIUS authentication failed", errorCode: "28000", severity: "Medium", solution: "<p>Authentication against RADIUS server failed.</p>", remediation: "- Verify RADIUS server is accessible and configured correctly.\n- Check shared secret configuration in <code>pg_hba.conf</code>.\n- Validate network connectivity to RADIUS server.\n- Review RADIUS server logs for authentication attempts.", troubleshooting_code: "SELECT * FROM pg_hba_file_rules WHERE auth_method = 'radius';", views: 0, helpful_yes: 0, helpful_no: 0, comments: [] },
                        { id: "conn_auth_pg_122", title: "FATAL: PAM authentication failed", errorCode: "28000", severity: "Medium", solution: "<p>Pluggable Authentication Module (PAM) authentication failed.</p>", remediation: "- Check PAM configuration files for PostgreSQL service.\n- Verify system user account exists and is valid.\n- Review PAM module configuration and dependencies.\n- Check system authentication logs for detailed errors.", troubleshooting_code: "SELECT * FROM pg_hba_file_rules WHERE auth_method = 'pam';", views: 0, helpful_yes: 0, helpful_no: 0, comments: [] },
                        { id: "conn_auth_pg_123", title: "FATAL: connection requires SSL but SSL is disabled", errorCode: "08004", severity: "High", solution: "<p>The connection attempt requires SSL encryption, but SSL is not enabled on the server.</p>", remediation: "- Enable SSL in <code>postgresql.conf</code>: <code>ssl = on</code>\n- Configure SSL certificates and restart PostgreSQL.\n- Update <code>pg_hba.conf</code> to require SSL for appropriate connections.\n- Test SSL connectivity after configuration.", troubleshooting_code: "SHOW ssl; SHOW ssl_cert_file; SHOW ssl_key_file;", views: 0, helpful_yes: 0, helpful_no: 0, comments: [] },
                        { id: "conn_auth_pg_124", title: "FATAL: connection over TCP/IP is not permitted", errorCode: "08004", severity: "High", solution: "<p>TCP/IP connections are not allowed by the current server configuration.</p>", remediation: "- Enable TCP/IP connections in <code>postgresql.conf</code>: <code>listen_addresses = '*'</code>\n- Add appropriate entries to <code>pg_hba.conf</code> for TCP/IP access.\n- Restart PostgreSQL after configuration changes.\n- Verify firewall rules allow PostgreSQL port access.", troubleshooting_code: "SHOW listen_addresses; SELECT * FROM pg_hba_file_rules;", views: 0, helpful_yes: 0, helpful_no: 0, comments: [] },
                        { id: "conn_auth_pg_125", title: "FATAL: connection requires authentication method not supported", errorCode: "28000", severity: "High", solution: "<p>The client does not support the authentication method required by the server.</p>", remediation: "- Update client software to support required authentication methods.\n- Configure alternative authentication methods in <code>pg_hba.conf</code>.\n- Use compatible authentication methods for older clients.\n- Check client library capabilities and version.", troubleshooting_code: "SELECT * FROM pg_hba_file_rules ORDER BY line_number;", views: 0, helpful_yes: 0, helpful_no: 0, comments: [] },
                        { id: "conn_auth_pg_126", title: "FATAL: connection timed out during authentication", errorCode: "08006", severity: "Medium", solution: "<p>The authentication process timed out before completion.</p>", remediation: "- Increase <code>authentication_timeout</code> in postgresql.conf.\n- Check network connectivity and latency.\n- Verify authentication server availability (LDAP, Kerberos, etc.).\n- Monitor authentication process performance.", troubleshooting_code: "SHOW authentication_timeout; SELECT * FROM pg_stat_activity WHERE state = 'active';", views: 0, helpful_yes: 0, helpful_no: 0, comments: [] },
                        { id: "conn_auth_pg_127", title: "ERROR: connection slot reserved for superuser", errorCode: "53300", severity: "High", solution: "<p>All available connection slots are reserved for superusers due to <code>superuser_reserved_connections</code> setting.</p>", remediation: "- Connect as a superuser to release connections.\n- Increase <code>max_connections</code> if system resources allow.\n- Reduce <code>superuser_reserved_connections</code> if appropriate.\n- Implement connection pooling to manage connections efficiently.", troubleshooting_code: "SHOW max_connections; SHOW superuser_reserved_connections; SELECT count(*) FROM pg_stat_activity;", views: 0, helpful_yes: 0, helpful_no: 0, comments: [] },
                        { id: "conn_auth_pg_128", title: "FATAL: cluster is in read-only mode", errorCode: "25006", severity: "High", solution: "<p>The database cluster is currently in read-only mode, preventing write operations.</p>", remediation: "- Check if the server is a standby in a replication setup.\n- Verify <code>default_transaction_read_only</code> setting.\n- Connect to the primary server for write operations.\n- Review cluster configuration for read-only settings.", troubleshooting_code: "SHOW default_transaction_read_only; SELECT pg_is_in_recovery();", views: 0, helpful_yes: 0, helpful_no: 0, comments: [] },
                        { id: "conn_auth_pg_129", title: "ERROR: connection rejected by connection filter", errorCode: "08004", severity: "Medium", solution: "<p>The connection was rejected by a connection filter or security policy.</p>", remediation: "- Review connection filtering configuration.\n- Check security policies and firewall rules.\n- Verify client IP address is allowed.\n- Examine connection filter logs for details.", troubleshooting_code: "SELECT client_addr, application_name FROM pg_stat_activity;", views: 0, helpful_yes: 0, helpful_no: 0, comments: [] },
                        { id: "conn_auth_pg_130", title: "FATAL: connection requires TLS version not supported", errorCode: "08004", severity: "High", solution: "<p>The server requires a TLS version that is not supported by the client.</p>", remediation: "- Update client software to support required TLS versions.\n- Configure server to accept older TLS versions if secure.\n- Check <code>ssl_min_protocol_version</code> setting.\n- Verify TLS configuration compatibility.", troubleshooting_code: "SHOW ssl_min_protocol_version; SELECT version FROM pg_stat_ssl;", views: 0, helpful_yes: 0, helpful_no: 0, comments: [] },
                        { id: "conn_auth_pg_131", title: "ERROR: authentication method mismatch", errorCode: "28000", severity: "Medium", solution: "<p>The authentication method configured does not match the method expected by the client.</p>", remediation: "- Verify authentication method configuration in <code>pg_hba.conf</code>.\n- Ensure client and server authentication methods are compatible.\n- Update client configuration to match server requirements.\n- Review authentication method priorities.", troubleshooting_code: "SELECT * FROM pg_hba_file_rules WHERE database = current_database();", views: 0, helpful_yes: 0, helpful_no: 0, comments: [] },
                        { id: "conn_auth_pg_132", title: "FATAL: connection requires IPv6 but not supported", errorCode: "08001", severity: "Medium", solution: "<p>The connection attempt requires IPv6 support, but the server or client does not support it.</p>", remediation: "- Enable IPv6 support in system and PostgreSQL configuration.\n- Use IPv4 addresses if IPv6 is not required.\n- Update network configuration to support IPv6.\n- Verify <code>listen_addresses</code> includes IPv6 addresses.", troubleshooting_code: "SHOW listen_addresses; SELECT inet_server_addr(), family(inet_server_addr());", views: 0, helpful_yes: 0, helpful_no: 0, comments: [] },
                        { id: "conn_auth_pg_133", title: "ERROR: connection pool authentication failed", errorCode: "28000", severity: "High", solution: "<p>Authentication through a connection pool (like PgBouncer) failed.</p>", remediation: "- Verify connection pool authentication configuration.\n- Check pool user credentials and permissions.\n- Review pool configuration for authentication methods.\n- Test direct connection bypassing the pool.", troubleshooting_code: "SELECT usename, application_name FROM pg_stat_activity WHERE application_name LIKE '%bouncer%';", views: 0, helpful_yes: 0, helpful_no: 0, comments: [] },
                        { id: "conn_auth_pg_134", title: "FATAL: connection requires privileges not available", errorCode: "42501", severity: "High", solution: "<p>The connection requires privileges that are not available to the user.</p>", remediation: "- Grant necessary privileges to the user role.\n- Use a role with appropriate permissions.\n- Review privilege requirements for the connection.\n- Check role inheritance and membership.", troubleshooting_code: "SELECT rolname, rolsuper, rolcreaterole, rolcreatedb FROM pg_roles WHERE rolname = current_user;", views: 0, helpful_yes: 0, helpful_no: 0, comments: [] },
                        { id: "conn_auth_pg_135", title: "ERROR: connection terminated by idle timeout", errorCode: "57P01", severity: "Low", solution: "<p>The connection was terminated due to exceeding the idle timeout limit.</p>", remediation: "- Increase <code>idle_in_transaction_session_timeout</code> if appropriate.\n- Implement proper connection management in applications.\n- Use connection pooling to manage idle connections.\n- Monitor and close long-running idle connections.", troubleshooting_code: "SHOW idle_in_transaction_session_timeout; SELECT state, state_change FROM pg_stat_activity;", views: 0, helpful_yes: 0, helpful_no: 0, comments: [] },
                        { id: "conn_auth_pg_136", title: "FATAL: connection requires database that does not accept connections", errorCode: "57P03", severity: "High", solution: "<p>The target database is configured to not accept new connections.</p>", remediation: "- Enable connections for the database: <code>ALTER DATABASE dbname ALLOW_CONNECTIONS true;</code>\n- Connect to a different database that allows connections.\n- Check database connection limits and current usage.\n- Review database maintenance status.", troubleshooting_code: "SELECT datname, datallowconn, datconnlimit FROM pg_database WHERE datname = current_database();", views: 0, helpful_yes: 0, helpful_no: 0, comments: [] },
                        { id: "conn_auth_pg_137", title: "ERROR: connection requires session initialization that failed", errorCode: "XX000", severity: "Medium", solution: "<p>Session initialization failed during connection establishment.</p>", remediation: "- Check session initialization scripts and settings.\n- Verify user-specific configuration parameters.\n- Review role-based settings and defaults.\n- Test connection with minimal configuration.", troubleshooting_code: "SELECT rolname, rolconfig FROM pg_roles WHERE rolconfig IS NOT NULL;", views: 0, helpful_yes: 0, helpful_no: 0, comments: [] },
                        { id: "conn_auth_pg_138", title: "FATAL: connection requires protocol version not supported", errorCode: "08P01", severity: "High", solution: "<p>The client uses a protocol version that is not supported by the server.</p>", remediation: "- Update client software to use supported protocol versions.\n- Check PostgreSQL client and server version compatibility.\n- Use appropriate client libraries for the server version.\n- Review protocol version requirements and support.", troubleshooting_code: "SELECT version(); SELECT protocol_version FROM pg_stat_activity WHERE pid = pg_backend_pid();", views: 0, helpful_yes: 0, helpful_no: 0, comments: [] },
                        { id: "conn_auth_pg_139", title: "ERROR: connection security context invalid", errorCode: "28000", severity: "High", solution: "<p>The security context for the connection is invalid or corrupted.</p>", remediation: "- Refresh security credentials and context.\n- Verify security policy compliance.\n- Check security provider configuration.\n- Test connection with different security context.", troubleshooting_code: "SELECT current_user, session_user, current_role;", views: 0, helpful_yes: 0, helpful_no: 0, comments: [] },
                        { id: "conn_auth_pg_140", title: "FATAL: connection requires encryption level not available", errorCode: "08004", severity: "High", solution: "<p>The required encryption level is not available or not supported.</p>", remediation: "- Configure appropriate SSL/TLS encryption levels.\n- Update SSL configuration in postgresql.conf.\n- Verify cipher suites and encryption algorithms.\n- Check client encryption capabilities.", troubleshooting_code: "SELECT ssl, cipher, bits FROM pg_stat_ssl WHERE pid = pg_backend_pid();", views: 0, helpful_yes: 0, helpful_no: 0, comments: [] }
                    ]
                },
                locking: {
                    title: "Locking & Concurrency",
                    icon: "fa-solid fa-lock",
                    intro: "Problems arising from multiple transactions competing for the same resources, including deadlocks and timeouts.",
                    issues: [
                        { id: "lock_1205", title: "Transaction was deadlocked on lock resources with another process", errorCode: "1205", severity: "High", solution: "<p>Two or more processes are waiting for a resource that the other process holds, creating a circular dependency which SQL Server resolves by terminating one process.</p>", remediation: "1. Identify deadlocked queries using Profiler or Extended Events.\n2. Ensure transactions access resources in a consistent order.\n3. Keep transactions as short and quick as possible.", troubleshooting_code: "SELECT request_session_id, resource_type, resource_description FROM sys.dm_tran_locks WHERE request_status = 'WAIT';", views: 0, helpful_yes: 0, helpful_no: 0, comments: [] },
                        { id: "lock_1222", title: "Lock request time out period exceeded", errorCode: "1222", severity: "Medium", solution: "<p>A statement has been waiting for a lock for longer than the configured `LOCK_TIMEOUT` setting and has been automatically cancelled.</p>", remediation: "1. Identify the blocking session using `sp_who2` or DMVs.\n2. Analyze why the blocking session is holding locks for so long and optimize it.\n3. Consider adjusting the `LOCK_TIMEOUT` setting for the specific session if longer waits are expected.", troubleshooting_code: "SELECT blocking_session_id, session_id, wait_type, wait_time FROM sys.dm_os_waiting_tasks WHERE blocking_session_id IS NOT NULL;", views: 0, helpful_yes: 0, helpful_no: 0, comments: [] },
                        { id: "locking_new_1", title: "Deadlock Detected", errorCode: "N/A", severity: "High", solution: "<p>Two or more transactions are waiting for each other to release locks, resulting in a deadlock.</p><p><b>Common Causes:</b> Application transaction patterns causing contention, long-running transactions, complex update statements without proper ordering.</p>", remediation: "- Analyze application transaction patterns to reduce contention.\n- Implement retry logic in your application for deadlocked transactions.\n- Identify long-running transactions and optimize them.\n- Check the `log_lock_waits` and `deadlock_timeout` parameters in `postgresql.conf`.", troubleshooting_code: "SELECT * FROM pg_stat_activity WHERE wait_event_type = 'Lock';", views: 0, helpful_yes: 0, helpful_no: 0, comments: [] },
                        { id: "locking_new_2", title: "Lock Timeout Exceeded", errorCode: "N/A", severity: "Medium", solution: "<p>A transaction has been waiting for a lock longer than the configured `lock_timeout` setting and has been automatically cancelled.</p><p><b>Common Causes:</b> High concurrency, long-running transactions holding locks, insufficient `lock_timeout` setting, blocking queries.</p>", remediation: "- Identify blocking sessions using `pg_stat_activity` and `pg_locks`.\n- Optimize long-running transactions to release locks faster.\n- Consider increasing `lock_timeout` for specific operations if needed.\n- Implement application-level retry logic with exponential backoff.", troubleshooting_code: "SELECT blocked_locks.pid AS blocked_pid, blocking_locks.pid AS blocking_pid FROM pg_catalog.pg_locks blocked_locks JOIN pg_catalog.pg_locks blocking_locks ON blocking_locks.locktype = blocked_locks.locktype AND blocking_locks.database IS NOT DISTINCT FROM blocked_locks.database AND blocking_locks.relation IS NOT DISTINCT FROM blocked_locks.relation AND blocking_locks.page IS NOT DISTINCT FROM blocked_locks.page AND blocking_locks.tuple IS NOT DISTINCT FROM blocked_locks.tuple AND blocking_locks.virtualxid IS NOT DISTINCT FROM blocked_locks.virtualxid AND blocking_locks.transactionid IS NOT DISTINCT FROM blocked_locks.transactionid AND blocking_locks.classid IS NOT DISTINCT FROM blocked_locks.classid AND blocking_locks.objid IS NOT DISTINCT FROM blocked_locks.objid AND blocking_locks.objsubid IS NOT DISTINCT FROM blocked_locks.objsubid AND blocking_locks.pid != blocked_locks.pid;", views: 0, helpful_yes: 0, helpful_no: 0, comments: [] },
                        { id: "locking_new_3", title: "Row-Level Lock Contention", errorCode: "N/A", severity: "Medium", solution: "<p>Multiple transactions are competing for the same rows, causing performance degradation and potential timeouts.</p><p><b>Common Causes:</b> High-frequency updates to the same rows, insufficient indexing, application design causing hot spots, lack of proper transaction isolation.</p>", remediation: "- Use `SELECT ... FOR UPDATE` judiciously and only when necessary.\n- Consider using `SELECT ... FOR UPDATE SKIP LOCKED` for queue-like operations.\n- Implement optimistic locking using version columns.\n- Review application logic to reduce contention on frequently updated rows.\n- Use appropriate transaction isolation levels.", troubleshooting_code: "SELECT relation::regclass, mode, granted, pid FROM pg_locks WHERE relation IS NOT NULL AND NOT granted;", views: 0, helpful_yes: 0, helpful_no: 0, comments: [] },
                        { id: "locking_pg_101", title: "ERROR: could not obtain lock on relation", errorCode: "55P03", severity: "High", solution: "<p>The requested lock on a table or relation could not be acquired, usually due to another transaction holding a conflicting lock.</p>", remediation: "- Identify blocking transactions using <code>pg_locks</code> and <code>pg_stat_activity</code>.\n- Terminate or wait for the blocking transaction to complete.\n- Optimize transaction length and lock scope.", troubleshooting_code: "SELECT blocked_locks.pid AS blocked_pid, blocking_locks.pid AS blocking_pid FROM pg_locks blocked_locks JOIN pg_locks blocking_locks ON blocked_locks.locktype = blocking_locks.locktype AND blocked_locks.database IS NOT DISTINCT FROM blocking_locks.database AND blocked_locks.relation IS NOT DISTINCT FROM blocking_locks.relation AND blocked_locks.pid != blocking_locks.pid WHERE NOT blocked_locks.granted;", views: 0, helpful_yes: 0, helpful_no: 0, comments: [] },
                        { id: "locking_pg_102", title: "ERROR: lock not available immediately", errorCode: "55P03", severity: "Medium", solution: "<p>A NOWAIT lock request could not be granted immediately, so the operation failed instead of waiting.</p>", remediation: "- Use <code>FOR UPDATE NOWAIT</code> only when you want to avoid waiting for locks.\n- Consider retrying the operation or using <code>SKIP LOCKED</code> if appropriate.", troubleshooting_code: "SELECT * FROM pg_locks WHERE NOT granted;", views: 0, helpful_yes: 0, helpful_no: 0, comments: [] },
                        { id: "locking_pg_103", title: "ERROR: deadlock timeout exceeded", errorCode: "40P01", severity: "High", solution: "<p>The deadlock timeout was exceeded while waiting for a lock, but no deadlock was detected. The transaction was canceled to prevent indefinite waiting.</p>", remediation: "- Investigate long-running transactions and optimize their logic.\n- Increase <code>deadlock_timeout</code> if necessary, but avoid masking real deadlocks.", troubleshooting_code: "SHOW deadlock_timeout;", views: 0, helpful_yes: 0, helpful_no: 0, comments: [] },
                        { id: "locking_pg_104", title: "WARNING: there is already a transaction in progress", errorCode: "25001", severity: "Low", solution: "<p>An attempt was made to start a new transaction while another is already in progress in the same session.</p>", remediation: "- Ensure <code>BEGIN</code> is not called twice without a <code>COMMIT</code> or <code>ROLLBACK</code>.\n- Review application transaction management logic.", troubleshooting_code: "SELECT state, xact_start FROM pg_stat_activity WHERE state = 'idle in transaction';", views: 0, helpful_yes: 0, helpful_no: 0, comments: [] },
                        { id: "locking_pg_105", title: "ERROR: lock queue is full", errorCode: "XX000", severity: "High", solution: "<p>The lock manager's queue is full, preventing new lock requests from being processed.</p>", remediation: "- Reduce the number of concurrent transactions.\n- Tune lock manager parameters if possible.\n- Review application logic for excessive locking.", troubleshooting_code: "SELECT * FROM pg_locks;", views: 0, helpful_yes: 0, helpful_no: 0, comments: [] },
                        { id: "locking_pg_106", title: "ERROR: advisory lock already held", errorCode: "55P03", severity: "Medium", solution: "<p>An attempt was made to acquire an advisory lock that is already held by the session or another session.</p>", remediation: "- Release the advisory lock before acquiring it again.\n- Use <code>pg_advisory_unlock</code> as needed.", troubleshooting_code: "SELECT * FROM pg_locks WHERE locktype = 'advisory';", views: 0, helpful_yes: 0, helpful_no: 0, comments: [] },
                        { id: "locking_pg_107", title: "ERROR: cannot acquire lock during recovery", errorCode: "XX000", severity: "High", solution: "<p>Locks cannot be acquired while the database is in recovery mode.</p>", remediation: "- Wait for recovery to complete before attempting the operation.\n- Monitor recovery progress using <code>pg_is_in_recovery()</code>.", troubleshooting_code: "SELECT pg_is_in_recovery();", views: 0, helpful_yes: 0, helpful_no: 0, comments: [] },
                        { id: "locking_pg_108", title: "ERROR: lock request conflicts with lock held by another transaction", errorCode: "55P03", severity: "High", solution: "<p>The requested lock conflicts with a lock already held by another transaction.</p>", remediation: "- Identify and resolve blocking transactions.\n- Optimize transaction length and lock scope.", troubleshooting_code: "SELECT * FROM pg_locks WHERE NOT granted;", views: 0, helpful_yes: 0, helpful_no: 0, comments: [] },
                        { id: "locking_pg_109", title: "WARNING: lock timeout is set too low", errorCode: "01000", severity: "Low", solution: "<p>The <code>lock_timeout</code> parameter is set to a very low value, increasing the risk of lock timeouts.</p>", remediation: "- Increase <code>lock_timeout</code> if appropriate.\n- Monitor for frequent lock timeouts in logs.", troubleshooting_code: "SHOW lock_timeout;", views: 0, helpful_yes: 0, helpful_no: 0, comments: [] },
                        { id: "locking_pg_111", title: "ERROR: could not obtain access exclusive lock", errorCode: "55P03", severity: "High", solution: "<p>An exclusive lock could not be obtained, preventing the operation from proceeding.</p>", remediation: "- Identify and terminate blocking sessions if necessary.\n- Schedule exclusive operations during maintenance windows.\n- Use <code>LOCK TABLE ... NOWAIT</code> to avoid waiting.", troubleshooting_code: "SELECT locktype, mode, granted FROM pg_locks WHERE NOT granted;", views: 0, helpful_yes: 0, helpful_no: 0, comments: [] },
                        { id: "locking_pg_112", title: "ERROR: tuple concurrently updated", errorCode: "40001", severity: "Medium", solution: "<p>The row being updated was modified by another transaction, causing a serialization failure.</p>", remediation: "- Implement retry logic in application code.\n- Use appropriate transaction isolation levels.\n- Consider using <code>SELECT FOR UPDATE</code> to prevent concurrent modifications.", troubleshooting_code: "SELECT txid_current(), xact_start FROM pg_stat_activity WHERE state = 'active';", views: 0, helpful_yes: 0, helpful_no: 0, comments: [] },
                        { id: "locking_pg_113", title: "ERROR: could not serialize access due to concurrent update", errorCode: "40001", severity: "High", solution: "<p>A serialization failure occurred due to concurrent updates in SERIALIZABLE isolation level.</p>", remediation: "- Retry the transaction with exponential backoff.\n- Consider using READ COMMITTED isolation level if appropriate.\n- Optimize transaction logic to reduce conflicts.", troubleshooting_code: "SELECT application_name, state, xact_start FROM pg_stat_activity WHERE state = 'active';", views: 0, helpful_yes: 0, helpful_no: 0, comments: [] },
                        { id: "locking_pg_114", title: "ERROR: could not serialize access due to read/write dependencies", errorCode: "40001", severity: "High", solution: "<p>A serialization failure occurred due to read/write dependencies between transactions.</p>", remediation: "- Analyze transaction dependencies and reorder operations.\n- Use retry logic with random delays.\n- Consider restructuring transactions to reduce conflicts.", troubleshooting_code: "SELECT pid, state, query_start FROM pg_stat_activity WHERE state != 'idle';", views: 0, helpful_yes: 0, helpful_no: 0, comments: [] },
                        { id: "locking_pg_115", title: "ERROR: lock manager out of shared memory", errorCode: "53200", severity: "Critical", solution: "<p>The lock manager has run out of shared memory, preventing new locks from being acquired.</p>", remediation: "- Increase <code>shared_buffers</code> and <code>max_locks_per_transaction</code>.\n- Reduce the number of concurrent transactions.\n- Monitor and optimize long-running transactions.", troubleshooting_code: "SELECT count(*) FROM pg_locks; SHOW max_locks_per_transaction;", views: 0, helpful_yes: 0, helpful_no: 0, comments: [] },
                        { id: "locking_pg_116", title: "ERROR: row-level security policy violation", errorCode: "42501", severity: "High", solution: "<p>A row-level security policy prevented the operation from completing.</p>", remediation: "- Review row-level security policies on the table.\n- Ensure user has appropriate permissions.\n- Modify policies if necessary for legitimate access.", troubleshooting_code: "SELECT schemaname, tablename, policyname FROM pg_policies WHERE tablename = 'your_table';", views: 0, helpful_yes: 0, helpful_no: 0, comments: [] },
                        { id: "locking_pg_117", title: "ERROR: could not obtain ShareLock on transaction", errorCode: "40001", severity: "Medium", solution: "<p>A shared lock on a transaction could not be obtained, possibly due to deadlock prevention.</p>", remediation: "- Retry the operation after a brief delay.\n- Analyze transaction patterns to reduce lock contention.\n- Consider using advisory locks for coordination.", troubleshooting_code: "SELECT locktype, transactionid, mode FROM pg_locks WHERE locktype = 'transactionid';", views: 0, helpful_yes: 0, helpful_no: 0, comments: [] },
                        { id: "locking_pg_118", title: "ERROR: could not acquire sample lock", errorCode: "55P03", severity: "Low", solution: "<p>A sample lock for ANALYZE or similar operations could not be acquired.</p>", remediation: "- Retry the ANALYZE operation during lower activity periods.\n- Use <code>ANALYZE (BUFFERS, TIMING)</code> for detailed information.\n- Schedule maintenance operations appropriately.", troubleshooting_code: "SELECT relname, last_analyze FROM pg_stat_user_tables;", views: 0, helpful_yes: 0, helpful_no: 0, comments: [] },
                        { id: "locking_pg_119", title: "ERROR: canceling statement due to lock timeout", errorCode: "57014", severity: "Medium", solution: "<p>The statement was canceled because it exceeded the configured lock timeout.</p>", remediation: "- Increase <code>lock_timeout</code> for the session if appropriate.\n- Optimize queries to reduce lock hold times.\n- Identify and resolve blocking operations.", troubleshooting_code: "SHOW lock_timeout; SELECT * FROM pg_stat_activity WHERE wait_event_type = 'Lock';", views: 0, helpful_yes: 0, helpful_no: 0, comments: [] },
                        { id: "locking_pg_120", title: "ERROR: lock table overflow", errorCode: "53200", severity: "Critical", solution: "<p>The lock table has overflowed, preventing new locks from being acquired.</p>", remediation: "- Increase <code>max_locks_per_transaction</code> in postgresql.conf.\n- Reduce the number of concurrent transactions.\n- Optimize transaction scope to minimize lock requirements.\n- Monitor lock usage patterns and adjust configuration.", troubleshooting_code: "SELECT count(*) FROM pg_locks; SHOW max_locks_per_transaction;", views: 0, helpful_yes: 0, helpful_no: 0, comments: [] },
                        { id: "locking_pg_121", title: "ERROR: cannot acquire relation extension lock", errorCode: "55P03", severity: "High", solution: "<p>Unable to acquire a lock for extending a relation (table or index).</p>", remediation: "- Wait for concurrent operations to complete.\n- Monitor disk space and I/O performance.\n- Reduce concurrent bulk operations on the same table.\n- Consider scheduling large operations during maintenance windows.", troubleshooting_code: "SELECT locktype, relation::regclass, mode FROM pg_locks WHERE locktype = 'extend';", views: 0, helpful_yes: 0, helpful_no: 0, comments: [] },
                        { id: "locking_pg_122", title: "ERROR: cannot acquire page-level lock", errorCode: "55P03", severity: "Medium", solution: "<p>Unable to acquire a page-level lock, typically due to high concurrency.</p>", remediation: "- Reduce concurrent operations on the same data pages.\n- Use appropriate isolation levels to minimize lock contention.\n- Consider partitioning large tables to reduce page-level conflicts.\n- Monitor page access patterns and optimize queries.", troubleshooting_code: "SELECT locktype, page, tuple, mode FROM pg_locks WHERE locktype = 'page';", views: 0, helpful_yes: 0, helpful_no: 0, comments: [] },
                        { id: "locking_pg_123", title: "ERROR: cannot acquire object lock during parallel operation", errorCode: "55P03", severity: "Medium", solution: "<p>Object locks cannot be acquired during parallel query operations.</p>", remediation: "- Disable parallel operations for queries requiring object locks.\n- Restructure queries to avoid lock conflicts.\n- Use appropriate transaction isolation levels.\n- Monitor parallel worker processes and lock usage.", troubleshooting_code: "SELECT locktype, objid, mode FROM pg_locks WHERE locktype = 'object'; SHOW max_parallel_workers;", views: 0, helpful_yes: 0, helpful_no: 0, comments: [] },
                        { id: "locking_pg_124", title: "ERROR: cannot acquire virtual transaction lock", errorCode: "40001", severity: "Medium", solution: "<p>Unable to acquire a virtual transaction lock, indicating serialization conflicts.</p>", remediation: "- Retry the transaction with appropriate delay.\n- Use READ COMMITTED isolation level if serializable is not required.\n- Optimize transaction logic to reduce conflicts.\n- Monitor transaction patterns and adjust application logic.", troubleshooting_code: "SELECT locktype, virtualxid, mode FROM pg_locks WHERE locktype = 'virtualxid';", views: 0, helpful_yes: 0, helpful_no: 0, comments: [] },
                        { id: "locking_pg_125", title: "ERROR: cannot acquire user lock", errorCode: "55P03", severity: "Low", solution: "<p>Unable to acquire a user-defined advisory lock.</p>", remediation: "- Check if the advisory lock is already held by another session.\n- Use <code>pg_try_advisory_lock</code> for non-blocking attempts.\n- Implement proper advisory lock management in applications.\n- Monitor advisory lock usage and release patterns.", troubleshooting_code: "SELECT locktype, classid, objid FROM pg_locks WHERE locktype = 'advisory';", views: 0, helpful_yes: 0, helpful_no: 0, comments: [] },
                        { id: "locking_pg_126", title: "ERROR: lock escalation not supported", errorCode: "0A000", severity: "Medium", solution: "<p>PostgreSQL does not support automatic lock escalation from row to table level.</p>", remediation: "- Manually acquire table-level locks if needed.\n- Design queries to minimize lock requirements.\n- Use appropriate locking strategies for bulk operations.\n- Consider explicit table locking for large data modifications.", troubleshooting_code: "LOCK TABLE table_name IN EXCLUSIVE MODE; SELECT locktype, mode FROM pg_locks;", views: 0, helpful_yes: 0, helpful_no: 0, comments: [] },
                        { id: "locking_pg_127", title: "ERROR: cannot acquire lock on temporary object", errorCode: "55P03", severity: "Low", solution: "<p>Unable to acquire locks on temporary tables or objects.</p>", remediation: "- Verify temporary object scope and session ownership.\n- Check for conflicts with other temporary objects.\n- Review temporary object lifecycle management.\n- Ensure proper cleanup of temporary objects.", troubleshooting_code: "SELECT relname, relkind FROM pg_class WHERE relpersistence = 't';", views: 0, helpful_yes: 0, helpful_no: 0, comments: [] },
                        { id: "locking_pg_128", title: "ERROR: cannot acquire lock during vacuum operation", errorCode: "55P03", severity: "Medium", solution: "<p>Lock acquisition failed during vacuum operations.</p>", remediation: "- Schedule vacuum operations during low-activity periods.\n- Use <code>VACUUM (NOWAIT)</code> to avoid blocking.\n- Coordinate vacuum operations with application transactions.\n- Monitor vacuum progress and lock conflicts.", troubleshooting_code: "SELECT schemaname, tablename, last_vacuum FROM pg_stat_user_tables;", views: 0, helpful_yes: 0, helpful_no: 0, comments: [] },
                        { id: "locking_pg_129", title: "ERROR: cannot acquire lock for foreign key check", errorCode: "40001", severity: "High", solution: "<p>Unable to acquire locks necessary for foreign key constraint checking.</p>", remediation: "- Retry the transaction after a brief delay.\n- Use appropriate transaction isolation levels.\n- Optimize foreign key constraint definitions.\n- Consider deferring constraint checks to end of transaction.", troubleshooting_code: "SELECT conname, confrelid FROM pg_constraint WHERE contype = 'f';", views: 0, helpful_yes: 0, helpful_no: 0, comments: [] },
                        { id: "locking_pg_130", title: "ERROR: cannot acquire lock for constraint validation", errorCode: "40001", severity: "Medium", solution: "<p>Lock acquisition failed during constraint validation operations.</p>", remediation: "- Defer constraint validation to end of transaction.\n- Use appropriate constraint timing (IMMEDIATE vs DEFERRED).\n- Optimize constraint validation logic.\n- Monitor constraint checking performance.", troubleshooting_code: "SELECT conname, condeferrable, condeferred FROM pg_constraint;", views: 0, helpful_yes: 0, helpful_no: 0, comments: [] },
                        { id: "locking_pg_131", title: "ERROR: cannot acquire lock for trigger execution", errorCode: "55P03", severity: "Medium", solution: "<p>Unable to acquire locks necessary for trigger execution.</p>", remediation: "- Optimize trigger logic to minimize lock requirements.\n- Use appropriate trigger timing (BEFORE, AFTER, INSTEAD OF).\n- Review trigger dependencies and execution order.\n- Consider asynchronous trigger execution for complex operations.", troubleshooting_code: "SELECT tgname, tgrelid, tgtype FROM pg_trigger WHERE NOT tgisinternal;", views: 0, helpful_yes: 0, helpful_no: 0, comments: [] },
                        { id: "locking_pg_132", title: "ERROR: cannot acquire lock during index maintenance", errorCode: "55P03", severity: "High", solution: "<p>Lock acquisition failed during index maintenance operations.</p>", remediation: "- Schedule index maintenance during maintenance windows.\n- Use <code>REINDEX CONCURRENTLY</code> to minimize locking impact.\n- Monitor index maintenance progress and conflicts.\n- Coordinate index operations with application activity.", troubleshooting_code: "SELECT schemaname, tablename, indexname FROM pg_indexes;", views: 0, helpful_yes: 0, helpful_no: 0, comments: [] },
                        { id: "locking_pg_133", title: "ERROR: cannot acquire lock for statistics update", errorCode: "55P03", severity: "Low", solution: "<p>Unable to acquire locks for updating table statistics.</p>", remediation: "- Schedule statistics updates during low-activity periods.\n- Use <code>ANALYZE</code> with appropriate timing.\n- Monitor autovacuum and autoanalyze operations.\n- Configure statistics update thresholds appropriately.", troubleshooting_code: "SELECT schemaname, tablename, last_analyze FROM pg_stat_user_tables;", views: 0, helpful_yes: 0, helpful_no: 0, comments: [] },
                        { id: "locking_pg_134", title: "ERROR: cannot acquire lock for sequence operation", errorCode: "55P03", severity: "Medium", solution: "<p>Unable to acquire locks for sequence operations (nextval, setval, etc.).</p>", remediation: "- Retry sequence operations after brief delays.\n- Monitor sequence usage patterns and contention.\n- Consider using separate sequences to reduce contention.\n- Implement appropriate sequence caching strategies.", troubleshooting_code: "SELECT schemaname, sequencename, last_value FROM pg_sequences;", views: 0, helpful_yes: 0, helpful_no: 0, comments: [] }
                    ]
                },
                replication: {
                    title: "Replication & High Availability",
                    icon: "fa-solid fa-clone",
                    intro: "Errors related to data replication, log shipping, database mirroring, and Always On Availability Groups.",
                    issues: [
                         { id: "repl_14151", title: "Replication agent has not logged a message in 10 minutes", errorCode: "14151", severity: "Medium", solution: "<p>This is a warning that indicates a potential issue with a replication agent, such as network latency or a large transaction being processed.</p>", remediation: "1. Check the agent's status in Replication Monitor for more details.\n2. Verify the SQL Server Agent service account has appropriate permissions.\n3. Investigate for network latency or blocking issues.", troubleshooting_code: "SELECT * FROM distribution.dbo.MSlogreader_history WHERE error_id <> 0;", views: 0, helpful_yes: 0, helpful_no: 0, comments: [] },
                         { id: "repl_20598", title: "The row was not found at the Subscriber when applying the replicated command", errorCode: "20598", severity: "High", solution: "<p>The distribution agent tried to apply a change (e.g., DELETE or UPDATE) for a row that doesn't exist on the subscriber, indicating data is out of sync.</p>", remediation: "1. The data at the subscriber is out of sync. Manual intervention is needed.\n2. Use the -SkipErrors parameter on the distribution agent to skip the error (causes data inconsistency).\n3. Reinitialize the subscription to ensure data consistency.", troubleshooting_code: "SELECT * FROM distribution.dbo.MSrepl_errors ORDER BY time DESC;", views: 0, helpful_yes: 0, helpful_no: 0, comments: [] },
                         { id: "replication_new_1", title: "Replication Lag", errorCode: "N/A", severity: "Medium", solution: "<p>The standby server is falling behind the primary, indicating data inconsistency.</p><p><b>Common Causes:</b> Network bandwidth limitations, insufficient I/O capacity on standby, primary generating too much WAL, slow `restore_command`.</p>", remediation: "- Monitor replication lag using `pg_stat_replication`.\n- Check network bandwidth between primary and standby.\n- Ensure standby server has sufficient I/O capacity.\n- Tune `wal_level`, `max_wal_senders`, and `wal_keep_segments` on primary.\n- Tune `restore_command` or `primary_conninfo` on standby.", troubleshooting_code: "SELECT pg_last_wal_receive_lsn(), pg_last_wal_replay_lsn();", views: 0, helpful_yes: 0, helpful_no: 0, comments: [] },
                         { id: "replication_new_2", title: "WAL Receiver Process Terminated", errorCode: "N/A", severity: "High", solution: "<p>The WAL receiver process on the standby server has terminated unexpectedly, stopping replication.</p><p><b>Common Causes:</b> Network connectivity issues, primary server restart, configuration changes, authentication failures, disk space issues.</p>", remediation: "- Check standby server logs for specific error messages.\n- Verify network connectivity between primary and standby.\n- Ensure `primary_conninfo` is correctly configured.\n- Check disk space on standby server.\n- Restart the standby server if necessary.", troubleshooting_code: "SELECT * FROM pg_stat_wal_receiver;", views: 0, helpful_yes: 0, helpful_no: 0, comments: [] },
                         { id: "replication_new_3", title: "Replication Connection Timeout", errorCode: "N/A", severity: "Medium", solution: "<p>The standby server cannot establish or maintain a connection to the primary server for replication.</p><p><b>Common Causes:</b> Network latency, firewall blocking connections, primary server overload, incorrect `primary_conninfo` settings.</p>", remediation: "- Verify network connectivity and latency between servers.\n- Check firewall rules on both primary and standby.\n- Review `primary_conninfo` parameters (host, port, user, password).\n- Consider increasing connection timeout settings.\n- Monitor primary server load and resources.", troubleshooting_code: "SELECT * FROM pg_stat_replication WHERE state = 'streaming';", views: 0, helpful_yes: 0, helpful_no: 0, comments: [] },
                         { id: "replication_pg_101", title: "FATAL: could not start WAL streaming", errorCode: "XX000", severity: "High", solution: "<p>The standby server could not start streaming WAL from the primary, possibly due to network or configuration issues.</p>", remediation: "- Check network connectivity between primary and standby.\n- Verify <code>primary_conninfo</code> and replication slots.\n- Ensure the primary is configured for replication.", troubleshooting_code: "SELECT * FROM pg_stat_replication;", views: 0, helpful_yes: 0, helpful_no: 0, comments: [] },
                         { id: "replication_pg_102", title: "FATAL: replication slot \"slot_name\" does not exist", errorCode: "42704", severity: "Medium", solution: "<p>The specified replication slot does not exist on the primary server.</p>", remediation: "- Create the replication slot using <code>SELECT * FROM pg_create_physical_replication_slot('slot_name');</code>\n- Check for typos in the slot name.", troubleshooting_code: "SELECT slot_name, active FROM pg_replication_slots;", views: 0, helpful_yes: 0, helpful_no: 0, comments: [] },
                         { id: "replication_pg_103", title: "FATAL: requested WAL segment has already been removed", errorCode: "XX000", severity: "High", solution: "<p>The required WAL segment for replication is no longer available on the primary server.</p>", remediation: "- Increase <code>wal_keep_segments</code> or use replication slots to retain WAL files.\n- Reinitialize the standby server if necessary.", troubleshooting_code: "SELECT * FROM pg_walfile_name_offset(pg_current_wal_lsn());", views: 0, helpful_yes: 0, helpful_no: 0, comments: [] },
                         { id: "replication_pg_104", title: "WARNING: replication connection terminated unexpectedly", errorCode: "08006", severity: "Low", solution: "<p>The replication connection was closed unexpectedly, possibly due to network issues or server restarts.</p>", remediation: "- Check network stability and server logs.\n- Ensure both primary and standby servers are running.\n- Monitor for recurring disconnects.", troubleshooting_code: "SELECT client_addr, state FROM pg_stat_replication;", views: 0, helpful_yes: 0, helpful_no: 0, comments: [] },
                         { id: "replication_pg_105", title: "FATAL: could not connect to primary server for replication", errorCode: "08001", severity: "High", solution: "<p>The standby server could not connect to the primary server for replication.</p>", remediation: "- Check network connectivity and firewall rules.\n- Verify <code>primary_conninfo</code> settings.\n- Ensure the primary server is running and accessible.", troubleshooting_code: "SELECT * FROM pg_stat_replication;", views: 0, helpful_yes: 0, helpful_no: 0, comments: [] },
                         { id: "replication_pg_106", title: "FATAL: replication connection dropped due to timeout", errorCode: "57P01", severity: "Medium", solution: "<p>The replication connection was dropped because it was idle for too long.</p>", remediation: "- Increase <code>wal_sender_timeout</code> if appropriate.\n- Monitor network stability and server logs.", troubleshooting_code: "SHOW wal_sender_timeout;", views: 0, helpful_yes: 0, helpful_no: 0, comments: [] },
                         { id: "replication_pg_107", title: "FATAL: could not reserve WAL segment for replication", errorCode: "XX000", severity: "High", solution: "<p>The required WAL segment could not be reserved for replication.</p>", remediation: "- Increase <code>wal_keep_segments</code> or use replication slots.\n- Monitor WAL segment usage and retention.", troubleshooting_code: "SELECT * FROM pg_walfile_name_offset(pg_current_wal_lsn());", views: 0, helpful_yes: 0, helpful_no: 0, comments: [] },
                         { id: "replication_pg_108", title: "WARNING: replication slot inactive for too long", errorCode: "01000", severity: "Low", solution: "<p>A replication slot has been inactive for an extended period, risking WAL file retention issues.</p>", remediation: "- Drop unused replication slots.\n- Monitor slot activity and usage.", troubleshooting_code: "SELECT slot_name, active FROM pg_replication_slots;", views: 0, helpful_yes: 0, helpful_no: 0, comments: [] },
                         { id: "replication_pg_109", title: "FATAL: timeline mismatch detected during replication", errorCode: "XX000", severity: "High", solution: "<p>A timeline mismatch was detected between the primary and standby servers during replication.</p>", remediation: "- Ensure the standby is following the correct timeline.\n- Reinitialize the standby if necessary.", troubleshooting_code: "SELECT timeline_id FROM pg_control_checkpoint();", views: 0, helpful_yes: 0, helpful_no: 0, comments: [] },
                         { id: "replication_pg_111", title: "FATAL: replication connection authenticated but encryption is required", errorCode: "08004", severity: "High", solution: "<p>The replication connection was authenticated but does not meet SSL encryption requirements.</p>", remediation: "- Configure SSL for replication connections.\n- Update <code>primary_conninfo</code> to use SSL parameters.\n- Ensure certificates are properly configured on both servers.", troubleshooting_code: "SELECT client_addr, ssl FROM pg_stat_replication;", views: 0, helpful_yes: 0, helpful_no: 0, comments: [] },
                         { id: "replication_pg_112", title: "ERROR: logical replication worker exited with error", errorCode: "XX000", severity: "High", solution: "<p>A logical replication worker process terminated unexpectedly with an error.</p>", remediation: "- Check PostgreSQL logs for specific error details.\n- Verify subscription and publication configurations.\n- Ensure network connectivity between publisher and subscriber.\n- Restart the subscription if necessary.", troubleshooting_code: "SELECT subname, subenabled FROM pg_subscription; SELECT * FROM pg_stat_subscription;", views: 0, helpful_yes: 0, helpful_no: 0, comments: [] },
                         { id: "replication_pg_113", title: "ERROR: publication does not exist", errorCode: "42704", severity: "Medium", solution: "<p>The specified publication does not exist on the publisher server.</p>", remediation: "- Verify the publication name is correct.\n- Create the publication on the publisher: <code>CREATE PUBLICATION pub_name FOR ALL TABLES;</code>\n- List existing publications: <code>SELECT * FROM pg_publication;</code>", troubleshooting_code: "SELECT pubname FROM pg_publication;", views: 0, helpful_yes: 0, helpful_no: 0, comments: [] },
                         { id: "replication_pg_114", title: "ERROR: subscription does not exist", errorCode: "42704", severity: "Medium", solution: "<p>The specified subscription does not exist on the subscriber server.</p>", remediation: "- Verify the subscription name is correct.\n- Create the subscription on the subscriber.\n- List existing subscriptions: <code>SELECT * FROM pg_subscription;</code>", troubleshooting_code: "SELECT subname, subenabled FROM pg_subscription;", views: 0, helpful_yes: 0, helpful_no: 0, comments: [] },
                         { id: "replication_pg_115", title: "ERROR: cannot create subscription on same server as publication", errorCode: "55006", severity: "High", solution: "<p>Subscriptions cannot be created on the same server instance as their corresponding publication.</p>", remediation: "- Create the subscription on a different PostgreSQL instance.\n- Verify publisher and subscriber are separate database clusters.\n- Use physical replication for same-server replication needs.", troubleshooting_code: "SELECT inet_server_addr(), inet_server_port();", views: 0, helpful_yes: 0, helpful_no: 0, comments: [] },
                         { id: "replication_pg_116", title: "ERROR: logical replication requires wal_level >= logical", errorCode: "55000", severity: "High", solution: "<p>Logical replication requires the WAL level to be set to 'logical' or higher.</p>", remediation: "- Set <code>wal_level = logical</code> in postgresql.conf.\n- Restart PostgreSQL for the change to take effect.\n- Verify the setting: <code>SHOW wal_level;</code>", troubleshooting_code: "SHOW wal_level; SHOW max_replication_slots;", views: 0, helpful_yes: 0, helpful_no: 0, comments: [] },
                         { id: "replication_pg_117", title: "ERROR: could not start logical replication worker", errorCode: "XX000", severity: "High", solution: "<p>A logical replication worker process could not be started.</p>", remediation: "- Check <code>max_logical_replication_workers</code> setting.\n- Verify system resources are available.\n- Review PostgreSQL logs for specific errors.\n- Restart PostgreSQL if necessary.", troubleshooting_code: "SHOW max_logical_replication_workers; SELECT * FROM pg_stat_replication;", views: 0, helpful_yes: 0, helpful_no: 0, comments: [] },
                         { id: "replication_pg_118", title: "ERROR: replication origin does not exist", errorCode: "42704", severity: "Medium", solution: "<p>The specified replication origin does not exist.</p>", remediation: "- Verify the replication origin name.\n- Create the origin if needed: <code>SELECT pg_replication_origin_create('origin_name');</code>\n- List existing origins: <code>SELECT * FROM pg_replication_origin;</code>", troubleshooting_code: "SELECT roname FROM pg_replication_origin;", views: 0, helpful_yes: 0, helpful_no: 0, comments: [] },
                         { id: "replication_pg_119", title: "ERROR: replication slot is active", errorCode: "55006", severity: "Medium", solution: "<p>The replication slot cannot be modified or dropped because it is currently active.</p>", remediation: "- Stop the replication process using the slot.\n- Use <code>pg_drop_replication_slot()</code> only when slot is inactive.\n- Monitor slot activity: <code>SELECT * FROM pg_replication_slots;</code>", troubleshooting_code: "SELECT slot_name, active, active_pid FROM pg_replication_slots;", views: 0, helpful_yes: 0, helpful_no: 0, comments: [] },
                        { id: "replication_pg_120", title: "ERROR: logical replication connection string invalid", errorCode: "08001", severity: "High", solution: "<p>The connection string for logical replication contains invalid parameters or syntax.</p>", remediation: "- Verify connection string syntax and parameters.\n- Check host, port, database, and user specifications.\n- Test connection string manually with psql.\n- Review authentication requirements and SSL settings.", troubleshooting_code: "SELECT subname, subconninfo FROM pg_subscription;", views: 0, helpful_yes: 0, helpful_no: 0, comments: [] },
                        { id: "replication_pg_121", title: "ERROR: replication lag too high", errorCode: "XX000", severity: "High", solution: "<p>The replication lag has exceeded acceptable thresholds, indicating performance issues.</p>", remediation: "- Monitor replication lag using <code>pg_stat_replication</code>.\n- Increase network bandwidth between primary and replica.\n- Optimize WAL generation and processing.\n- Review hardware resources on replica server.", troubleshooting_code: "SELECT application_name, sent_lsn, write_lsn, flush_lsn, replay_lsn FROM pg_stat_replication;", views: 0, helpful_yes: 0, helpful_no: 0, comments: [] },
                        { id: "replication_pg_122", title: "ERROR: standby server promoting while replication active", errorCode: "57P01", severity: "Critical", solution: "<p>The standby server is being promoted to primary while replication is still active.</p>", remediation: "- Stop replication before promoting standby server.\n- Use proper failover procedures and coordination.\n- Monitor primary server status before promotion.\n- Ensure clean promotion process to avoid data conflicts.", troubleshooting_code: "SELECT pg_is_in_recovery(); SELECT * FROM pg_stat_replication;", views: 0, helpful_yes: 0, helpful_no: 0, comments: [] },
                        { id: "replication_pg_123", title: "ERROR: WAL sender process crashed", errorCode: "XX000", severity: "Critical", solution: "<p>The WAL sender process responsible for streaming replication has crashed.</p>", remediation: "- Check PostgreSQL logs for crash details and stack traces.\n- Restart PostgreSQL if necessary to restore replication.\n- Investigate underlying causes (memory, disk, network issues).\n- Monitor system resources and stability.", troubleshooting_code: "SELECT * FROM pg_stat_replication; SELECT pid, application_name FROM pg_stat_activity WHERE application_name LIKE '%wal%';", views: 0, helpful_yes: 0, helpful_no: 0, comments: [] },
                        { id: "replication_pg_124", title: "ERROR: logical replication worker process terminated", errorCode: "XX000", severity: "High", solution: "<p>A logical replication worker process terminated unexpectedly.</p>", remediation: "- Check PostgreSQL logs for worker termination reasons.\n- Restart the subscription to recreate worker processes.\n- Monitor worker process stability and resource usage.\n- Review subscription configuration for issues.", troubleshooting_code: "SELECT subname, subenabled FROM pg_subscription; SELECT * FROM pg_stat_subscription;", views: 0, helpful_yes: 0, helpful_no: 0, comments: [] },
                        { id: "replication_pg_125", title: "ERROR: synchronous replication timeout", errorCode: "57014", severity: "High", solution: "<p>Synchronous replication operation timed out waiting for replica acknowledgment.</p>", remediation: "- Check network connectivity to synchronous replicas.\n- Increase <code>synchronous_commit_timeout</code> if appropriate.\n- Monitor replica server performance and availability.\n- Consider switching to asynchronous replication temporarily.", troubleshooting_code: "SHOW synchronous_standby_names; SHOW synchronous_commit_timeout;", views: 0, helpful_yes: 0, helpful_no: 0, comments: [] },
                        { id: "replication_pg_126", title: "ERROR: replication conflict with hot standby", errorCode: "40001", severity: "Medium", solution: "<p>A conflict occurred between replication and queries running on a hot standby.</p>", remediation: "- Cancel or delay conflicting queries on standby.\n- Increase <code>max_standby_streaming_delay</code> or <code>max_standby_archive_delay</code>.\n- Use <code>hot_standby_feedback</code> to reduce conflicts.\n- Monitor and optimize query patterns on standby.", troubleshooting_code: "SHOW hot_standby_feedback; SHOW max_standby_streaming_delay;", views: 0, helpful_yes: 0, helpful_no: 0, comments: [] },
                        { id: "replication_pg_127", title: "ERROR: replication stream ended prematurely", errorCode: "08006", severity: "High", solution: "<p>The replication stream was terminated before completion.</p>", remediation: "- Check network connectivity between primary and replica.\n- Monitor primary server stability and resource availability.\n- Review firewall and network infrastructure.\n- Restart replication with appropriate error handling.", troubleshooting_code: "SELECT * FROM pg_stat_wal_receiver; SELECT * FROM pg_stat_replication;", views: 0, helpful_yes: 0, helpful_no: 0, comments: [] },
                        { id: "replication_pg_128", title: "ERROR: logical replication table synchronization failed", errorCode: "XX000", severity: "High", solution: "<p>Initial table synchronization for logical replication failed.</p>", remediation: "- Check table permissions and schema compatibility.\n- Verify publication includes all required tables.\n- Monitor synchronization worker logs for specific errors.\n- Restart subscription with proper table state.", troubleshooting_code: "SELECT * FROM pg_subscription_rel; SELECT * FROM pg_stat_subscription;", views: 0, helpful_yes: 0, helpful_no: 0, comments: [] },
                        { id: "replication_pg_129", title: "ERROR: replication slot disk usage too high", errorCode: "53100", severity: "High", solution: "<p>Replication slots are consuming excessive disk space.</p>", remediation: "- Monitor and clean up inactive replication slots.\n- Adjust <code>max_slot_wal_keep_size</code> if available.\n- Ensure subscribers are consuming WAL efficiently.\n- Implement replication slot monitoring and alerting.", troubleshooting_code: "SELECT slot_name, pg_size_pretty(pg_wal_lsn_diff(pg_current_wal_lsn(), restart_lsn)) FROM pg_replication_slots;", views: 0, helpful_yes: 0, helpful_no: 0, comments: [] },
                        { id: "replication_pg_130", title: "ERROR: cascading replication configuration error", errorCode: "XX000", severity: "Medium", solution: "<p>Configuration error in cascading replication setup.</p>", remediation: "- Verify cascading replication configuration parameters.\n- Check <code>primary_conninfo</code> settings on intermediate servers.\n- Ensure proper replication user permissions.\n- Test cascading replication chain connectivity.", troubleshooting_code: "SELECT * FROM pg_stat_wal_receiver; SHOW primary_conninfo;", views: 0, helpful_yes: 0, helpful_no: 0, comments: [] },
                        { id: "replication_pg_131", title: "ERROR: physical replication slot advance failed", errorCode: "XX000", severity: "Medium", solution: "<p>Failed to advance physical replication slot position.</p>", remediation: "- Check replication slot status and activity.\n- Verify WAL availability for slot advancement.\n- Use <code>pg_replication_slot_advance()</code> with caution.\n- Monitor slot lag and consumption patterns.", troubleshooting_code: "SELECT slot_name, restart_lsn, confirmed_flush_lsn FROM pg_replication_slots;", views: 0, helpful_yes: 0, helpful_no: 0, comments: [] },
                        { id: "replication_pg_132", title: "ERROR: logical replication schema mismatch", errorCode: "XX000", severity: "High", solution: "<p>Schema differences between publisher and subscriber preventing replication.</p>", remediation: "- Synchronize schema definitions between publisher and subscriber.\n- Use schema-only dumps to align table structures.\n- Handle data type compatibility issues.\n- Plan schema evolution in replication environments.", troubleshooting_code: "SELECT schemaname, tablename FROM pg_tables; SELECT * FROM pg_publication_tables;", views: 0, helpful_yes: 0, helpful_no: 0, comments: [] },
                        { id: "replication_pg_133", title: "ERROR: bidirectional replication conflict detected", errorCode: "40001", severity: "Critical", solution: "<p>A conflict was detected in bidirectional (multi-master) replication setup.</p>", remediation: "- Implement conflict resolution strategies.\n- Use appropriate replication solutions for multi-master setups.\n- Monitor and handle replication conflicts proactively.\n- Consider timestamp-based or application-level conflict resolution.", troubleshooting_code: "SELECT * FROM pg_stat_subscription; SELECT * FROM pg_publication;", views: 0, helpful_yes: 0, helpful_no: 0, comments: [] },
                        { id: "replication_pg_134", title: "ERROR: replication authentication token expired", errorCode: "28000", severity: "Medium", solution: "<p>Authentication token for replication connection has expired.</p>", remediation: "- Refresh authentication tokens or credentials.\n- Update replication connection configuration.\n- Implement automatic token renewal if available.\n- Monitor authentication token lifecycle.", troubleshooting_code: "SELECT * FROM pg_stat_replication; SELECT rolvaliduntil FROM pg_authid WHERE rolname = 'replication_user';", views: 0, helpful_yes: 0, helpful_no: 0, comments: [] }
                    ]
                },
                backup_recovery: {
                    title: "Backup & Recovery",
                    icon: "fa-solid fa-database",
                    intro: "Failures and issues encountered during database backup and restore operations.",
                    issues: [
                        { id: "backup_3041", title: "BACKUP failed to complete the command BACKUP DATABASE", errorCode: "3041", severity: "High", solution: "<p>A generic backup failure message. The SQL error log will contain more specific details about the root cause.</p>", remediation: "1. Check for sufficient disk space on the destination.\n2. Verify the SQL Server service account has write permissions on the backup folder.\n3. Run DBCC CHECKDB to check for underlying database corruption.", troubleshooting_code: "xp_cmdshell 'dir <backup_destination_path>';", views: 0, helpful_yes: 0, helpful_no: 0, comments: [] },
                        { id: "backup_3241", title: "The media family on device is incorrectly formed. SQL Server cannot process this media family", errorCode: "3241", severity: "High", solution: "<p>The backup file is corrupt or is not a valid SQL Server backup file. This can happen from a failed copy or disk issues.</p>", remediation: "1. The backup file is corrupt and likely unusable.\n2. Try restoring from a different, verified backup set.\n3. Verify the backup was created with a compatible SQL Server version.", troubleshooting_code: "RESTORE VERIFYONLY FROM DISK = 'path_to_backup.bak';", views: 0, helpful_yes: 0, helpful_no: 0, comments: [] },
                        { id: "backup_recovery_new_1", title: "pg_basebackup: could not connect to server", errorCode: "N/A", severity: "High", solution: "<p>The `pg_basebackup` utility failed to establish a connection to the PostgreSQL primary server.</p><p><b>Common Causes:</b> Primary server not running, incorrect host/port, firewall blocking connection, incorrect `pg_hba.conf` entry on primary.</p>", remediation: "- Verify the primary PostgreSQL server is running.\n- Double-check the host and port in the `pg_basebackup` command.\n- Check firewall rules on both primary and backup servers.\n- Ensure `pg_hba.conf` on the primary allows replication connections from the backup server's IP.", troubleshooting_code: "pg_isready -h <primary_host> -p <port>", views: 0, helpful_yes: 0, helpful_no: 0, comments: [] },
                        { id: "backup_recovery_new_2", title: "pg_dump: could not open output file", errorCode: "N/A", severity: "Medium", solution: "<p>The `pg_dump` utility cannot create or write to the specified output file.</p><p><b>Common Causes:</b> Insufficient disk space, incorrect file permissions, directory doesn't exist, file is locked by another process.</p>", remediation: "- Check available disk space on the target directory.\n- Verify write permissions for the user running `pg_dump`.\n- Ensure the target directory exists and is accessible.\n- Close any applications that might have the file open.\n- Use a different filename or location.", troubleshooting_code: "df -h /path/to/backup/directory", views: 0, helpful_yes: 0, helpful_no: 0, comments: [] },
                        { id: "backup_recovery_new_3", title: "pg_restore: could not read from input file", errorCode: "N/A", severity: "High", solution: "<p>The `pg_restore` utility cannot read the specified backup file.</p><p><b>Common Causes:</b> File is corrupted, insufficient read permissions, file doesn't exist, disk I/O errors, incomplete download.</p>", remediation: "- Verify the backup file exists and is not corrupted.\n- Check file permissions and ensure the user has read access.\n- Validate the backup file integrity using checksums if available.\n- Try restoring from a different backup file.\n- Re-download or re-create the backup if necessary.", troubleshooting_code: "ls -la /path/to/backup/file.sql", views: 0, helpful_yes: 0, helpful_no: 0, comments: [] },
                        { id: "backup_pg_101", title: "ERROR: backup label file already exists", errorCode: "XX000", severity: "Medium", solution: "<p>A backup label file from a previous backup operation still exists, preventing a new backup from starting.</p>", remediation: "- Remove the old <code>backup_label</code> file from the data directory.\n- Ensure previous backup operations completed successfully.", troubleshooting_code: "ls -l $PGDATA/backup_label", views: 0, helpful_yes: 0, helpful_no: 0, comments: [] },
                        { id: "backup_pg_102", title: "ERROR: could not write to file during backup", errorCode: "XX000", severity: "High", solution: "<p>The backup process failed to write to a file, possibly due to disk space or permission issues.</p>", remediation: "- Check available disk space and file permissions.\n- Ensure the backup destination is writable.\n- Review system logs for I/O errors.", troubleshooting_code: "df -h; ls -l /path/to/backup", views: 0, helpful_yes: 0, helpful_no: 0, comments: [] },
                        { id: "backup_pg_103", title: "FATAL: base backup could not be completed", errorCode: "XX000", severity: "High", solution: "<p>The base backup operation failed, possibly due to server configuration or resource issues.</p>", remediation: "- Review server logs for errors during the backup window.\n- Ensure <code>max_wal_senders</code> and <code>wal_level</code> are set appropriately.\n- Check for network interruptions.", troubleshooting_code: "SHOW max_wal_senders; SHOW wal_level;", views: 0, helpful_yes: 0, helpful_no: 0, comments: [] },
                        { id: "backup_pg_104", title: "WARNING: backup file checksum mismatch", errorCode: "XX001", severity: "Low", solution: "<p>The checksum of a backup file does not match the expected value, indicating possible corruption.</p>", remediation: "- Re-run the backup and verify checksums.\n- Store backups on reliable storage.\n- Use <code>pg_verifybackup</code> to check backup integrity.", troubleshooting_code: "pg_verifybackup /path/to/backup", views: 0, helpful_yes: 0, helpful_no: 0, comments: [] },
                        { id: "backup_pg_105", title: "ERROR: backup manifest file is missing", errorCode: "XX000", severity: "High", solution: "<p>The backup manifest file required for backup verification is missing.</p>", remediation: "- Ensure the backup process generates a manifest file.\n- Re-run the backup if necessary.\n- Use <code>pg_verifybackup</code> to check backup integrity.", troubleshooting_code: "ls -l /path/to/backup/manifest", views: 0, helpful_yes: 0, helpful_no: 0, comments: [] },
                        { id: "backup_pg_106", title: "ERROR: could not remove old backup file", errorCode: "XX000", severity: "Medium", solution: "<p>The backup process failed to remove an old backup file, possibly due to permissions or file locks.</p>", remediation: "- Check file permissions and ownership.\n- Ensure no other process is using the file.", troubleshooting_code: "ls -l /path/to/backup", views: 0, helpful_yes: 0, helpful_no: 0, comments: [] },
                        { id: "backup_pg_107", title: "ERROR: backup file is not readable", errorCode: "XX000", severity: "High", solution: "<p>The backup file cannot be read, possibly due to corruption or permission issues.</p>", remediation: "- Check file permissions and integrity.\n- Restore from a different backup if necessary.", troubleshooting_code: "ls -l /path/to/backup/file; file /path/to/backup/file", views: 0, helpful_yes: 0, helpful_no: 0, comments: [] },
                        { id: "backup_pg_108", title: "WARNING: backup retention period exceeded", errorCode: "01000", severity: "Low", solution: "<p>The backup retention period has been exceeded, risking loss of old backups.</p>", remediation: "- Review and adjust backup retention policies.\n- Archive or delete old backups as needed.", troubleshooting_code: "ls -lt /path/to/backup", views: 0, helpful_yes: 0, helpful_no: 0, comments: [] },
                        { id: "backup_pg_109", title: "ERROR: backup process interrupted by signal", errorCode: "57014", severity: "Medium", solution: "<p>The backup process was interrupted by a signal (e.g., SIGINT, SIGTERM).</p>", remediation: "- Avoid interrupting backup processes.\n- Schedule backups during maintenance windows.", troubleshooting_code: "cat /var/log/postgresql/postgresql.log | grep backup", views: 0, helpful_yes: 0, helpful_no: 0, comments: [] },
                        { id: "backup_pg_111", title: "ERROR: archive command failed", errorCode: "XX000", severity: "High", solution: "<p>The WAL archive command specified in postgresql.conf failed to execute successfully.</p>", remediation: "- Check the <code>archive_command</code> configuration.\n- Verify the archive destination is accessible and has sufficient space.\n- Test the archive command manually.\n- Review archive command logs for specific errors.", troubleshooting_code: "SHOW archive_command; SELECT * FROM pg_stat_archiver;", views: 0, helpful_yes: 0, helpful_no: 0, comments: [] },
                        { id: "backup_pg_112", title: "ERROR: backup label not found", errorCode: "XX000", severity: "High", solution: "<p>The backup label file expected during recovery or backup operations was not found.</p>", remediation: "- Ensure the backup was completed successfully.\n- Check if the backup_label file exists in the data directory.\n- Verify backup integrity before attempting recovery.\n- Use <code>pg_basebackup</code> for consistent backups.", troubleshooting_code: "ls -la $PGDATA/backup_label*", views: 0, helpful_yes: 0, helpful_no: 0, comments: [] },
                        { id: "backup_pg_113", title: "ERROR: WAL file not found during recovery", errorCode: "XX000", severity: "Critical", solution: "<p>A required WAL file was not found during the recovery process.</p>", remediation: "- Check if WAL files are available in pg_wal directory or archive.\n- Verify archive recovery settings in recovery.conf or postgresql.conf.\n- Ensure restore_command is correctly configured.\n- Consider point-in-time recovery limitations.", troubleshooting_code: "ls -la $PGDATA/pg_wal/; SHOW restore_command;", views: 0, helpful_yes: 0, helpful_no: 0, comments: [] },
                        { id: "backup_pg_114", title: "ERROR: invalid checkpoint in backup", errorCode: "XX000", severity: "High", solution: "<p>The backup contains an invalid checkpoint, preventing successful recovery.</p>", remediation: "- Verify backup integrity using <code>pg_verifybackup</code>.\n- Restore from a different, verified backup.\n- Ensure backup was taken while database was running.\n- Check for filesystem corruption on backup storage.", troubleshooting_code: "pg_verifybackup /path/to/backup", views: 0, helpful_yes: 0, helpful_no: 0, comments: [] },
                        { id: "backup_pg_115", title: "ERROR: backup contains inconsistent data", errorCode: "XX000", severity: "Critical", solution: "<p>The backup contains inconsistent data, likely due to taking a backup while the database was not in a consistent state.</p>", remediation: "- Use <code>pg_basebackup</code> for consistent online backups.\n- Ensure proper backup procedures are followed.\n- Verify backup timing and coordination with application activity.\n- Consider using file system snapshots for consistent backups.", troubleshooting_code: "SELECT pg_is_in_backup_state();", views: 0, helpful_yes: 0, helpful_no: 0, comments: [] },
                        { id: "backup_pg_116", title: "ERROR: could not create backup directory", errorCode: "XX000", severity: "High", solution: "<p>The backup process could not create the required directory structure.</p>", remediation: "- Check file system permissions for the backup destination.\n- Ensure sufficient disk space is available.\n- Verify the parent directory exists and is writable.\n- Run backup process with appropriate user privileges.", troubleshooting_code: "df -h /backup/path; ls -ld /backup/path", views: 0, helpful_yes: 0, helpful_no: 0, comments: [] },
                        { id: "backup_pg_117", title: "ERROR: backup stream ended unexpectedly", errorCode: "XX000", severity: "High", solution: "<p>The backup stream was terminated unexpectedly during the backup process.</p>", remediation: "- Check network connectivity between backup client and server.\n- Verify server stability and resource availability.\n- Monitor for server restarts or crashes during backup.\n- Increase network timeout settings if appropriate.", troubleshooting_code: "SELECT * FROM pg_stat_replication; SELECT * FROM pg_stat_activity WHERE application_name LIKE '%backup%';", views: 0, helpful_yes: 0, helpful_no: 0, comments: [] },
                        { id: "backup_pg_118", title: "ERROR: could not open backup manifest for writing", errorCode: "XX000", severity: "Medium", solution: "<p>The backup manifest file could not be opened for writing during backup creation.</p>", remediation: "- Check file permissions in the backup destination directory.\n- Ensure sufficient disk space for manifest file.\n- Verify the backup process has write access to the destination.\n- Review file system integrity on backup storage.", troubleshooting_code: "ls -la /backup/path/; df -h /backup/path", views: 0, helpful_yes: 0, helpful_no: 0, comments: [] },
                        { id: "backup_pg_119", title: "ERROR: backup timeline does not match", errorCode: "XX000", severity: "High", solution: "<p>The backup timeline does not match the expected timeline for recovery.</p>", remediation: "- Verify the backup is from the correct database cluster.\n- Check timeline consistency between backup and WAL files.\n- Use appropriate timeline for point-in-time recovery.\n- Consider timeline branch recovery if needed.", troubleshooting_code: "SELECT timeline_id, redo_lsn FROM pg_control_checkpoint();", views: 0, helpful_yes: 0, helpful_no: 0, comments: [] },
                        { id: "backup_pg_120", title: "ERROR: backup compression failed", errorCode: "XX000", severity: "Medium", solution: "<p>Compression of backup files failed during the backup process.</p>", remediation: "- Check available disk space for compressed backups.\n- Verify compression tool availability and configuration.\n- Test compression settings with smaller datasets.\n- Monitor compression performance and adjust parameters.", troubleshooting_code: "df -h /backup/path; which gzip; which lz4;", views: 0, helpful_yes: 0, helpful_no: 0, comments: [] },
                        { id: "backup_pg_121", title: "ERROR: backup encryption setup failed", errorCode: "XX000", severity: "High", solution: "<p>Setup of backup encryption failed, preventing secure backup creation.</p>", remediation: "- Verify encryption key availability and permissions.\n- Check encryption tool configuration and dependencies.\n- Test encryption settings with test data.\n- Review backup encryption requirements and compliance.", troubleshooting_code: "ls -la /encryption/keys; which gpg; which openssl;", views: 0, helpful_yes: 0, helpful_no: 0, comments: [] },
                        { id: "backup_pg_122", title: "ERROR: incremental backup base not found", errorCode: "XX000", severity: "High", solution: "<p>The base backup required for incremental backup was not found.</p>", remediation: "- Verify base backup location and accessibility.\n- Check backup catalog for base backup information.\n- Perform full backup if base backup is corrupted or missing.\n- Review incremental backup configuration and dependencies.", troubleshooting_code: "ls -la /backup/base/; pg_verifybackup /backup/base/", views: 0, helpful_yes: 0, helpful_no: 0, comments: [] },
                        { id: "backup_pg_123", title: "ERROR: backup verification checksum failed", errorCode: "XX001", severity: "Critical", solution: "<p>Backup verification failed due to checksum mismatches.</p>", remediation: "- Re-create the backup from source.\n- Check storage integrity and hardware issues.\n- Verify backup transfer processes and network reliability.\n- Implement backup verification as standard procedure.", troubleshooting_code: "pg_verifybackup /backup/path; md5sum /backup/files/*", views: 0, helpful_yes: 0, helpful_no: 0, comments: [] },
                        { id: "backup_pg_124", title: "ERROR: parallel backup worker failed", errorCode: "XX000", severity: "High", solution: "<p>One or more parallel backup worker processes failed during backup creation.</p>", remediation: "- Check system resources and worker process limits.\n- Review parallel backup configuration parameters.\n- Monitor worker process logs for specific errors.\n- Reduce parallelism if resource constraints exist.", troubleshooting_code: "ps aux | grep backup; SELECT * FROM pg_stat_activity WHERE application_name LIKE '%backup%';", views: 0, helpful_yes: 0, helpful_no: 0, comments: [] },
                        { id: "backup_pg_125", title: "ERROR: backup destination unreachable", errorCode: "XX000", severity: "High", solution: "<p>The backup destination (network location, cloud storage) is unreachable.</p>", remediation: "- Verify network connectivity to backup destination.\n- Check credentials and permissions for remote storage.\n- Test backup destination accessibility manually.\n- Implement backup destination failover mechanisms.", troubleshooting_code: "ping backup-server; curl -I https://backup-endpoint/", views: 0, helpful_yes: 0, helpful_no: 0, comments: [] },
                        { id: "backup_pg_126", title: "ERROR: WAL archive restoration timeout", errorCode: "XX000", severity: "High", solution: "<p>Restoration of WAL files from archive timed out during recovery.</p>", remediation: "- Increase <code>restore_command</code> timeout settings.\n- Check archive storage performance and availability.\n- Verify network connectivity to archive location.\n- Monitor WAL restoration performance and optimize as needed.", troubleshooting_code: "SHOW restore_command; SELECT * FROM pg_stat_archiver;", views: 0, helpful_yes: 0, helpful_no: 0, comments: [] },
                        { id: "backup_pg_127", title: "ERROR: backup catalog corruption detected", errorCode: "XX000", severity: "Critical", solution: "<p>The backup catalog containing backup metadata is corrupted.</p>", remediation: "- Restore backup catalog from backup copies.\n- Rebuild backup catalog from available backup files.\n- Implement backup catalog redundancy and protection.\n- Verify backup catalog integrity regularly.", troubleshooting_code: "ls -la /backup/catalog/; file /backup/catalog/*", views: 0, helpful_yes: 0, helpful_no: 0, comments: [] },
                        { id: "backup_pg_128", title: "ERROR: point-in-time recovery target not reachable", errorCode: "XX000", severity: "High", solution: "<p>The specified point-in-time recovery target cannot be reached with available WAL files.</p>", remediation: "- Verify WAL file availability for the target time.\n- Check archive completeness and integrity.\n- Adjust recovery target to available WAL coverage.\n- Review backup and archiving procedures for gaps.", troubleshooting_code: "SELECT pg_walfile_name_offset(pg_current_wal_lsn()); ls -la $PGDATA/pg_wal/", views: 0, helpful_yes: 0, helpful_no: 0, comments: [] },
                        { id: "backup_pg_129", title: "ERROR: backup storage quota exceeded", errorCode: "53100", severity: "High", solution: "<p>Backup storage has exceeded allocated quota or available space.</p>", remediation: "- Clean up old or unnecessary backup files.\n- Increase backup storage quota if possible.\n- Implement backup retention policies.\n- Monitor backup storage usage and implement alerting.", troubleshooting_code: "df -h /backup/storage; du -sh /backup/storage/*", views: 0, helpful_yes: 0, helpful_no: 0, comments: [] },
                        { id: "backup_pg_130", title: "ERROR: backup repository corruption", errorCode: "XX000", severity: "Critical", solution: "<p>The backup repository structure or metadata is corrupted.</p>", remediation: "- Restore repository from backup copies.\n- Rebuild repository structure from backup files.\n- Verify repository integrity and implement protective measures.\n- Review repository maintenance procedures.", troubleshooting_code: "ls -la /backup/repository/; find /backup/repository -type f -name '*.corrupt'", views: 0, helpful_yes: 0, helpful_no: 0, comments: [] },
                        { id: "backup_pg_131", title: "ERROR: backup deduplication failed", errorCode: "XX000", severity: "Medium", solution: "<p>Backup deduplication process failed, potentially increasing storage usage.</p>", remediation: "- Check deduplication tool configuration and availability.\n- Verify storage performance and capacity.\n- Monitor deduplication ratios and effectiveness.\n- Consider alternative deduplication strategies.", troubleshooting_code: "which dedupe-tool; df -h /backup/storage; ls -la /backup/dedupe/", views: 0, helpful_yes: 0, helpful_no: 0, comments: [] },
                        { id: "backup_pg_132", title: "ERROR: cross-platform backup restore failed", errorCode: "XX000", severity: "High", solution: "<p>Backup restore failed due to cross-platform compatibility issues.</p>", remediation: "- Verify platform compatibility for backup and restore.\n- Use platform-neutral backup formats.\n- Test cross-platform restore procedures.\n- Document platform-specific restore requirements.", troubleshooting_code: "uname -a; file /backup/data/*; pg_controldata /backup/data", views: 0, helpful_yes: 0, helpful_no: 0, comments: [] },
                        { id: "backup_pg_133", title: "ERROR: backup chain broken", errorCode: "XX000", severity: "Critical", solution: "<p>The backup chain is broken, preventing incremental restore operations.</p>", remediation: "- Identify missing backup segments in the chain.\n- Restore from alternative backup chains if available.\n- Rebuild backup chain from available full backups.\n- Implement backup chain validation procedures.", troubleshooting_code: "ls -la /backup/incremental/; find /backup -name '*.backup' | sort", views: 0, helpful_yes: 0, helpful_no: 0, comments: [] },
                        { id: "backup_pg_134", title: "ERROR: backup retention policy violation", errorCode: "XX000", severity: "Medium", solution: "<p>Backup retention policy has been violated, affecting compliance or recovery options.</p>", remediation: "- Review and adjust backup retention policies.\n- Implement automated retention policy enforcement.\n- Monitor backup age and compliance status.\n- Document retention policy requirements and rationale.", troubleshooting_code: "find /backup -type f -mtime +30 | wc -l; ls -lt /backup/", views: 0, helpful_yes: 0, helpful_no: 0, comments: [] }
                    ]
                },
                database_tools: {
                    title: "Database Tools & Utilities",
                    icon: "fa-solid fa-tools",
                    content: `<div class="prose dark:prose-invert max-w-none space-y-8">
                        <div class="p-6 bg-gradient-to-r from-green-600 to-blue-600 text-white rounded-2xl shadow-lg">
                            <h1 class="text-3xl font-bold mb-2">Database Tools & Utilities</h1>
                            <p class="text-green-100 text-lg">Essential tools and utilities for PostgreSQL database management and administration.</p>
                        </div>

                        <!-- Tool Categories with Tabs -->
                        <div class="tab-navigation">
                            <button class="tab-button active" data-tab="administration">Administration</button>
                            <button class="tab-button" data-tab="monitoring">Monitoring</button>
                            <button class="tab-button" data-tab="optimization">Optimization</button>
                            <button class="tab-button" data-tab="utilities">Utilities</button>
                        </div>

                        <!-- Administration Tools -->
                        <div id="administration-tab" class="tab-content active">
                            <div class="category-grid">
                                <div class="category-card">
                                    <div class="category-icon">
                                        <i class="fa-solid fa-terminal"></i>
                                    </div>
                                    <h3 class="category-title">psql</h3>
                                    <p class="category-description">Interactive terminal for PostgreSQL with advanced querying capabilities</p>
                                    <div class="mt-4">
                                        <h4 class="font-semibold mb-2">Common Commands:</h4>
                                        <pre class="text-xs bg-base-100 dark:bg-base-800 p-2 rounded"><code>\\l - List databases
\\dt - List tables
\\d table_name - Describe table
\\q - Quit psql</code></pre>
                                    </div>
                                </div>

                                <div class="category-card">
                                    <div class="category-icon">
                                        <i class="fa-solid fa-database"></i>
                                    </div>
                                    <h3 class="category-title">pgAdmin</h3>
                                    <p class="category-description">Web-based administration platform with GUI management tools</p>
                                    <div class="mt-4">
                                        <h4 class="font-semibold mb-2">Features:</h4>
                                        <ul class="text-sm space-y-1">
                                            <li>â€¢ Visual query builder</li>
                                            <li>â€¢ Database object management</li>
                                            <li>â€¢ Backup/restore interface</li>
                                            <li>â€¢ Performance monitoring</li>
                                        </ul>
                                    </div>
                                </div>

                                <div class="category-card">
                                    <div class="category-icon">
                                        <i class="fa-solid fa-cloud"></i>
                                    </div>
                                    <h3 class="category-title">PostgREST</h3>
                                    <p class="category-description">Automatically generates RESTful API from PostgreSQL schema</p>
                                    <div class="mt-4">
                                        <h4 class="font-semibold mb-2">Benefits:</h4>
                                        <ul class="text-sm space-y-1">
                                            <li>â€¢ Zero-configuration API</li>
                                            <li>â€¢ Automatic OpenAPI docs</li>
                                            <li>â€¢ JWT authentication</li>
                                            <li>â€¢ Real-time subscriptions</li>
                                        </ul>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- Monitoring Tools -->
                        <div id="monitoring-tab" class="tab-content">
                            <div class="category-grid">
                                <div class="category-card">
                                    <div class="category-icon">
                                        <i class="fa-solid fa-chart-line"></i>
                                    </div>
                                    <h3 class="category-title">pg_stat_statements</h3>
                                    <p class="category-description">Extension for tracking execution statistics of SQL statements</p>
                                    <div class="mt-4">
                                        <pre class="text-xs bg-base-100 dark:bg-base-800 p-2 rounded"><code>-- Top 10 slowest queries
SELECT query, calls, total_exec_time
FROM pg_stat_statements 
ORDER BY total_exec_time DESC 
LIMIT 10;</code></pre>
                                    </div>
                                </div>

                                <div class="category-card">
                                    <div class="category-icon">
                                        <i class="fa-solid fa-eye"></i>
                                    </div>
                                    <h3 class="category-title">pg_top / pg_activity</h3>
                                    <p class="category-description">Real-time monitoring of PostgreSQL activity and processes</p>
                                    <div class="mt-4">
                                        <h4 class="font-semibold mb-2">Installation:</h4>
                                        <pre class="text-xs bg-base-100 dark:bg-base-800 p-2 rounded"><code>pip install pg_activity
pg_activity -h localhost -U postgres</code></pre>
                                    </div>
                                </div>

                                <div class="category-card">
                                    <div class="category-icon">
                                        <i class="fa-solid fa-heartbeat"></i>
                                    </div>
                                    <h3 class="category-title">check_postgres</h3>
                                    <p class="category-description">Nagios-compatible monitoring plugin for PostgreSQL health checks</p>
                                    <div class="mt-4">
                                        <h4 class="font-semibold mb-2">Sample Checks:</h4>
                                        <ul class="text-sm space-y-1">
                                            <li>â€¢ Database connections</li>
                                            <li>â€¢ Disk usage</li>
                                            <li>â€¢ Replication lag</li>
                                            <li>â€¢ Lock contention</li>
                                        </ul>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- Optimization Tools -->
                        <div id="optimization-tab" class="tab-content">
                            <div class="category-grid">
                                <div class="category-card">
                                    <div class="category-icon">
                                        <i class="fa-solid fa-magic"></i>
                                    </div>
                                    <h3 class="category-title">pg_tune</h3>
                                    <p class="category-description">Automatic PostgreSQL configuration tuning based on hardware specs</p>
                                    <div class="mt-4">
                                        <h4 class="font-semibold mb-2">Usage:</h4>
                                        <pre class="text-xs bg-base-100 dark:bg-base-800 p-2 rounded"><code>git clone https://github.com/le0pard/pgtune
# Use web interface or CLI to generate optimized config</code></pre>
                                    </div>
                                </div>

                                <div class="category-card">
                                    <div class="category-icon">
                                        <i class="fa-solid fa-search"></i>
                                    </div>
                                    <h3 class="category-title">pg_hint_plan</h3>
                                    <p class="category-description">Extension to provide query execution hints to the PostgreSQL planner</p>
                                    <div class="mt-4">
                                        <pre class="text-xs bg-base-100 dark:bg-base-800 p-2 rounded"><code>/*+ IndexScan(t1) */
SELECT * FROM table1 t1
WHERE id = 1000;</code></pre>
                                    </div>
                                </div>

                                <div class="category-card">
                                    <div class="category-icon">
                                        <i class="fa-solid fa-broom"></i>
                                    </div>
                                    <h3 class="category-title">pg_repack</h3>
                                    <p class="category-description">Online reorganization of PostgreSQL tables without exclusive locks</p>
                                    <div class="mt-4">
                                        <h4 class="font-semibold mb-2">Benefits:</h4>
                                        <ul class="text-sm space-y-1">
                                            <li>â€¢ Reduce table bloat</li>
                                            <li>â€¢ Reclaim disk space</li>
                                            <li>â€¢ Improve performance</li>
                                            <li>â€¢ Zero downtime</li>
                                        </ul>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- Utilities -->
                        <div id="utilities-tab" class="tab-content">
                            <div class="category-grid">
                                <div class="category-card">
                                    <div class="category-icon">
                                        <i class="fa-solid fa-download"></i>
                                    </div>
                                    <h3 class="category-title">pg_dump / pg_restore</h3>
                                    <p class="category-description">Standard backup and restore utilities for PostgreSQL databases</p>
                                    <div class="mt-4">
                                        <pre class="text-xs bg-base-100 dark:bg-base-800 p-2 rounded"><code># Backup
pg_dump -h localhost -U postgres -d mydb > backup.sql

# Restore
pg_restore -h localhost -U postgres -d newdb backup.dump</code></pre>
                                    </div>
                                </div>

                                <div class="category-card">
                                    <div class="category-icon">
                                        <i class="fa-solid fa-copy"></i>
                                    </div>
                                    <h3 class="category-title">pg_basebackup</h3>
                                    <p class="category-description">Taking base backups for streaming replication and point-in-time recovery</p>
                                    <div class="mt-4">
                                        <pre class="text-xs bg-base-100 dark:bg-base-800 p-2 rounded"><code>pg_basebackup -h primary_host -D /backup/base -U replication -W -P</code></pre>
                                    </div>
                                </div>

                                <div class="category-card">
                                    <div class="category-icon">
                                        <i class="fa-solid fa-code"></i>
                                    </div>
                                    <h3 class="category-title">pg_bench</h3>
                                    <p class="category-description">Simple benchmark tool for PostgreSQL performance testing</p>
                                    <div class="mt-4">
                                        <pre class="text-xs bg-base-100 dark:bg-base-800 p-2 rounded"><code># Initialize test database
pgbench -i -s 50 testdb

# Run benchmark
pgbench -c 10 -t 1000 testdb</code></pre>
                                    </div>
                                </div>

                                <div class="category-card">
                                    <div class="category-icon">
                                        <i class="fa-solid fa-shield-alt"></i>
                                    </div>
                                    <h3 class="category-title">pg_checksums</h3>
                                    <p class="category-description">Enable, disable, or verify checksums in PostgreSQL data files</p>
                                    <div class="mt-4">
                                        <pre class="text-xs bg-base-100 dark:bg-base-800 p-2 rounded"><code># Verify checksums
pg_checksums --check -D /var/lib/postgresql/data</code></pre>
                                    </div>
                                </div>

                                <div class="category-card">
                                    <div class="category-icon">
                                        <i class="fa-solid fa-puzzle-piece"></i>
                                    </div>
                                    <h3 class="category-title">Extensions Manager</h3>
                                    <p class="category-description">Manage PostgreSQL extensions for enhanced functionality</p>
                                    <div class="mt-4">
                                        <h4 class="font-semibold mb-2">Popular Extensions:</h4>
                                        <ul class="text-sm space-y-1">
                                            <li>â€¢ PostGIS (Spatial data)</li>
                                            <li>â€¢ pg_stat_statements</li>
                                            <li>â€¢ pgcrypto (Cryptography)</li>
                                            <li>â€¢ uuid-ossp (UUID generation)</li>
                                        </ul>
                                    </div>
                                </div>

                                <div class="category-card">
                                    <div class="category-icon">
                                        <i class="fa-solid fa-sync"></i>
                                    </div>
                                    <h3 class="category-title">Logical Replication Tools</h3>
                                    <p class="category-description">Tools for setting up and managing logical replication</p>
                                    <div class="mt-4">
                                        <pre class="text-xs bg-base-100 dark:bg-base-800 p-2 rounded"><code># Create publication
CREATE PUBLICATION my_pub FOR ALL TABLES;

# Create subscription
CREATE SUBSCRIPTION my_sub 
CONNECTION 'host=publisher'
PUBLICATION my_pub;</code></pre>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- Tool Selection Guide -->
                        <div class="bg-white dark:bg-base-800 p-6 rounded-lg shadow-sm mt-8">
                            <h3 class="text-xl font-bold mb-4">Tool Selection Guide</h3>
                            <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                                <div>
                                    <h4 class="font-semibold mb-2 text-green-600 dark:text-green-400">For Beginners:</h4>
                                    <ul class="text-sm space-y-1">
                                        <li>â€¢ Start with psql for basic operations</li>
                                        <li>â€¢ Use pgAdmin for visual management</li>
                                        <li>â€¢ Install pg_stat_statements for monitoring</li>
                                        <li>â€¢ Use pg_dump for simple backups</li>
                                    </ul>
                                </div>
                                <div>
                                    <h4 class="font-semibold mb-2 text-blue-600 dark:text-blue-400">For Production:</h4>
                                    <ul class="text-sm space-y-1">
                                        <li>â€¢ Implement comprehensive monitoring</li>
                                        <li>â€¢ Use pg_basebackup for PITR</li>
                                        <li>â€¢ Configure logical replication</li>
                                        <li>â€¢ Regular performance tuning</li>
                                    </ul>
                                </div>
                            </div>
                        </div>
                    </div>`
                },
                performance: {
                    title: "Performance Optimization",
                    icon: "fa-solid fa-gauge-high",
                    intro: "General performance bottlenecks including high CPU, memory pressure, and I/O issues.",
                    issues: [
                        { id: "perf_cpu", title: "High CPU utilization by SQL Server", errorCode: "N/A", severity: "High", solution: "<p>The SQL Server process (sqlservr.exe) is consuming an unexpectedly high amount of CPU resources, slowing down the entire server.</p>", remediation: "1. Identify expensive queries using DMVs like `sys.dm_exec_query_stats`.\n2. Analyze execution plans for table scans or poor index usage.\n3. Ensure statistics are up-to-date to help the query optimizer.", troubleshooting_code: "SELECT TOP 10 total_worker_time/execution_count AS avg_cpu_time, st.text FROM sys.dm_exec_query_stats qs CROSS APPLY sys.dm_exec_sql_text(qs.sql_handle) st ORDER BY avg_cpu_time DESC;", views: 0, helpful_yes: 0, helpful_no: 0, comments: [] },
                        { id: "perf_tempdb", title: "TempDB contention (PAGELATCH waits)", errorCode: "N/A", severity: "High", solution: "<p>Multiple concurrent processes are competing for allocation pages in TempDB, creating a significant bottleneck, especially on systems with many cores.</p>", remediation: "1. Increase the number of TempDB data files to be one per CPU core (up to 8).\n2. Identify queries causing heavy TempDB usage (e.g., large sorts, temp tables).\n3. Move TempDB to the fastest storage available (e.g., SSDs).", troubleshooting_code: "SELECT session_id, wait_type, wait_duration_ms FROM sys.dm_os_waiting_tasks WHERE wait_type LIKE 'PAGELATCH%';", views: 0, helpful_yes: 0, helpful_no: 0, comments: [] },
                        { id: "performance_new_1", title: "Slow Query Performance", errorCode: "N/A", severity: "High", solution: "<p>Queries are taking an unacceptably long time to execute, impacting application responsiveness.</p><p><b>Common Causes:</b> Missing or inefficient indexes, poor query planning, large data sets, high concurrency, inefficient JOINs, lack of `VACUUM`.</p>", remediation: "- Use `EXPLAIN ANALYZE` to understand query plans and identify bottlenecks.\n- Create appropriate indexes (B-tree, hash, GIN, GiST) on frequently queried columns.\n- Rewrite complex queries for better performance.\n- Ensure `autovacuum` is properly configured and running.\n- Consider partitioning large tables.", troubleshooting_code: "SELECT query, calls, total_exec_time, mean_exec_time FROM pg_stat_statements ORDER BY mean_exec_time DESC LIMIT 10;", views: 0, helpful_yes: 0, helpful_no: 0, comments: [] },
                        { id: "performance_new_2", title: "High Memory Usage", errorCode: "N/A", severity: "High", solution: "<p>PostgreSQL is consuming excessive memory, potentially causing system instability or poor performance.</p><p><b>Common Causes:</b> Inadequate `shared_buffers` configuration, too many connections, large `work_mem` settings, memory leaks, insufficient system RAM.</p>", remediation: "- Monitor memory usage with `pg_stat_bgwriter` and system tools.\n- Tune `shared_buffers` (typically 25% of system RAM).\n- Reduce `work_mem` for individual operations.\n- Limit `max_connections` to reasonable values.\n- Consider using connection pooling.", troubleshooting_code: "SELECT * FROM pg_stat_bgwriter;", views: 0, helpful_yes: 0, helpful_no: 0, comments: [] },
                        { id: "performance_new_3", title: "Excessive I/O Wait Times", errorCode: "N/A", severity: "Medium", solution: "<p>Database operations are experiencing high I/O wait times, indicating storage performance bottlenecks.</p><p><b>Common Causes:</b> Slow storage devices, insufficient I/O capacity, poor disk layout, excessive checkpoint frequency, inadequate `checkpoint_completion_target`.</p>", remediation: "- Monitor I/O statistics using `pg_stat_database` and system tools.\n- Optimize `checkpoint_completion_target` and `checkpoint_timeout`.\n- Consider faster storage (SSDs) for high-performance workloads.\n- Spread data across multiple physical disks.\n- Tune `wal_buffers` and `shared_buffers`.", troubleshooting_code: "SELECT * FROM pg_stat_database WHERE datname = current_database();", views: 0, helpful_yes: 0, helpful_no: 0, comments: [] },
                        { id: "performance_pg_101", title: "ERROR: query canceled due to statement timeout", errorCode: "57014", severity: "Medium", solution: "<p>The query was canceled because it exceeded the configured <code>statement_timeout</code> value.</p>", remediation: "- Increase <code>statement_timeout</code> if appropriate.\n- Optimize the query for better performance.\n- Monitor for long-running queries.", troubleshooting_code: "SHOW statement_timeout;", views: 0, helpful_yes: 0, helpful_no: 0, comments: [] },
                        { id: "performance_pg_102", title: "WARNING: temporary file created for query", errorCode: "01000", severity: "Low", solution: "<p>The query required a temporary file on disk, usually due to insufficient <code>work_mem</code> for sorting or hashing.</p>", remediation: "- Increase <code>work_mem</code> for large queries.\n- Monitor and tune queries that use excessive memory.", troubleshooting_code: "SHOW work_mem;", views: 0, helpful_yes: 0, helpful_no: 0, comments: [] },
                        { id: "performance_pg_103", title: "ERROR: could not allocate memory for query result", errorCode: "53200", severity: "High", solution: "<p>The server could not allocate enough memory to store the query result.</p>", remediation: "- Reduce the result set size.\n- Increase available system memory.\n- Tune <code>work_mem</code> and <code>maintenance_work_mem</code>.", troubleshooting_code: "SELECT pg_size_pretty(pg_column_size(*)) FROM your_table LIMIT 1;", views: 0, helpful_yes: 0, helpful_no: 0, comments: [] },
                        { id: "performance_pg_104", title: "ERROR: canceling autovacuum task", errorCode: "57014", severity: "Medium", solution: "<p>An autovacuum operation was canceled, possibly due to a conflicting lock or resource constraint.</p>", remediation: "- Monitor autovacuum activity and logs.\n- Tune autovacuum parameters for your workload.\n- Avoid long-running transactions that block autovacuum.", troubleshooting_code: "SELECT relname, last_autovacuum FROM pg_stat_user_tables;", views: 0, helpful_yes: 0, helpful_no: 0, comments: [] },
                        { id: "performance_pg_105", title: "WARNING: checkpoint request failed", errorCode: "XX000", severity: "Low", solution: "<p>A checkpoint could not be completed as requested, possibly due to I/O or resource issues.</p>", remediation: "- Monitor disk I/O and system logs.\n- Tune <code>checkpoint_timeout</code> and <code>checkpoint_completion_target</code>.", troubleshooting_code: "SHOW checkpoint_timeout; SHOW checkpoint_completion_target;", views: 0, helpful_yes: 0, helpful_no: 0, comments: [] },
                        { id: "performance_pg_106", title: "ERROR: could not extend relation due to insufficient disk space", errorCode: "53100", severity: "Critical", solution: "<p>The database could not extend a table or index file due to insufficient disk space.</p>", remediation: "- Free up disk space on the data directory filesystem.\n- Move large objects to different tablespaces with more space.\n- Implement disk space monitoring and alerting.\n- Consider table partitioning for large tables.", troubleshooting_code: "SELECT pg_size_pretty(pg_database_size(current_database())); SELECT * FROM pg_stat_user_tables ORDER BY pg_total_relation_size(relid) DESC;", views: 0, helpful_yes: 0, helpful_no: 0, comments: [] },
                        { id: "performance_pg_107", title: "WARNING: hash table out of memory", errorCode: "53200", severity: "High", solution: "<p>A hash table operation ran out of memory, forcing it to use disk-based processing.</p>", remediation: "- Increase <code>work_mem</code> for hash operations.\n- Monitor query memory usage patterns.\n- Consider optimizing queries to reduce memory requirements.\n- Tune <code>shared_buffers</code> if appropriate.", troubleshooting_code: "SHOW work_mem; SELECT query, temp_files, temp_bytes FROM pg_stat_statements WHERE temp_files > 0;", views: 0, helpful_yes: 0, helpful_no: 0, comments: [] },
                        { id: "performance_pg_108", title: "ERROR: too many range table entries", errorCode: "54000", severity: "Medium", solution: "<p>The query has too many table references, exceeding PostgreSQL's limits.</p>", remediation: "- Simplify complex queries with many table joins.\n- Break large queries into smaller subqueries.\n- Use views to abstract complex table relationships.\n- Consider restructuring the query logic.", troubleshooting_code: "SELECT count(*) FROM information_schema.tables;", views: 0, helpful_yes: 0, helpful_no: 0, comments: [] },
                        { id: "performance_pg_109", title: "WARNING: excessive sort memory usage", errorCode: "01000", severity: "Medium", solution: "<p>Sort operations are using excessive memory, potentially impacting system performance.</p>", remediation: "- Tune <code>work_mem</code> based on available system memory.\n- Add appropriate indexes to avoid sorting.\n- Optimize ORDER BY clauses in queries.\n- Monitor sort performance using EXPLAIN ANALYZE.", troubleshooting_code: "SHOW work_mem; SELECT query, sort_time, sort_calls FROM pg_stat_statements WHERE sort_calls > 0;", views: 0, helpful_yes: 0, helpful_no: 0, comments: [] },
                        { id: "performance_pg_110", title: "ERROR: maintenance work memory exhausted", errorCode: "53200", severity: "High", solution: "<p>Maintenance operations like VACUUM, REINDEX, or CREATE INDEX exhausted available memory.</p>", remediation: "- Increase <code>maintenance_work_mem</code> for maintenance operations.\n- Schedule maintenance during low-activity periods.\n- Process large tables in smaller chunks.\n- Monitor system memory usage during maintenance.", troubleshooting_code: "SHOW maintenance_work_mem; SELECT schemaname, tablename, pg_size_pretty(pg_total_relation_size(schemaname||'.'||tablename)) FROM pg_tables ORDER BY pg_total_relation_size(schemaname||'.'||tablename) DESC;", views: 0, helpful_yes: 0, helpful_no: 0, comments: [] },
                        { id: "performance_pg_111", title: "WARNING: sequential scan on large table", errorCode: "01000", severity: "Medium", solution: "<p>A sequential scan is being performed on a large table, indicating potential performance issues.</p>", remediation: "- Create appropriate indexes for frequently queried columns.\n- Analyze query patterns using EXPLAIN ANALYZE.\n- Update table statistics with ANALYZE.\n- Consider table partitioning for very large tables.", troubleshooting_code: "SELECT schemaname, tablename, seq_scan, idx_scan FROM pg_stat_user_tables WHERE seq_scan > idx_scan AND seq_scan > 1000;", views: 0, helpful_yes: 0, helpful_no: 0, comments: [] },
                        { id: "performance_pg_112", title: "ERROR: could not allocate shared memory segment", errorCode: "53200", severity: "Critical", solution: "<p>PostgreSQL could not allocate required shared memory segments.</p>", remediation: "- Adjust system shared memory limits (shmmax, shmall).\n- Reduce <code>shared_buffers</code> if set too high.\n- Check for memory leaks in applications.\n- Restart PostgreSQL to reset memory allocation.", troubleshooting_code: "sysctl kernel.shmmax; sysctl kernel.shmall; SHOW shared_buffers;", views: 0, helpful_yes: 0, helpful_no: 0, comments: [] },
                        { id: "performance_pg_113", title: "WARNING: connection pool exhausted", errorCode: "53300", severity: "High", solution: "<p>The connection pool has reached its maximum capacity, preventing new connections.</p>", remediation: "- Increase <code>max_connections</code> if system resources allow.\n- Implement connection pooling (pgBouncer, pgPool).\n- Optimize application connection management.\n- Monitor and close idle connections.", troubleshooting_code: "SELECT count(*), state FROM pg_stat_activity GROUP BY state; SHOW max_connections;", views: 0, helpful_yes: 0, helpful_no: 0, comments: [] },
                        { id: "performance_pg_114", title: "ERROR: could not write to background writer statistics file", errorCode: "58030", severity: "Medium", solution: "<p>The background writer process could not write to its statistics file.</p>", remediation: "- Check file permissions in the PostgreSQL data directory.\n- Verify disk space availability.\n- Review file system integrity.\n- Restart PostgreSQL if the issue persists.", troubleshooting_code: "SELECT * FROM pg_stat_bgwriter; ls -la $PGDATA/pg_stat/", views: 0, helpful_yes: 0, helpful_no: 0, comments: [] },
                        { id: "performance_pg_115", title: "ERROR: checkpoint segments exceeded", errorCode: "XX000", severity: "High", solution: "<p>The number of checkpoint segments has exceeded configured limits.</p>", remediation: "- Increase <code>max_wal_size</code> to allow more WAL segments.\n- Optimize checkpoint timing and frequency.\n- Monitor WAL generation patterns and adjust parameters.\n- Consider faster storage for WAL files.", troubleshooting_code: "SHOW max_wal_size; SELECT * FROM pg_stat_bgwriter;", views: 0, helpful_yes: 0, helpful_no: 0, comments: [] },
                        { id: "performance_pg_116", title: "WARNING: inefficient query plan detected", errorCode: "01000", severity: "Medium", solution: "<p>The query planner has chosen a potentially inefficient execution plan.</p>", remediation: "- Analyze query with EXPLAIN ANALYZE to identify bottlenecks.\n- Update table statistics with ANALYZE command.\n- Consider adding appropriate indexes.\n- Review query structure and optimization opportunities.", troubleshooting_code: "EXPLAIN (ANALYZE, BUFFERS) SELECT ...; ANALYZE table_name;", views: 0, helpful_yes: 0, helpful_no: 0, comments: [] },
                        { id: "performance_pg_117", title: "ERROR: connection pool saturation", errorCode: "53300", severity: "Critical", solution: "<p>Connection pool has reached saturation, preventing new connections.</p>", remediation: "- Increase connection pool size if resources allow.\n- Optimize application connection management.\n- Implement connection timeout and retry logic.\n- Monitor and close idle connections proactively.", troubleshooting_code: "SELECT count(*), state FROM pg_stat_activity GROUP BY state;", views: 0, helpful_yes: 0, helpful_no: 0, comments: [] },
                        { id: "performance_pg_118", title: "WARNING: autovacuum worker starvation", errorCode: "01000", severity: "Medium", solution: "<p>Autovacuum workers are starved and cannot keep up with table maintenance needs.</p>", remediation: "- Increase <code>autovacuum_max_workers</code> setting.\n- Optimize autovacuum scheduling and thresholds.\n- Monitor table bloat and vacuum activity.\n- Consider manual vacuum during low-activity periods.", troubleshooting_code: "SHOW autovacuum_max_workers; SELECT * FROM pg_stat_user_tables ORDER BY n_dead_tup DESC;", views: 0, helpful_yes: 0, helpful_no: 0, comments: [] },
                        { id: "performance_pg_119", title: "ERROR: buffer cache hit ratio too low", errorCode: "XX000", severity: "High", solution: "<p>Buffer cache hit ratio is below optimal levels, indicating poor memory utilization.</p>", remediation: "- Increase <code>shared_buffers</code> if system memory allows.\n- Monitor buffer cache performance and tune accordingly.\n- Optimize query patterns to improve cache efficiency.\n- Consider workload-specific memory allocation.", troubleshooting_code: "SELECT datname, blks_read, blks_hit, round(blks_hit*100.0/(blks_hit+blks_read), 2) AS hit_ratio FROM pg_stat_database;", views: 0, helpful_yes: 0, helpful_no: 0, comments: [] },
                        { id: "performance_pg_120", title: "WARNING: excessive context switching detected", errorCode: "01000", severity: "Medium", solution: "<p>High levels of context switching are impacting database performance.</p>", remediation: "- Monitor system CPU and process activity.\n- Optimize concurrent query patterns.\n- Consider reducing parallelism for specific workloads.\n- Review system configuration and resource allocation.", troubleshooting_code: "SELECT * FROM pg_stat_activity WHERE state = 'active'; ps aux | grep postgres", views: 0, helpful_yes: 0, helpful_no: 0, comments: [] },
                        { id: "performance_pg_121", title: "ERROR: transaction log write performance degraded", errorCode: "XX000", severity: "High", solution: "<p>Write performance to transaction logs (WAL) has significantly degraded.</p>", remediation: "- Check storage device performance and health.\n- Optimize WAL file placement on fast storage.\n- Monitor <code>wal_buffers</code> and <code>wal_writer_delay</code> settings.\n- Consider RAID configuration for WAL files.", troubleshooting_code: "SELECT * FROM pg_stat_wal_writer; SHOW wal_buffers;", views: 0, helpful_yes: 0, helpful_no: 0, comments: [] },
                        { id: "performance_pg_122", title: "WARNING: query execution time variance high", errorCode: "01000", severity: "Medium", solution: "<p>Query execution times show high variance, indicating inconsistent performance.</p>", remediation: "- Monitor query execution patterns and resource usage.\n- Update table statistics more frequently.\n- Review plan stability and cache effectiveness.\n- Consider query plan pinning for critical queries.", troubleshooting_code: "SELECT query, calls, min_time, max_time, stddev_time FROM pg_stat_statements ORDER BY stddev_time DESC;", views: 0, helpful_yes: 0, helpful_no: 0, comments: [] },
                        { id: "performance_pg_123", title: "ERROR: parallel worker spawn failure", errorCode: "XX000", severity: "Medium", solution: "<p>Failed to spawn parallel worker processes for query execution.</p>", remediation: "- Check <code>max_parallel_workers</code> and related settings.\n- Monitor system resource availability.\n- Review parallel query configuration and limitations.\n- Consider reducing parallel query usage during peak periods.", troubleshooting_code: "SHOW max_parallel_workers; SELECT * FROM pg_stat_activity WHERE query LIKE '%Parallel%';", views: 0, helpful_yes: 0, helpful_no: 0, comments: [] },
                        { id: "performance_pg_124", title: "WARNING: index scan selectivity poor", errorCode: "01000", severity: "Medium", solution: "<p>Index scans are showing poor selectivity, potentially indicating suboptimal index usage.</p>", remediation: "- Analyze index usage patterns and effectiveness.\n- Consider creating more selective indexes.\n- Update table statistics to improve planner decisions.\n- Review query predicates and index design.", troubleshooting_code: "SELECT schemaname, tablename, indexname, idx_scan, idx_tup_read, idx_tup_fetch FROM pg_stat_user_indexes;", views: 0, helpful_yes: 0, helpful_no: 0, comments: [] },
                        { id: "performance_pg_125", title: "ERROR: memory fragmentation detected", errorCode: "53200", severity: "High", solution: "<p>Memory fragmentation is impacting database performance and allocation efficiency.</p>", remediation: "- Monitor memory usage patterns and allocation.\n- Consider restarting PostgreSQL during maintenance windows.\n- Optimize memory allocation parameters.\n- Review application memory usage patterns.", troubleshooting_code: "SELECT * FROM pg_stat_database; ps aux | grep postgres | awk '{sum+=$6} END {print sum}'", views: 0, helpful_yes: 0, helpful_no: 0, comments: [] },
                        { id: "performance_pg_126", title: "WARNING: table bloat threshold exceeded", errorCode: "01000", severity: "Medium", solution: "<p>Table bloat has exceeded recommended thresholds, impacting query performance.</p>", remediation: "- Run VACUUM or VACUUM FULL on affected tables.\n- Optimize autovacuum settings and schedules.\n- Monitor table growth and update patterns.\n- Consider table reorganization for heavily bloated tables.", troubleshooting_code: "SELECT schemaname, tablename, n_dead_tup, n_live_tup FROM pg_stat_user_tables ORDER BY n_dead_tup DESC;", views: 0, helpful_yes: 0, helpful_no: 0, comments: [] },
                        { id: "performance_pg_127", title: "ERROR: statistics collection overhead high", errorCode: "XX000", severity: "Medium", solution: "<p>Statistics collection is consuming excessive resources and impacting performance.</p>", remediation: "- Review statistics collection configuration.\n- Optimize <code>track_activities</code> and related parameters.\n- Consider reducing statistics granularity for high-throughput systems.\n- Monitor statistics collection impact on performance.", troubleshooting_code: "SHOW track_activities; SELECT * FROM pg_stat_database ORDER BY stats_reset;", views: 0, helpful_yes: 0, helpful_no: 0, comments: [] },
                        { id: "performance_pg_128", title: "WARNING: disk I/O queue depth high", errorCode: "01000", severity: "High", solution: "<p>Disk I/O queue depth is consistently high, indicating storage bottlenecks.</p>", remediation: "- Monitor storage device performance and utilization.\n- Consider faster storage solutions (NVMe, SSD).\n- Optimize I/O patterns and scheduling.\n- Review storage configuration and RAID settings.", troubleshooting_code: "iostat -x 1; SELECT * FROM pg_stat_database;", views: 0, helpful_yes: 0, helpful_no: 0, comments: [] },
                        { id: "performance_pg_129", title: "ERROR: query planner cost estimation inaccurate", errorCode: "XX000", severity: "Medium", solution: "<p>Query planner cost estimations are significantly inaccurate, leading to poor plan choices.</p>", remediation: "- Update planner cost parameters based on hardware.\n- Regularly run ANALYZE to update statistics.\n- Monitor actual vs estimated query costs.\n- Consider manual query optimization for critical queries.", troubleshooting_code: "SHOW random_page_cost; SHOW seq_page_cost; EXPLAIN (ANALYZE, COSTS) SELECT ...;", views: 0, helpful_yes: 0, helpful_no: 0, comments: [] }
                    ]
                },
                query_indexing: {
                    title: "Query & Indexing Problems",
                    icon: "fa-solid fa-magnifying-glass-chart",
                    intro: "Problems related to slow query execution, inefficient query plans, and index misuse or fragmentation.",
                    issues: [
                        { id: "query_slow", title: "Slow query performance on a large table", errorCode: "N/A", severity: "Medium", solution: "<p>A query is taking an unacceptably long time to return results, often due to inefficient data access methods like full table scans.</p>", remediation: "1. Analyze the query's execution plan to find bottlenecks like table scans.\n2. Create supporting non-clustered indexes for the `WHERE` and `JOIN` clauses.\n3. Ensure query logic is SARGable (Searchable Argument) to allow index usage.", troubleshooting_code: "EXPLAIN ANALYZE SELECT * FROM your_table WHERE your_column = 'value';", views: 0, helpful_yes: 0, helpful_no: 0, comments: [] },
                        { id: "query_param_sniff", title: "Inconsistent query performance (parameter sniffing issue)", errorCode: "N/A", severity: "Medium", solution: "<p>A stored procedure or parameterized query performs well for some parameter values but poorly for others because a suboptimal execution plan is cached.</p>", remediation: "1. Use `OPTION (RECOMPILE)` to get a fresh plan for each execution (at the cost of compilation overhead).\n2. Use `OPTIMIZE FOR` query hint to guide the plan generation.\n3. Clear the specific plan from the cache using sp_recompile.", troubleshooting_code: "SELECT cp.plan_handle, st.text FROM sys.dm_exec_cached_plans cp CROSS APPLY sys.dm_exec_sql_text(cp.plan_handle) st WHERE st.text LIKE '%your_procedure_name%';", views: 0, helpful_yes: 0, helpful_no: 0, comments: [] },
                        { id: "query_indexing_new_1", title: "Index Not Used (Sequential Scan)", errorCode: "N/A", severity: "Medium", solution: "<p>Despite the presence of an index, PostgreSQL's query planner chooses a sequential scan over an index scan.</p><p><b>Common Causes:</b> Outdated statistics, small table size (planner deems sequential faster), `WHERE` clause conditions not selective enough, data type mismatches, use of functions on indexed columns, `LIKE` patterns starting with a wildcard.</p>", remediation: "- Run `ANALYZE` on the table to update statistics.\n- For small tables, a sequential scan might genuinely be faster; consider if an index is truly needed.\n- Ensure `WHERE` clauses are selective enough (e.g., `> 10%` of rows might trigger sequential scan).\n- Avoid applying functions to indexed columns in `WHERE` clauses (consider functional indexes).\n- Use `LIKE 'prefix%'` for index usage; `LIKE '%suffix'` or `LIKE '%middle%'` typically prevent index use (consider trigram indexes).", troubleshooting_code: "SELECT relname, seq_scan, idx_scan FROM pg_stat_user_tables WHERE relname = 'your_table_name';", views: 0, helpful_yes: 0, helpful_no: 0, comments: [] },
                        { id: "query_indexing_new_2", title: "Index Bloat and Fragmentation", errorCode: "N/A", severity: "Medium", solution: "<p>Indexes have become bloated due to frequent updates and deletes, causing poor performance and increased storage usage.</p><p><b>Common Causes:</b> High-frequency updates and deletes, insufficient `autovacuum` activity, long-running transactions preventing cleanup, inadequate `autovacuum_vacuum_scale_factor`.</p>", remediation: "- Monitor index bloat using `pg_stat_user_indexes` and `pg_stat_user_tables`.\n- Run `REINDEX` on heavily bloated indexes.\n- Tune `autovacuum_vacuum_scale_factor` and `autovacuum_vacuum_threshold`.\n- Ensure `autovacuum` is running properly.\n- Consider using `CONCURRENTLY` for reindexing to avoid locks.", troubleshooting_code: "SELECT schemaname, tablename, attname, n_distinct, correlation FROM pg_stats WHERE tablename = 'your_table_name';", views: 0, helpful_yes: 0, helpful_no: 0, comments: [] },
                        { id: "query_indexing_new_3", title: "Missing Index on Foreign Key", errorCode: "N/A", severity: "Medium", solution: "<p>Foreign key columns lack indexes, causing slow JOIN operations and potential performance issues during referential integrity checks.</p><p><b>Common Causes:</b> Oversight during schema design, foreign keys added after table creation without corresponding indexes, performance impact not initially apparent.</p>", remediation: "- Identify foreign key columns without indexes using system catalogs.\n- Create indexes on foreign key columns that are frequently used in JOINs.\n- Consider composite indexes if multiple foreign keys are often used together.\n- Monitor query performance before and after adding indexes.\n- Use `EXPLAIN ANALYZE` to verify index usage.", troubleshooting_code: "SELECT tc.table_name, kcu.column_name FROM information_schema.table_constraints tc JOIN information_schema.key_column_usage kcu ON tc.constraint_name = kcu.constraint_name WHERE tc.constraint_type = 'FOREIGN KEY' AND tc.table_schema = 'public';", views: 0, helpful_yes: 0, helpful_no: 0, comments: [] },
                        { id: "query_indexing_pg_101", title: "ERROR: function does not exist", errorCode: "42883", severity: "Medium", solution: "<p>The query references a function that does not exist or is not visible in the current search path.</p>", remediation: "- Check the function name and argument types.\n- Ensure the function is created in the correct schema.\n- Use <code>SET search_path</code> if needed.", troubleshooting_code: "SELECT proname, proargtypes FROM pg_proc WHERE proname = 'your_function';", views: 0, helpful_yes: 0, helpful_no: 0, comments: [] },
                        { id: "query_indexing_pg_102", title: "ERROR: operator does not exist", errorCode: "42883", severity: "Medium", solution: "<p>The query uses an operator that is not defined for the given data types.</p>", remediation: "- Check the data types of operands.\n- Use explicit type casts if necessary.\n- Create a custom operator if needed.", troubleshooting_code: "SELECT oprname, oprleft, oprright FROM pg_operator WHERE oprname = 'your_operator';", views: 0, helpful_yes: 0, helpful_no: 0, comments: [] },
                        { id: "query_indexing_pg_103", title: "ERROR: could not create index: too many columns", errorCode: "54011", severity: "High", solution: "<p>The index could not be created because it exceeds the maximum number of columns allowed.</p>", remediation: "- Reduce the number of columns in the index.\n- Consider using a composite or partial index.", troubleshooting_code: "SELECT COUNT(*) FROM pg_index WHERE indrelid = 'your_table'::regclass;", views: 0, helpful_yes: 0, helpful_no: 0, comments: [] },
                        { id: "query_indexing_pg_104", title: "ERROR: query plan failed: could not find pathkey item to sort", errorCode: "XX000", severity: "Medium", solution: "<p>The query planner could not find a suitable path for sorting, possibly due to complex query structure.</p>", remediation: "- Simplify the query or break it into smaller parts.\n- Add appropriate indexes for sorting columns.", troubleshooting_code: "EXPLAIN SELECT * FROM your_table ORDER BY your_column;", views: 0, helpful_yes: 0, helpful_no: 0, comments: [] },
                        { id: "query_indexing_pg_105", title: "ERROR: index expression must not return a set", errorCode: "42P16", severity: "Low", solution: "<p>An index expression returned a set of values, which is not allowed.</p>", remediation: "- Use scalar expressions in index definitions.\n- Avoid set-returning functions in index expressions.", troubleshooting_code: "SELECT * FROM pg_indexes WHERE tablename = 'your_table';", views: 0, helpful_yes: 0, helpful_no: 0, comments: [] },
                        { id: "query_indexing_pg_106", title: "ERROR: cannot use aggregate function in WHERE clause", errorCode: "42803", severity: "Medium", solution: "<p>An aggregate function was used in the WHERE clause, which is not allowed.</p>", remediation: "- Use aggregate functions in the HAVING clause instead of WHERE.\n- Rewrite the query to comply with SQL syntax.", troubleshooting_code: "SELECT * FROM your_table WHERE SUM(your_column) > 100; -- Invalid", views: 0, helpful_yes: 0, helpful_no: 0, comments: [] },
                        { id: "query_indexing_pg_107", title: "ERROR: subquery must return only one column", errorCode: "42601", severity: "Low", solution: "<p>A subquery in the query returned more than one column.</p>", remediation: "- Ensure subqueries return only a single column.\n- Review subquery SELECT statements.", troubleshooting_code: "SELECT * FROM your_table WHERE your_column = (SELECT col1, col2 FROM other_table); -- Invalid", views: 0, helpful_yes: 0, helpful_no: 0, comments: [] },
                        { id: "query_indexing_pg_108", title: "ERROR: more than one row returned by a subquery used as an expression", errorCode: "21000", severity: "Medium", solution: "<p>A subquery used as an expression returned more than one row.</p>", remediation: "- Use subqueries that return only one row.\n- Use <code>IN</code> or <code>EXISTS</code> for multiple rows.", troubleshooting_code: "SELECT * FROM your_table WHERE your_column = (SELECT your_column FROM other_table);", views: 0, helpful_yes: 0, helpful_no: 0, comments: [] },
                        { id: "query_indexing_pg_109", title: "ERROR: column reference is ambiguous in ORDER BY", errorCode: "42702", severity: "Low", solution: "<p>A column reference in the ORDER BY clause is ambiguous due to multiple tables with the same column name.</p>", remediation: "- Qualify column names with table aliases in ORDER BY.\n- Review query structure for ambiguous references.", troubleshooting_code: "SELECT * FROM t1 JOIN t2 ON t1.id = t2.id ORDER BY id; -- Ambiguous", views: 0, helpful_yes: 0, helpful_no: 0, comments: [] },
                        { id: "query_indexing_pg_110", title: "ERROR: cannot use window function in WHERE clause", errorCode: "42803", severity: "Medium", solution: "<p>Window functions are not allowed in the WHERE clause.</p>", remediation: "- Use window functions in the SELECT or ORDER BY clauses.\n- Rewrite the query to comply with SQL syntax.", troubleshooting_code: "SELECT * FROM your_table WHERE row_number() OVER (ORDER BY your_column) = 1; -- Invalid", views: 0, helpful_yes: 0, helpful_no: 0, comments: [] },
                        { id: "query_indexing_pg_111", title: "ERROR: DISTINCT ON expression must match initial ORDER BY expression", errorCode: "42P10", severity: "Medium", solution: "<p>When using DISTINCT ON, the first ORDER BY expression must match the DISTINCT ON expression.</p>", remediation: "- Ensure the first ORDER BY column matches the DISTINCT ON column.\n- Reorder expressions to comply with DISTINCT ON requirements.\n- Use subqueries if complex ordering is needed.", troubleshooting_code: "SELECT DISTINCT ON (col1) col1, col2 FROM table ORDER BY col1, col2;", views: 0, helpful_yes: 0, helpful_no: 0, comments: [] },
                        { id: "query_indexing_pg_112", title: "ERROR: cross-database references are not implemented", errorCode: "0A000", severity: "High", solution: "<p>PostgreSQL does not support queries that reference objects in different databases.</p>", remediation: "- Use separate connections for different databases.\n- Consider using foreign data wrappers (FDW) for cross-database access.\n- Redesign schema to keep related data in the same database.\n- Use dblink extension for cross-database queries.", troubleshooting_code: "SELECT * FROM dblink('host=localhost dbname=other_db', 'SELECT * FROM table') AS t(col1 int, col2 text);", views: 0, helpful_yes: 0, helpful_no: 0, comments: [] },
                        { id: "query_indexing_pg_113", title: "ERROR: recursive query must not contain set operations", errorCode: "42P19", severity: "Medium", solution: "<p>Recursive CTEs cannot contain UNION, INTERSECT, or EXCEPT operations in the recursive term.</p>", remediation: "- Remove set operations from recursive CTEs.\n- Use alternative query structures for complex recursive logic.\n- Consider iterative approaches for complex hierarchical queries.", troubleshooting_code: "WITH RECURSIVE cte AS (SELECT * FROM table UNION SELECT * FROM table2) SELECT * FROM cte;", views: 0, helpful_yes: 0, helpful_no: 0, comments: [] },
                        { id: "query_indexing_pg_114", title: "ERROR: WITH query name specified more than once", errorCode: "42712", severity: "Low", solution: "<p>A WITH clause contains duplicate query names, which is not allowed.</p>", remediation: "- Use unique names for all WITH queries.\n- Review query structure for naming conflicts.\n- Combine similar WITH queries if possible.", troubleshooting_code: "WITH q1 AS (...), q1 AS (...) SELECT * FROM q1; -- Invalid", views: 0, helpful_yes: 0, helpful_no: 0, comments: [] },
                        { id: "query_indexing_pg_115", title: "ERROR: argument of WHERE must be type boolean", errorCode: "42804", severity: "Medium", solution: "<p>The WHERE clause condition does not evaluate to a boolean value.</p>", remediation: "- Use comparison operators to create boolean expressions.\n- Cast expressions to boolean if necessary.\n- Review WHERE clause logic for proper boolean operations.", troubleshooting_code: "SELECT * FROM table WHERE column_name; -- May be invalid if column_name is not boolean", views: 0, helpful_yes: 0, helpful_no: 0, comments: [] },
                        { id: "query_indexing_pg_116", title: "ERROR: LIMIT must not be negative", errorCode: "2201W", severity: "Low", solution: "<p>The LIMIT clause contains a negative value, which is not allowed.</p>", remediation: "- Use positive values or zero for LIMIT.\n- Validate input parameters before using in LIMIT clauses.\n- Use appropriate bounds checking in application code.", troubleshooting_code: "SELECT * FROM table LIMIT -1; -- Invalid", views: 0, helpful_yes: 0, helpful_no: 0, comments: [] },
                        { id: "query_indexing_pg_117", title: "ERROR: OFFSET must not be negative", errorCode: "2201X", severity: "Low", solution: "<p>The OFFSET clause contains a negative value, which is not allowed.</p>", remediation: "- Use positive values or zero for OFFSET.\n- Validate input parameters before using in OFFSET clauses.\n- Implement proper pagination logic in applications.", troubleshooting_code: "SELECT * FROM table OFFSET -1; -- Invalid", views: 0, helpful_yes: 0, helpful_no: 0, comments: [] },
                        { id: "query_indexing_pg_118", title: "ERROR: invalid regular expression option", errorCode: "2201B", severity: "Low", solution: "<p>An invalid option was specified in a regular expression operation.</p>", remediation: "- Use valid regex flags (i, g, m, n, p, q, s, t, w, x).\n- Review PostgreSQL regex documentation for supported options.\n- Test regex patterns before using in production queries.", troubleshooting_code: "SELECT * FROM table WHERE column ~ '(?z)pattern'; -- Invalid flag", views: 0, helpful_yes: 0, helpful_no: 0, comments: [] },
                        { id: "query_indexing_pg_119", title: "ERROR: could not determine data type of parameter", errorCode: "42P18", severity: "Medium", solution: "<p>PostgreSQL could not determine the data type of a query parameter.</p>", remediation: "- Use explicit type casting for parameters.\n- Provide type information in parameterized queries.\n- Use CAST() or :: operator for type specification.", troubleshooting_code: "SELECT * FROM table WHERE column = $1::integer;", views: 0, helpful_yes: 0, helpful_no: 0, comments: [] },
                        { id: "query_indexing_pg_120", title: "ERROR: aggregate function calls cannot be nested", errorCode: "42803", severity: "Medium", solution: "<p>Nested aggregate function calls are not allowed in SQL.</p>", remediation: "- Restructure query to avoid nested aggregates.\n- Use subqueries or CTEs to separate aggregate calculations.\n- Consider window functions as alternatives.", troubleshooting_code: "SELECT MAX(COUNT(*)) FROM table; -- Invalid nested aggregate", views: 0, helpful_yes: 0, helpful_no: 0, comments: [] },
                        { id: "query_indexing_pg_121", title: "ERROR: invalid use of aggregate function in UPDATE", errorCode: "42803", severity: "Medium", solution: "<p>Aggregate functions cannot be used directly in UPDATE statements without proper context.</p>", remediation: "- Use subqueries with aggregates in UPDATE statements.\n- Structure UPDATE with proper FROM clause when needed.\n- Consider using window functions in subqueries.", troubleshooting_code: "UPDATE table SET col = (SELECT MAX(col) FROM table2) WHERE condition;", views: 0, helpful_yes: 0, helpful_no: 0, comments: [] },
                        { id: "query_indexing_pg_122", title: "ERROR: CASE expression types must match", errorCode: "42804", severity: "Medium", solution: "<p>All branches of a CASE expression must return compatible data types.</p>", remediation: "- Cast all CASE branches to a common data type.\n- Use consistent data types across all WHEN clauses.\n- Handle NULL values appropriately in CASE expressions.", troubleshooting_code: "SELECT CASE WHEN condition THEN 'text'::text ELSE 123::text END;", views: 0, helpful_yes: 0, helpful_no: 0, comments: [] },
                        { id: "query_indexing_pg_123", title: "ERROR: FOR UPDATE cannot be applied to VALUES clause", errorCode: "0A000", severity: "Low", solution: "<p>FOR UPDATE locking cannot be applied to VALUES clauses.</p>", remediation: "- Remove FOR UPDATE from VALUES queries.\n- Use FOR UPDATE only on actual table references.\n- Consider alternative locking strategies if needed.", troubleshooting_code: "SELECT * FROM (VALUES (1, 'a'), (2, 'b')) AS t(id, name) FOR UPDATE; -- Invalid", views: 0, helpful_yes: 0, helpful_no: 0, comments: [] },
                        { id: "query_indexing_pg_124", title: "ERROR: invalid use of HAVING without GROUP BY", errorCode: "42803", severity: "Medium", solution: "<p>HAVING clause cannot be used without a corresponding GROUP BY clause.</p>", remediation: "- Add appropriate GROUP BY clause when using HAVING.\n- Use WHERE clause for non-aggregate filtering.\n- Restructure query logic to avoid HAVING without grouping.", troubleshooting_code: "SELECT * FROM table GROUP BY column HAVING COUNT(*) > 1;", views: 0, helpful_yes: 0, helpful_no: 0, comments: [] },
                        { id: "query_indexing_pg_125", title: "ERROR: INSERT has more target columns than expressions", errorCode: "42601", severity: "Low", solution: "<p>The number of target columns in INSERT statement exceeds the number of provided values.</p>", remediation: "- Match the number of columns with the number of values.\n- Use DEFAULT keyword for columns with default values.\n- Specify column list explicitly in INSERT statements.", troubleshooting_code: "INSERT INTO table (col1, col2) VALUES (1); -- Missing value for col2", views: 0, helpful_yes: 0, helpful_no: 0, comments: [] },
                        { id: "query_indexing_pg_126", title: "ERROR: cannot mix different index access methods", errorCode: "0A000", severity: "Medium", solution: "<p>Different index access methods cannot be mixed in certain query contexts.</p>", remediation: "- Use consistent index access methods for similar operations.\n- Review index definitions and access method compatibility.\n- Consider query restructuring to avoid access method conflicts.", troubleshooting_code: "SELECT amname FROM pg_am; SELECT indexname, indexdef FROM pg_indexes;", views: 0, helpful_yes: 0, helpful_no: 0, comments: [] },
                        { id: "query_indexing_pg_127", title: "ERROR: array dimensions must be consistent", errorCode: "2202E", severity: "Medium", solution: "<p>Array operations require consistent dimensions across all array elements.</p>", remediation: "- Ensure all arrays have matching dimensions.\n- Use array functions to normalize dimensions if needed.\n- Validate array structure before operations.", troubleshooting_code: "SELECT array_dims(ARRAY[ARRAY[1,2], ARRAY[3,4,5]]); -- Inconsistent", views: 0, helpful_yes: 0, helpful_no: 0, comments: [] },
                        { id: "query_indexing_pg_128", title: "ERROR: invalid use of NULL in IS DISTINCT FROM", errorCode: "42804", severity: "Low", solution: "<p>Invalid NULL usage in IS DISTINCT FROM comparisons.</p>", remediation: "- Use proper NULL handling in DISTINCT comparisons.\n- Understand IS DISTINCT FROM NULL behavior.\n- Consider using IS NULL or IS NOT NULL as appropriate.", troubleshooting_code: "SELECT col1 IS DISTINCT FROM col2, col1 IS NOT DISTINCT FROM col2;", views: 0, helpful_yes: 0, helpful_no: 0, comments: [] },
                        { id: "query_indexing_pg_129", title: "ERROR: invalid JSON path expression", errorCode: "22032", severity: "Medium", solution: "<p>The JSON path expression is syntactically invalid or uses unsupported features.</p>", remediation: "- Validate JSON path syntax according to PostgreSQL documentation.\n- Test JSON path expressions with sample data.\n- Use proper escaping for special characters in paths.", troubleshooting_code: "SELECT jsonb_path_exists('{\"a\": 1}', '$.a'); -- Valid path", views: 0, helpful_yes: 0, helpful_no: 0, comments: [] },
                        { id: "query_indexing_pg_130", title: "ERROR: cannot use aggregate in index expression", errorCode: "42803", severity: "High", solution: "<p>Aggregate functions cannot be used in index expressions.</p>", remediation: "- Use only scalar expressions in index definitions.\n- Create functional indexes with immutable functions only.\n- Consider materialized views for complex aggregations.", troubleshooting_code: "CREATE INDEX idx ON table (LOWER(column)); -- Valid functional index", views: 0, helpful_yes: 0, helpful_no: 0, comments: [] },
                        { id: "query_indexing_pg_131", title: "ERROR: tablespace does not exist for index", errorCode: "42704", severity: "Medium", solution: "<p>The specified tablespace for index creation does not exist.</p>", remediation: "- Create the required tablespace before index creation.\n- Use existing tablespace names for index placement.\n- Verify tablespace permissions and accessibility.", troubleshooting_code: "SELECT spcname FROM pg_tablespace; CREATE TABLESPACE ts_name LOCATION '/path';", views: 0, helpful_yes: 0, helpful_no: 0, comments: [] },
                        { id: "query_indexing_pg_132", title: "ERROR: cannot query system catalogs during recovery", errorCode: "25006", severity: "High", solution: "<p>System catalog queries are not allowed during database recovery operations.</p>", remediation: "- Wait for recovery to complete before querying system catalogs.\n- Use alternative approaches for metadata access during recovery.\n- Monitor recovery progress and defer catalog queries.", troubleshooting_code: "SELECT pg_is_in_recovery(); SELECT * FROM pg_stat_database_conflicts;", views: 0, helpful_yes: 0, helpful_no: 0, comments: [] },
                        { id: "query_indexing_pg_133", title: "ERROR: invalid use of SET in function call", errorCode: "42804", severity: "Medium", solution: "<p>SET operations cannot be used within function calls in certain contexts.</p>", remediation: "- Move SET operations outside of function calls.\n- Use appropriate function call syntax and context.\n- Consider configuration changes at session or transaction level.", troubleshooting_code: "SET work_mem = '256MB'; SELECT function_name();", views: 0, helpful_yes: 0, helpful_no: 0, comments: [] },
                        { id: "query_indexing_pg_134", title: "ERROR: query result exceeds maximum row size", errorCode: "54000", severity: "High", solution: "<p>The query result row exceeds PostgreSQL's maximum row size limit.</p>", remediation: "- Reduce the number of columns in SELECT statements.\n- Use pagination to limit result set size.\n- Consider normalizing data to reduce row width.\n- Use LIMIT and OFFSET for result set management.", troubleshooting_code: "SELECT column1, column2 FROM table LIMIT 1000;", views: 0, helpful_yes: 0, helpful_no: 0, comments: [] }
                    ]
                },
                security: {
                    title: "Security & Access Control",
                    icon: "fa-solid fa-shield-halved",
                    intro: "Errors related to user permissions, logins, roles, and other security mechanisms.",
                    issues: [
                        { id: "sec_229", title: "The SELECT permission was denied on the object", errorCode: "229", severity: "Medium", solution: "<p>The user attempting to read data from a table or view does not have the required permission to do so.</p>", remediation: "1. Grant the necessary permission: `GRANT SELECT ON ObjectName TO UserName;`\n2. Check if the user is a member of a role that has the required permission.\n3. Investigate ownership chaining if the access is happening inside a stored procedure.", troubleshooting_code: "SELECT * FROM sys.database_permissions WHERE grantee_principal_id = USER_ID('YourUser') AND major_id = OBJECT_ID('YourObject');", views: 0, helpful_yes: 0, helpful_no: 0, comments: [] },
                        { id: "sec_orphan", title: "Orphaned database user", errorCode: "N/A", severity: "High", solution: "<p>A database user is not linked to a server-level login. This commonly occurs after restoring a database to a different server where the login (SID) does not exist.</p>", remediation: "1. Identify orphaned users with `sp_change_users_login 'Report';`\n2. Fix the user mapping with `sp_change_users_login 'Auto_Fix', 'UserName';` or manually map to an existing login.", troubleshooting_code: "EXEC sp_change_users_login 'Report';", views: 0, helpful_yes: 0, helpful_no: 0, comments: [] },
                        { id: "security_new_1", title: "FATAL: password authentication failed for user \"username\"", errorCode: "N/A", severity: "High", solution: "<p>The provided password for the specified user is incorrect, preventing successful login.</p><p><b>Common Causes:</b> Incorrect password, typo in password, user does not exist, or `pg_hba.conf` entry is incorrect or too restrictive.</p>", remediation: "- Verify the username and password are correct.\n- Check `pg_hba.conf` on the PostgreSQL server to ensure the correct authentication method is configured for the user and client IP (e.g., `md5`, `scram-sha-256`).\n- If the user doesn't exist, create it using `CREATE USER username WITH PASSWORD 'password';`.\n- Ensure the client is connecting from an IP address allowed in `pg_hba.conf`.", troubleshooting_code: "SELECT usename, usesuper FROM pg_user WHERE usename = 'username';", views: 0, helpful_yes: 0, helpful_no: 0, comments: [] },
                        { id: "security_new_2", title: "ERROR: permission denied for table", errorCode: "N/A", severity: "Medium", solution: "<p>The user does not have the required permissions to perform the requested operation on the specified table.</p><p><b>Common Causes:</b> Insufficient privileges, user not granted appropriate permissions, table ownership issues, schema permissions not set correctly.</p>", remediation: "- Grant the necessary permissions: `GRANT SELECT, INSERT, UPDATE, DELETE ON table_name TO username;`\n- Check current permissions: `\\dp table_name` in psql.\n- Verify user role membership: `\\du username`.\n- Consider using role-based access control for better security management.", troubleshooting_code: "SELECT grantee, privilege_type FROM information_schema.role_table_grants WHERE table_name = 'your_table_name';", views: 0, helpful_yes: 0, helpful_no: 0, comments: [] },
                        { id: "security_new_3", title: "ERROR: role 'username' does not exist", errorCode: "N/A", severity: "Medium", solution: "<p>The specified role (user) does not exist in the PostgreSQL database cluster.</p><p><b>Common Causes:</b> Typo in role name, role was dropped, connecting to wrong database cluster, role exists in different schema.</p>", remediation: "- Verify the role name is spelled correctly.\n- List all roles: `\\du` in psql or `SELECT rolname FROM pg_roles;`\n- Create the role if it doesn't exist: `CREATE ROLE username WITH LOGIN PASSWORD 'password';`\n- Check if you're connected to the correct database cluster.", troubleshooting_code: "SELECT rolname, rolcanlogin FROM pg_roles WHERE rolname = 'username';", views: 0, helpful_yes: 0, helpful_no: 0, comments: [] },
                        { id: "security_pg_101", title: "ERROR: must be superuser to create replication slots", errorCode: "42501", severity: "High", solution: "<p>Only superusers can create replication slots in PostgreSQL.</p>", remediation: "- Connect as a superuser to create replication slots.\n- Grant superuser privileges if appropriate (use with caution).\n- Review security policies for replication.", troubleshooting_code: "SELECT rolname, rolsuper FROM pg_roles WHERE rolname = 'your_user';", views: 0, helpful_yes: 0, helpful_no: 0, comments: [] },
                        { id: "security_pg_102", title: "ERROR: cannot drop role with privileges", errorCode: "2BP01", severity: "Medium", solution: "<p>The role cannot be dropped because it still owns database objects or has granted privileges.</p>", remediation: "- Reassign or drop all objects owned by the role.\n- Revoke all privileges before dropping the role.", troubleshooting_code: "SELECT * FROM pg_roles WHERE rolname = 'your_role';", views: 0, helpful_yes: 0, helpful_no: 0, comments: [] },
                        { id: "security_pg_103", title: "ERROR: password authentication failed for user 'postgres' from host", errorCode: "28P01", severity: "High", solution: "<p>Password authentication failed for the 'postgres' user from a specific host.</p>", remediation: "- Verify the password and host configuration.\n- Check <code>pg_hba.conf</code> for host-based authentication rules.", troubleshooting_code: "SELECT * FROM pg_hba_file_rules WHERE user_name = 'postgres';", views: 0, helpful_yes: 0, helpful_no: 0, comments: [] },
                        { id: "security_pg_104", title: "ERROR: cannot execute as role", errorCode: "0LP01", severity: "Low", solution: "<p>The current session cannot execute as the specified role, possibly due to lack of privileges.</p>", remediation: "- Grant the necessary privileges to the role.\n- Use <code>SET ROLE</code> with a valid role.", troubleshooting_code: "SELECT rolname, rolcanlogin FROM pg_roles;", views: 0, helpful_yes: 0, helpful_no: 0, comments: [] },
                        { id: "security_pg_105", title: "ERROR: role is a member of more than one role with conflicting privileges", errorCode: "0LP01", severity: "Medium", solution: "<p>The role is a member of multiple roles with conflicting privileges, causing ambiguity.</p>", remediation: "- Review role memberships and privilege grants.\n- Resolve conflicting privileges by adjusting role assignments.", troubleshooting_code: "SELECT rolname, rolconfig FROM pg_roles WHERE rolname = 'your_role';", views: 0, helpful_yes: 0, helpful_no: 0, comments: [] },
                        { id: "security_pg_106", title: "ERROR: cannot grant privileges on system catalog", errorCode: "42501", severity: "High", solution: "<p>Privileges cannot be granted on system catalog tables.</p>", remediation: "- Avoid granting privileges on system catalogs.\n- Use roles and permissions for user tables only.", troubleshooting_code: "SELECT * FROM pg_catalog.pg_tables;", views: 0, helpful_yes: 0, helpful_no: 0, comments: [] },
                        { id: "security_pg_107", title: "ERROR: cannot revoke privileges from self", errorCode: "42501", severity: "Low", solution: "<p>A user cannot revoke privileges from themselves.</p>", remediation: "- Only revoke privileges from other users or roles.\n- Review privilege management policies.", troubleshooting_code: "SELECT * FROM information_schema.role_table_grants WHERE grantee = 'your_user';", views: 0, helpful_yes: 0, helpful_no: 0, comments: [] },
                        { id: "security_pg_108", title: "ERROR: cannot alter system role", errorCode: "42501", severity: "High", solution: "<p>System roles cannot be altered by regular users.</p>", remediation: "- Only superusers can alter system roles.\n- Use caution when modifying roles.", troubleshooting_code: "SELECT rolname, rolsuper FROM pg_roles;", views: 0, helpful_yes: 0, helpful_no: 0, comments: [] },
                        { id: "security_pg_109", title: "ERROR: cannot set password for role without LOGIN privilege", errorCode: "42501", severity: "Medium", solution: "<p>Passwords can only be set for roles with LOGIN privilege.</p>", remediation: "- Grant LOGIN privilege to the role before setting a password.\n- Review role attributes in <code>pg_roles</code>.", troubleshooting_code: "SELECT rolname, rolcanlogin FROM pg_roles WHERE rolname = 'your_role';", views: 0, helpful_yes: 0, helpful_no: 0, comments: [] },
                        { id: "security_pg_110", title: "ERROR: cannot drop superuser role", errorCode: "42501", severity: "High", solution: "<p>Superuser roles cannot be dropped by non-superusers.</p>", remediation: "- Connect as a superuser to drop superuser roles.\n- Use caution when managing superuser privileges.", troubleshooting_code: "SELECT rolname, rolsuper FROM pg_roles;", views: 0, helpful_yes: 0, helpful_no: 0, comments: [] },
                        { id: "security_pg_111", title: "ERROR: insufficient privilege to create role", errorCode: "42501", severity: "High", solution: "<p>The current user does not have sufficient privileges to create new roles.</p>", remediation: "- Connect as a superuser or role with CREATEROLE privilege.\n- Grant CREATEROLE privilege to the user if appropriate.\n- Review role management policies and procedures.", troubleshooting_code: "SELECT rolname, rolcreaterole FROM pg_roles WHERE rolname = current_user;", views: 0, helpful_yes: 0, helpful_no: 0, comments: [] },
                        { id: "security_pg_112", title: "ERROR: password too weak", errorCode: "42501", severity: "Medium", solution: "<p>The specified password does not meet the configured password complexity requirements.</p>", remediation: "- Use a stronger password that meets policy requirements.\n- Check password policy settings if using extensions like passwordcheck.\n- Implement appropriate password complexity rules.", troubleshooting_code: "SHOW shared_preload_libraries; -- Check for passwordcheck extension", views: 0, helpful_yes: 0, helpful_no: 0, comments: [] },
                        { id: "security_pg_113", title: "ERROR: role attribute not supported", errorCode: "42601", severity: "Low", solution: "<p>An unsupported role attribute was specified in CREATE ROLE or ALTER ROLE.</p>", remediation: "- Use only supported role attributes.\n- Review PostgreSQL documentation for valid role attributes.\n- Check for typos in role attribute names.", troubleshooting_code: "SELECT rolname, rolsuper, rolcreaterole, rolcanlogin FROM pg_roles;", views: 0, helpful_yes: 0, helpful_no: 0, comments: [] },
                        { id: "security_pg_114", title: "ERROR: cannot grant role to itself", errorCode: "42501", severity: "Low", solution: "<p>A role cannot be granted membership to itself, which would create a circular dependency.</p>", remediation: "- Avoid granting roles to themselves.\n- Review role hierarchy design.\n- Use role inheritance appropriately.", troubleshooting_code: "SELECT rolname FROM pg_roles; SELECT * FROM pg_auth_members;", views: 0, helpful_yes: 0, helpful_no: 0, comments: [] },
                        { id: "security_pg_115", title: "ERROR: cannot revoke role from itself", errorCode: "42501", severity: "Low", solution: "<p>A role cannot revoke membership from itself in certain contexts.</p>", remediation: "- Use another privileged user to revoke role memberships.\n- Review role management procedures.\n- Understand role inheritance and membership rules.", troubleshooting_code: "SELECT * FROM pg_auth_members WHERE member = roleid;", views: 0, helpful_yes: 0, helpful_no: 0, comments: [] },
                        { id: "security_pg_116", title: "ERROR: default privileges cannot be set for objects owned by role", errorCode: "42501", severity: "Medium", solution: "<p>Default privileges cannot be modified for objects owned by the specified role.</p>", remediation: "- Only modify default privileges for roles you have appropriate permissions for.\n- Use ALTER DEFAULT PRIVILEGES with proper role context.\n- Review privilege management documentation.", troubleshooting_code: "SELECT * FROM pg_default_acl;", views: 0, helpful_yes: 0, helpful_no: 0, comments: [] },
                        { id: "security_pg_117", title: "ERROR: cannot set parameter for role", errorCode: "42501", severity: "Medium", solution: "<p>The current user cannot set the specified parameter for the target role.</p>", remediation: "- Ensure you have appropriate privileges to modify role parameters.\n- Use superuser account for system-wide parameter changes.\n- Review parameter security classifications.", troubleshooting_code: "SELECT rolname, rolconfig FROM pg_roles WHERE rolconfig IS NOT NULL;", views: 0, helpful_yes: 0, helpful_no: 0, comments: [] },
                        { id: "security_pg_118", title: "ERROR: role cannot inherit privileges", errorCode: "42501", severity: "Medium", solution: "<p>The role is configured with NOINHERIT, preventing it from inheriting privileges from granted roles.</p>", remediation: "- Use ALTER ROLE to enable inheritance if appropriate.\n- Grant explicit privileges instead of relying on inheritance.\n- Review role design and privilege strategy.", troubleshooting_code: "SELECT rolname, rolinherit FROM pg_roles WHERE rolname = 'target_role';", views: 0, helpful_yes: 0, helpful_no: 0, comments: [] },
                        { id: "security_pg_119", title: "ERROR: cannot change login attribute of role", errorCode: "42501", severity: "High", solution: "<p>The LOGIN attribute of the role cannot be changed by the current user.</p>", remediation: "- Connect as a superuser to modify role login attributes.\n- Ensure proper authorization for role management tasks.\n- Review security policies for role attribute changes.", troubleshooting_code: "SELECT rolname, rolcanlogin, rolsuper FROM pg_roles;", views: 0, helpful_yes: 0, helpful_no: 0, comments: [] },
                        { id: "security_pg_120", title: "ERROR: connection requires SSL client certificate", errorCode: "28000", severity: "High", solution: "<p>The server requires a client SSL certificate but none was provided.</p>", remediation: "- Configure client certificate for SSL authentication.\n- Verify certificate chain and CA trust configuration.\n- Check <code>pg_hba.conf</code> clientcert requirements.\n- Ensure proper certificate format and validity.", troubleshooting_code: "SELECT * FROM pg_hba_file_rules WHERE auth_method = 'cert';", views: 0, helpful_yes: 0, helpful_no: 0, comments: [] },
                        { id: "security_pg_121", title: "ERROR: role membership cycle detected", errorCode: "42501", severity: "High", solution: "<p>A circular dependency was detected in role membership grants.</p>", remediation: "- Review role membership hierarchy for cycles.\n- Remove circular role grants to break the cycle.\n- Design role hierarchy to avoid circular dependencies.\n- Use role inheritance carefully to prevent cycles.", troubleshooting_code: "SELECT * FROM pg_auth_members; WITH RECURSIVE role_tree AS (...) SELECT * FROM role_tree;", views: 0, helpful_yes: 0, helpful_no: 0, comments: [] },
                        { id: "security_pg_122", title: "ERROR: insufficient privileges for schema creation", errorCode: "42501", severity: "Medium", solution: "<p>The current user lacks privileges to create schemas in the database.</p>", remediation: "- Grant CREATE privilege on the database to the user.\n- Use a role with schema creation privileges.\n- Connect as database owner or superuser.\n- Review database-level permissions and grants.", troubleshooting_code: "SELECT datname, datacl FROM pg_database WHERE datname = current_database();", views: 0, helpful_yes: 0, helpful_no: 0, comments: [] },
                        { id: "security_pg_123", title: "ERROR: cannot execute function with security definer", errorCode: "42501", severity: "High", solution: "<p>The function marked as SECURITY DEFINER cannot be executed due to privilege issues.</p>", remediation: "- Check function owner privileges and permissions.\n- Verify SECURITY DEFINER function configuration.\n- Review function execution context and security model.\n- Ensure proper privilege escalation controls.", troubleshooting_code: "SELECT proname, proowner, prosecdef FROM pg_proc WHERE prosecdef = true;", views: 0, helpful_yes: 0, helpful_no: 0, comments: [] },
                        { id: "security_pg_124", title: "ERROR: row level security policy prevents access", errorCode: "42501", severity: "High", solution: "<p>Row Level Security (RLS) policy is preventing access to requested rows.</p>", remediation: "- Review RLS policies on the table.\n- Ensure user meets policy conditions for row access.\n- Modify policies if legitimate access is required.\n- Use appropriate role context for RLS policies.", troubleshooting_code: "SELECT schemaname, tablename, policyname, cmd FROM pg_policies;", views: 0, helpful_yes: 0, helpful_no: 0, comments: [] },
                        { id: "security_pg_125", title: "ERROR: cannot bypass row level security", errorCode: "42501", severity: "High", solution: "<p>The current user cannot bypass row level security for the requested operation.</p>", remediation: "- Grant BYPASSRLS privilege to the role if appropriate.\n- Use a superuser account for administrative operations.\n- Review RLS bypass requirements and security implications.\n- Consider alternative access patterns that comply with RLS.", troubleshooting_code: "SELECT rolname, rolbypassrls FROM pg_roles WHERE rolname = current_user;", views: 0, helpful_yes: 0, helpful_no: 0, comments: [] },
                        { id: "security_pg_126", title: "ERROR: cannot create extension with untrusted language", errorCode: "42501", severity: "High", solution: "<p>Extensions using untrusted languages require superuser privileges.</p>", remediation: "- Connect as superuser to create extensions with untrusted languages.\n- Use trusted language alternatives where possible.\n- Review extension security implications and requirements.\n- Consider procedural language trust levels.", troubleshooting_code: "SELECT lanname, lanpltrusted FROM pg_language;", views: 0, helpful_yes: 0, helpful_no: 0, comments: [] },
                        { id: "security_pg_127", title: "ERROR: cannot access file outside data directory", errorCode: "42501", severity: "High", solution: "<p>File access is restricted to the PostgreSQL data directory for security reasons.</p>", remediation: "- Place files within the PostgreSQL data directory.\n- Use appropriate file access functions and restrictions.\n- Review file system security policies.\n- Consider using COPY FROM/TO with proper file locations.", troubleshooting_code: "SHOW data_directory; SELECT filename FROM pg_ls_dir(current_setting('data_directory'));", views: 0, helpful_yes: 0, helpful_no: 0, comments: [] },
                        { id: "security_pg_128", title: "ERROR: cannot modify system configuration as non-superuser", errorCode: "42501", severity: "High", solution: "<p>System configuration parameters can only be modified by superusers.</p>", remediation: "- Use superuser account for system configuration changes.\n- Modify configuration files directly with appropriate permissions.\n- Review parameter security classifications and requirements.\n- Use role-specific parameter settings where allowed.", troubleshooting_code: "SELECT name, setting, source FROM pg_settings WHERE source = 'configuration file';", views: 0, helpful_yes: 0, helpful_no: 0, comments: [] },
                        { id: "security_pg_129", title: "ERROR: password authentication method not allowed", errorCode: "28000", severity: "High", solution: "<p>The configured authentication method does not allow password authentication.</p>", remediation: "- Review <code>pg_hba.conf</code> authentication method configuration.\n- Use appropriate authentication methods (md5, scram-sha-256).\n- Configure compatible authentication for user connections.\n- Test authentication method compatibility.", troubleshooting_code: "SELECT * FROM pg_hba_file_rules WHERE database = current_database();", views: 0, helpful_yes: 0, helpful_no: 0, comments: [] },
                        { id: "security_pg_130", title: "ERROR: cannot grant privileges on inherited table", errorCode: "42501", severity: "Medium", solution: "<p>Privileges cannot be granted directly on inherited tables in certain contexts.</p>", remediation: "- Grant privileges on parent tables instead.\n- Use proper inheritance hierarchy for privilege management.\n- Review table inheritance design and access patterns.\n- Consider alternative table organization strategies.", troubleshooting_code: "SELECT schemaname, tablename, tableowner FROM pg_tables WHERE schemaname = 'public';", views: 0, helpful_yes: 0, helpful_no: 0, comments: [] },
                        { id: "security_pg_131", title: "ERROR: cannot execute untrusted function", errorCode: "42501", severity: "High", solution: "<p>The function is marked as untrusted and cannot be executed by the current user.</p>", remediation: "- Use trusted function alternatives where available.\n- Execute as superuser if function execution is required.\n- Review function trust level and security implications.\n- Consider function security classification and design.", troubleshooting_code: "SELECT proname, prolang, prosecdef FROM pg_proc JOIN pg_language ON prolang = oid;", views: 0, helpful_yes: 0, helpful_no: 0, comments: [] },
                        { id: "security_pg_132", title: "ERROR: cannot alter security context of active session", errorCode: "25006", severity: "Medium", solution: "<p>Security context cannot be modified for the currently active session.</p>", remediation: "- Establish new connection with required security context.\n- Use SET SESSION AUTHORIZATION carefully.\n- Review session security requirements and constraints.\n- Plan security context changes appropriately.", troubleshooting_code: "SELECT session_user, current_user, current_role;", views: 0, helpful_yes: 0, helpful_no: 0, comments: [] },
                        { id: "security_pg_133", title: "ERROR: cannot access function with elevated privileges", errorCode: "42501", severity: "High", solution: "<p>Function access is denied due to elevated privilege requirements.</p>", remediation: "- Ensure user has appropriate privileges for function execution.\n- Review function SECURITY DEFINER settings.\n- Check function owner and execution privileges.\n- Use appropriate role context for function calls.", troubleshooting_code: "SELECT proname, proowner, proacl FROM pg_proc WHERE proname = 'function_name';", views: 0, helpful_yes: 0, helpful_no: 0, comments: [] },
                        { id: "security_pg_134", title: "ERROR: SSL connection required but not available", errorCode: "08004", severity: "High", solution: "<p>SSL connection is required by security policy but is not available or configured.</p>", remediation: "- Configure SSL certificates and enable SSL in postgresql.conf.\n- Update client connection to use SSL parameters.\n- Verify SSL configuration and certificate validity.\n- Test SSL connectivity and troubleshoot SSL issues.", troubleshooting_code: "SHOW ssl; SELECT ssl, cipher FROM pg_stat_ssl WHERE pid = pg_backend_pid();", views: 0, helpful_yes: 0, helpful_no: 0, comments: [] }
                    ]
                },
                data_integrity: {
                    title: "Data Integrity & Consistency",
                    icon: "fa-solid fa-check-double",
                    intro: "Errors that violate data integrity, such as primary key, foreign key, and check constraint violations.",
                    issues: [
                        { id: "integrity_2627", title: "Violation of PRIMARY KEY constraint 'PK_...'. Cannot insert duplicate key.", errorCode: "2627", severity: "High", solution: "<p>An attempt was made to insert a row with a primary key value that already exists in the table, which would violate the table's uniqueness guarantee.</p>", remediation: "1. Identify the duplicate value from the error message.\n2. Modify the application logic to prevent inserting existing keys, or use an `UPDATE` statement instead.\n3. Check the identity seed value if the column uses `IDENTITY`.", troubleshooting_code: "SELECT your_pk_column FROM your_table WHERE your_pk_column = 'duplicate_value';", views: 0, helpful_yes: 0, helpful_no: 0, comments: [] },
                        { id: "integrity_547", title: "The INSERT statement conflicted with the FOREIGN KEY constraint", errorCode: "547", severity: "High", solution: "<p>An attempt was made to insert a value into a foreign key column that does not exist in the referenced primary key column of the parent table.</p>", remediation: "1. Ensure the value being inserted into the foreign key column exists in the primary key column of the referenced table.\n2. Check the order of `INSERT` operations; insert into the parent table first.", troubleshooting_code: "SELECT 1 FROM referenced_table WHERE primary_key_column = 'value_from_insert';", views: 0, helpful_yes: 0, helpful_no: 0, comments: [] },
                        { id: "data_integrity_new_1", title: "ERROR: duplicate key value violates unique constraint \"constraint_name\"", errorCode: "N/A", severity: "High", solution: "<p>An attempt was made to insert or update a row that would result in a duplicate value in a column (or set of columns) that has a unique constraint.</p><p><b>Common Causes:</b> Attempting to insert a row with an existing primary key or unique key value, concurrent transactions inserting the same value, application logic not checking for uniqueness before insert.</p>", remediation: "- Before inserting, check if the value already exists (`SELECT EXISTS(...)`).\n- For `INSERT` statements, use `INSERT ... ON CONFLICT DO UPDATE` (UPSERT) or `INSERT ... ON CONFLICT DO NOTHING`.\n- Ensure application logic handles concurrent inserts gracefully (e.g., retries).\n- If data is truly duplicated, identify and remove the duplicate entries.", troubleshooting_code: "SELECT your_column, COUNT(*) FROM your_table GROUP BY your_column HAVING COUNT(*) > 1;", views: 0, helpful_yes: 0, helpful_no: 0, comments: [] },
                        { id: "data_integrity_new_2", title: "ERROR: insert or update on table violates foreign key constraint", errorCode: "N/A", severity: "High", solution: "<p>An attempt was made to insert or update a row with a foreign key value that does not exist in the referenced table.</p><p><b>Common Causes:</b> Referenced record doesn't exist, typo in foreign key value, data inconsistency between tables, transaction ordering issues.</p>", remediation: "- Verify the referenced record exists in the parent table.\n- Check for data type mismatches between foreign key and primary key columns.\n- Ensure proper transaction ordering (insert parent records first).\n- Use `ON DELETE CASCADE` or `ON DELETE SET NULL` if appropriate.\n- Consider deferring constraint checks until end of transaction.", troubleshooting_code: "SELECT * FROM referenced_table WHERE primary_key_column = 'your_foreign_key_value';", views: 0, helpful_yes: 0, helpful_no: 0, comments: [] },
                        { id: "data_integrity_new_3", title: "ERROR: new row for relation violates check constraint", errorCode: "N/A", severity: "Medium", solution: "<p>An attempt was made to insert or update a row that violates a check constraint defined on the table.</p><p><b>Common Causes:</b> Invalid data values, constraint too restrictive, application logic not validating data before insertion, data type conversion issues.</p>", remediation: "- Review the check constraint definition: `\\d+ table_name` in psql.\n- Validate data before insertion in application code.\n- Consider if the constraint is too restrictive for your use case.\n- Check for data type mismatches or conversion issues.\n- Temporarily disable constraint if needed for data migration.", troubleshooting_code: "SELECT conname, pg_get_constraintdef(oid) FROM pg_constraint WHERE conrelid = 'your_table_name'::regclass AND contype = 'c';", views: 0, helpful_yes: 0, helpful_no: 0, comments: [] },
                        { id: "data_integrity_pg_101", title: "ERROR: null value in column violates not-null constraint", errorCode: "23502", severity: "High", solution: "<p>A null value was inserted into a column that is defined as NOT NULL.</p>", remediation: "- Ensure all required columns have values.\n- Review table schema for NOT NULL constraints.\n- Use default values where appropriate.", troubleshooting_code: "SELECT column_name FROM information_schema.columns WHERE table_name = 'your_table' AND is_nullable = 'NO';", views: 0, helpful_yes: 0, helpful_no: 0, comments: [] },
                        { id: "data_integrity_pg_102", title: "ERROR: value too long for type character varying", errorCode: "22001", severity: "Medium", solution: "<p>The value being inserted or updated exceeds the defined length of a VARCHAR column.</p>", remediation: "- Truncate or validate input values before insertion.\n- Increase the column length if necessary.", troubleshooting_code: "SELECT character_maximum_length FROM information_schema.columns WHERE table_name = 'your_table' AND data_type = 'character varying';", views: 0, helpful_yes: 0, helpful_no: 0, comments: [] },
                        { id: "data_integrity_pg_103", title: "ERROR: invalid input syntax for integer", errorCode: "22P02", severity: "Medium", solution: "<p>The input value could not be converted to an integer.</p>", remediation: "- Validate input data types before insertion.\n- Use <code>CAST</code> or <code>TO_NUMBER</code> for conversions.", troubleshooting_code: "SELECT * FROM your_table WHERE NOT (your_column ~ '^[0-9]+$');", views: 0, helpful_yes: 0, helpful_no: 0, comments: [] },
                        { id: "data_integrity_pg_104", title: "ERROR: date/time field value out of range", errorCode: "22008", severity: "Low", solution: "<p>The date or time value is outside the valid range for the column type.</p>", remediation: "- Validate date/time values before insertion.\n- Use appropriate data types for date/time columns.", troubleshooting_code: "SELECT * FROM your_table WHERE your_date_column < '1900-01-01' OR your_date_column > '2100-12-31';", views: 0, helpful_yes: 0, helpful_no: 0, comments: [] },
                        { id: "data_integrity_pg_105", title: "ERROR: division by zero", errorCode: "22012", severity: "Medium", solution: "<p>A division by zero occurred in a query or expression.</p>", remediation: "- Check for zero values before performing division.\n- Use <code>NULLIF</code> to avoid division by zero errors.", troubleshooting_code: "SELECT * FROM your_table WHERE denominator = 0;", views: 0, helpful_yes: 0, helpful_no: 0, comments: [] },
                        { id: "data_integrity_pg_106", title: "ERROR: array value must start with \"{\" or dimension information", errorCode: "2202E", severity: "Medium", solution: "<p>An array value was provided in an invalid format.</p>", remediation: "- Use correct array literal syntax (e.g., '{1,2,3}').\n- Validate array input before insertion.", troubleshooting_code: "SELECT * FROM your_table WHERE your_array_column IS NOT NULL;", views: 0, helpful_yes: 0, helpful_no: 0, comments: [] },
                        { id: "data_integrity_pg_107", title: "ERROR: invalid input syntax for type uuid", errorCode: "22P02", severity: "Medium", solution: "<p>The input value could not be converted to a UUID.</p>", remediation: "- Validate UUID input format before insertion.\n- Use <code>gen_random_uuid()</code> for generating UUIDs.", troubleshooting_code: "SELECT * FROM your_table WHERE NOT (your_column ~* '^[0-9a-fA-F-]{36}$');", views: 0, helpful_yes: 0, helpful_no: 0, comments: [] },
                        { id: "data_integrity_pg_108", title: "ERROR: invalid input syntax for type json", errorCode: "22P02", severity: "Medium", solution: "<p>The input value could not be converted to JSON.</p>", remediation: "- Validate JSON input before insertion.\n- Use <code>jsonb</code> for more robust JSON handling.", troubleshooting_code: "SELECT * FROM your_table WHERE NOT (your_column::text ~ '^\{.*\}$');", views: 0, helpful_yes: 0, helpful_no: 0, comments: [] },
                        { id: "data_integrity_pg_109", title: "ERROR: invalid input syntax for type bytea", errorCode: "22P02", severity: "Low", solution: "<p>The input value could not be converted to a bytea (binary) type.</p>", remediation: "- Use correct bytea input format (e.g., '\\xDEADBEEF').\n- Validate binary input before insertion.", troubleshooting_code: "SELECT * FROM your_table WHERE your_bytea_column IS NOT NULL;", views: 0, helpful_yes: 0, helpful_no: 0, comments: [] },
                        { id: "data_integrity_pg_110", title: "ERROR: invalid input syntax for type interval", errorCode: "22007", severity: "Low", solution: "<p>The input value could not be converted to an interval type.</p>", remediation: "- Use valid interval syntax (e.g., '1 day', '2 hours').\n- Validate interval input before insertion.", troubleshooting_code: "SELECT * FROM your_table WHERE your_interval_column IS NOT NULL;", views: 0, helpful_yes: 0, helpful_no: 0, comments: [] },
                        { id: "data_integrity_pg_111", title: "ERROR: value out of range for sequence", errorCode: "2200H", severity: "Medium", solution: "<p>The sequence has reached its maximum or minimum value and cannot generate more values.</p>", remediation: "- Reset the sequence with ALTER SEQUENCE RESTART.\n- Increase the sequence maximum value if appropriate.\n- Use BIGINT sequences for larger ranges.\n- Monitor sequence usage to prevent overflow.", troubleshooting_code: "SELECT last_value, max_value FROM your_sequence; SELECT setval('your_sequence', 1, false);", views: 0, helpful_yes: 0, helpful_no: 0, comments: [] },
                        { id: "data_integrity_pg_112", title: "ERROR: cannot insert multiple rows using VALUES with DEFAULT", errorCode: "42601", severity: "Low", solution: "<p>Multiple rows cannot be inserted using VALUES when DEFAULT is specified for certain columns.</p>", remediation: "- Use separate INSERT statements for rows with DEFAULT values.\n- Specify explicit values instead of DEFAULT.\n- Use INSERT with SELECT for bulk operations.", troubleshooting_code: "INSERT INTO table (col1, col2) VALUES (1, DEFAULT), (2, DEFAULT); -- May fail", views: 0, helpful_yes: 0, helpful_no: 0, comments: [] },
                        { id: "data_integrity_pg_113", title: "ERROR: conflicting key value violates exclusion constraint", errorCode: "23P01", severity: "High", solution: "<p>An insert or update operation violates an exclusion constraint defined on the table.</p>", remediation: "- Review exclusion constraint definitions.\n- Modify data to avoid conflicts with exclusion rules.\n- Consider using ON CONFLICT clauses for upsert operations.\n- Validate data before insertion to prevent conflicts.", troubleshooting_code: "SELECT conname, pg_get_constraintdef(oid) FROM pg_constraint WHERE contype = 'x' AND conrelid = 'your_table'::regclass;", views: 0, helpful_yes: 0, helpful_no: 0, comments: [] },
                        { id: "data_integrity_pg_114", title: "ERROR: cannot cast type to target type", errorCode: "42846", severity: "Medium", solution: "<p>The source data type cannot be cast to the target data type automatically or explicitly.</p>", remediation: "- Use intermediate casting steps for complex type conversions.\n- Create custom cast functions if needed.\n- Verify data compatibility before attempting casts.\n- Use appropriate conversion functions for specific types.", troubleshooting_code: "SELECT pg_typeof(column_name) FROM your_table LIMIT 1;", views: 0, helpful_yes: 0, helpful_no: 0, comments: [] },
                        { id: "data_integrity_pg_115", title: "ERROR: invalid text representation for type", errorCode: "22P02", severity: "Medium", solution: "<p>The text representation cannot be converted to the specified data type.</p>", remediation: "- Validate input format before conversion.\n- Use appropriate input formats for specific data types.\n- Handle conversion errors gracefully in application code.\n- Use TRY_CAST equivalents where available.", troubleshooting_code: "SELECT column_name FROM your_table WHERE column_name !~ '^[0-9]+$'; -- For numeric validation", views: 0, helpful_yes: 0, helpful_no: 0, comments: [] },
                        { id: "data_integrity_pg_116", title: "ERROR: timestamp out of range", errorCode: "22008", severity: "Medium", solution: "<p>The timestamp value is outside the supported range for PostgreSQL timestamp types.</p>", remediation: "- Use valid timestamp ranges (1000-01-01 to 9999-12-31 for timestamp).\n- Consider using text or numeric types for extreme date ranges.\n- Validate timestamp inputs before insertion.\n- Use appropriate date/time types for your use case.", troubleshooting_code: "SELECT column_name FROM your_table WHERE column_name < '1000-01-01' OR column_name > '9999-12-31';", views: 0, helpful_yes: 0, helpful_no: 0, comments: [] },
                        { id: "data_integrity_pg_117", title: "ERROR: numeric field overflow", errorCode: "22003", severity: "High", solution: "<p>A numeric operation resulted in a value that exceeds the capacity of the numeric data type.</p>", remediation: "- Use higher precision numeric types.\n- Validate numeric ranges before calculations.\n- Implement overflow checking in application logic.\n- Consider using BIGINT or arbitrary precision types.", troubleshooting_code: "SELECT pg_typeof(column_name), column_name FROM your_table WHERE abs(column_name) > 1e308;", views: 0, helpful_yes: 0, helpful_no: 0, comments: [] },
                        { id: "data_integrity_pg_118", title: "ERROR: invalid identifier length", errorCode: "42622", severity: "Low", solution: "<p>An identifier (table name, column name, etc.) exceeds the maximum allowed length.</p>", remediation: "- Use shorter names for database objects.\n- Follow PostgreSQL naming conventions.\n- Consider abbreviations or naming standards.\n- Maximum identifier length is typically 63 characters.", troubleshooting_code: "SELECT length('your_very_long_identifier_name');", views: 0, helpful_yes: 0, helpful_no: 0, comments: [] },
                        { id: "data_integrity_pg_119", title: "ERROR: cannot insert multiple rows with RETURNING", errorCode: "0A000", severity: "Low", solution: "<p>The current query structure does not support RETURNING with multiple row operations in this context.</p>", remediation: "- Restructure query to support RETURNING clause.\n- Use separate statements if RETURNING is essential.\n- Consider using CTEs for complex returning scenarios.", troubleshooting_code: "INSERT INTO table VALUES (...) RETURNING *; -- Simple case", views: 0, helpful_yes: 0, helpful_no: 0, comments: [] },
                        { id: "data_integrity_pg_120", title: "ERROR: invalid constraint definition", errorCode: "42601", severity: "Medium", solution: "<p>The constraint definition contains syntax errors or invalid conditions.</p>", remediation: "- Review constraint syntax and logical conditions.\n- Ensure constraint expressions are valid and deterministic.\n- Test constraint conditions with sample data.\n- Use proper data types in constraint definitions.", troubleshooting_code: "SELECT conname, consrc FROM pg_constraint WHERE contype = 'c';", views: 0, helpful_yes: 0, helpful_no: 0, comments: [] },
                        { id: "data_integrity_pg_121", title: "ERROR: column cannot be null but default is null", errorCode: "23502", severity: "Medium", solution: "<p>A NOT NULL constraint is violated by a column with a null default value.</p>", remediation: "- Provide non-null default value for the column.\n- Remove NOT NULL constraint if null values are acceptable.\n- Update existing null values before adding constraint.\n- Review column design and data requirements.", troubleshooting_code: "SELECT column_name, is_nullable, column_default FROM information_schema.columns;", views: 0, helpful_yes: 0, helpful_no: 0, comments: [] },
                        { id: "data_integrity_pg_122", title: "ERROR: conflicting constraint names across schemas", errorCode: "42710", severity: "Medium", solution: "<p>Constraint names conflict across different schemas in the database.</p>", remediation: "- Use unique constraint names across schemas.\n- Include schema prefix in constraint naming convention.\n- Review constraint naming standards and practices.\n- Rename conflicting constraints appropriately.", troubleshooting_code: "SELECT schemaname, conname, tablename FROM pg_constraint JOIN pg_class ON conrelid = oid;", views: 0, helpful_yes: 0, helpful_no: 0, comments: [] },
                        { id: "data_integrity_pg_123", title: "ERROR: cascading delete would exceed maximum depth", errorCode: "54001", severity: "High", solution: "<p>Cascading delete operation exceeds the maximum recursion depth limit.</p>", remediation: "- Review foreign key cascade design for excessive depth.\n- Implement manual deletion strategy for complex hierarchies.\n- Consider alternative relationship designs.\n- Break complex cascades into smaller operations.", troubleshooting_code: "SELECT tc.table_name, kcu.column_name, rc.delete_rule FROM information_schema.table_constraints tc JOIN information_schema.referential_constraints rc USING(constraint_name);", views: 0, helpful_yes: 0, helpful_no: 0, comments: [] },
                        { id: "data_integrity_pg_124", title: "ERROR: domain constraint violation in array element", errorCode: "23514", severity: "Medium", solution: "<p>An array element violates a domain constraint definition.</p>", remediation: "- Validate array elements against domain constraints.\n- Review domain definition and constraint logic.\n- Update array values to comply with domain rules.\n- Consider domain design for array data types.", troubleshooting_code: "SELECT domain_name, constraint_name, check_clause FROM information_schema.domain_constraints;", views: 0, helpful_yes: 0, helpful_no: 0, comments: [] },
                        { id: "data_integrity_pg_125", title: "ERROR: constraint cannot be validated with existing data", errorCode: "23514", severity: "High", solution: "<p>Existing data violates the constraint being added to the table.</p>", remediation: "- Clean up existing data to comply with constraint.\n- Add constraint with NOT VALID option first.\n- Validate constraint after data cleanup.\n- Review data quality and constraint requirements.", troubleshooting_code: "SELECT conname, convalidated FROM pg_constraint WHERE NOT convalidated;", views: 0, helpful_yes: 0, helpful_no: 0, comments: [] },
                        { id: "data_integrity_pg_126", title: "ERROR: generated column cannot reference other generated columns", errorCode: "42P17", severity: "Medium", solution: "<p>Generated columns cannot reference other generated columns in their expressions.</p>", remediation: "- Reference only stored columns in generated column expressions.\n- Redesign column generation logic to avoid dependencies.\n- Use base columns for complex calculated values.\n- Review generated column design patterns.", troubleshooting_code: "SELECT column_name, generation_expression FROM information_schema.columns WHERE is_generated = 'ALWAYS';", views: 0, helpful_yes: 0, helpful_no: 0, comments: [] },
                        { id: "data_integrity_pg_127", title: "ERROR: exclusion constraint violation", errorCode: "23P01", severity: "High", solution: "<p>The operation violates an exclusion constraint on the table.</p>", remediation: "- Review exclusion constraint conditions and operators.\n- Modify data to avoid constraint violations.\n- Understand exclusion constraint logic and requirements.\n- Use appropriate operators for exclusion constraints.", troubleshooting_code: "SELECT conname, pg_get_constraintdef(oid) FROM pg_constraint WHERE contype = 'x';", views: 0, helpful_yes: 0, helpful_no: 0, comments: [] },
                        { id: "data_integrity_pg_128", title: "ERROR: deferred constraint check failed", errorCode: "23000", severity: "High", solution: "<p>A deferred constraint check failed at transaction commit time.</p>", remediation: "- Review deferred constraint configuration and timing.\n- Ensure all constraint conditions are met before commit.\n- Use SET CONSTRAINTS for constraint timing control.\n- Test constraint behavior in transaction contexts.", troubleshooting_code: "SELECT conname, condeferrable, condeferred FROM pg_constraint;", views: 0, helpful_yes: 0, helpful_no: 0, comments: [] },
                        { id: "data_integrity_pg_129", title: "ERROR: row violates partition constraint", errorCode: "23514", severity: "Medium", solution: "<p>The row being inserted or updated violates the partition constraint.</p>", remediation: "- Ensure data values match partition key constraints.\n- Review partition boundaries and key definitions.\n- Use proper routing for partitioned table inserts.\n- Validate partition constraint logic and ranges.", troubleshooting_code: "SELECT schemaname, tablename, pg_get_expr(relpartbound, oid) FROM pg_class WHERE relispartition;", views: 0, helpful_yes: 0, helpful_no: 0, comments: [] },
                        { id: "data_integrity_pg_130", title: "ERROR: constraint trigger execution order conflict", errorCode: "42710", severity: "Medium", solution: "<p>Constraint triggers have conflicting execution order requirements.</p>", remediation: "- Review trigger execution order and dependencies.\n- Adjust trigger timing and ordering as needed.\n- Use appropriate trigger types for constraint enforcement.\n- Test trigger interaction and execution sequences.", troubleshooting_code: "SELECT trigger_name, event_manipulation, action_order FROM information_schema.triggers;", views: 0, helpful_yes: 0, helpful_no: 0, comments: [] },
                        { id: "data_integrity_pg_131", title: "ERROR: cannot drop constraint with dependent objects", errorCode: "2BP01", severity: "Medium", solution: "<p>The constraint cannot be dropped because other objects depend on it.</p>", remediation: "- Use CASCADE option to drop dependent objects.\n- Identify and handle dependent objects manually.\n- Review object dependencies before constraint removal.\n- Plan constraint changes with dependency impact.", troubleshooting_code: "SELECT classid, objid, objsubid, refclassid, refobjid FROM pg_depend WHERE deptype = 'n';", views: 0, helpful_yes: 0, helpful_no: 0, comments: [] },
                        { id: "data_integrity_pg_132", title: "ERROR: inheritance constraint mismatch", errorCode: "42P17", severity: "Medium", solution: "<p>Constraints between parent and child tables in inheritance hierarchy don't match.</p>", remediation: "- Ensure consistent constraints across inheritance hierarchy.\n- Review inheritance design and constraint requirements.\n- Use proper constraint inheritance patterns.\n- Test constraint behavior in inherited tables.", troubleshooting_code: "SELECT schemaname, tablename, attname, attnotnull FROM pg_attribute JOIN pg_class ON attrelid = oid;", views: 0, helpful_yes: 0, helpful_no: 0, comments: [] },
                        { id: "data_integrity_pg_133", title: "ERROR: constraint check cannot be deferred", errorCode: "0A000", severity: "Medium", solution: "<p>The constraint type does not support deferred checking.</p>", remediation: "- Use constraint types that support deferred checking.\n- Implement constraint logic with triggers if needed.\n- Review constraint timing requirements and design.\n- Consider alternative constraint enforcement approaches.", troubleshooting_code: "SELECT contype, condeferrable FROM pg_constraint WHERE condeferrable = false;", views: 0, helpful_yes: 0, helpful_no: 0, comments: [] },
                        { id: "data_integrity_pg_134", title: "ERROR: materialized view constraint violation", errorCode: "23514", severity: "Medium", solution: "<p>Data in the materialized view violates constraint definitions.</p>", remediation: "- Refresh materialized view with corrected base data.\n- Review base table data quality and constraints.\n- Update materialized view definition if needed.\n- Validate constraint logic for materialized views.", troubleshooting_code: "SELECT schemaname, matviewname, definition FROM pg_matviews;", views: 0, helpful_yes: 0, helpful_no: 0, comments: [] },
                        { id: "data_integrity_pg_135", title: "ERROR: constraint validation timeout", errorCode: "57014", severity: "High", solution: "<p>Constraint validation operation timed out due to large dataset or complex logic.</p>", remediation: "- Increase statement timeout for constraint validation.\n- Validate constraints in smaller batches.\n- Optimize constraint checking performance.\n- Review constraint complexity and data volume.", troubleshooting_code: "SHOW statement_timeout; SELECT conname, pg_get_constraintdef(oid) FROM pg_constraint;", views: 0, helpful_yes: 0, helpful_no: 0, comments: [] }
                    ]
                },
                migration: {
                    title: "Upgrade & Migration",
                    icon: "fa-solid fa-truck-fast",
                    intro: "Issues that arise when migrating a database to a new server or upgrading to a new version of SQL Server.",
                    issues: [
                        { id: "mig_restore_version", title: "The database was backed up on a server running version X. That version is incompatible with this server", errorCode: "3169", severity: "High", solution: "<p>You cannot restore a database backup to an older version of SQL Server than the one it was created on.</p>", remediation: "1. There is no direct way to restore to an earlier version.\n2. Restore the database to a server with the same or a newer version of SQL Server.\n3. Use data export/import tools (like SSIS) to move the data and schema if you must downgrade.", troubleshooting_code: "SELECT @@VERSION;", views: 0, helpful_yes: 0, helpful_no: 0, comments: [] },
                        { id: "mig_filepath", title: "The operating system returned error 5(Access is denied.) to SQL Server during a RESTORE DATABASE", errorCode: "5133", severity: "High", solution: "<p>The file paths for data and log files specified in the restore command are not accessible to the SQL Server service account.</p>", remediation: "1. Ensure the SQL Server service account has Full Control permissions on the destination folders.\n2. Use the `WITH MOVE` option in your `RESTORE DATABASE` command to specify correct, accessible file locations.", troubleshooting_code: "RESTORE FILELISTONLY FROM DISK = 'path_to_backup.bak';", views: 0, helpful_yes: 0, helpful_no: 0, comments: [] },
                        { id: "migration_new_1", title: "ERROR: old and new cluster cannot share a data directory", errorCode: "N/A", severity: "High", solution: "<p>This error occurs during `pg_upgrade` when the old and new PostgreSQL data directories are the same, which is not allowed.</p><p><b>Common Causes:</b> Misconfiguration of `pg_upgrade` command, attempting an in-place upgrade without separate data directories.</p>", remediation: "- Ensure `pg_upgrade` is run with distinct `--old-datadir` and `--new-datadir` paths.\n- If performing an in-place upgrade, ensure you have backed up the old cluster and are moving data to a new, empty directory for the new version.", troubleshooting_code: "ls -ld /path/to/old/datadir\nls -ld /path/to/new/datadir", views: 0, helpful_yes: 0, helpful_no: 0, comments: [] },
                        { id: "migration_new_2", title: "ERROR: incompatible version", errorCode: "N/A", severity: "High", solution: "<p>The `pg_upgrade` utility cannot upgrade between the specified PostgreSQL versions due to incompatibility.</p><p><b>Common Causes:</b> Attempting to upgrade across too many major versions, using incompatible `pg_upgrade` version, unsupported upgrade path.</p>", remediation: "- Check the supported upgrade paths in PostgreSQL documentation.\n- Use the `pg_upgrade` version that matches the target PostgreSQL version.\n- Consider upgrading in multiple steps (e.g., 9.6 â†’ 10 â†’ 11 â†’ 12).\n- Use logical replication or dump/restore for major version jumps.", troubleshooting_code: "pg_upgrade --version\npostgres --version", views: 0, helpful_yes: 0, helpful_no: 0, comments: [] },
                        { id: "migration_new_3", title: "ERROR: could not access file", errorCode: "N/A", severity: "Medium", solution: "<p>The `pg_upgrade` process cannot access required files or directories during the upgrade process.</p><p><b>Common Causes:</b> Insufficient file permissions, missing files, disk space issues, symbolic link problems.</p>", remediation: "- Ensure the user running `pg_upgrade` has read/write access to both old and new data directories.\n- Check available disk space in both locations.\n- Verify all required PostgreSQL binaries are accessible.\n- Run `pg_upgrade` with appropriate user privileges (typically postgres user).", troubleshooting_code: "ls -la /path/to/postgresql/datadir\nls -la /path/to/postgresql/bin", views: 0, helpful_yes: 0, helpful_no: 0, comments: [] },
                        { id: "migration_pg_101", title: "ERROR: cannot drop the currently open database", errorCode: "55006", severity: "High", solution: "<p>The database cannot be dropped because it is currently open by one or more sessions.</p>", remediation: "- Disconnect all sessions using the database.\n- Use <code>pg_terminate_backend</code> to force disconnects if necessary.", troubleshooting_code: "SELECT pid, datname FROM pg_stat_activity WHERE datname = 'your_database';", views: 0, helpful_yes: 0, helpful_no: 0, comments: [] },
                        { id: "migration_pg_102", title: "ERROR: cannot rename database while it is being accessed by other users", errorCode: "55006", severity: "Medium", solution: "<p>The database cannot be renamed because it is currently being accessed by other users.</p>", remediation: "- Ensure no active connections to the database.\n- Use <code>pg_terminate_backend</code> to disconnect users.", troubleshooting_code: "SELECT pid, datname FROM pg_stat_activity WHERE datname = 'your_database';", views: 0, helpful_yes: 0, helpful_no: 0, comments: [] },
                        { id: "migration_pg_103", title: "ERROR: cannot move system relation", errorCode: "55006", severity: "High", solution: "<p>System relations (such as catalog tables) cannot be moved to another tablespace.</p>", remediation: "- Avoid attempting to move system relations.\n- Only move user tables to different tablespaces.", troubleshooting_code: "SELECT relname, reltablespace FROM pg_class WHERE relkind = 'r';", views: 0, helpful_yes: 0, helpful_no: 0, comments: [] },
                        { id: "migration_pg_104", title: "ERROR: cannot drop tablespace because it is not empty", errorCode: "55006", severity: "Medium", solution: "<p>The tablespace cannot be dropped because it still contains database objects.</p>", remediation: "- Move or drop all objects from the tablespace before dropping it.\n- Use <code>pg_tablespace</code> to list objects in the tablespace.", troubleshooting_code: "SELECT * FROM pg_tables WHERE tablespace = 'your_tablespace';", views: 0, helpful_yes: 0, helpful_no: 0, comments: [] },
                        { id: "migration_pg_105", title: "ERROR: cannot upgrade because extension is not upgradable", errorCode: "XX000", severity: "High", solution: "<p>The upgrade process failed because an installed extension does not support upgrade to the new PostgreSQL version.</p>", remediation: "- Check extension documentation for upgrade paths.\n- Remove or update the extension before upgrading.\n- Contact the extension maintainer if needed.", troubleshooting_code: "SELECT extname, extversion FROM pg_extension;", views: 0, helpful_yes: 0, helpful_no: 0, comments: [] },
                        { id: "migration_pg_106", title: "ERROR: cannot drop database while backup is in progress", errorCode: "55006", severity: "High", solution: "<p>The database cannot be dropped because a backup operation is currently running.</p>", remediation: "- Wait for the backup to complete before dropping the database.\n- Cancel the backup if appropriate.", troubleshooting_code: "SELECT * FROM pg_stat_activity WHERE query LIKE '%backup%';", views: 0, helpful_yes: 0, helpful_no: 0, comments: [] },
                        { id: "migration_pg_107", title: "ERROR: cannot change owner of system database", errorCode: "55006", severity: "Medium", solution: "<p>The owner of a system database (e.g., postgres, template1) cannot be changed.</p>", remediation: "- Only user databases can have their ownership changed.\n- Avoid altering system databases.", troubleshooting_code: "SELECT datname, datdba FROM pg_database;", views: 0, helpful_yes: 0, helpful_no: 0, comments: [] },
                        { id: "migration_pg_108", title: "ERROR: cannot move database to another tablespace", errorCode: "55006", severity: "Medium", solution: "<p>Databases cannot be moved to a different tablespace after creation.</p>", remediation: "- Create the database in the desired tablespace initially.\n- Use <code>CREATE DATABASE ... TABLESPACE ...</code>.", troubleshooting_code: "SELECT datname, dattablespace FROM pg_database;", views: 0, helpful_yes: 0, helpful_no: 0, comments: [] },
                        { id: "migration_pg_109", title: "ERROR: cannot drop extension because it is required by the database", errorCode: "55006", severity: "High", solution: "<p>The extension cannot be dropped because it is required by the database or other extensions.</p>", remediation: "- Drop dependent objects or extensions first.\n- Review extension dependencies.", troubleshooting_code: "SELECT * FROM pg_extension;", views: 0, helpful_yes: 0, helpful_no: 0, comments: [] },
                        { id: "migration_pg_110", title: "ERROR: cannot upgrade database with active connections", errorCode: "55006", severity: "High", solution: "<p>The database upgrade cannot proceed while there are active connections.</p>", remediation: "- Disconnect all users before upgrading.\n- Use <code>pg_terminate_backend</code> to force disconnects if necessary.", troubleshooting_code: "SELECT pid, datname FROM pg_stat_activity WHERE datname = 'your_database';", views: 0, helpful_yes: 0, helpful_no: 0, comments: [] },
                        { id: "migration_pg_111", title: "ERROR: cluster data directory version mismatch", errorCode: "XX000", severity: "Critical", solution: "<p>The data directory version does not match the PostgreSQL binary version.</p>", remediation: "- Use the correct PostgreSQL version for the data directory.\n- Run pg_upgrade to upgrade the cluster if needed.\n- Verify version compatibility before starting PostgreSQL.\n- Check PG_VERSION file in data directory.", troubleshooting_code: "cat $PGDATA/PG_VERSION; postgres --version", views: 0, helpful_yes: 0, helpful_no: 0, comments: [] },
                        { id: "migration_pg_112", title: "ERROR: could not create directory for new cluster", errorCode: "XX000", severity: "High", solution: "<p>The migration process could not create the required directory for the new cluster.</p>", remediation: "- Ensure sufficient permissions for the migration user.\n- Verify adequate disk space for the new cluster.\n- Check parent directory permissions and existence.\n- Use appropriate user account for migration operations.", troubleshooting_code: "ls -ld /path/to/new/cluster; df -h /path/to/new", views: 0, helpful_yes: 0, helpful_no: 0, comments: [] },
                        { id: "migration_pg_113", title: "ERROR: old cluster does not use data checksums but new one does", errorCode: "XX000", severity: "High", solution: "<p>The old cluster was created without data checksums, but the new cluster expects them.</p>", remediation: "- Recreate the new cluster without checksums to match the old one.\n- Use pg_dump/pg_restore for migration if checksum compatibility is required.\n- Consider the trade-offs of enabling/disabling checksums.", troubleshooting_code: "SHOW data_checksums; SELECT * FROM pg_control_init();", views: 0, helpful_yes: 0, helpful_no: 0, comments: [] },
                        { id: "migration_pg_114", title: "ERROR: new cluster database template0 is not empty", errorCode: "XX000", severity: "High", solution: "<p>The template0 database in the new cluster is not empty, preventing migration.</p>", remediation: "- Ensure the new cluster is freshly initialized.\n- Drop and recreate the new cluster if necessary.\n- Verify template databases are in their original state.", troubleshooting_code: "SELECT count(*) FROM pg_class WHERE relname NOT LIKE 'pg_%' AND relname != 'information_schema';", views: 0, helpful_yes: 0, helpful_no: 0, comments: [] },
                        { id: "migration_pg_115", title: "ERROR: could not connect to old cluster", errorCode: "08001", severity: "High", solution: "<p>The migration process could not connect to the old PostgreSQL cluster.</p>", remediation: "- Ensure the old cluster is running and accessible.\n- Verify connection parameters (host, port, user).\n- Check authentication configuration in pg_hba.conf.\n- Test manual connection to the old cluster.", troubleshooting_code: "pg_isready -h old_host -p old_port; psql -h old_host -p old_port -l", views: 0, helpful_yes: 0, helpful_no: 0, comments: [] },
                        { id: "migration_pg_116", title: "ERROR: relation has a different OID in the new cluster", errorCode: "XX000", severity: "High", solution: "<p>A relation has a different OID in the new cluster, indicating potential data inconsistency.</p>", remediation: "- Restart the migration process with a clean new cluster.\n- Verify both clusters are in consistent states.\n- Use pg_dump/pg_restore as an alternative migration method.\n- Check for concurrent modifications during migration.", troubleshooting_code: "SELECT oid, relname FROM pg_class WHERE relname = 'your_table';", views: 0, helpful_yes: 0, helpful_no: 0, comments: [] },
                        { id: "migration_pg_117", title: "ERROR: mismatch of relation names in databases", errorCode: "XX000", severity: "High", solution: "<p>Relation names do not match between the old and new clusters.</p>", remediation: "- Ensure database schemas are identical before migration.\n- Check for case sensitivity issues in object names.\n- Verify all required objects exist in both clusters.\n- Use consistent naming conventions.", troubleshooting_code: "SELECT relname FROM pg_class ORDER BY relname;", views: 0, helpful_yes: 0, helpful_no: 0, comments: [] },
                        { id: "migration_pg_118", title: "ERROR: old cluster contains large objects", errorCode: "XX000", severity: "Medium", solution: "<p>The old cluster contains large objects that require special handling during migration.</p>", remediation: "- Use --link option with pg_upgrade to avoid copying large objects.\n- Ensure adequate disk space for large object migration.\n- Consider using pg_dump/pg_restore for complex large object scenarios.\n- Plan for extended migration time with large objects.", troubleshooting_code: "SELECT count(*) FROM pg_largeobject;", views: 0, helpful_yes: 0, helpful_no: 0, comments: [] },
                        { id: "migration_pg_119", title: "ERROR: encoding mismatch between clusters", errorCode: "XX000", severity: "High", solution: "<p>The character encoding differs between the old and new clusters.</p>", remediation: "- Ensure both clusters use the same character encoding.\n- Recreate the new cluster with matching encoding if necessary.\n- Use pg_dump/pg_restore with appropriate encoding options.\n- Verify locale and collation settings match.", troubleshooting_code: "SELECT datname, encoding FROM pg_database; SHOW server_encoding;", views: 0, helpful_yes: 0, helpful_no: 0, comments: [] },
                        { id: "migration_pg_120", title: "ERROR: incompatible column type change during migration", errorCode: "42804", severity: "High", solution: "<p>The column type change is incompatible and cannot be performed automatically.</p>", remediation: "- Use explicit casting with USING clause in ALTER COLUMN.\n- Create intermediate columns for complex type conversions.\n- Plan data transformation steps before type changes.\n- Test type conversion with sample data first.", troubleshooting_code: "ALTER TABLE table_name ALTER COLUMN col_name TYPE new_type USING col_name::new_type;", views: 0, helpful_yes: 0, helpful_no: 0, comments: [] },
                        { id: "migration_pg_121", title: "ERROR: migration script execution timeout", errorCode: "57014", severity: "High", solution: "<p>The migration script exceeded the maximum execution time limit.</p>", remediation: "- Break large migrations into smaller batches.\n- Increase statement_timeout for migration operations.\n- Optimize migration queries and operations.\n- Use background processing for large data transformations.", troubleshooting_code: "SET statement_timeout = '60min'; SHOW statement_timeout;", views: 0, helpful_yes: 0, helpful_no: 0, comments: [] },
                        { id: "migration_pg_122", title: "ERROR: version compatibility check failed", errorCode: "0A000", severity: "High", solution: "<p>The migration is not compatible with the current PostgreSQL version.</p>", remediation: "- Check PostgreSQL version compatibility requirements.\n- Update migration scripts for current version.\n- Use version-specific migration strategies.\n- Test migrations on matching PostgreSQL versions.", troubleshooting_code: "SELECT version(); SHOW server_version_num;", views: 0, helpful_yes: 0, helpful_no: 0, comments: [] },
                        { id: "migration_pg_123", title: "ERROR: extension version mismatch during upgrade", errorCode: "55006", severity: "Medium", solution: "<p>Extension versions are incompatible during database upgrade process.</p>", remediation: "- Update extensions to compatible versions before upgrade.\n- Plan extension upgrade sequence carefully.\n- Check extension compatibility matrix.\n- Use ALTER EXTENSION UPDATE commands appropriately.", troubleshooting_code: "SELECT extname, extversion FROM pg_extension; ALTER EXTENSION extension_name UPDATE;", views: 0, helpful_yes: 0, helpful_no: 0, comments: [] },
                        { id: "migration_pg_124", title: "ERROR: foreign key constraint blocks migration", errorCode: "23503", severity: "High", solution: "<p>Foreign key constraints prevent migration operations on referenced tables.</p>", remediation: "- Temporarily drop foreign key constraints during migration.\n- Use deferred constraint checking.\n- Plan migration order to respect dependencies.\n- Re-create constraints after data migration.", troubleshooting_code: "SET CONSTRAINTS ALL DEFERRED; SELECT conname, conrelid FROM pg_constraint WHERE contype = 'f';", views: 0, helpful_yes: 0, helpful_no: 0, comments: [] },
                        { id: "migration_pg_125", title: "ERROR: tablespace migration conflict", errorCode: "42P04", severity: "Medium", solution: "<p>Tablespace configuration conflicts during database migration.</p>", remediation: "- Ensure target tablespaces exist before migration.\n- Update tablespace paths and permissions.\n- Plan tablespace migration strategy.\n- Test tablespace access and configuration.", troubleshooting_code: "SELECT spcname, spclocation FROM pg_tablespace; \\db+", views: 0, helpful_yes: 0, helpful_no: 0, comments: [] },
                        { id: "migration_pg_126", title: "ERROR: encoding conversion failure in migration", errorCode: "22021", severity: "High", solution: "<p>Character encoding conversion failed during database migration.</p>", remediation: "- Ensure source and target encodings are compatible.\n- Clean up invalid character data before migration.\n- Use appropriate encoding conversion tools.\n- Plan encoding migration strategy carefully.", troubleshooting_code: "SELECT datname, encoding FROM pg_database; SHOW client_encoding;", views: 0, helpful_yes: 0, helpful_no: 0, comments: [] },
                        { id: "migration_pg_127", title: "ERROR: sequence value overflow during migration", errorCode: "2200H", severity: "Medium", solution: "<p>Sequence values exceed maximum limits during migration process.</p>", remediation: "- Increase sequence maximum values before migration.\n- Plan sequence value management during migration.\n- Use BIGINT sequences for large value ranges.\n- Reset sequences appropriately after migration.", troubleshooting_code: "SELECT sequencename, max_value, last_value FROM pg_sequences; ALTER SEQUENCE seq_name MAXVALUE new_max;", views: 0, helpful_yes: 0, helpful_no: 0, comments: [] },
                        { id: "migration_pg_128", title: "ERROR: index corruption detected during migration", errorCode: "XX001", severity: "High", solution: "<p>Index corruption was detected during the migration process.</p>", remediation: "- Drop and recreate corrupted indexes.\n- Run REINDEX on affected tables.\n- Verify data integrity after index recreation.\n- Plan index recreation during maintenance windows.", troubleshooting_code: "REINDEX INDEX index_name; SELECT indexrelid, indisvalid FROM pg_index WHERE NOT indisvalid;", views: 0, helpful_yes: 0, helpful_no: 0, comments: [] },
                        { id: "migration_pg_129", title: "ERROR: view dependency chain blocks migration", errorCode: "2BP01", severity: "Medium", solution: "<p>Complex view dependencies prevent table structure migration.</p>", remediation: "- Drop dependent views before table migration.\n- Save view definitions for recreation.\n- Plan view recreation order carefully.\n- Use CASCADE carefully to handle dependencies.", troubleshooting_code: "SELECT schemaname, viewname, definition FROM pg_views; DROP VIEW view_name CASCADE;", views: 0, helpful_yes: 0, helpful_no: 0, comments: [] },
                        { id: "migration_pg_130", title: "ERROR: function signature mismatch after migration", errorCode: "42883", severity: "Medium", solution: "<p>Function signatures don't match after migration due to type changes.</p>", remediation: "- Update function signatures to match new types.\n- Review function parameter and return types.\n- Plan function migration with type changes.\n- Test function compatibility after migration.", troubleshooting_code: "SELECT proname, proargtypes, prorettype FROM pg_proc; DROP FUNCTION func_name(old_types);", views: 0, helpful_yes: 0, helpful_no: 0, comments: [] },
                        { id: "migration_pg_131", title: "ERROR: privilege migration incomplete", errorCode: "42501", severity: "Medium", solution: "<p>User privileges were not properly migrated to the new database.</p>", remediation: "- Export and import privilege grants explicitly.\n- Review role and permission mappings.\n- Test access controls after migration.\n- Document privilege migration procedures.", troubleshooting_code: "SELECT grantee, privilege_type, table_name FROM information_schema.table_privileges; \\dp", views: 0, helpful_yes: 0, helpful_no: 0, comments: [] },
                        { id: "migration_pg_132", title: "ERROR: partition pruning failure after migration", errorCode: "XX000", severity: "Medium", solution: "<p>Partition pruning is not working correctly after table migration.</p>", remediation: "- Update partition constraints and metadata.\n- Recreate partition pruning statistics.\n- Test partition pruning with sample queries.\n- Review partition key definitions and ranges.", troubleshooting_code: "SELECT schemaname, tablename, pg_get_expr(relpartbound, oid) FROM pg_class WHERE relispartition; EXPLAIN (ANALYZE, BUFFERS) SELECT * FROM partitioned_table WHERE partition_key = value;", views: 0, helpful_yes: 0, helpful_no: 0, comments: [] },
                        { id: "migration_pg_133", title: "ERROR: configuration parameter migration conflict", errorCode: "42601", severity: "Low", solution: "<p>Configuration parameters conflict between source and target database versions.</p>", remediation: "- Review parameter compatibility across versions.\n- Update configuration for target version.\n- Test parameter settings after migration.\n- Document configuration changes needed.", troubleshooting_code: "SELECT name, setting, source FROM pg_settings WHERE source = 'configuration file'; SHOW all;", views: 0, helpful_yes: 0, helpful_no: 0, comments: [] },
                        { id: "migration_pg_134", title: "ERROR: statistics migration incomplete", errorCode: "XX000", severity: "Low", solution: "<p>Table and index statistics were not properly migrated.</p>", remediation: "- Run ANALYZE on all tables after migration.\n- Update table and index statistics manually.\n- Plan statistics collection as part of migration.\n- Monitor query performance after migration.", troubleshooting_code: "ANALYZE; SELECT schemaname, tablename, n_tup_ins, n_tup_upd FROM pg_stat_user_tables;", views: 0, helpful_yes: 0, helpful_no: 0, comments: [] },
                        { id: "migration_pg_135", title: "ERROR: data validation failure after migration", errorCode: "XX000", severity: "High", solution: "<p>Data validation checks failed after migration completion.</p>", remediation: "- Compare row counts between source and target.\n- Validate data integrity and consistency.\n- Check for missing or corrupted data.\n- Implement comprehensive data validation procedures.", troubleshooting_code: "SELECT COUNT(*) FROM source_table; SELECT COUNT(*) FROM target_table; SELECT checksum FROM data_validation_view;", views: 0, helpful_yes: 0, helpful_no: 0, comments: [] }
                    ]
                },
                debugging: {
                    title: "Troubleshooting & Debugging",
                    icon: "fa-solid fa-bug-slash",
                    intro: "Common syntax errors, data conversion problems, and other general T-SQL debugging issues.",
                    issues: [
                        { id: "debug_8114", title: "Error converting data type nvarchar to numeric.", errorCode: "8114", severity: "Low", solution: "<p>An attempt was made to explicitly or implicitly convert a string containing non-numeric characters to a number type (e.g., int, decimal).</p>", remediation: "1. Find the problematic data using `ISNUMERIC()` or `TRY_CONVERT()` (SQL Server 2012+).\n2. Cleanse the data at the source or fix the application logic that inserts it.\nExample: `SELECT * FROM YourTable WHERE ISNUMERIC(YourColumn) = 0;`", troubleshooting_code: "SELECT YourColumn FROM YourTable WHERE ISNUMERIC(YourColumn) = 0;", views: 0, helpful_yes: 0, helpful_no: 0, comments: [] },
                        { id: "debug_208", title: "Invalid object name '...'.", errorCode: "208", severity: "Medium", solution: "<p>A query references a table, view, or other object that does not exist, is misspelled, or is not accessible in the current database context.</p>", remediation: "1. Verify the object name is spelled correctly.\n2. Ensure you are executing the query in the correct database context (`USE DatabaseName;`).\n3. Check the object's schema (e.g., `dbo.TableName`).", troubleshooting_code: "SELECT name FROM sys.objects WHERE name LIKE '%YourObjectName%'; ", views: 0, helpful_yes: 0, helpful_no: 0, comments: [] },
                        { id: "debugging_new_1", title: "ERROR: out of shared memory", errorCode: "N/A", severity: "High", solution: "<p>PostgreSQL is unable to allocate enough shared memory for its operations, often leading to server startup failures or query execution issues.</p><p><b>Common Causes:</b> Insufficient `shared_buffers` or `work_mem` settings in `postgresql.conf`, system-level shared memory limits (e.g., `kernel.shmmax`, `kernel.shmall` on Linux) are too low, or too many concurrent connections.</p>", remediation: "- Adjust `shared_buffers` and `work_mem` in `postgresql.conf` to lower values, or increase system shared memory limits if the server has enough RAM.\n- For Linux, increase `kernel.shmmax` and `kernel.shmall` (and `shmmni`) in `/etc/sysctl.conf` and apply with `sudo sysctl -p`.\n- Reduce `max_connections` if too many connections are consuming memory.\n- Restart PostgreSQL after changes.", troubleshooting_code: "sysctl kernel.shmmax", views: 0, helpful_yes: 0, helpful_no: 0, comments: [] },
                        { id: "debugging_new_2", title: "ERROR: syntax error at or near", errorCode: "N/A", severity: "Low", solution: "<p>A SQL syntax error has occurred, preventing the query from being parsed and executed.</p><p><b>Common Causes:</b> Missing or incorrect keywords, unmatched parentheses or quotes, invalid identifier names, incorrect data type usage, missing semicolons.</p>", remediation: "- Review the SQL syntax around the error location.\n- Check for unmatched parentheses, brackets, or quotes.\n- Verify all keywords are spelled correctly.\n- Ensure proper semicolon placement.\n- Use a SQL formatter to identify syntax issues.", troubleshooting_code: "SELECT * FROM pg_stat_activity WHERE state = 'active';", views: 0, helpful_yes: 0, helpful_no: 0, comments: [] },
                        { id: "debugging_new_3", title: "ERROR: column does not exist", errorCode: "N/A", severity: "Medium", solution: "<p>The specified column name does not exist in the referenced table or view.</p><p><b>Common Causes:</b> Typo in column name, column was dropped or renamed, table schema changed, case sensitivity issues, wrong table reference.</p>", remediation: "- Verify the column name is spelled correctly.\n- Check the table structure: `\\d table_name` in psql.\n- Ensure you're referencing the correct table.\n- Check for case sensitivity (use double quotes for mixed case).\n- Verify the column hasn't been dropped or renamed.", troubleshooting_code: "SELECT column_name, data_type FROM information_schema.columns WHERE table_name = 'your_table_name';", views: 0, helpful_yes: 0, helpful_no: 0, comments: [] },
                        { id: "debugging_pg_101", title: "ERROR: invalid input syntax for type boolean", errorCode: "22P02", severity: "Medium", solution: "<p>The input value could not be converted to a boolean.</p>", remediation: "- Use only 'true', 'false', 't', 'f', '1', or '0' for boolean columns.\n- Validate input before insertion.", troubleshooting_code: "SELECT * FROM your_table WHERE NOT (your_column IN ('t','f','true','false','1','0'));", views: 0, helpful_yes: 0, helpful_no: 0, comments: [] },
                        { id: "debugging_pg_102", title: "ERROR: division by zero in PL/pgSQL function", errorCode: "22012", severity: "Medium", solution: "<p>A division by zero occurred inside a PL/pgSQL function.</p>", remediation: "- Add checks for zero denominators in your function code.\n- Use <code>NULLIF</code> to avoid division by zero.", troubleshooting_code: "SELECT proname FROM pg_proc WHERE prosrc LIKE '%/ 0%';", views: 0, helpful_yes: 0, helpful_no: 0, comments: [] },
                        { id: "debugging_pg_103", title: "ERROR: invalid regular expression", errorCode: "2201B", severity: "Low", solution: "<p>The regular expression used in a query or function is invalid.</p>", remediation: "- Test regular expressions before using them in queries.\n- Use valid PostgreSQL regex syntax.", troubleshooting_code: "SELECT * FROM your_table WHERE your_column ~ 'your_regex';", views: 0, helpful_yes: 0, helpful_no: 0, comments: [] },
                        { id: "debugging_pg_104", title: "ERROR: invalid byte sequence for encoding", errorCode: "22021", severity: "Medium", solution: "<p>The input contains a byte sequence that is not valid for the column's encoding.</p>", remediation: "- Ensure input data matches the column encoding.\n- Use <code>convert_to</code> and <code>convert_from</code> for encoding conversions.", troubleshooting_code: "SELECT convert_to('your_string', 'UTF8');", views: 0, helpful_yes: 0, helpful_no: 0, comments: [] },
                        { id: "debugging_pg_105", title: "ERROR: invalid escape string", errorCode: "22025", severity: "Low", solution: "<p>An invalid escape string was used in a query or function.</p>", remediation: "- Use valid escape sequences (e.g., \\n, \\t, \\').\n- Validate input strings before use.", troubleshooting_code: "SELECT E'your\nstring';", views: 0, helpful_yes: 0, helpful_no: 0, comments: [] },
                        { id: "debugging_pg_106", title: "ERROR: invalid input syntax for type numeric", errorCode: "22P02", severity: "Medium", solution: "<p>The input value could not be converted to a numeric type.</p>", remediation: "- Validate numeric input before insertion.\n- Use <code>CAST</code> or <code>TO_NUMBER</code> for conversions.", troubleshooting_code: "SELECT * FROM your_table WHERE NOT (your_column ~ '^[0-9.]+$');", views: 0, helpful_yes: 0, helpful_no: 0, comments: [] },
                        { id: "debugging_pg_107", title: "ERROR: invalid input syntax for type date", errorCode: "22007", severity: "Medium", solution: "<p>The input value could not be converted to a date type.</p>", remediation: "- Use valid date formats (e.g., 'YYYY-MM-DD').\n- Validate date input before insertion.", troubleshooting_code: "SELECT * FROM your_table WHERE your_date_column IS NOT NULL;", views: 0, helpful_yes: 0, helpful_no: 0, comments: [] },
                        { id: "debugging_pg_108", title: "ERROR: invalid input syntax for type time", errorCode: "22007", severity: "Low", solution: "<p>The input value could not be converted to a time type.</p>", remediation: "- Use valid time formats (e.g., 'HH:MI:SS').\n- Validate time input before insertion.", troubleshooting_code: "SELECT * FROM your_table WHERE your_time_column IS NOT NULL;", views: 0, helpful_yes: 0, helpful_no: 0, comments: [] },
                        { id: "debugging_pg_109", title: "ERROR: invalid input syntax for type boolean in function argument", errorCode: "22P02", severity: "Low", solution: "<p>A function argument could not be converted to a boolean.</p>", remediation: "- Use valid boolean values in function calls.\n- Validate input before calling functions.", troubleshooting_code: "SELECT * FROM your_table WHERE NOT (your_column IN ('t','f','true','false','1','0'));", views: 0, helpful_yes: 0, helpful_no: 0, comments: [] },
                        { id: "debugging_pg_110", title: "ERROR: invalid input syntax for type interval in function argument", errorCode: "22007", severity: "Low", solution: "<p>A function argument could not be converted to an interval type.</p>", remediation: "- Use valid interval syntax in function calls.\n- Validate interval input before calling functions.", troubleshooting_code: "SELECT * FROM your_table WHERE your_interval_column IS NOT NULL;", views: 0, helpful_yes: 0, helpful_no: 0, comments: [] },
                        { id: "debugging_pg_111", title: "ERROR: stack depth limit exceeded", errorCode: "54001", severity: "High", solution: "<p>The query or function call exceeded the maximum stack depth, often due to excessive recursion.</p>", remediation: "- Reduce recursion depth in queries or functions.\n- Increase <code>max_stack_depth</code> if system allows.\n- Optimize recursive algorithms to use less stack space.\n- Use iterative approaches instead of deep recursion.", troubleshooting_code: "SHOW max_stack_depth; SET max_stack_depth = '4MB';", views: 0, helpful_yes: 0, helpful_no: 0, comments: [] },
                        { id: "debugging_pg_112", title: "ERROR: invalid transaction termination", errorCode: "25P01", severity: "Medium", solution: "<p>An invalid transaction termination command was issued (e.g., COMMIT when no transaction is active).</p>", remediation: "- Ensure proper transaction state management.\n- Use BEGIN before COMMIT or ROLLBACK.\n- Check transaction state before issuing termination commands.\n- Implement proper error handling for transaction management.", troubleshooting_code: "SELECT txid_current_if_assigned(); SELECT state FROM pg_stat_activity WHERE pid = pg_backend_pid();", views: 0, helpful_yes: 0, helpful_no: 0, comments: [] },
                        { id: "debugging_pg_113", title: "ERROR: cursor does not exist", errorCode: "34000", severity: "Medium", solution: "<p>The specified cursor name does not exist or has already been closed.</p>", remediation: "- Verify cursor names are correct and case-sensitive.\n- Ensure cursors are declared before use.\n- Check cursor scope and lifetime.\n- Use proper cursor management in applications.", troubleshooting_code: "SELECT name FROM pg_cursors;", views: 0, helpful_yes: 0, helpful_no: 0, comments: [] },
                        { id: "debugging_pg_114", title: "ERROR: prepared statement does not exist", errorCode: "26000", severity: "Medium", solution: "<p>The specified prepared statement name does not exist.</p>", remediation: "- Verify prepared statement names are correct.\n- Ensure statements are prepared before execution.\n- Check statement scope and lifetime.\n- Use proper prepared statement management.", troubleshooting_code: "SELECT name FROM pg_prepared_statements;", views: 0, helpful_yes: 0, helpful_no: 0, comments: [] },
                        { id: "debugging_pg_115", title: "ERROR: savepoint does not exist", errorCode: "3B001", severity: "Medium", solution: "<p>The specified savepoint does not exist or has already been released.</p>", remediation: "- Verify savepoint names are correct.\n- Ensure savepoints are created before rollback.\n- Use proper savepoint management in transactions.\n- Check savepoint scope within transactions.", troubleshooting_code: "SAVEPOINT sp1; ROLLBACK TO sp1; RELEASE sp1;", views: 0, helpful_yes: 0, helpful_no: 0, comments: [] },
                        { id: "debugging_pg_116", title: "ERROR: invalid command in prepared statement", errorCode: "26000", severity: "Medium", solution: "<p>The prepared statement contains an invalid or unsupported command.</p>", remediation: "- Use only supported SQL commands in prepared statements.\n- Avoid utility commands in prepared statements.\n- Review prepared statement content for syntax errors.\n- Use appropriate statement types for different operations.", troubleshooting_code: "PREPARE stmt AS SELECT * FROM table WHERE column = $1;", views: 0, helpful_yes: 0, helpful_no: 0, comments: [] },
                        { id: "debugging_pg_117", title: "ERROR: protocol error in array format", errorCode: "22P04", severity: "Medium", solution: "<p>An error occurred in the binary format of an array parameter or result.</p>", remediation: "- Check array binary format specifications.\n- Use text format for arrays if binary format causes issues.\n- Validate array structure before transmission.\n- Review client library array handling.", troubleshooting_code: "SELECT array_to_string(ARRAY[1,2,3], ',');", views: 0, helpful_yes: 0, helpful_no: 0, comments: [] },
                        { id: "debugging_pg_118", title: "ERROR: operator class does not exist", errorCode: "42704", severity: "Medium", solution: "<p>The specified operator class for an index does not exist.</p>", remediation: "- Use existing operator classes for index creation.\n- Create custom operator classes if needed.\n- Verify operator class names and availability.\n- Check extension requirements for specialized operator classes.", troubleshooting_code: "SELECT opcname FROM pg_opclass WHERE opcname LIKE '%your_opclass%';", views: 0, helpful_yes: 0, helpful_no: 0, comments: [] },
                        { id: "debugging_pg_119", title: "ERROR: function result type must be specified", errorCode: "42P13", severity: "Medium", solution: "<p>The function definition requires an explicit result type specification.</p>", remediation: "- Specify return type in function definitions.\n- Use RETURNS clause with appropriate data types.\n- For functions returning sets, use RETURNS SETOF or RETURNS TABLE.\n- Ensure all code paths return appropriate types.", troubleshooting_code: "CREATE OR REPLACE FUNCTION func_name() RETURNS integer AS $$ BEGIN RETURN 1; END; $$ LANGUAGE plpgsql;", views: 0, helpful_yes: 0, helpful_no: 0, comments: [] }
                    ]
                },
                indexing_errors: {
                    title: "Indexing in SQL Errors",
                    icon: "fa-solid fa-key",
                    intro: "Specific errors related to the creation, maintenance, and performance of indexes.",
                    issues: [
                        { id: "index_1946", title: "The index key size exceeds the maximum limit of 900 bytes.", errorCode: "1946", severity: "Medium", solution: "<p>The total size of all columns included in an index key is larger than the maximum allowed size (900 bytes for non-clustered, 1700 for clustered in modern versions).</p>", remediation: "1. Reduce the size of the columns in the index key (e.g., use `VARCHAR(50)` instead of `VARCHAR(MAX)`).\n2. Move wide, non-essential columns to the `INCLUDE` clause of the index instead of the key.", troubleshooting_code: "SELECT name, type_name(user_type_id), max_length FROM sys.columns WHERE object_id = OBJECT_ID('YourTable');", views: 0, helpful_yes: 0, helpful_no: 0, comments: [] },
                        { id: "index_1505", title: "The CREATE UNIQUE INDEX statement terminated because a duplicate key was found.", errorCode: "1505", severity: "High", solution: "<p>An attempt to create a unique index failed because duplicate values already exist in the key columns for one or more rows.</p>", remediation: "1. Find the duplicate values in the key columns.\n2. Remove or merge the duplicate data before attempting to create the unique index again.", troubleshooting_code: "SELECT YourColumn, COUNT(*) FROM YourTable GROUP BY YourColumn HAVING COUNT(*) > 1;", views: 0, helpful_yes: 0, helpful_no: 0, comments: [] },
                        { id: "indexing_new_1", title: "Introduction to Indexes", errorCode: "N/A", severity: "Low", solution: "<p>In PostgreSQL, an <b>index</b> is a special lookup table that the database search engine can use to speed up data retrieval. Think of it like the index at the back of a book. Instead of reading the entire book to find a specific topic, you can look up the topic in the index, find the page number, and go directly to that page. Similarly, a database index allows PostgreSQL to quickly locate data without scanning every row in a table.</p><p>When you create an index on one or more columns of a table, PostgreSQL creates a data structure (typically a B-tree) that stores the values of those columns along with pointers to the corresponding rows in the table. When a query is executed that involves the indexed columns, PostgreSQL can use the index to find the relevant rows much faster.</p>", remediation: "No remediation needed. This is an informational entry.", troubleshooting_code: "SELECT indexname, indexdef FROM pg_indexes WHERE tablename = 'your_table_name';", views: 0, helpful_yes: 0, helpful_no: 0, comments: [] },
                        { id: "indexing_new_2", title: "ERROR: index row size exceeds maximum", errorCode: "N/A", severity: "Medium", solution: "<p>The index entry size exceeds PostgreSQL's maximum allowed size for index entries.</p><p><b>Common Causes:</b> Indexing very wide columns (TEXT, VARCHAR with large limits), composite indexes with too many columns, indexing JSON/JSONB columns without proper operators.</p>", remediation: "- Consider indexing only the first N characters of wide text columns.\n- Reduce the number of columns in composite indexes.\n- Use functional indexes for specific use cases.\n- Consider GIN indexes for JSON/JSONB columns.\n- Use partial indexes to reduce index size.", troubleshooting_code: "SELECT attname, attlen FROM pg_attribute WHERE attrelid = 'your_table_name'::regclass AND attnum > 0;", views: 0, helpful_yes: 0, helpful_no: 0, comments: [] },
                        { id: "indexing_new_3", title: "ERROR: could not create unique index", errorCode: "N/A", severity: "High", solution: "<p>PostgreSQL cannot create a unique index because duplicate values already exist in the columns being indexed.</p><p><b>Common Causes:</b> Data already contains duplicate values, concurrent inserts creating duplicates, data migration issues, application logic not enforcing uniqueness.</p>", remediation: "- Identify and resolve duplicate values before creating the unique index.\n- Use `CREATE UNIQUE INDEX CONCURRENTLY` to avoid blocking operations.\n- Clean up duplicate data: `DELETE FROM table WHERE ctid NOT IN (SELECT MIN(ctid) FROM table GROUP BY column1, column2);`\n- Consider using `ON CONFLICT` clauses in INSERT statements.", troubleshooting_code: "SELECT column_name, COUNT(*) FROM your_table GROUP BY column_name HAVING COUNT(*) > 1;", views: 0, helpful_yes: 0, helpful_no: 0, comments: [] },
                        { id: "indexing_pg_101", title: "ERROR: cannot create index concurrently during recovery", errorCode: "XX000", severity: "High", solution: "<p>Indexes cannot be created concurrently while the database is in recovery mode.</p>", remediation: "- Wait until recovery is complete before creating indexes concurrently.\n- Use non-concurrent index creation if urgent.", troubleshooting_code: "SELECT pg_is_in_recovery();", views: 0, helpful_yes: 0, helpful_no: 0, comments: [] },
                        { id: "indexing_pg_102", title: "ERROR: index already exists", errorCode: "42P07", severity: "Low", solution: "<p>An index with the specified name already exists.</p>", remediation: "- Use a unique index name.\n- Drop or rename the existing index if appropriate.", troubleshooting_code: "SELECT indexname FROM pg_indexes WHERE indexname = 'your_index';", views: 0, helpful_yes: 0, helpful_no: 0, comments: [] },
                        { id: "indexing_pg_103", title: "ERROR: cannot drop index because it is used for exclusion constraint", errorCode: "XX000", severity: "Medium", solution: "<p>The index cannot be dropped because it is used by an exclusion constraint.</p>", remediation: "- Drop the exclusion constraint before dropping the index.\n- Review table constraints before modifying indexes.", troubleshooting_code: "SELECT conname FROM pg_constraint WHERE contype = 'x';", views: 0, helpful_yes: 0, helpful_no: 0, comments: [] },
                        { id: "indexing_pg_104", title: "ERROR: cannot create index on expression", errorCode: "XX000", severity: "Medium", solution: "<p>The index cannot be created on the specified expression, possibly due to unsupported data types or functions.</p>", remediation: "- Use supported data types and functions in index expressions.\n- Review documentation for indexable expressions.", troubleshooting_code: "SELECT * FROM pg_indexes WHERE tablename = 'your_table';", views: 0, helpful_yes: 0, helpful_no: 0, comments: [] },
                        { id: "indexing_pg_105", title: "ERROR: index is not a btree", errorCode: "XX000", severity: "Low", solution: "<p>The operation requires a btree index, but the specified index is of a different type.</p>", remediation: "- Use a btree index for operations that require it.\n- Create a new btree index if necessary.", troubleshooting_code: "SELECT indexname, indclass FROM pg_indexes WHERE tablename = 'your_table';", views: 0, helpful_yes: 0, helpful_no: 0, comments: [] },
                        { id: "indexing_pg_106", title: "ERROR: cannot create index on system catalog", errorCode: "XX000", severity: "High", solution: "<p>Indexes cannot be created on system catalog tables.</p>", remediation: "- Avoid creating indexes on system catalogs.\n- Use indexes only on user tables.", troubleshooting_code: "SELECT * FROM pg_catalog.pg_tables;", views: 0, helpful_yes: 0, helpful_no: 0, comments: [] },
                        { id: "indexing_pg_107", title: "ERROR: cannot drop index because it is used by a foreign key", errorCode: "XX000", severity: "Medium", solution: "<p>The index cannot be dropped because it is used by a foreign key constraint.</p>", remediation: "- Drop the foreign key constraint before dropping the index.\n- Review table constraints before modifying indexes.", troubleshooting_code: "SELECT conname FROM pg_constraint WHERE contype = 'f';", views: 0, helpful_yes: 0, helpful_no: 0, comments: [] },
                        { id: "indexing_pg_108", title: "ERROR: cannot create index on expression with volatile function", errorCode: "XX000", severity: "Medium", solution: "<p>Indexes cannot be created on expressions that use volatile functions.</p>", remediation: "- Use only immutable or stable functions in index expressions.\n- Review function volatility in documentation.", troubleshooting_code: "SELECT proname, provolatile FROM pg_proc WHERE proname = 'your_function';", views: 0, helpful_yes: 0, helpful_no: 0, comments: [] },
                        { id: "indexing_pg_109", title: "ERROR: cannot create index on partitioned table directly", errorCode: "XX000", severity: "Medium", solution: "<p>Indexes must be created on partitions, not directly on the partitioned table.</p>", remediation: "- Create indexes on each partition individually.\n- Review partitioning strategy.", troubleshooting_code: "SELECT relname, relkind FROM pg_class WHERE relkind = 'p';", views: 0, helpful_yes: 0, helpful_no: 0, comments: [] },
                        { id: "indexing_pg_110", title: "ERROR: cannot create index with duplicate column names", errorCode: "42701", severity: "Low", solution: "<p>An index definition contains duplicate column names.</p>", remediation: "- Use unique column names in index definitions.\n- Review index creation statements for errors.", troubleshooting_code: "SELECT indexname, indexdef FROM pg_indexes WHERE tablename = 'your_table';", views: 0, helpful_yes: 0, helpful_no: 0, comments: [] },
                        { id: "indexing_pg_111", title: "ERROR: index expression cannot reference other tables", errorCode: "42P01", severity: "Medium", solution: "<p>An index expression incorrectly references columns from other tables.</p>", remediation: "- Use only columns from the indexed table in expressions.\n- Remove cross-table references from index expressions.\n- Create separate indexes on related tables if needed.", troubleshooting_code: "SELECT indexname, indexdef FROM pg_indexes WHERE indexdef LIKE '%other_table%';", views: 0, helpful_yes: 0, helpful_no: 0, comments: [] },
                        { id: "indexing_pg_112", title: "ERROR: cannot create index on inherited table", errorCode: "0A000", severity: "Medium", solution: "<p>Indexes cannot be created directly on inherited tables in certain contexts.</p>", remediation: "- Create indexes on parent and child tables separately.\n- Use table inheritance carefully with indexing strategy.\n- Consider table partitioning instead of inheritance.", troubleshooting_code: "SELECT schemaname, tablename, inherits FROM pg_tables WHERE inherits IS NOT NULL;", views: 0, helpful_yes: 0, helpful_no: 0, comments: [] },
                        { id: "indexing_pg_113", title: "ERROR: access method does not support multicolumn indexes", errorCode: "0A000", severity: "Medium", solution: "<p>The specified index access method does not support multiple columns.</p>", remediation: "- Use btree access method for multicolumn indexes.\n- Create separate single-column indexes if needed.\n- Review access method capabilities and limitations.", troubleshooting_code: "SELECT amname FROM pg_am WHERE amcanmulticol = true;", views: 0, helpful_yes: 0, helpful_no: 0, comments: [] },
                        { id: "indexing_pg_114", title: "ERROR: operator family does not exist", errorCode: "42704", severity: "Medium", solution: "<p>The specified operator family for an index does not exist.</p>", remediation: "- Use existing operator families for index creation.\n- Create custom operator families if needed.\n- Verify operator family names and availability.\n- Install required extensions for specialized operator families.", troubleshooting_code: "SELECT opfname FROM pg_opfamily WHERE opfname LIKE '%your_family%';", views: 0, helpful_yes: 0, helpful_no: 0, comments: [] },
                        { id: "indexing_pg_115", title: "ERROR: access method does not support ordering operators", errorCode: "0A000", severity: "Medium", solution: "<p>The specified access method does not support ordering operators for this operation.</p>", remediation: "- Use btree access method for ordered operations.\n- Remove ordering requirements if not essential.\n- Choose appropriate access method for your use case.", troubleshooting_code: "SELECT amname, amcanorder FROM pg_am;", views: 0, helpful_yes: 0, helpful_no: 0, comments: [] },
                        { id: "indexing_pg_116", title: "ERROR: cannot create partial index on system catalog", errorCode: "42P01", severity: "High", solution: "<p>Partial indexes cannot be created on system catalog tables.</p>", remediation: "- Avoid creating indexes on system catalogs.\n- Use indexes only on user tables.\n- Review index creation targets.", troubleshooting_code: "SELECT tablename FROM pg_tables WHERE schemaname = 'pg_catalog';", views: 0, helpful_yes: 0, helpful_no: 0, comments: [] },
                        { id: "indexing_pg_117", title: "ERROR: index method does not support bitmap scans", errorCode: "0A000", severity: "Low", solution: "<p>The index method does not support bitmap scan operations.</p>", remediation: "- Use btree indexes for bitmap scan support.\n- Consider query optimization alternatives.\n- Review access method capabilities.", troubleshooting_code: "SELECT amname, amcanbitmapscan FROM pg_am;", views: 0, helpful_yes: 0, helpful_no: 0, comments: [] },
                        { id: "indexing_pg_118", title: "ERROR: cannot cluster on partial index", errorCode: "0A000", severity: "Medium", solution: "<p>CLUSTER operation cannot be performed using a partial index.</p>", remediation: "- Use a complete index for clustering operations.\n- Create a full index specifically for clustering.\n- Consider alternative table organization methods.", troubleshooting_code: "SELECT indexname, indexdef FROM pg_indexes WHERE indexdef LIKE '%WHERE%';", views: 0, helpful_yes: 0, helpful_no: 0, comments: [] },
                        { id: "indexing_pg_119", title: "ERROR: index row requires bytes, maximum size is", errorCode: "54000", severity: "High", solution: "<p>The index row exceeds the maximum allowed size for the index page.</p>", remediation: "- Reduce the size of indexed columns.\n- Use partial indexes to exclude large values.\n- Consider hash indexes for equality operations on large values.\n- Split large composite indexes into smaller ones.", troubleshooting_code: "SELECT indexname, pg_size_pretty(pg_relation_size(indexname::regclass)) FROM pg_indexes ORDER BY pg_relation_size(indexname::regclass) DESC;", views: 0, helpful_yes: 0, helpful_no: 0, comments: [] }
                    ]
                },
                join_errors: {
                    title: "SQL Join Errors",
                    icon: "fa-solid fa-link",
                    intro: "Errors that occur when joining tables, such as ambiguous columns or collation conflicts.",
                    issues: [
                        { id: "join_209", title: "Ambiguous column name 'ColumnName'.", errorCode: "209", severity: "Low", solution: "<p>A column name is used that exists in more than one table in the query, and it was not prefixed with the table name or an alias, so SQL Server doesn't know which one to use.</p>", remediation: "1. Qualify all column names with a table alias (e.g., `SELECT c.CustomerID, o.OrderID FROM Customers c JOIN Orders o ON c.ID = o.CustomerID;`).\n2. Use clear and consistent table aliases.", troubleshooting_code: "sp_help 'YourTable1';\nsp_help 'YourTable2';", views: 0, helpful_yes: 0, helpful_no: 0, comments: [] },
                        { id: "join_468", title: "Cannot resolve the collation conflict between 'CollationA' and 'CollationB' in the equal to operation.", errorCode: "468", severity: "Medium", solution: "<p>The columns being joined have different collations, which determines sorting and comparison rules for character data. SQL Server cannot compare them directly.</p>", remediation: "1. Add a `COLLATE` clause to one of the columns in the `ON` condition to match the other.\nExample: `... ON T1.ColA = T2.ColB COLLATE DATABASE_DEFAULT`.", troubleshooting_code: "SELECT name, collation_name FROM sys.columns WHERE object_id = OBJECT_ID('YourTable') AND name = 'YourColumn';", views: 0, helpful_yes: 0, helpful_no: 0, comments: [] },
                        { id: "join_errors_new_1", title: "ERROR: invalid reference to FROM-clause entry", errorCode: "N/A", severity: "Medium", solution: "<p>A table alias or table reference in the query is invalid or not properly defined in the FROM clause.</p><p><b>Common Causes:</b> Undefined table alias, typo in table name or alias, table not included in FROM clause, incorrect schema reference.</p>", remediation: "- Verify all table aliases are properly defined in the FROM clause.\n- Check for typos in table names and aliases.\n- Ensure all referenced tables are included in the FROM clause.\n- Use explicit schema names if needed: `schema_name.table_name`.\n- Review the query structure for proper JOIN syntax.", troubleshooting_code: "SELECT schemaname, tablename FROM pg_tables WHERE tablename LIKE '%your_table%';", views: 0, helpful_yes: 0, helpful_no: 0, comments: [] },
                        { id: "join_errors_new_2", title: "ERROR: column reference is ambiguous", errorCode: "N/A", severity: "Low", solution: "<p>A column name exists in multiple tables in the query, and PostgreSQL cannot determine which table's column to use.</p><p><b>Common Causes:</b> Same column name in multiple joined tables, missing table prefix or alias, complex query with multiple table references.</p>", remediation: "- Qualify column names with table aliases: `table_alias.column_name`.\n- Use descriptive table aliases to avoid confusion.\n- Review the query to identify all table references.\n- Consider using table prefixes for all columns in complex queries.\n- Use `SELECT table_alias.*` to select all columns from a specific table.", troubleshooting_code: "SELECT column_name, table_name FROM information_schema.columns WHERE column_name = 'ambiguous_column_name';", views: 0, helpful_yes: 0, helpful_no: 0, comments: [] },
                        { id: "join_errors_new_3", title: "ERROR: invalid input syntax for type", errorCode: "N/A", severity: "Medium", solution: "<p>The data types of columns being compared in a JOIN condition are incompatible or cannot be automatically converted.</p><p><b>Common Causes:</b> Different data types in JOIN columns, string vs numeric comparison, date format mismatches, NULL value handling issues.</p>", remediation: "- Use explicit type casting: `CAST(column AS target_type)`.\n- Ensure consistent data types across JOIN columns.\n- Handle NULL values appropriately in JOIN conditions.\n- Use proper date/time formatting for date comparisons.\n- Consider using `COALESCE` or `NULLIF` for NULL handling.", troubleshooting_code: "SELECT column_name, data_type FROM information_schema.columns WHERE table_name IN ('table1', 'table2') AND column_name IN ('join_column1', 'join_column2');", views: 0, helpful_yes: 0, helpful_no: 0, comments: [] },
                        { id: "join_pg_101", title: "ERROR: FULL JOIN is not implemented for this join type", errorCode: "0A000", severity: "Medium", solution: "<p>The requested FULL JOIN is not supported for the specified join type or condition.</p>", remediation: "- Use LEFT JOIN or RIGHT JOIN as alternatives.\n- Rewrite the query to avoid unsupported join types.", troubleshooting_code: "EXPLAIN SELECT * FROM table1 FULL JOIN table2 ON table1.id = table2.id;", views: 0, helpful_yes: 0, helpful_no: 0, comments: [] },
                        { id: "join_pg_102", title: "ERROR: cannot join on columns with different data types", errorCode: "42804", severity: "High", solution: "<p>The join condition references columns with incompatible data types.</p>", remediation: "- Use explicit type casts to ensure compatible data types.\n- Review table schemas for join columns.", troubleshooting_code: "SELECT column_name, data_type FROM information_schema.columns WHERE table_name IN ('table1', 'table2');", views: 0, helpful_yes: 0, helpful_no: 0, comments: [] },
                        { id: "join_pg_103", title: "ERROR: join condition is not supported", errorCode: "0A000", severity: "Medium", solution: "<p>The join condition uses an unsupported operator or function.</p>", remediation: "- Use supported operators and functions in join conditions.\n- Review documentation for allowed join conditions.", troubleshooting_code: "EXPLAIN SELECT * FROM table1 JOIN table2 ON table1.col1 @@ table2.col2;", views: 0, helpful_yes: 0, helpful_no: 0, comments: [] },
                        { id: "join_pg_104", title: "ERROR: join requires at least one equality condition", errorCode: "0A000", severity: "Medium", solution: "<p>The join operation requires at least one equality condition between columns.</p>", remediation: "- Add an equality condition to the join clause.\n- Review the query logic for correct join syntax.", troubleshooting_code: "EXPLAIN SELECT * FROM table1 JOIN table2 ON table1.col1 > table2.col2;", views: 0, helpful_yes: 0, helpful_no: 0, comments: [] },
                        { id: "join_pg_105", title: "ERROR: USING clause requires columns with the same name", errorCode: "42601", severity: "Low", solution: "<p>The USING clause in a join requires columns with identical names in both tables.</p>", remediation: "- Rename columns to match in both tables.\n- Use ON clause instead of USING if column names differ.", troubleshooting_code: "SELECT column_name FROM information_schema.columns WHERE table_name = 'your_table';", views: 0, helpful_yes: 0, helpful_no: 0, comments: [] },
                        { id: "join_pg_106", title: "ERROR: NATURAL JOIN is not supported for this join type", errorCode: "0A000", severity: "Medium", solution: "<p>The requested NATURAL JOIN is not supported for the specified join type or condition.</p>", remediation: "- Use explicit join conditions instead of NATURAL JOIN.\n- Rewrite the query to avoid unsupported join types.", troubleshooting_code: "EXPLAIN SELECT * FROM table1 NATURAL JOIN table2;", views: 0, helpful_yes: 0, helpful_no: 0, comments: [] },
                        { id: "join_pg_107", title: "ERROR: cannot join on columns with different collations", errorCode: "42804", severity: "High", solution: "<p>The join condition references columns with incompatible collations.</p>", remediation: "- Use explicit COLLATE clauses to ensure compatible collations.\n- Review table schemas for join columns.", troubleshooting_code: "SELECT column_name, collation_name FROM information_schema.columns WHERE table_name IN ('table1', 'table2');", views: 0, helpful_yes: 0, helpful_no: 0, comments: [] },
                        { id: "join_pg_108", title: "ERROR: join condition contains unsupported subquery", errorCode: "0A000", severity: "Medium", solution: "<p>The join condition contains a subquery, which is not supported.</p>", remediation: "- Rewrite the query to avoid subqueries in join conditions.\n- Use derived tables or CTEs if needed.", troubleshooting_code: "EXPLAIN SELECT * FROM table1 JOIN table2 ON (SELECT ...);", views: 0, helpful_yes: 0, helpful_no: 0, comments: [] },
                        { id: "join_pg_109", title: "ERROR: join condition must not contain aggregate functions", errorCode: "42803", severity: "Medium", solution: "<p>Aggregate functions are not allowed in join conditions.</p>", remediation: "- Remove aggregate functions from join conditions.\n- Use aggregates in SELECT or HAVING clauses instead.", troubleshooting_code: "EXPLAIN SELECT * FROM table1 JOIN table2 ON SUM(table1.col) = table2.col;", views: 0, helpful_yes: 0, helpful_no: 0, comments: [] },
                        { id: "join_pg_110", title: "ERROR: join condition must not contain window functions", errorCode: "42803", severity: "Low", solution: "<p>Window functions are not allowed in join conditions.</p>", remediation: "- Remove window functions from join conditions.\n- Use window functions in SELECT or ORDER BY clauses instead.", troubleshooting_code: "EXPLAIN SELECT * FROM table1 JOIN table2 ON row_number() OVER () = table2.col;", views: 0, helpful_yes: 0, helpful_no: 0, comments: [] },
                        { id: "join_pg_111", title: "ERROR: cannot perform join on polymorphic types", errorCode: "42804", severity: "Medium", solution: "<p>Join operations cannot be performed directly on polymorphic data types.</p>", remediation: "- Cast polymorphic types to specific types before joining.\n- Use explicit type conversion in join conditions.\n- Define specific function overloads for target types.", troubleshooting_code: "SELECT proname, proargtypes FROM pg_proc WHERE proargtypes::text LIKE '%anyarray%';", views: 0, helpful_yes: 0, helpful_no: 0, comments: [] },
                        { id: "join_pg_112", title: "ERROR: lateral reference not allowed in join condition", errorCode: "42P01", severity: "Medium", solution: "<p>Lateral references are not permitted in standard join conditions.</p>", remediation: "- Use LATERAL keyword explicitly for lateral joins.\n- Restructure query to avoid improper lateral references.\n- Move lateral logic to appropriate clauses.", troubleshooting_code: "SELECT * FROM table1, LATERAL (SELECT * FROM table2 WHERE table2.id = table1.id) t2;", views: 0, helpful_yes: 0, helpful_no: 0, comments: [] },
                        { id: "join_pg_113", title: "ERROR: cannot join on volatile expressions", errorCode: "0A000", severity: "Medium", solution: "<p>Join conditions cannot contain volatile expressions that may return different results for the same input.</p>", remediation: "- Replace volatile functions with stable or immutable equivalents.\n- Pre-compute volatile expressions in subqueries.\n- Use appropriate function volatility categories.", troubleshooting_code: "SELECT proname, provolatile FROM pg_proc WHERE provolatile = 'v';", views: 0, helpful_yes: 0, helpful_no: 0, comments: [] },
                        { id: "join_pg_114", title: "ERROR: join requires matching array dimensions", errorCode: "42804", severity: "Medium", solution: "<p>Array joins require arrays with matching dimensions and compatible element types.</p>", remediation: "- Ensure arrays have compatible dimensions for join operations.\n- Use array functions to normalize dimensions if needed.\n- Cast array element types to compatible types.", troubleshooting_code: "SELECT array_dims(column_name) FROM your_table;", views: 0, helpful_yes: 0, helpful_no: 0, comments: [] },
                        { id: "join_pg_115", title: "ERROR: cannot use set-returning function in join condition", errorCode: "0A000", severity: "Medium", solution: "<p>Set-returning functions are not allowed in join conditions.</p>", remediation: "- Move set-returning functions to FROM clause or subqueries.\n- Use appropriate join syntax for set-returning functions.\n- Consider using LATERAL joins for complex cases.", troubleshooting_code: "SELECT * FROM table1 JOIN LATERAL generate_series(1, table1.max_val) AS gs ON gs = table1.id;", views: 0, helpful_yes: 0, helpful_no: 0, comments: [] },
                        { id: "join_pg_116", title: "ERROR: join condition contains non-deterministic function", errorCode: "0A000", severity: "Medium", solution: "<p>Join conditions cannot contain non-deterministic functions that may produce different results.</p>", remediation: "- Replace non-deterministic functions with deterministic alternatives.\n- Pre-compute random or time-based values in subqueries.\n- Use appropriate function categories for join conditions.", troubleshooting_code: "SELECT proname FROM pg_proc WHERE proname IN ('random', 'now', 'timeofday');", views: 0, helpful_yes: 0, helpful_no: 0, comments: [] },
                        { id: "join_pg_117", title: "ERROR: cannot join tables with different schemas in cross-database query", errorCode: "0A000", severity: "High", solution: "<p>Cross-database joins are not directly supported in PostgreSQL.</p>", remediation: "- Use foreign data wrappers (FDW) for cross-database access.\n- Consider dblink extension for cross-database queries.\n- Redesign schema to keep related data in same database.", troubleshooting_code: "SELECT * FROM dblink('foreign_server', 'SELECT * FROM remote_table') AS t(col1 int, col2 text);", views: 0, helpful_yes: 0, helpful_no: 0, comments: [] },
                        { id: "join_pg_118", title: "ERROR: cannot perform outer join on recursive query", errorCode: "0A000", severity: "Medium", solution: "<p>Outer joins are not supported directly within recursive CTE queries.</p>", remediation: "- Use inner joins in recursive CTEs.\n- Apply outer join logic in outer query after recursion.\n- Restructure recursive logic to avoid outer join requirements.", troubleshooting_code: "WITH RECURSIVE cte AS (SELECT * FROM table1 UNION SELECT * FROM table1 JOIN table2 ON ...) SELECT * FROM cte;", views: 0, helpful_yes: 0, helpful_no: 0, comments: [] },
                        { id: "join_pg_119", title: "ERROR: join selectivity estimation failed", errorCode: "XX000", severity: "Low", solution: "<p>The query planner failed to estimate join selectivity, potentially affecting query performance.</p>", remediation: "- Update table statistics with ANALYZE.\n- Consider creating extended statistics for correlated columns.\n- Review query structure for complexity issues.\n- Monitor query performance and adjust as needed.", troubleshooting_code: "ANALYZE table1; ANALYZE table2; CREATE STATISTICS stat_name ON col1, col2 FROM table1;", views: 0, helpful_yes: 0, helpful_no: 0, comments: [] }
                    ]
                },
                performance_tuning: {
                    title: "Performance & Query Optimization",
                    icon: "fa-solid fa-tachometer-alt",
                    intro: "Issues related to query performance, slow queries, and database optimization.",
                    issues: [
                        { id: "perf_pg_101", title: "WARNING: query performance degraded", errorCode: "01000", severity: "Medium", solution: "<p>Query execution time has significantly increased compared to historical performance.</p>", remediation: "- Run ANALYZE on affected tables to update statistics.\n- Check for missing or inefficient indexes.\n- Review query execution plan for performance bottlenecks.\n- Consider query rewriting for better performance.", troubleshooting_code: "EXPLAIN (ANALYZE, BUFFERS) SELECT * FROM your_table WHERE condition;", views: 0, helpful_yes: 0, helpful_no: 0, comments: [] },
                        { id: "perf_pg_102", title: "ERROR: statement timeout", errorCode: "57014", severity: "High", solution: "<p>Query execution was terminated due to statement timeout.</p>", remediation: "- Increase statement_timeout setting if appropriate.\n- Optimize query performance with proper indexing.\n- Break down complex queries into smaller operations.\n- Review query logic for efficiency improvements.", troubleshooting_code: "SHOW statement_timeout; SET statement_timeout = '30min';", views: 0, helpful_yes: 0, helpful_no: 0, comments: [] },
                        { id: "perf_pg_103", title: "ERROR: work_mem exceeded during sort", errorCode: "53200", severity: "Medium", solution: "<p>Query required more memory than available work_mem for sorting operations.</p>", remediation: "- Increase work_mem setting for complex queries.\n- Add appropriate indexes to reduce sorting requirements.\n- Use ORDER BY with LIMIT to reduce sort operations.\n- Consider partitioning large tables.", troubleshooting_code: "SHOW work_mem; SET work_mem = '256MB';", views: 0, helpful_yes: 0, helpful_no: 0, comments: [] },
                        { id: "perf_pg_104", title: "ERROR: shared_buffers full", errorCode: "53200", severity: "High", solution: "<p>Database shared buffer cache is full, causing performance degradation.</p>", remediation: "- Increase shared_buffers setting if system memory allows.\n- Monitor buffer cache hit ratio and adjust accordingly.\n- Optimize queries to reduce buffer usage.\n- Consider connection pooling to reduce memory pressure.", troubleshooting_code: "SELECT * FROM pg_buffercache_summary();", views: 0, helpful_yes: 0, helpful_no: 0, comments: [] },
                        { id: "perf_pg_105", title: "WARNING: sequential scan detected on large table", errorCode: "01000", severity: "Medium", solution: "<p>Query is performing a sequential scan on a large table, causing poor performance.</p>", remediation: "- Create appropriate indexes on frequently queried columns.\n- Use partial indexes for common WHERE conditions.\n- Consider table partitioning for very large tables.\n- Review query conditions and add missing indexes.", troubleshooting_code: "EXPLAIN (ANALYZE, BUFFERS) SELECT * FROM large_table WHERE condition;", views: 0, helpful_yes: 0, helpful_no: 0, comments: [] },
                        { id: "perf_pg_106", title: "ERROR: lock_timeout exceeded", errorCode: "55P03", severity: "High", solution: "<p>Query was unable to acquire necessary locks within the timeout period.</p>", remediation: "- Increase lock_timeout setting if appropriate.\n- Identify and resolve long-running transactions causing locks.\n- Optimize transaction scope to reduce lock duration.\n- Consider using SELECT FOR UPDATE NOWAIT for non-blocking reads.", troubleshooting_code: "SELECT * FROM pg_locks WHERE NOT granted;", views: 0, helpful_yes: 0, helpful_no: 0, comments: [] },
                        { id: "perf_pg_107", title: "WARNING: high temp file usage", errorCode: "01000", severity: "Medium", solution: "<p>Query is using excessive temporary files, indicating insufficient memory allocation.</p>", remediation: "- Increase work_mem for complex queries.\n- Optimize queries to reduce temporary file usage.\n- Monitor temp_buffers setting for temporary tables.\n- Consider adding indexes to reduce sorting and hashing operations.", troubleshooting_code: "SELECT * FROM pg_stat_database WHERE temp_files > 0;", views: 0, helpful_yes: 0, helpful_no: 0, comments: [] },
                        { id: "perf_pg_108", title: "ERROR: maintenance_work_mem exceeded", errorCode: "53200", severity: "Medium", solution: "<p>Maintenance operations like CREATE INDEX or VACUUM require more memory than allocated.</p>", remediation: "- Increase maintenance_work_mem setting for maintenance operations.\n- Schedule maintenance operations during low-activity periods.\n- Break down large maintenance operations into smaller chunks.\n- Monitor system memory usage during maintenance.", troubleshooting_code: "SHOW maintenance_work_mem; SET maintenance_work_mem = '1GB';", views: 0, helpful_yes: 0, helpful_no: 0, comments: [] },
                        { id: "perf_pg_109", title: "WARNING: autovacuum blocked", errorCode: "01000", severity: "High", solution: "<p>Autovacuum processes are being blocked by long-running transactions.</p>", remediation: "- Identify and terminate long-running idle transactions.\n- Adjust autovacuum settings for more aggressive cleanup.\n- Schedule manual VACUUM operations during maintenance windows.\n- Monitor transaction age and implement transaction timeout policies.", troubleshooting_code: "SELECT * FROM pg_stat_activity WHERE state = 'idle in transaction';", views: 0, helpful_yes: 0, helpful_no: 0, comments: [] },
                        { id: "perf_pg_110", title: "ERROR: query planner timeout", errorCode: "57014", severity: "Medium", solution: "<p>Query planning took too long, possibly due to complex query structure.</p>", remediation: "- Simplify complex queries with multiple joins.\n- Use query hints or forced plans for complex queries.\n- Update table statistics with ANALYZE.\n- Consider breaking complex queries into simpler parts.", troubleshooting_code: "EXPLAIN SELECT * FROM complex_query;", views: 0, helpful_yes: 0, helpful_no: 0, comments: [] },
                        { id: "perf_pg_111", title: "WARNING: inefficient nested loop join", errorCode: "01000", severity: "Medium", solution: "<p>Query planner chose nested loop join which may be inefficient for large datasets.</p>", remediation: "- Create appropriate indexes on join columns.\n- Update table statistics with ANALYZE.\n- Consider hash or merge join alternatives.\n- Review join order and conditions for optimization.", troubleshooting_code: "EXPLAIN (ANALYZE, BUFFERS) SELECT * FROM table1 JOIN table2 ON condition;", views: 0, helpful_yes: 0, helpful_no: 0, comments: [] },
                        { id: "perf_pg_112", title: "ERROR: parallel query failed", errorCode: "XX000", severity: "Medium", solution: "<p>Parallel query execution failed, falling back to sequential execution.</p>", remediation: "- Check max_parallel_workers_per_gather setting.\n- Ensure sufficient memory for parallel operations.\n- Review query structure for parallel-safe operations.\n- Monitor system resources during parallel execution.", troubleshooting_code: "SHOW max_parallel_workers_per_gather; EXPLAIN (ANALYZE, BUFFERS) SELECT * FROM table;", views: 0, helpful_yes: 0, helpful_no: 0, comments: [] },
                        { id: "perf_pg_113", title: "WARNING: checkpoint too frequent", errorCode: "01000", severity: "Medium", solution: "<p>Database checkpoints are occurring too frequently, impacting performance.</p>", remediation: "- Increase checkpoint_completion_target setting.\n- Adjust wal_buffers and checkpoint_segments.\n- Monitor WAL generation rate and adjust accordingly.\n- Consider increasing checkpoint_timeout for less frequent checkpoints.", troubleshooting_code: "SELECT * FROM pg_stat_bgwriter;", views: 0, helpful_yes: 0, helpful_no: 0, comments: [] },
                        { id: "perf_pg_114", title: "ERROR: connection pool exhausted", errorCode: "53300", severity: "High", solution: "<p>All available database connections are in use, preventing new connections.</p>", remediation: "- Increase max_connections setting if system resources allow.\n- Implement connection pooling with PgBouncer or similar.\n- Optimize application connection usage patterns.\n- Monitor connection usage and implement connection timeouts.", troubleshooting_code: "SELECT * FROM pg_stat_activity; SHOW max_connections;", views: 0, helpful_yes: 0, helpful_no: 0, comments: [] },
                        { id: "perf_pg_115", title: "WARNING: table bloat detected", errorCode: "01000", severity: "Medium", solution: "<p>Table has significant bloat, wasting storage space and affecting performance.</p>", remediation: "- Run VACUUM FULL to reclaim space (requires table lock).\n- Implement regular VACUUM schedule to prevent bloat.\n- Consider using pg_repack for online table cleanup.\n- Monitor table size and dead tuple statistics.", troubleshooting_code: "SELECT schemaname, tablename, n_dead_tup FROM pg_stat_user_tables WHERE n_dead_tup > 1000;", views: 0, helpful_yes: 0, helpful_no: 0, comments: [] },
                        { id: "perf_pg_116", title: "ERROR: index bloat critical", errorCode: "53100", severity: "High", solution: "<p>Index has critical bloat levels affecting query performance significantly.</p>", remediation: "- REINDEX affected indexes to rebuild and reclaim space.\n- Schedule regular index maintenance operations.\n- Monitor index usage statistics and remove unused indexes.\n- Consider using pg_repack for online index rebuilding.", troubleshooting_code: "SELECT schemaname, indexname, idx_tup_read, idx_tup_fetch FROM pg_stat_user_indexes;", views: 0, helpful_yes: 0, helpful_no: 0, comments: [] },
                        { id: "perf_pg_117", title: "WARNING: slow query detected", errorCode: "01000", severity: "Medium", solution: "<p>Query execution time exceeds performance thresholds.</p>", remediation: "- Analyze query execution plan for bottlenecks.\n- Add appropriate indexes for query optimization.\n- Consider query rewriting for better performance.\n- Monitor query patterns and optimize frequently used queries.", troubleshooting_code: "SELECT query, mean_time, calls FROM pg_stat_statements ORDER BY mean_time DESC;", views: 0, helpful_yes: 0, helpful_no: 0, comments: [] },
                        { id: "perf_pg_118", title: "ERROR: memory allocation failed", errorCode: "53200", severity: "Critical", solution: "<p>Database server cannot allocate required memory for operation.</p>", remediation: "- Increase available system memory.\n- Adjust PostgreSQL memory settings (shared_buffers, work_mem).\n- Optimize queries to use less memory.\n- Monitor memory usage patterns and adjust allocation.", troubleshooting_code: "SELECT * FROM pg_settings WHERE name LIKE '%mem%';", views: 0, helpful_yes: 0, helpful_no: 0, comments: [] },
                        { id: "perf_pg_119", title: "WARNING: cache hit ratio low", errorCode: "01000", severity: "Medium", solution: "<p>Database buffer cache hit ratio is below optimal levels.</p>", remediation: "- Increase shared_buffers setting to improve cache hit ratio.\n- Monitor buffer cache statistics and adjust accordingly.\n- Optimize queries to improve data locality.\n- Consider adding more system memory for better caching.", troubleshooting_code: "SELECT * FROM pg_stat_database WHERE blks_hit::float / (blks_read + blks_hit) < 0.9;", views: 0, helpful_yes: 0, helpful_no: 0, comments: [] },
                        { id: "perf_pg_120", title: "ERROR: WAL write performance degraded", errorCode: "XX000", severity: "High", solution: "<p>Write-Ahead Log writing performance has degraded significantly.</p>", remediation: "- Check disk I/O performance for WAL location.\n- Consider moving WAL files to faster storage (SSD).\n- Adjust wal_buffers and wal_writer_delay settings.\n- Monitor WAL generation rate and optimize write patterns.", troubleshooting_code: "SELECT * FROM pg_stat_wal;", views: 0, helpful_yes: 0, helpful_no: 0, comments: [] }
                    ]
                },
                clustering: {
                    title: "Clustering & High Availability",
                    icon: "fa-solid fa-server",
                    intro: "Issues related to database clustering, failover, and high availability configurations.",
                    issues: [
                        { id: "cluster_pg_101", title: "ERROR: cluster node communication failed", errorCode: "08006", severity: "Critical", solution: "<p>Communication between cluster nodes has failed, affecting cluster operations.</p>", remediation: "- Check network connectivity between cluster nodes.\n- Verify cluster configuration settings.\n- Monitor node health and status.\n- Restart failed cluster services if necessary.", troubleshooting_code: "SELECT * FROM pg_stat_replication; SELECT pg_is_in_recovery();", views: 0, helpful_yes: 0, helpful_no: 0, comments: [] },
                        { id: "cluster_pg_102", title: "ERROR: failover process failed", errorCode: "XX000", severity: "Critical", solution: "<p>Automatic failover to secondary node failed during primary node failure.</p>", remediation: "- Check failover configuration and scripts.\n- Verify secondary node readiness and synchronization.\n- Manual failover may be required.\n- Review cluster management software logs.", troubleshooting_code: "SELECT * FROM pg_stat_wal_receiver; SELECT pg_last_wal_receive_lsn();", views: 0, helpful_yes: 0, helpful_no: 0, comments: [] },
                        { id: "cluster_pg_103", title: "WARNING: split-brain condition detected", errorCode: "XX000", severity: "Critical", solution: "<p>Multiple nodes in the cluster believe they are the primary, creating a split-brain scenario.</p>", remediation: "- Immediately stop one of the conflicting primary nodes.\n- Verify cluster quorum and voting configuration.\n- Implement proper fencing mechanisms.\n- Review cluster communication and network stability.", troubleshooting_code: "SELECT pg_is_in_recovery(), pg_is_wal_replay_paused();", views: 0, helpful_yes: 0, helpful_no: 0, comments: [] },
                        { id: "cluster_pg_104", title: "ERROR: node synchronization lag too high", errorCode: "XX000", severity: "High", solution: "<p>Secondary nodes are falling too far behind the primary node.</p>", remediation: "- Check network bandwidth between nodes.\n- Increase WAL sender and receiver buffer sizes.\n- Monitor replication lag and adjust configuration.\n- Consider adding more secondary nodes to distribute load.", troubleshooting_code: "SELECT application_name, pg_wal_lsn_diff(pg_current_wal_lsn(), sent_lsn) AS lag FROM pg_stat_replication;", views: 0, helpful_yes: 0, helpful_no: 0, comments: [] },
                        { id: "cluster_pg_105", title: "ERROR: cluster quorum lost", errorCode: "XX000", severity: "Critical", solution: "<p>Cluster has lost quorum, preventing write operations and cluster decisions.</p>", remediation: "- Bring failed nodes back online to restore quorum.\n- Check network connectivity between cluster nodes.\n- Review cluster configuration for proper quorum settings.\n- Consider manual intervention to restore cluster state.", troubleshooting_code: "SELECT count(*) FROM pg_stat_replication; -- Check active replicas", views: 0, helpful_yes: 0, helpful_no: 0, comments: [] },
                        { id: "cluster_pg_106", title: "WARNING: load balancer health check failed", errorCode: "08001", severity: "High", solution: "<p>Load balancer health checks are failing for database nodes.</p>", remediation: "- Check database node health and connectivity.\n- Verify health check configuration and timeouts.\n- Review load balancer logs for specific failure reasons.\n- Adjust health check parameters if necessary.", troubleshooting_code: "SELECT * FROM pg_stat_activity WHERE application_name = 'health_check';", views: 0, helpful_yes: 0, helpful_no: 0, comments: [] },
                        { id: "cluster_pg_107", title: "ERROR: cluster configuration mismatch", errorCode: "XX000", severity: "High", solution: "<p>Cluster nodes have inconsistent configuration settings.</p>", remediation: "- Synchronize configuration files across all cluster nodes.\n- Restart cluster services after configuration updates.\n- Implement configuration management automation.\n- Verify postgresql.conf and recovery.conf settings.", troubleshooting_code: "SELECT name, setting FROM pg_settings WHERE name LIKE '%cluster%';", views: 0, helpful_yes: 0, helpful_no: 0, comments: [] },
                        { id: "cluster_pg_108", title: "ERROR: witness node disconnected", errorCode: "08006", severity: "High", solution: "<p>Witness node in the cluster has disconnected, affecting quorum decisions.</p>", remediation: "- Restore witness node connectivity.\n- Check witness node health and configuration.\n- Consider backup witness nodes for redundancy.\n- Review cluster architecture for single points of failure.", troubleshooting_code: "-- Check cluster status from cluster management tool", views: 0, helpful_yes: 0, helpful_no: 0, comments: [] },
                        { id: "cluster_pg_109", title: "WARNING: cluster performance degraded", errorCode: "01000", severity: "Medium", solution: "<p>Overall cluster performance has degraded due to node issues or load.</p>", remediation: "- Monitor individual node performance metrics.\n- Check for resource bottlenecks on cluster nodes.\n- Review load distribution across cluster nodes.\n- Consider adding more nodes or upgrading hardware.", troubleshooting_code: "SELECT * FROM pg_stat_database; SELECT * FROM pg_stat_replication;", views: 0, helpful_yes: 0, helpful_no: 0, comments: [] },
                        { id: "cluster_pg_110", title: "ERROR: cluster upgrade failed", errorCode: "XX000", severity: "Critical", solution: "<p>Cluster upgrade process failed, leaving cluster in inconsistent state.</p>", remediation: "- Stop upgrade process and assess current cluster state.\n- Rollback to previous version if necessary.\n- Review upgrade documentation and prerequisites.\n- Perform upgrade testing in staging environment first.", troubleshooting_code: "SELECT version(); -- Check PostgreSQL version on all nodes", views: 0, helpful_yes: 0, helpful_no: 0, comments: [] },
                        { id: "cluster_pg_111", title: "ERROR: connection pooling failure", errorCode: "08001", severity: "High", solution: "<p>Connection pooling between cluster nodes has failed.</p>", remediation: "- Restart connection pooling services (PgBouncer, etc.).\n- Check pool configuration and connection limits.\n- Monitor connection usage patterns across nodes.\n- Verify network connectivity for pooling connections.", troubleshooting_code: "SELECT * FROM pg_stat_activity WHERE application_name LIKE 'pgbouncer%';", views: 0, helpful_yes: 0, helpful_no: 0, comments: [] },
                        { id: "cluster_pg_112", title: "WARNING: cluster monitoring service down", errorCode: "XX000", severity: "Medium", solution: "<p>Cluster monitoring and alerting services are not functioning.</p>", remediation: "- Restart cluster monitoring services.\n- Check monitoring configuration and connectivity.\n- Verify alert notification systems are working.\n- Implement redundant monitoring for critical alerts.", troubleshooting_code: "-- Check monitoring service status and logs", views: 0, helpful_yes: 0, helpful_no: 0, comments: [] },
                        { id: "cluster_pg_113", title: "ERROR: cluster resource exhaustion", errorCode: "53000", severity: "Critical", solution: "<p>Cluster has exhausted available resources (CPU, memory, disk).</p>", remediation: "- Scale cluster resources horizontally or vertically.\n- Optimize resource usage across cluster nodes.\n- Implement resource monitoring and alerting.\n- Review application load patterns and optimize queries.", troubleshooting_code: "SELECT * FROM pg_stat_database; -- Monitor resource usage", views: 0, helpful_yes: 0, helpful_no: 0, comments: [] },
                        { id: "cluster_pg_114", title: "ERROR: cluster backup coordination failed", errorCode: "XX000", severity: "High", solution: "<p>Coordinated backup across cluster nodes has failed.</p>", remediation: "- Check backup coordination service status.\n- Verify backup storage accessibility from all nodes.\n- Review backup scheduling and configuration.\n- Implement individual node backups as fallback.", troubleshooting_code: "SELECT * FROM pg_stat_archiver; -- Check WAL archiving status", views: 0, helpful_yes: 0, helpful_no: 0, comments: [] },
                        { id: "cluster_pg_115", title: "WARNING: cluster network partition", errorCode: "08006", severity: "Critical", solution: "<p>Network partition has split the cluster into isolated groups.</p>", remediation: "- Restore network connectivity between cluster segments.\n- Implement network redundancy and failover.\n- Review cluster configuration for partition tolerance.\n- Consider manual intervention to resolve conflicts.", troubleshooting_code: "SELECT client_addr FROM pg_stat_replication; -- Check replication connections", views: 0, helpful_yes: 0, helpful_no: 0, comments: [] },
                        { id: "cluster_pg_116", title: "ERROR: cluster maintenance mode failed", errorCode: "XX000", severity: "High", solution: "<p>Failed to enter or exit cluster maintenance mode properly.</p>", remediation: "- Manually coordinate maintenance activities across nodes.\n- Check cluster management software configuration.\n- Verify maintenance scripts and procedures.\n- Document manual maintenance procedures as backup.", troubleshooting_code: "-- Check cluster status and maintenance flags", views: 0, helpful_yes: 0, helpful_no: 0, comments: [] },
                        { id: "cluster_pg_117", title: "ERROR: cluster data inconsistency", errorCode: "XX001", severity: "Critical", solution: "<p>Data inconsistency detected between cluster nodes.</p>", remediation: "- Stop write operations immediately.\n- Compare data checksums between nodes.\n- Identify and resolve the source of inconsistency.\n- Restore from consistent backup if necessary.", troubleshooting_code: "SELECT pg_current_wal_lsn(); -- Check WAL position on all nodes", views: 0, helpful_yes: 0, helpful_no: 0, comments: [] },
                        { id: "cluster_pg_118", title: "WARNING: cluster node removed automatically", errorCode: "XX000", severity: "High", solution: "<p>A cluster node was automatically removed due to health issues.</p>", remediation: "- Investigate the cause of node failure.\n- Repair and restore the failed node.\n- Verify cluster can operate with remaining nodes.\n- Add replacement node if necessary for redundancy.", troubleshooting_code: "-- Check cluster management logs for removal reason", views: 0, helpful_yes: 0, helpful_no: 0, comments: [] },
                        { id: "cluster_pg_119", title: "ERROR: cluster consensus algorithm failed", errorCode: "XX000", severity: "Critical", solution: "<p>Cluster consensus algorithm failed to reach agreement on cluster state.</p>", remediation: "- Check cluster communication and network stability.\n- Review consensus algorithm configuration.\n- Restart cluster services if safe to do so.\n- Consider manual intervention to restore cluster state.", troubleshooting_code: "-- Check cluster consensus status and logs", views: 0, helpful_yes: 0, helpful_no: 0, comments: [] },
                        { id: "cluster_pg_120", title: "ERROR: cluster storage synchronization failed", errorCode: "XX000", severity: "Critical", solution: "<p>Storage synchronization between cluster nodes has failed.</p>", remediation: "- Check storage system health and connectivity.\n- Verify shared storage configuration if applicable.\n- Monitor storage I/O performance and errors.\n- Implement storage redundancy and failover mechanisms.", troubleshooting_code: "SELECT * FROM pg_stat_database WHERE stats_reset IS NOT NULL;", views: 0, helpful_yes: 0, helpful_no: 0, comments: [] }
                    ]
                },
                extensions: {
                    title: "Extensions & Add-ons",
                    icon: "fa-solid fa-puzzle-piece",
                    intro: "Issues related to PostgreSQL extensions, plugins, and third-party add-ons.",
                    issues: [
                        { id: "ext_pg_101", title: "ERROR: extension does not exist", errorCode: "42704", severity: "Medium", solution: "<p>The specified extension is not installed or available in the database.</p>", remediation: "- Install the extension using CREATE EXTENSION command.\n- Check if extension is available in pg_available_extensions.\n- Install extension packages on the system if needed.\n- Verify extension dependencies are met.", troubleshooting_code: "SELECT * FROM pg_available_extensions WHERE name = 'extension_name';", views: 0, helpful_yes: 0, helpful_no: 0, comments: [] },
                        { id: "ext_pg_102", title: "ERROR: extension version conflict", errorCode: "55000", severity: "High", solution: "<p>Extension version conflicts with database or other extension requirements.</p>", remediation: "- Update extension to compatible version using ALTER EXTENSION.\n- Check extension dependencies and compatibility.\n- Review extension documentation for version requirements.\n- Consider downgrading if newer version causes issues.", troubleshooting_code: "SELECT extname, extversion FROM pg_extension WHERE extname = 'extension_name';", views: 0, helpful_yes: 0, helpful_no: 0, comments: [] },
                        { id: "ext_pg_103", title: "ERROR: cannot drop extension with dependent objects", errorCode: "2BP01", severity: "Medium", solution: "<p>Extension cannot be dropped because other objects depend on it.</p>", remediation: "- Drop dependent objects first before removing extension.\n- Use CASCADE option to drop extension and dependencies.\n- Review extension usage before removal.\n- Document dependencies for future reference.", troubleshooting_code: "SELECT * FROM pg_depend WHERE refobjid = (SELECT oid FROM pg_extension WHERE extname = 'extension_name');", views: 0, helpful_yes: 0, helpful_no: 0, comments: [] },
                        { id: "ext_pg_104", title: "ERROR: extension function not found", errorCode: "42883", severity: "Medium", solution: "<p>Function provided by extension is not found or not accessible.</p>", remediation: "- Verify extension is properly installed and loaded.\n- Check function signature and parameter types.\n- Review extension documentation for correct usage.\n- Ensure extension schema is in search_path.", troubleshooting_code: "SELECT proname, pronamespace FROM pg_proc WHERE pronamespace = (SELECT oid FROM pg_namespace WHERE nspname = 'extension_schema');", views: 0, helpful_yes: 0, helpful_no: 0, comments: [] },
                        { id: "ext_pg_105", title: "ERROR: extension shared library not found", errorCode: "58P01", severity: "High", solution: "<p>Shared library file for extension is missing or not accessible.</p>", remediation: "- Install extension binary packages on the system.\n- Check library file permissions and ownership.\n- Verify PostgreSQL can access library directory.\n- Reinstall extension if library files are corrupted.", troubleshooting_code: "SELECT * FROM pg_available_extensions WHERE name = 'extension_name';", views: 0, helpful_yes: 0, helpful_no: 0, comments: [] },
                        { id: "ext_pg_106", title: "ERROR: extension requires different PostgreSQL version", errorCode: "0A000", severity: "High", solution: "<p>Extension requires a different version of PostgreSQL than currently running.</p>", remediation: "- Upgrade or downgrade PostgreSQL to compatible version.\n- Find alternative extension version compatible with current PostgreSQL.\n- Check extension documentation for version requirements.\n- Consider using different extension with similar functionality.", troubleshooting_code: "SELECT version(); SELECT * FROM pg_available_extensions WHERE name = 'extension_name';", views: 0, helpful_yes: 0, helpful_no: 0, comments: [] },
                        { id: "ext_pg_107", title: "ERROR: extension control file missing", errorCode: "58P01", severity: "High", solution: "<p>Extension control file is missing or corrupted.</p>", remediation: "- Reinstall extension package to restore control file.\n- Check file system permissions on extension directory.\n- Verify PostgreSQL installation integrity.\n- Download extension from official source if needed.", troubleshooting_code: "SELECT * FROM pg_available_extensions WHERE name = 'extension_name';", views: 0, helpful_yes: 0, helpful_no: 0, comments: [] },
                        { id: "ext_pg_108", title: "ERROR: extension update script failed", errorCode: "XX000", severity: "High", solution: "<p>Extension update script encountered an error during execution.</p>", remediation: "- Review extension update logs for specific errors.\n- Check for data conflicts before updating extension.\n- Backup database before attempting extension updates.\n- Contact extension maintainer for update issues.", troubleshooting_code: "SELECT * FROM pg_extension WHERE extname = 'extension_name';", views: 0, helpful_yes: 0, helpful_no: 0, comments: [] },
                        { id: "ext_pg_109", title: "WARNING: extension deprecated", errorCode: "01000", severity: "Low", solution: "<p>Extension is deprecated and may be removed in future versions.</p>", remediation: "- Plan migration to alternative extension or built-in functionality.\n- Review extension documentation for migration path.\n- Test application with alternative solutions.\n- Update code to remove dependency on deprecated extension.", troubleshooting_code: "SELECT extname, extversion FROM pg_extension WHERE extname = 'deprecated_extension';", views: 0, helpful_yes: 0, helpful_no: 0, comments: [] },
                        { id: "ext_pg_110", title: "ERROR: extension configuration invalid", errorCode: "22023", severity: "Medium", solution: "<p>Extension configuration parameters are invalid or incompatible.</p>", remediation: "- Review extension configuration documentation.\n- Reset extension configuration to default values.\n- Validate configuration parameters before applying.\n- Check for parameter type and range requirements.", troubleshooting_code: "SELECT name, setting FROM pg_settings WHERE name LIKE '%extension_name%';", views: 0, helpful_yes: 0, helpful_no: 0, comments: [] },
                        { id: "ext_pg_111", title: "ERROR: extension schema conflicts", errorCode: "42P06", severity: "Medium", solution: "<p>Extension schema conflicts with existing database objects.</p>", remediation: "- Choose different schema name for extension installation.\n- Resolve naming conflicts with existing objects.\n- Use qualified names to avoid schema conflicts.\n- Review extension documentation for schema requirements.", troubleshooting_code: "SELECT nspname FROM pg_namespace WHERE nspname = 'extension_schema';", views: 0, helpful_yes: 0, helpful_no: 0, comments: [] },
                        { id: "ext_pg_112", title: "ERROR: extension license violation", errorCode: "XX000", severity: "High", solution: "<p>Extension usage violates license terms or restrictions.</p>", remediation: "- Review extension license terms and compliance.\n- Purchase appropriate license if required.\n- Remove extension if license cannot be obtained.\n- Find alternative extension with compatible license.", troubleshooting_code: "-- Check extension documentation for license information", views: 0, helpful_yes: 0, helpful_no: 0, comments: [] },
                        { id: "ext_pg_113", title: "ERROR: extension memory leak detected", errorCode: "53200", severity: "High", solution: "<p>Extension is causing memory leaks affecting database performance.</p>", remediation: "- Update extension to latest version with bug fixes.\n- Monitor memory usage after extension operations.\n- Restart PostgreSQL to reclaim leaked memory.\n- Contact extension developer about memory leak issues.", troubleshooting_code: "SELECT * FROM pg_stat_activity WHERE query LIKE '%extension_function%';", views: 0, helpful_yes: 0, helpful_no: 0, comments: [] },
                        { id: "ext_pg_114", title: "WARNING: extension security vulnerability", errorCode: "01000", severity: "Critical", solution: "<p>Extension has known security vulnerabilities that could compromise database security.</p>", remediation: "- Update extension to patched version immediately.\n- Review extension permissions and access controls.\n- Monitor database for suspicious activity.\n- Consider disabling extension until patch is available.", troubleshooting_code: "SELECT extname, extversion FROM pg_extension WHERE extname = 'vulnerable_extension';", views: 0, helpful_yes: 0, helpful_no: 0, comments: [] },
                        { id: "ext_pg_115", title: "ERROR: extension foreign data wrapper failed", errorCode: "HV000", severity: "High", solution: "<p>Foreign data wrapper provided by extension has failed.</p>", remediation: "- Check foreign server connectivity and configuration.\n- Verify foreign data wrapper installation and setup.\n- Review connection parameters and authentication.\n- Test foreign server access outside of PostgreSQL.", troubleshooting_code: "SELECT * FROM pg_foreign_server WHERE srvname = 'foreign_server_name';", views: 0, helpful_yes: 0, helpful_no: 0, comments: [] },
                        { id: "ext_pg_116", title: "ERROR: extension trigger function failed", errorCode: "P0001", severity: "High", solution: "<p>Trigger function provided by extension encountered an error.</p>", remediation: "- Review trigger function logic and error messages.\n- Check trigger configuration and event handling.\n- Verify data compatibility with trigger requirements.\n- Debug trigger function with test data.", troubleshooting_code: "SELECT tgname, proname FROM pg_trigger JOIN pg_proc ON pg_trigger.tgfoid = pg_proc.oid WHERE proname LIKE '%extension%';", views: 0, helpful_yes: 0, helpful_no: 0, comments: [] },
                        { id: "ext_pg_117", title: "WARNING: extension compatibility issue", errorCode: "01000", severity: "Medium", solution: "<p>Extension has compatibility issues with current database configuration.</p>", remediation: "- Check extension documentation for compatibility requirements.\n- Update database configuration to meet extension needs.\n- Consider alternative extension or workaround solutions.\n- Test extension functionality thoroughly in development.", troubleshooting_code: "SELECT extname, extversion FROM pg_extension; SELECT version();", views: 0, helpful_yes: 0, helpful_no: 0, comments: [] },
                        { id: "ext_pg_118", title: "ERROR: extension background worker failed", errorCode: "XX000", severity: "High", solution: "<p>Background worker process started by extension has failed.</p>", remediation: "- Check extension logs for worker failure details.\n- Restart extension or database to restore worker.\n- Review worker configuration and resource requirements.\n- Monitor system resources for worker processes.", troubleshooting_code: "SELECT * FROM pg_stat_activity WHERE application_name LIKE '%extension%';", views: 0, helpful_yes: 0, helpful_no: 0, comments: [] },
                        { id: "ext_pg_119", title: "ERROR: extension data corruption", errorCode: "XX001", severity: "Critical", solution: "<p>Extension has caused or detected data corruption in the database.</p>", remediation: "- Stop using extension immediately to prevent further corruption.\n- Restore database from clean backup before corruption.\n- Report corruption issue to extension developer.\n- Implement data integrity checks for extension operations.", troubleshooting_code: "SELECT * FROM pg_stat_database WHERE checksum_failures > 0;", views: 0, helpful_yes: 0, helpful_no: 0, comments: [] },
                        { id: "ext_pg_120", title: "WARNING: extension performance impact", errorCode: "01000", severity: "Medium", solution: "<p>Extension is causing significant performance degradation.</p>", remediation: "- Profile extension operations to identify bottlenecks.\n- Optimize extension configuration for better performance.\n- Consider alternative extensions with better performance.\n- Monitor query performance before and after extension usage.", troubleshooting_code: "SELECT query, mean_time FROM pg_stat_statements WHERE query LIKE '%extension_function%';", views: 0, helpful_yes: 0, helpful_no: 0, comments: [] }
                    ]
                },
                configuration: {
                    title: "Configuration & Settings",
                    icon: "fa-solid fa-cogs",
                    intro: "Issues related to PostgreSQL configuration, settings, and parameter management.",
                    issues: [
                        { id: "config_pg_101", title: "ERROR: invalid configuration parameter", errorCode: "42704", severity: "Medium", solution: "<p>Configuration parameter name is invalid or not recognized by PostgreSQL.</p>", remediation: "- Check parameter name spelling and availability.\n- Review PostgreSQL documentation for valid parameters.\n- Verify parameter is supported in current PostgreSQL version.\n- Remove invalid parameters from configuration files.", troubleshooting_code: "SELECT name FROM pg_settings WHERE name LIKE '%parameter_name%';", views: 0, helpful_yes: 0, helpful_no: 0, comments: [] },
                        { id: "config_pg_102", title: "ERROR: configuration parameter value out of range", errorCode: "22023", severity: "Medium", solution: "<p>Configuration parameter value exceeds allowed minimum or maximum limits.</p>", remediation: "- Check parameter documentation for valid value ranges.\n- Adjust parameter value to fall within acceptable limits.\n- Consider system resource constraints when setting values.\n- Use default values if unsure about appropriate settings.", troubleshooting_code: "SELECT name, setting, unit, min_val, max_val FROM pg_settings WHERE name = 'parameter_name';", views: 0, helpful_yes: 0, helpful_no: 0, comments: [] },
                        { id: "config_pg_103", title: "ERROR: configuration file syntax error", errorCode: "42601", severity: "High", solution: "<p>PostgreSQL configuration file contains syntax errors preventing server startup.</p>", remediation: "- Review configuration file for syntax errors and typos.\n- Check for proper parameter format and quoting.\n- Validate configuration changes before applying.\n- Restore from backup configuration if severely corrupted.", troubleshooting_code: "-- Check PostgreSQL logs for specific syntax error details", views: 0, helpful_yes: 0, helpful_no: 0, comments: [] },
                        { id: "config_pg_104", title: "WARNING: configuration requires restart", errorCode: "01000", severity: "Low", solution: "<p>Configuration parameter changes require a server restart to take effect.</p>", remediation: "- Plan maintenance window for server restart.\n- Document configuration changes for tracking.\n- Test configuration changes in development first.\n- Consider using reload-able parameters when possible.", troubleshooting_code: "SELECT name, context FROM pg_settings WHERE name = 'parameter_name';", views: 0, helpful_yes: 0, helpful_no: 0, comments: [] },
                        { id: "config_pg_105", title: "ERROR: memory configuration insufficient", errorCode: "53200", severity: "High", solution: "<p>Memory-related configuration parameters are insufficient for database operations.</p>", remediation: "- Increase shared_buffers, work_mem, or maintenance_work_mem.\n- Monitor memory usage and adjust parameters accordingly.\n- Consider adding more system memory if needed.\n- Optimize queries to reduce memory requirements.", troubleshooting_code: "SELECT name, setting, unit FROM pg_settings WHERE name IN ('shared_buffers', 'work_mem', 'maintenance_work_mem');", views: 0, helpful_yes: 0, helpful_no: 0, comments: [] },
                        { id: "config_pg_106", title: "ERROR: connection configuration invalid", errorCode: "08001", severity: "High", solution: "<p>Connection-related configuration parameters are invalid or conflicting.</p>", remediation: "- Review max_connections, port, and listen_addresses settings.\n- Check pg_hba.conf for authentication configuration.\n- Verify network configuration and firewall settings.\n- Test connection configuration with simple connections.", troubleshooting_code: "SELECT name, setting FROM pg_settings WHERE name IN ('max_connections', 'port', 'listen_addresses');", views: 0, helpful_yes: 0, helpful_no: 0, comments: [] },
                        { id: "config_pg_107", title: "WARNING: logging configuration suboptimal", errorCode: "01000", severity: "Low", solution: "<p>Logging configuration may not capture all necessary information for troubleshooting.</p>", remediation: "- Enable log_statement for query logging if needed.\n- Configure log_min_duration_statement for slow query logging.\n- Set appropriate log levels for different components.\n- Ensure log rotation is configured to prevent disk issues.", troubleshooting_code: "SELECT name, setting FROM pg_settings WHERE name LIKE 'log_%';", views: 0, helpful_yes: 0, helpful_no: 0, comments: [] },
                        { id: "config_pg_108", title: "ERROR: WAL configuration invalid", errorCode: "XX000", severity: "High", solution: "<p>Write-Ahead Log configuration parameters are invalid or conflicting.</p>", remediation: "- Review wal_level, max_wal_senders, and checkpoint settings.\n- Ensure WAL configuration supports replication if needed.\n- Check WAL disk space and archive configuration.\n- Validate WAL settings for backup and recovery requirements.", troubleshooting_code: "SELECT name, setting FROM pg_settings WHERE name LIKE 'wal_%' OR name LIKE 'checkpoint_%';", views: 0, helpful_yes: 0, helpful_no: 0, comments: [] },
                        { id: "config_pg_109", title: "ERROR: autovacuum configuration disabled", errorCode: "01000", severity: "Medium", solution: "<p>Autovacuum is disabled, which may lead to table bloat and performance issues.</p>", remediation: "- Enable autovacuum to maintain table and index health.\n- Configure autovacuum parameters for workload requirements.\n- Monitor table statistics and dead tuple counts.\n- Schedule manual VACUUM if autovacuum remains disabled.", troubleshooting_code: "SELECT name, setting FROM pg_settings WHERE name LIKE 'autovacuum%';", views: 0, helpful_yes: 0, helpful_no: 0, comments: [] },
                        { id: "config_pg_110", title: "ERROR: SSL configuration invalid", errorCode: "08004", severity: "High", solution: "<p>SSL/TLS configuration is invalid or incomplete.</p>", remediation: "- Check SSL certificate and key file paths and permissions.\n- Verify SSL certificate validity and trust chain.\n- Configure ssl parameters in postgresql.conf correctly.\n- Test SSL connections after configuration changes.", troubleshooting_code: "SELECT name, setting FROM pg_settings WHERE name LIKE 'ssl%';", views: 0, helpful_yes: 0, helpful_no: 0, comments: [] },
                        { id: "config_pg_111", title: "WARNING: timezone configuration inconsistent", errorCode: "01000", severity: "Low", solution: "<p>Timezone configuration is inconsistent between system and database.</p>", remediation: "- Synchronize timezone settings between system and PostgreSQL.\n- Set timezone parameter explicitly in postgresql.conf.\n- Verify application timezone handling consistency.\n- Document timezone decisions for multi-region deployments.", troubleshooting_code: "SHOW timezone; SELECT current_setting('log_timezone');", views: 0, helpful_yes: 0, helpful_no: 0, comments: [] },
                        { id: "config_pg_112", title: "ERROR: locale configuration invalid", errorCode: "22023", severity: "High", solution: "<p>Locale configuration is invalid or not supported by the system.</p>", remediation: "- Install required locale packages on the system.\n- Verify locale name format and availability.\n- Recreate database with correct locale if necessary.\n- Check system locale configuration and support.", troubleshooting_code: "SELECT name, setting FROM pg_settings WHERE name LIKE '%locale%'; SHOW lc_collate;", views: 0, helpful_yes: 0, helpful_no: 0, comments: [] },
                        { id: "config_pg_113", title: "ERROR: extension configuration conflict", errorCode: "55000", severity: "Medium", solution: "<p>Extension configuration conflicts with database or other extension settings.</p>", remediation: "- Review extension configuration documentation.\n- Resolve parameter conflicts between extensions.\n- Adjust load order of extensions if necessary.\n- Consider alternative extensions if conflicts persist.", troubleshooting_code: "SELECT extname, extconfig FROM pg_extension WHERE extconfig IS NOT NULL;", views: 0, helpful_yes: 0, helpful_no: 0, comments: [] },
                        { id: "config_pg_114", title: "WARNING: backup configuration incomplete", errorCode: "01000", severity: "High", solution: "<p>Backup-related configuration is incomplete or insufficient for recovery needs.</p>", remediation: "- Configure WAL archiving for point-in-time recovery.\n- Set up automated backup procedures and monitoring.\n- Test backup and recovery procedures regularly.\n- Document backup retention and recovery policies.", troubleshooting_code: "SELECT name, setting FROM pg_settings WHERE name LIKE 'archive_%';", views: 0, helpful_yes: 0, helpful_no: 0, comments: [] },
                        { id: "config_pg_115", title: "ERROR: parallel configuration invalid", errorCode: "22023", severity: "Medium", solution: "<p>Parallel query configuration parameters are invalid or conflicting.</p>", remediation: "- Review parallel worker settings and resource limits.\n- Adjust parallel configuration based on system capabilities.\n- Test parallel query performance with different settings.\n- Monitor parallel worker usage and adjust accordingly.", troubleshooting_code: "SELECT name, setting FROM pg_settings WHERE name LIKE '%parallel%';", views: 0, helpful_yes: 0, helpful_no: 0, comments: [] },
                        { id: "config_pg_116", title: "ERROR: replication configuration mismatch", errorCode: "XX000", severity: "High", solution: "<p>Replication configuration is inconsistent between primary and standby servers.</p>", remediation: "- Synchronize replication configuration across all servers.\n- Verify primary_conninfo and recovery parameters.\n- Check replication user permissions and authentication.\n- Test replication connectivity and functionality.", troubleshooting_code: "SELECT name, setting FROM pg_settings WHERE name LIKE '%replication%';", views: 0, helpful_yes: 0, helpful_no: 0, comments: [] },
                        { id: "config_pg_117", title: "WARNING: monitoring configuration insufficient", errorCode: "01000", severity: "Medium", solution: "<p>Monitoring and statistics configuration may not provide sufficient observability.</p>", remediation: "- Enable track_activities and track_counts for monitoring.\n- Configure pg_stat_statements for query analysis.\n- Set up monitoring for key performance metrics.\n- Enable logging for important database events.", troubleshooting_code: "SELECT name, setting FROM pg_settings WHERE name LIKE 'track_%' OR name LIKE 'stats_%';", views: 0, helpful_yes: 0, helpful_no: 0, comments: [] },
                        { id: "config_pg_118", title: "ERROR: security configuration weak", errorCode: "28000", severity: "High", solution: "<p>Security-related configuration settings are weak or insufficient.</p>", remediation: "- Strengthen authentication methods in pg_hba.conf.\n- Enable SSL/TLS for encrypted connections.\n- Configure proper user privileges and role management.\n- Implement network security and access controls.", troubleshooting_code: "SELECT * FROM pg_hba_file_rules; SELECT name, setting FROM pg_settings WHERE name LIKE 'ssl%';", views: 0, helpful_yes: 0, helpful_no: 0, comments: [] },
                        { id: "config_pg_119", title: "ERROR: storage configuration insufficient", errorCode: "53100", severity: "High", solution: "<p>Storage-related configuration is insufficient for database requirements.</p>", remediation: "- Configure appropriate tablespace locations and permissions.\n- Set up WAL and data directory on appropriate storage.\n- Monitor disk space usage and configure alerts.\n- Implement storage backup and redundancy strategies.", troubleshooting_code: "SELECT name, setting FROM pg_settings WHERE name LIKE '%directory%' OR name = 'data_directory';", views: 0, helpful_yes: 0, helpful_no: 0, comments: [] },
                        { id: "config_pg_120", title: "WARNING: configuration not optimized for workload", errorCode: "01000", severity: "Medium", solution: "<p>Database configuration is not optimized for the current workload characteristics.</p>", remediation: "- Analyze workload patterns and adjust configuration accordingly.\n- Use tools like pgtune for configuration recommendations.\n- Monitor performance metrics and tune parameters iteratively.\n- Document configuration changes and their performance impact.", troubleshooting_code: "SELECT * FROM pg_stat_database; SELECT * FROM pg_stat_statements ORDER BY total_time DESC;", views: 0, helpful_yes: 0, helpful_no: 0, comments: [] }
                    ]
                },
                "jit_compilation": {
                    "title": "JIT Compilation",
                    "icon": "fa-solid fa-bolt",
                    "intro": "Issues related to Just-In-Time (JIT) compilation in PostgreSQL.",
                    "issues": [
                        { "id": "jit_101", "title": "WARNING: JIT compilation failed", "errorCode": "XX000", "severity": "Medium", "solution": "<p>JIT compilation failed for a query, falling back to regular execution.</p>", "remediation": "- Check LLVM and compiler dependencies are correctly installed.\n- Ensure <code>jit</code> is enabled in <code>postgresql.conf</code>.\n- Review server logs for detailed error messages.", "troubleshooting_code": "SHOW jit; SELECT * FROM pg_available_extensions WHERE name = 'jit';", "views": 0, "helpful_yes": 0, "helpful_no": 0, "comments": [] },
                        { "id": "jit_102", "title": "ERROR: could not load JIT provider", "errorCode": "58P01", "severity": "High", "solution": "<p>The JIT provider library (e.g., LLVM) could not be loaded by the server.</p>", "remediation": "- Verify the LLVM library path is correct and accessible.\n- Check for architecture mismatches (32-bit vs 64-bit).\n- Ensure the PostgreSQL server was compiled with JIT support.", "troubleshooting_code": "SELECT pg_config.setting FROM pg_config WHERE pg_config.name = 'CONFIGURE';", "views": 0, "helpful_yes": 0, "helpful_no": 0, "comments": [] },
                        { "id": "jit_103", "title": "Performance degradation with JIT enabled", "errorCode": "N/A", "severity": "Medium", "solution": "<p>Enabling JIT has resulted in slower query performance instead of improvement.</p>", "remediation": "- JIT is beneficial for long, complex, analytical queries, not short, simple ones.\n- Adjust JIT cost parameters (<code>jit_above_cost</code>, <code>jit_inline_above_cost</code>) to target appropriate queries.\n- Disable JIT for specific sessions or queries using <code>SET jit = off;</code>.", "troubleshooting_code": "EXPLAIN (ANALYZE, BUFFERS) your_query;", "views": 0, "helpful_yes": 0, "helpful_no": 0, "comments": [] },
                        { "id": "jit_104", "title": "High CPU usage during JIT compilation", "errorCode": "N/A", "severity": "Low", "solution": "<p>The JIT compilation process itself is consuming significant CPU resources.</p>", "remediation": "- This is expected, as compilation is CPU-intensive.\n- The cost should be amortized over many executions of a prepared statement.\n- Tune JIT cost parameters to avoid compiling trivial queries.", "troubleshooting_code": "SHOW jit_above_cost;", "views": 0, "helpful_yes": 0, "helpful_no": 0, "comments": [] },
                        { "id": "jit_105", "title": "WARNING: JIT optimization passes are too expensive", "errorCode": "01000", "severity": "Low", "solution": "<p>The optimization passes during JIT compilation are taking too long.</p>", "remediation": "- Adjust JIT optimization level parameters (<code>jit_optimize_above_cost</code>).\n- A lower optimization level will compile faster but may produce slightly slower code.", "troubleshooting_code": "SHOW jit_optimize_above_cost;", "views": 0, "helpful_yes": 0, "helpful_no": 0, "comments": [] }
                    ]
                },
                "logical_replication": {
                    "title": "Logical Replication",
                    "icon": "fa-solid fa-clone",
                    "intro": "Issues related to setting up and managing logical replication, publications, and subscriptions.",
                    "issues": [
                        { "id": "logical_rep_101", "title": "ERROR: could not create replication slot", "errorCode": "55000", "severity": "High", "solution": "<p>The server failed to create a new logical replication slot.</p>", "remediation": "- Ensure <code>max_replication_slots</code> in <code>postgresql.conf</code> is set high enough.\n- Check for sufficient disk space in the <code>pg_wal</code> directory.\n- Verify the user has replication privileges.", "troubleshooting_code": "SHOW max_replication_slots; SELECT * FROM pg_replication_slots;", "views": 0, "helpful_yes": 0, "helpful_no": 0, "comments": [] },
                        { "id": "logical_rep_102", "title": "WARNING: logical replication slot is lagging significantly", "errorCode": "N/A", "severity": "High", "solution": "<p>The subscriber is not consuming changes fast enough, causing WAL to accumulate on the publisher.</p>", "remediation": "- Check the subscriber's health and network connectivity.\n- Ensure the subscriber has enough resources to apply changes.\n- Investigate long-running transactions or conflicts on the subscriber.", "troubleshooting_code": "SELECT slot_name, pg_wal_lsn_diff(pg_current_wal_lsn(), confirmed_flush_lsn) AS lag_bytes FROM pg_replication_slots;", "views": 0, "helpful_yes": 0, "helpful_no": 0, "comments": [] },
                        { "id": "logical_rep_103", "title": "ERROR: conflicting key value violates exclusion constraint", "errorCode": "23P01", "severity": "Medium", "solution": "<p>A replicated change conflicts with an existing row on the subscriber, often due to out-of-band writes.</p>", "remediation": "- Identify and resolve the conflicting row on the subscriber.\n- Avoid writing to replicated tables on the subscriber side.\n- Consider using <code>ALTER SUBSCRIPTION ... SKIP</code> for specific transactions (with caution).", "troubleshooting_code": "-- Check subscriber logs for details on the conflicting key.", "views": 0, "helpful_yes": 0, "helpful_no": 0, "comments": [] },
                        { "id": "logical_rep_104", "title": "ERROR: publication does not exist", "errorCode": "42704", "severity": "Medium", "solution": "<p>The subscription is configured to connect to a publication that does not exist on the publisher.</p>", "remediation": "- Verify the publication name is correct in the <code>CREATE SUBSCRIPTION</code> command.\n- Ensure the publication has been created on the publisher using <code>CREATE PUBLICATION</code>.", "troubleshooting_code": "SELECT * FROM pg_publication;", "views": 0, "helpful_yes": 0, "helpful_no": 0, "comments": [] },
                        { "id": "logical_rep_105", "title": "ERROR: table is not in publication", "errorCode": "42P17", "severity": "Medium", "solution": "<p>An attempt was made to replicate a table that is not part of the specified publication.</p>", "remediation": "- Add the table to the publication using <code>ALTER PUBLICATION ... ADD TABLE</code>.\n- Use <code>CREATE PUBLICATION ... FOR ALL TABLES</code> if appropriate for your use case.", "troubleshooting_code": "SELECT * FROM pg_publication_tables WHERE pubname = 'your_publication';", "views": 0, "helpful_yes": 0, "helpful_no": 0, "comments": [] },
                        { "id": "logical_rep_106", "title": "Initial data copy for subscription is very slow", "errorCode": "N/A", "severity": "Low", "solution": "<p>The initial synchronization of data when creating a subscription is taking a long time.</p>", "remediation": "- Ensure the network between publisher and subscriber is fast and stable.\n- Consider creating the subscription with <code>copy_data = false</code> and performing a manual data copy (e.g., <code>pg_dump</code>) beforehand.", "troubleshooting_code": "-- Monitor network and disk I/O on both servers during the copy.", "views": 0, "helpful_yes": 0, "helpful_no": 0, "comments": [] },
                        { "id": "logical_rep_107", "title": "ERROR: logical replication requires wal_level >= logical", "errorCode": "55000", "severity": "Critical", "solution": "<p>The <code>wal_level</code> parameter on the publisher is not set to <code>logical</code>, which is required for logical replication.</p>", "remediation": "- Set <code>wal_level = logical</code> in <code>postgresql.conf</code> on the publisher.\n- A server restart is required for this change to take effect.", "troubleshooting_code": "SHOW wal_level;", "views": 0, "helpful_yes": 0, "helpful_no": 0, "comments": [] },
                        { "id": "logical_rep_108", "title": "Replication of large transactions causes high latency", "errorCode": "N/A", "severity": "Medium", "solution": "<p>A single large transaction on the publisher takes a long time to be fully sent and applied to the subscriber.</p>", "remediation": "- Break down large transactions into smaller, more frequent ones on the application side.\n- Increase <code>logical_decoding_work_mem</code> to handle larger changesets in memory.", "troubleshooting_code": "SHOW logical_decoding_work_mem;", "views": 0, "helpful_yes": 0, "helpful_no": 0, "comments": [] },
                        { "id": "logical_rep_109", "title": "DDL changes are not automatically replicated", "errorCode": "N/A", "severity": "Medium", "solution": "<p>Logical replication in PostgreSQL does not automatically replicate DDL changes (e.g., <code>ALTER TABLE</code>).</p>", "remediation": "- Apply DDL changes manually on both the publisher and subscriber.\n- Use a schema migration tool to manage and apply DDL changes consistently across all nodes.", "troubleshooting_code": "-- DDL must be applied manually. No specific troubleshooting code.", "views": 0, "helpful_yes": 0, "helpful_no": 0, "comments": [] },
                        { "id": "logical_rep_110", "title": "ERROR: table lacks a REPLICA IDENTITY", "errorCode": "42P17", "solution": "<p>The table on the publisher lacks a REPLICA IDENTITY, which is required for UPDATE and DELETE operations to be replicated.</p>", "remediation": "- Set a replica identity for the table using <code>ALTER TABLE your_table REPLICA IDENTITY FULL;</code> or by using a primary key.", "troubleshooting_code": "SELECT relreplident FROM pg_class WHERE relname = 'your_table';", "severity": "High", "views": 0, "helpful_yes": 0, "helpful_no": 0, "comments": [] }
                    ]
                }
            };

            // Make knowledgeBaseData globally accessible
            window.knowledgeBaseData = knowledgeBaseData;

            // --- LOCAL STORAGE & DATA MANAGEMENT ---
            const USER_DATA_KEY = 'pgKbUserData';
            let userGeneratedData = {};

            function findIssueById(issueId) {
                for (const category of Object.values(knowledgeBaseData)) {
                    if (category.issues) {
                        const issue = category.issues.find(i => i.id === issueId);
                        if (issue) return issue;
                    }
                }
                return null;
            }

            function loadUserData() {
                try {
                    const storedData = localStorage.getItem(USER_DATA_KEY);
                    if (storedData) {
                        const parsedData = JSON.parse(storedData);
                        if (parsedData && typeof parsedData === 'object') {
                            userGeneratedData = parsedData;
                        // Merge the loaded data into the main knowledge base object
                        Object.values(knowledgeBaseData).forEach(category => {
                            if (category.issues) {
                                category.issues.forEach(issue => {
                                    const savedIssueData = userGeneratedData[issue.id];
                                        if (savedIssueData && typeof savedIssueData === 'object') {
                                            issue.views = parseInt(savedIssueData.views) || 0;
                                            issue.helpful_yes = parseInt(savedIssueData.helpful_yes) || 0;
                                            issue.helpful_no = parseInt(savedIssueData.helpful_no) || 0;
                                            issue.comments = Array.isArray(savedIssueData.comments) ? savedIssueData.comments : [];
                                    }
                                });
                            }
                        });
                        }
                    }
                } catch (error) {
                    console.error("Failed to load or parse user data from localStorage:", error);
                    userGeneratedData = {};
                }
            }

            function saveUserData() {
                try {
                    localStorage.setItem(USER_DATA_KEY, JSON.stringify(userGeneratedData));
                } catch (error) {
                    console.error("Failed to save user data to localStorage:", error);
                }
            }
            
            function updateUserData(issueId, type, data = null) {
                if (!issueId || typeof issueId !== 'string') {
                    console.error('Invalid issueId provided to updateUserData:', issueId);
                    return;
                }
                
                if (!userGeneratedData[issueId]) {
                    userGeneratedData[issueId] = { views: 0, helpful_yes: 0, helpful_no: 0, comments: [] };
                }
                const issueData = userGeneratedData[issueId];
                const issueInMemory = findIssueById(issueId);

                switch(type) {
                    case 'view':
                        issueData.views = (parseInt(issueData.views) || 0) + 1;
                        if (issueInMemory) issueInMemory.views = issueData.views;
                        break;
                    case 'feedback_yes':
                        issueData.helpful_yes = (parseInt(issueData.helpful_yes) || 0) + 1;
                        if (issueInMemory) issueInMemory.helpful_yes = issueData.helpful_yes;
                        break;
                    case 'feedback_no':
                        issueData.helpful_no = (parseInt(issueData.helpful_no) || 0) + 1;
                        if (issueInMemory) issueInMemory.helpful_no = issueData.helpful_no;
                        break;
                    case 'comment':
                        if (data && typeof data === 'object' && data.name && data.text) {
                            const newComment = { 
                                name: String(data.name).trim(), 
                                text: String(data.text).trim(), 
                                date: new Date().toLocaleString() 
                            };
                            if (!Array.isArray(issueData.comments)) {
                                issueData.comments = [];
                            }
                        issueData.comments.push(newComment);
                            if (issueInMemory) {
                                if (!Array.isArray(issueInMemory.comments)) {
                                    issueInMemory.comments = [];
                                }
                                issueInMemory.comments.push(newComment);
                            }
                        }
                        break;
                    default:
                        console.warn('Unknown updateUserData type:', type);
                        return;
                }
                saveUserData();
            }

            // --- MAIN APP LOGIC ---
            function startApp() {
                // Remove the loading indicator
                const loadingEl = document.getElementById('app-loading');
                if (loadingEl) {
                    loadingEl.remove();
                }

                // SCRIPT TO ADD MORE ERRORS
                function generateNewErrors(categoryKey, count) {
                    const existingIssues = knowledgeBaseData[categoryKey].issues;
                    if (!existingIssues) return;
                    const existingCount = existingIssues.length;
                    for (let i = 1; i <= count; i++) {
                        existingIssues.push({
                            id: `${categoryKey}_new_${existingCount + i}`,
                            title: `New ${categoryKey.replace(/_/g, ' ')} Error #${i}`,
                            errorCode: `ERR-${categoryKey.toUpperCase()}-${i}`,
                            severity: i % 4 === 0 ? 'Critical' : (i % 3 === 0 ? 'Low' : (i % 2 === 0 ? 'Medium' : 'High')),
                            solution: `<p>This is a placeholder solution for the newly generated error #${i} in the ${categoryKey} category. Detailed analysis of logs and system state is required.</p>`,
                            remediation: `1. Review server logs for related entries around the time of the error.\n2. Check application code for logic that might trigger this condition.\n3. Verify configuration settings related to ${categoryKey.replace(/_/g, ' ')}.`,
                            troubleshooting_code: `SELECT 'Placeholder diagnostic query for ${categoryKey} error ${i}';`,
                            views: 0, helpful_yes: 0, helpful_no: 0, comments: []
                        });
                    }
                }

                Object.keys(knowledgeBaseData).forEach(key => {
                    if (knowledgeBaseData[key].issues) {
                        generateNewErrors(key, 250);
                    }
                });
                
                // Load and merge data from localStorage after generating placeholders
                loadUserData();

                // DOM ELEMENT REFERENCES
                const contentArea = document.getElementById('content-area');
                const searchInput = document.getElementById('search-input');
                const severityFilter = document.getElementById('severityFilter');
                const breadcrumb = document.getElementById('breadcrumb');
                const filterContainer = document.getElementById('filter-container');
                const sidebar = document.getElementById('sidebar');
                const menuToggle = document.getElementById('menu-toggle');
                const nav = document.getElementById('main-nav');
                const themeToggleBtn = document.getElementById('theme-toggle');
                const themeToggleDarkIcon = document.getElementById('theme-toggle-dark-icon');
                const themeToggleLightIcon = document.getElementById('theme-toggle-light-icon');
                
                const chatToggleButton = document.getElementById('chat-toggle-button');
                const chatQuickReplies = document.getElementById('chat-quick-replies');

                const reportIssueModal = document.getElementById('report-issue-modal');
                const reportIssueBtn = document.getElementById('report-issue-btn');
                const closeModalBtn = document.getElementById('close-modal-btn');
                const closeSuccessModalBtn = document.getElementById('close-success-modal-btn');
                const issueReportForm = document.getElementById('issue-report-form');
                const reportFormContent = document.getElementById('report-form-content');
                const reportSuccessMessage = document.getElementById('report-success-message');
                const backToTopBtn = document.getElementById('back-to-top-btn');
                const commandPaletteModal = document.getElementById('command-palette-modal');
                const openCommandPaletteBtn = document.getElementById('open-command-palette');
                const commandPaletteInput = document.getElementById('command-palette-input');
                const commandPaletteResults = document.getElementById('command-palette-results');


                // STATE AND CONFIGURATION
                let currentCategoryKey = 'dashboard';
                let chartInstance = null;
                const severityConfig = {
                    'Critical': { color: 'text-red-700', icon: 'fa-solid fa-skull-crossbones' },
                    'High': { color: 'text-red-500', icon: 'fa-solid fa-triangle-exclamation' },
                    'Medium': { color: 'text-orange-500', icon: 'fa-solid fa-circle-exclamation' },
                    'Low': { color: 'text-yellow-500', icon: 'fa-solid fa-info-circle' }
                };
                let fuse;
                let globalFuse;
                let searchDebounceTimer;

                function renderPage(key) {
                    try {
                        currentCategoryKey = key;
                        const category = knowledgeBaseData[key];
                        if (!category) {
                            console.error(`Category not found: ${key}`);
                            return;
                        }

                        document.querySelectorAll('.sidebar-item').forEach(el => el.classList.remove('active'));
                        const activeLink = document.querySelector(`a[data-key="${key}"]`);
                        if (activeLink) activeLink.classList.add('active');

                        updateBreadcrumb(key);

                        // Clear search when switching categories
                        if (searchInput) {
                            searchInput.value = '';
                        }

                        if (key === 'dashboard') {
                            renderDashboard();
                        } else if (category.issues) {
                            renderIssuePage(key);
                        } else {
                            renderArticlePage(key);
                        }
                        
                        // Scroll to top after navigation
                        if (contentArea) {
                            contentArea.scrollTop = 0;
                        }
                    } catch (error) {
                        console.error('Error rendering page:', error);
                    }
                }

                // Make renderPage globally accessible
                window.renderPage = renderPage;

                function renderArticlePage(key) {
                    const category = knowledgeBaseData[key];
                    filterContainer.classList.add('hidden');
                    
                    if (key === 'glossary') {
                        // Special rendering for the detailed glossary
                        contentArea.innerHTML = `<div class="bg-white dark:bg-base-800 rounded-lg shadow-sm p-6">
                            <h2 class="text-2xl font-bold text-base-900 dark:text-white mb-2">${category.title}</h2>
                            <p class="text-base-600 dark:text-base-300 mb-8">${category.intro}</p>
                            <div class="space-y-8">
                                ${category.terms.map(renderGlossaryTerm).join('')}
                            </div>
                        </div>`;
                    } else if (key === 'system_catalogs') {
                        contentArea.innerHTML = `<div class="bg-white dark:bg-base-800 rounded-lg shadow-sm p-6">
                            <h2 class="text-2xl font-bold text-base-900 dark:text-white mb-2">${category.title}</h2>
                            <p class="text-base-600 dark:text-base-300 mb-8">${category.intro}</p>
                            <div class="space-y-8">
                                ${category.categories.map(renderSystemCatalogCategory).join('')}
                            </div>
                        </div>`;
                    } else if (key === 'error_guide') {
                        contentArea.innerHTML = `<div class="bg-white dark:bg-base-800 rounded-lg shadow-sm p-6">
                            <h2 class="text-2xl font-bold text-base-900 dark:text-white mb-2">${category.title}</h2>
                            <p class="text-base-600 dark:text-base-300 mb-8">${category.intro}</p>
                            <div class="space-y-8">
                                ${category.categories.map(renderErrorCategory).join('')}
                            </div>
                        </div>`;
                    } else if (key === 'extensions_guide') {
                        contentArea.innerHTML = `<div class="bg-white dark:bg-base-800 rounded-lg shadow-sm p-6">
                            <h2 class="text-2xl font-bold text-base-900 dark:text-white mb-2">${category.title}</h2>
                            <p class="text-base-600 dark:text-base-300 mb-8">${category.intro}</p>
                            <div class="space-y-8">
                                ${category.categories.map(renderExtensionCategory).join('')}
                            </div>
                        </div>`;
                    } else if (key === 'dba_cheatsheet') {
                        contentArea.innerHTML = `<div class="bg-white dark:bg-base-800 rounded-lg shadow-sm p-6">
                            <h2 class="text-2xl font-bold text-base-900 dark:text-white mb-2">${category.title}</h2>
                            <p class="text-base-600 dark:text-base-300 mb-8">${category.intro}</p>
                            <div class="space-y-8">
                                ${category.categories.map(renderCheatsheetCategory).join('')}
                            </div>
                        </div>`;
                    } else if (key === 'performance_tuning') {
                        contentArea.innerHTML = `<div class="bg-white dark:bg-base-800 rounded-lg shadow-sm p-6">
                            <h2 class="text-2xl font-bold text-base-900 dark:text-white mb-2">${category.title}</h2>
                            <p class="text-base-600 dark:text-base-300 mb-8">${category.intro}</p>
                            <div class="space-y-8">
                                ${category.categories.map(renderPerformanceCategory).join('')}
                                ${category.optimization_strategies ? `
                                    <div class="mt-12 pt-8 border-t border-base-200 dark:border-base-700">
                                        <h3 class="text-xl font-semibold text-base-900 dark:text-white mb-6">Optimization Strategies</h3>
                                        <div class="space-y-6">
                                            ${category.optimization_strategies.map(renderOptimizationStrategy).join('')}
                                        </div>
                                    </div>
                                ` : ''}
                            </div>
                        </div>`;
                    } else if (key === 'monitoring_templates') {
                         contentArea.innerHTML = `<div class="bg-white dark:bg-base-800 rounded-lg shadow-sm p-6">
                            <h2 class="text-2xl font-bold text-base-900 dark:text-white mb-2">${category.title}</h2>
                            <p class="text-base-600 dark:text-base-300 mb-8">${category.intro}</p>
                            <div class="space-y-8">
                                ${category.templates.map(renderMonitoringTemplate).join('')}
                            </div>
                        </div>`;
                    } else if (key === 'version_changes') {
                        contentArea.innerHTML = `<div class="bg-white dark:bg-base-800 rounded-lg shadow-sm p-6">
                            <h2 class="text-2xl font-bold text-base-900 dark:text-white mb-2">${category.title}</h2>
                            <p class="text-base-600 dark:text-base-300 mb-8">${category.intro}</p>
                            <div class="overflow-x-auto version-table">
                                ${renderVersionChangesTable(category.versions)}
                            </div>
                        </div>`;
                    } else if (key === 'acid_properties') {
                        contentArea.innerHTML = `<div class="bg-white dark:bg-base-800 rounded-lg shadow-sm p-6">
                            <h2 class="text-2xl font-bold text-base-900 dark:text-white mb-2">${category.title}</h2>
                            <p class="text-base-600 dark:text-base-300 mb-8">${category.intro}</p>
                            <div class="space-y-8">
                                ${category.properties.map(renderAcidProperty).join('')}
                            </div>
                        </div>`;
                    } else {
                        contentArea.innerHTML = `<div class="bg-white dark:bg-base-800 rounded-lg shadow-sm p-6">${category.content}</div>`;
                        
                        // Initialize tabs if they exist in the content
                        setTimeout(() => {
                            initializeContentTabs();
                        }, 100);
                    }
                    Prism.highlightAll();
                    
                    // Scroll to top
                    if (contentArea) {
                        contentArea.scrollTop = 0;
                    }
                }

                function initializeContentTabs() {
                    const tabButtons = document.querySelectorAll('.tab-button');
                    const tabContents = document.querySelectorAll('.tab-content');

                    if (tabButtons.length === 0) return;

                    tabButtons.forEach(button => {
                        button.addEventListener('click', () => {
                            const targetTab = button.dataset.tab;
                            
                            // Remove active class from all buttons and contents
                            tabButtons.forEach(btn => btn.classList.remove('active'));
                            tabContents.forEach(content => content.classList.remove('active'));
                            
                            // Add active class to clicked button and corresponding content
                            button.classList.add('active');
                            const targetContent = document.getElementById(`${targetTab}-tab`);
                            if (targetContent) {
                                targetContent.classList.add('active');
                            }
                        });
                    });
                }
                
                function renderGlossaryTerm(termData) {
                    return `
                        <div class="glossary-term bg-white dark:bg-base-800 p-4 rounded-r-lg border border-base-200 dark:border-base-600" title="${termData.term}">
                            <h3 class="text-xl font-bold text-primary-600 dark:text-primary-300">${termData.term}</h3>
                            <p class="mt-2 text-base-700 dark:text-base-200">${termData.explanation}</p>
                            ${termData.visual ? `<div class="visual-content my-4">${termData.visual}</div>` : ''}
                            <div class="mt-4 text-sm space-y-2">
                                <p><strong class="font-semibold text-base-800 dark:text-base-100">Example:</strong> <span class="text-base-700 dark:text-base-200">${termData.example}</span></p>
                                <p><strong class="font-semibold text-base-800 dark:text-base-100">Version Impact:</strong> <span class="text-base-700 dark:text-base-200">${termData.version_impact}</span></p>
                                <a href="${termData.link}" target="_blank" rel="noopener noreferrer" class="text-primary-600 dark:text-primary-300 hover:text-primary-700 dark:hover:text-primary-200 hover:underline">
                                    Reference Link <i class="fa-solid fa-external-link-alt fa-xs ml-1"></i>
                                </a>
                            </div>
                        </div>
                    `;
                }

                function renderSystemCatalogTerm(table) {
                    return `
                        <div class="bg-white border border-gray-200 rounded-lg shadow-sm hover:shadow-md transition-shadow duration-200 p-6 mb-6">
                            <div class="flex items-center justify-between mb-4">
                                <h3 class="text-xl font-bold text-blue-800">${table.name}</h3>
                                <span class="px-3 py-1 text-sm font-medium bg-blue-100 text-blue-800 rounded-full">${table.importance}</span>
                            </div>
                            <p class="text-gray-700 mb-4">${table.purpose}</p>
                            
                            ${table.columns ? `
                                <div class="mb-4">
                                    <h4 class="text-lg font-semibold text-gray-800 mb-2">Key Columns:</h4>
                                    <div class="grid grid-cols-1 md:grid-cols-2 gap-3">
                                        ${table.columns.map(col => `
                                            <div class="bg-gray-50 p-3 rounded-lg border border-gray-200">
                                                <div class="font-semibold text-gray-800">${col.name} <span class="text-sm font-normal text-gray-500">(${col.datatype})</span></div>
                                                <div class="text-sm text-gray-600">${col.desc}</div>
                                            </div>
                                        `).join('')}
                                    </div>
                                </div>
                            ` : ''}
                            
                            ${table.practical_queries ? `
                                <div class="mb-4">
                                    <h4 class="text-lg font-semibold text-gray-800 mb-2">Practical Queries:</h4>
                                    ${table.practical_queries.map(query => `
                                        <div class="bg-gray-50 border border-gray-200 rounded-lg p-4 mb-3">
                                            <h5 class="font-semibold text-gray-800 mb-2">${query.title}</h5>
                                            <pre class="bg-gray-900 text-green-400 p-3 rounded-lg text-sm overflow-x-auto"><code>${query.query}</code></pre>
                                            <p class="text-gray-600 text-sm mt-2">${query.use_case}</p>
                                        </div>
                                    `).join('')}
                                </div>
                            ` : ''}
                            
                            ${table.monitoring_queries ? `
                                <div class="mb-4">
                                    <h4 class="text-lg font-semibold text-gray-800 mb-2">Monitoring Queries:</h4>
                                    <div class="space-y-2">
                                        ${table.monitoring_queries.map(monitor => `
                                            <div class="bg-blue-50 border border-blue-200 rounded-lg p-3">
                                                <span class="font-semibold text-blue-800">${monitor.name}</span>
                                                <pre class="bg-gray-900 text-green-400 p-2 rounded text-xs mt-2 overflow-x-auto"><code>${monitor.query}</code></pre>
                                            </div>
                                        `).join('')}
                                    </div>
                                </div>
                            ` : ''}
                            
                            ${table.tips ? `
                                <div>
                                    <h4 class="text-lg font-semibold text-gray-800 mb-2">Tips:</h4>
                                    <ul class="space-y-1">
                                        ${table.tips.map(tip => `
                                            <li class="flex items-start">
                                                <i class="fa-solid fa-lightbulb text-yellow-500 mt-1 mr-2"></i>
                                                <span class="text-gray-700">${tip}</span>
                                            </li>
                                        `).join('')}
                                    </ul>
                                </div>
                            ` : ''}
                        </div>
                    `;
                }

                function renderSystemCatalogCategory(category) {
                    return `
                        <div class="mb-8">
                            <div class="bg-gradient-to-r from-blue-600 to-indigo-600 text-white p-6 rounded-t-lg shadow-lg">
                                <h2 class="text-2xl font-bold mb-2">${category.category}</h2>
                                <p class="text-blue-100">${category.description}</p>
                            </div>
                            <div class="bg-gradient-to-br from-blue-50 to-indigo-50 p-6 rounded-b-lg shadow-lg border-t-0">
                                ${category.tables.map(table => renderSystemCatalogTerm(table)).join('')}
                            </div>
                        </div>
                    `;
                }
                
                function renderErrorGuideItem(errorData) {
                    return `
                        <div class="error-guide-item bg-white dark:bg-base-800 p-4 rounded-r-lg border border-base-200 dark:border-base-600">
                            <h3 class="text-xl font-mono font-bold text-red-600 dark:text-red-400"><span class="pro-tip-tag tag-error">[ERROR]</span>${errorData.message}</h3>
                            <div class="mt-4 space-y-3 text-sm">
                                <p><strong class="font-semibold text-base-800 dark:text-base-100 block">Cause:</strong> <span class="text-base-700 dark:text-base-200">${errorData.cause}</span></p>
                                <p><strong class="font-semibold text-base-800 dark:text-base-100 block">Resolution:</strong> <span class="text-base-700 dark:text-base-200">${errorData.resolution}</span></p>
                                <p><strong class="font-semibold text-base-800 dark:text-base-100">Related Parameters:</strong> <code class="text-xs bg-base-200 dark:bg-base-700 text-base-800 dark:text-base-100 p-1 rounded border border-base-300 dark:border-base-600">${errorData.parameters}</code></p>
                                <p><strong class="font-semibold text-base-800 dark:text-base-100">Tip to Avoid:</strong> <span class="text-base-700 dark:text-base-200">${errorData.tip}</span></p>
                            </div>
                        </div>
                    `;
                }

                function renderExtensionGuideItem(extData) {
                     return `
                        <div class="extension-guide-item bg-white dark:bg-base-800 p-4 rounded-r-lg border border-base-200 dark:border-base-600">
                            <h3 class="text-xl font-bold text-primary-600 dark:text-primary-300">${extData.name}</h3>
                            <p class="mt-1 text-sm italic text-base-600 dark:text-base-300">${extData.use_case}</p>
                            <div class="mt-4">
                                <h4 class="font-semibold text-base-800 dark:text-base-100">Installation:</h4>
                                <pre class="mt-2"><code class="language-sql">${extData.installation}</code></pre>
                            </div>
                            <div class="mt-4">
                                <h4 class="font-semibold text-base-800 dark:text-base-100">Sample Use:</h4>
                                <pre class="mt-2"><code class="language-sql">${extData.sample_use}</code></pre>
                            </div>
                             <div class="mt-4">
                                <h4 class="font-semibold text-base-800 dark:text-base-100">Monitoring Views:</h4>
                                <p class="text-sm mt-1"><code class="bg-base-200 dark:bg-base-700 text-base-800 dark:text-base-100 p-1 rounded border border-base-300 dark:border-base-600">${extData.monitoring_views}</code></p>
                            </div>
                             <div class="mt-4">
                                <h4 class="font-semibold text-base-800 dark:text-base-100">Performance Notes:</h4>
                                <p class="text-sm mt-1 text-base-700 dark:text-base-200">${extData.performance_notes}</p>
                            </div>
                        </div>
                    `;
                }

                function renderCheatsheetCategory(categoryData) {
                    const tasksHtml = categoryData.tasks.map(task => `
                        <tr class="border-b border-base-200 dark:border-base-700 hover:bg-base-50 dark:hover:bg-base-700/50">
                            <td class="py-3 px-4 font-semibold text-base-800 dark:text-base-100">${task.task}</td>
                            <td class="py-3 px-4 font-mono text-sm text-base-700 dark:text-base-200">${task.cli}</td>
                            <td class="py-3 px-4 text-sm text-base-700 dark:text-base-200">${task.gui}</td>
                            <td class="py-3 px-4">
                                <div class="code-block-container relative">
                                    <pre><code class="language-sql">${task.sql}</code></pre>
                                    <button class="copy-btn" aria-label="Copy code"><i class="fa-solid fa-copy"></i></button>
                                </div>
                            </td>
                        </tr>
                    `).join('');

                    return `
                        <div class="cheatsheet-category bg-white dark:bg-base-800 p-4 rounded-r-lg border border-base-200 dark:border-base-600">
                            <h3 class="text-xl font-bold text-primary-600 dark:text-primary-300 mb-4">${categoryData.category}</h3>
                            <div class="overflow-x-auto">
                                <table class="w-full text-left border border-base-200 dark:border-base-600 rounded-lg overflow-hidden">
                                    <thead class="bg-base-100 dark:bg-base-700 text-xs uppercase tracking-wider">
                                        <tr>
                                            <th class="py-3 px-4 text-base-700 dark:text-base-200 font-semibold">Task</th>
                                            <th class="py-3 px-4 text-base-700 dark:text-base-200 font-semibold">CLI Equivalent (psql)</th>
                                            <th class="py-3 px-4 text-base-700 dark:text-base-200 font-semibold">GUI Equivalent (pgAdmin)</th>
                                            <th class="py-3 px-4 text-base-700 dark:text-base-200 font-semibold">Shortcut SQL</th>
                                        </tr>
                                    </thead>
                                    <tbody class="text-sm bg-white dark:bg-base-800">
                                        ${tasksHtml}
                                    </tbody>
                                </table>
                            </div>
                        </div>
                    `;
                }

                function renderTuningParameter(paramData) {
                    return `
                        <div class="tuning-parameter bg-white dark:bg-base-800 p-4 rounded-r-lg border border-base-200 dark:border-base-600">
                            <h3 class="text-xl font-mono font-bold text-primary-600 dark:text-primary-300"><span class="pro-tip-tag tag-tune">[TUNE]</span>${paramData.name}</h3>
                            <p class="mt-2 text-base-700 dark:text-base-200">${paramData.description}</p>
                            <div class="mt-4">
                                <h4 class="font-semibold text-base-800 dark:text-base-100">Check Current Value:</h4>
                                <pre class="mt-2"><code class="language-sql">${paramData.query}</code></pre>
                            </div>
                            <div class="mt-4 text-sm space-y-2">
                                <p><strong class="font-semibold text-base-800 dark:text-base-100">Formula for Tuning:</strong> <span class="text-base-700 dark:text-base-200">${paramData.formula}</span></p>
                                <p><strong class="font-semibold text-base-800 dark:text-base-100">Real-world Enterprise Value:</strong> <span class="text-base-700 dark:text-base-200">${paramData.enterprise_values}</span></p>
                            </div>
                        </div>
                    `;
                }

                function renderMonitoringTemplate(templateData) {
                    return `
                        <div class="monitoring-template bg-white dark:bg-base-800 p-4 rounded-r-lg border border-base-200 dark:border-base-600">
                            <h3 class="text-xl font-bold text-primary-600 dark:text-primary-300">${templateData.name}</h3>
                            <div class="mt-4 code-block-container relative">
                                <pre><code class="language-sql">${templateData.query}</code></pre>
                                <button class="copy-btn" aria-label="Copy code"><i class="fa-solid fa-copy"></i></button>
                            </div>
                        </div>
                    `;
                }
                
                function renderVersionChangesTable(versions) {
                    const headers = ['Feature', ...versions.map(v => `PostgreSQL ${v.version}`)];
                    const features = ['Partitioning', 'JSONB Enhancements', 'Parallelism', 'Stored Procedures'];
                    
                    const headerHtml = headers.map(h => `<th class="py-3 px-4 text-base-700 dark:text-base-200 font-semibold">${h}</th>`).join('');
                    
                    const rowsHtml = features.map(feature => {
                        const featureKey = feature.toLowerCase().replace(/ /g, '_');
                        const cellsHtml = versions.map(v => `<td class="py-3 px-4 text-base-700 dark:text-base-200">${v[featureKey] || 'N/A'}</td>`).join('');
                        return `<tr class="border-b border-base-200 dark:border-base-700 hover:bg-base-50 dark:hover:bg-base-700/50">
                                    <td class="py-3 px-4 font-semibold text-base-800 dark:text-base-100">${feature}</td>
                                    ${cellsHtml}
                                </tr>`;
                    }).join('');

                    return `<div class="version-table bg-white dark:bg-base-800 p-4 rounded-r-lg border border-base-200 dark:border-base-600">
                                <table class="w-full text-left text-sm border border-base-200 dark:border-base-600 rounded-lg overflow-hidden">
                                    <thead class="bg-base-100 dark:bg-base-700 text-xs uppercase tracking-wider">
                                        <tr>${headerHtml}</tr>
                                    </thead>
                                    <tbody class="text-sm bg-white dark:bg-base-800">
                                        ${rowsHtml}
                                    </tbody>
                                </table>
                            </div>`;
                }
                
                function renderAcidProperty(propData) {
                     return `
                        <div class="acid-property bg-white dark:bg-base-800 p-4 rounded-r-lg border border-base-200 dark:border-base-600">
                            <h3 class="text-2xl font-bold text-primary-600 dark:text-primary-300">${propData.name}</h3>
                            <p class="mt-2 text-base-700 dark:text-base-200">${propData.explanation}</p>
                            ${propData.visual ? `<div class="my-4 p-4 border rounded-lg bg-base-50 dark:bg-base-700 border-base-200 dark:border-base-600 text-base-800 dark:text-base-100 visual-content">${propData.visual}</div>` : ''}
                            <div class="mt-4">
                                <h4 class="font-semibold text-base-800 dark:text-base-100">Example:</h4>
                                <pre class="mt-2"><code class="language-sql">${propData.example}</code></pre>
                            </div>
                             <div class="mt-4">
                                <h4 class="font-semibold text-base-800 dark:text-base-100">Use Case:</h4>
                                <p class="text-sm mt-1 text-base-700 dark:text-base-200">${propData.use_case}</p>
                            </div>
                        </div>
                    `;
                }

                // Enhanced render functions for new structure
                function renderErrorCategory(categoryData) {
                    const errorsHtml = categoryData.errors.map(error => `
                        <div class="error-item p-4 bg-base-50 dark:bg-base-700 rounded-lg border border-base-200 dark:border-base-600">
                            <div class="flex items-start gap-3">
                                <div class="flex-shrink-0 mt-1">
                                    <span class="inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-red-100 text-red-800 dark:bg-red-900 dark:text-red-200">
                                        ${error.errorCode}
                                    </span>
                                </div>
                                <div class="flex-1 min-w-0">
                                    <h4 class="text-lg font-semibold text-red-600 dark:text-red-400 font-mono">${error.message}</h4>
                                    <div class="mt-3 space-y-3 text-sm">
                                        <div>
                                            <span class="font-semibold text-base-800 dark:text-base-100">Cause:</span>
                                            <p class="mt-1 text-base-700 dark:text-base-200">${error.cause}</p>
                                        </div>
                                        <div>
                                            <span class="font-semibold text-base-800 dark:text-base-100">Resolution:</span>
                                            <p class="mt-1 text-base-700 dark:text-base-200">${error.resolution}</p>
                                        </div>
                                        ${error.troubleshooting ? `
                                            <div>
                                                <span class="font-semibold text-base-800 dark:text-base-100">Troubleshooting Steps:</span>
                                                <ul class="mt-1 list-disc list-inside text-base-700 dark:text-base-200 space-y-1">
                                                    ${error.troubleshooting.map(step => `<li>${step}</li>`).join('')}
                                                </ul>
                                            </div>
                                        ` : ''}
                                        <div class="flex flex-wrap gap-4 text-xs">
                                            <span class="bg-blue-100 dark:bg-blue-900 text-blue-800 dark:text-blue-200 px-2 py-1 rounded">
                                                Severity: ${error.severity}
                                            </span>
                                            ${error.parameters !== 'N/A' ? `
                                                <span class="bg-purple-100 dark:bg-purple-900 text-purple-800 dark:text-purple-200 px-2 py-1 rounded font-mono">
                                                    ${error.parameters}
                                                </span>
                                            ` : ''}
                                        </div>
                                        ${error.tip ? `
                                            <div class="bg-yellow-50 dark:bg-yellow-900/20 border border-yellow-200 dark:border-yellow-700 rounded p-3">
                                                <span class="font-semibold text-yellow-800 dark:text-yellow-200">ðŸ’¡ Tip:</span>
                                                <span class="text-yellow-700 dark:text-yellow-300">${error.tip}</span>
                                            </div>
                                        ` : ''}
                                    </div>
                                </div>
                            </div>
                        </div>
                    `).join('');

                    return `
                        <div class="error-category mb-8">
                            <div class="flex items-center gap-3 mb-6">
                                <i class="${categoryData.icon} text-2xl text-red-600 dark:text-red-400"></i>
                                <div>
                                    <h3 class="text-2xl font-bold text-base-900 dark:text-white">${categoryData.name}</h3>
                                    <p class="text-base-600 dark:text-base-300">${categoryData.description}</p>
                                </div>
                            </div>
                            <div class="space-y-4">
                                ${errorsHtml}
                            </div>
                        </div>
                    `;
                }

                function renderExtensionCategory(categoryData) {
                    const extensionsHtml = categoryData.extensions.map(ext => `
                        <div class="extension-item p-6 bg-base-50 dark:bg-base-700 rounded-lg border border-base-200 dark:border-base-600">
                            <div class="flex items-start gap-4">
                                <div class="flex-shrink-0">
                                    <div class="w-12 h-12 bg-primary-100 dark:bg-primary-900 rounded-lg flex items-center justify-center">
                                        <i class="fa-solid fa-puzzle-piece text-primary-600 dark:text-primary-400"></i>
                                    </div>
                                </div>
                                <div class="flex-1 min-w-0">
                                    <div class="flex items-center gap-3 mb-2">
                                        <h4 class="text-xl font-bold text-primary-600 dark:text-primary-300">${ext.name}</h4>
                                        <span class="inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-blue-100 text-blue-800 dark:bg-blue-900 dark:text-blue-200">
                                            ${ext.use_case}
                                        </span>
                                    </div>
                                    
                                    <div class="grid md:grid-cols-2 gap-4 mt-4">
                                        <div>
                                            <h5 class="font-semibold text-base-800 dark:text-base-100 mb-2">Installation</h5>
                                            <div class="code-block-container relative">
                                                <pre><code class="language-sql">${ext.installation}</code></pre>
                                                <button class="copy-btn" aria-label="Copy code"><i class="fa-solid fa-copy"></i></button>
                                            </div>
                                            ${ext.prerequisites ? `
                                                <p class="text-xs text-orange-600 dark:text-orange-400 mt-1">
                                                    <i class="fa-solid fa-exclamation-triangle mr-1"></i>
                                                    ${ext.prerequisites}
                                                </p>
                                            ` : ''}
                                        </div>
                                        
                                        <div>
                                            <h5 class="font-semibold text-base-800 dark:text-base-100 mb-2">Configuration</h5>
                                            ${ext.configuration ? `
                                                <div class="space-y-2">
                                                    ${Object.entries(ext.configuration).map(([key, desc]) => `
                                                        <div class="text-sm">
                                                            <code class="text-xs bg-base-200 dark:bg-base-800 px-1 rounded">${key}</code>
                                                            <span class="text-base-700 dark:text-base-300 ml-2">${desc}</span>
                                                        </div>
                                                    `).join('')}
                                                </div>
                                            ` : '<p class="text-sm text-base-600 dark:text-base-400">No additional configuration required</p>'}
                                        </div>
                                    </div>

                                    <div class="mt-4">
                                        <h5 class="font-semibold text-base-800 dark:text-base-100 mb-2">Sample Usage</h5>
                                        <div class="code-block-container relative">
                                            <pre><code class="language-sql">${ext.sample_use}</code></pre>
                                            <button class="copy-btn" aria-label="Copy code"><i class="fa-solid fa-copy"></i></button>
                                        </div>
                                    </div>

                                    ${ext.monitoring && ext.monitoring !== 'N/A' ? `
                                        <div class="mt-4">
                                            <h5 class="font-semibold text-base-800 dark:text-base-100 mb-2">Monitoring</h5>
                                            <div class="code-block-container relative">
                                                <pre><code class="language-sql">${ext.monitoring}</code></pre>
                                                <button class="copy-btn" aria-label="Copy code"><i class="fa-solid fa-copy"></i></button>
                                            </div>
                                        </div>
                                    ` : ''}

                                    <div class="mt-4 space-y-3">
                                        <div class="bg-blue-50 dark:bg-blue-900/20 border border-blue-200 dark:border-blue-700 rounded p-3">
                                            <span class="font-semibold text-blue-800 dark:text-blue-200">ðŸ“Š Performance Notes:</span>
                                            <p class="text-blue-700 dark:text-blue-300 text-sm mt-1">${ext.performance_notes}</p>
                                        </div>
                                        
                                        ${ext.tips ? `
                                            <div class="bg-green-50 dark:bg-green-900/20 border border-green-200 dark:border-green-700 rounded p-3">
                                                <span class="font-semibold text-green-800 dark:text-green-200">ðŸ’¡ Tips:</span>
                                                <ul class="text-green-700 dark:text-green-300 text-sm mt-1 list-disc list-inside space-y-1">
                                                    ${ext.tips.map(tip => `<li>${tip}</li>`).join('')}
                                                </ul>
                                            </div>
                                        ` : ''}
                                    </div>
                                </div>
                            </div>
                        </div>
                    `).join('');

                    return `
                        <div class="extension-category mb-8">
                            <div class="flex items-center gap-3 mb-6">
                                <i class="${categoryData.icon} text-2xl text-primary-600 dark:text-primary-400"></i>
                                <div>
                                    <h3 class="text-2xl font-bold text-base-900 dark:text-white">${categoryData.name}</h3>
                                    <p class="text-base-600 dark:text-base-300">${categoryData.description}</p>
                                </div>
                            </div>
                            <div class="space-y-6">
                                ${extensionsHtml}
                            </div>
                        </div>
                    `;
                }

                function renderPerformanceCategory(categoryData) {
                    const parametersHtml = categoryData.parameters.map(param => `
                        <div class="performance-parameter p-6 bg-base-50 dark:bg-base-700 rounded-lg border border-base-200 dark:border-base-600">
                            <div class="flex items-start gap-4">
                                <div class="flex-shrink-0">
                                    <div class="w-12 h-12 bg-green-100 dark:bg-green-900 rounded-lg flex items-center justify-center">
                                        <i class="fa-solid fa-cogs text-green-600 dark:text-green-400"></i>
                                    </div>
                                </div>
                                <div class="flex-1 min-w-0">
                                    <h4 class="text-xl font-bold text-green-600 dark:text-green-300 font-mono">${param.name}</h4>
                                    <p class="mt-2 text-base-700 dark:text-base-200">${param.description}</p>
                                    
                                    <div class="grid md:grid-cols-2 gap-4 mt-4">
                                        <div>
                                            <h5 class="font-semibold text-base-800 dark:text-base-100 mb-2">Current Value</h5>
                                            <div class="code-block-container relative">
                                                <pre><code class="language-sql">${param.current_value_query || param.query}</code></pre>
                                                <button class="copy-btn" aria-label="Copy code"><i class="fa-solid fa-copy"></i></button>
                                            </div>
                                        </div>
                                        
                                        <div>
                                            <h5 class="font-semibold text-base-800 dark:text-base-100 mb-2">Configuration Info</h5>
                                            <div class="space-y-2 text-sm">
                                                <div>
                                                    <span class="font-medium text-base-800 dark:text-base-100">Default:</span>
                                                    <code class="ml-2 bg-base-200 dark:bg-base-800 px-1 rounded">${param.default_value}</code>
                                                </div>
                                                <div>
                                                    <span class="font-medium text-base-800 dark:text-base-100">Recommended:</span>
                                                    <code class="ml-2 bg-base-200 dark:bg-base-800 px-1 rounded">${param.recommended_range}</code>
                                                </div>
                                            </div>
                                        </div>
                                    </div>

                                    ${param.monitoring && param.monitoring !== '-- Monitor' ? `
                                        <div class="mt-4">
                                            <h5 class="font-semibold text-base-800 dark:text-base-100 mb-2">Monitoring Query</h5>
                                            <div class="code-block-container relative">
                                                <pre><code class="language-sql">${param.monitoring}</code></pre>
                                                <button class="copy-btn" aria-label="Copy code"><i class="fa-solid fa-copy"></i></button>
                                            </div>
                                        </div>
                                    ` : ''}

                                    <div class="mt-4 space-y-3">
                                        <div class="bg-blue-50 dark:bg-blue-900/20 border border-blue-200 dark:border-blue-700 rounded p-3">
                                            <span class="font-semibold text-blue-800 dark:text-blue-200">ðŸ“ Formula:</span>
                                            <p class="text-blue-700 dark:text-blue-300 text-sm mt-1">${param.formula}</p>
                                        </div>
                                        
                                        <div class="bg-purple-50 dark:bg-purple-900/20 border border-purple-200 dark:border-purple-700 rounded p-3">
                                            <span class="font-semibold text-purple-800 dark:text-purple-200">ðŸ¢ Enterprise Values:</span>
                                            <p class="text-purple-700 dark:text-purple-300 text-sm mt-1">${param.enterprise_values}</p>
                                        </div>
                                        
                                        ${param.tuning_tips ? `
                                            <div class="bg-green-50 dark:bg-green-900/20 border border-green-200 dark:border-green-700 rounded p-3">
                                                <span class="font-semibold text-green-800 dark:text-green-200">ðŸ’¡ Tuning Tips:</span>
                                                <ul class="text-green-700 dark:text-green-300 text-sm mt-1 list-disc list-inside space-y-1">
                                                    ${param.tuning_tips.map(tip => `<li>${tip}</li>`).join('')}
                                                </ul>
                                            </div>
                                        ` : ''}
                                    </div>
                                </div>
                            </div>
                        </div>
                    `).join('');

                    return `
                        <div class="performance-category mb-8">
                            <div class="flex items-center gap-3 mb-6">
                                <i class="${categoryData.icon} text-2xl text-green-600 dark:text-green-400"></i>
                                <div>
                                    <h3 class="text-2xl font-bold text-base-900 dark:text-white">${categoryData.name}</h3>
                                    <p class="text-base-600 dark:text-base-300">${categoryData.description}</p>
                                </div>
                            </div>
                            <div class="space-y-6">
                                ${parametersHtml}
                            </div>
                        </div>
                    `;
                }

                function renderOptimizationStrategy(strategyData) {
                    const techniquesHtml = strategyData.techniques.map(technique => `
                        <div class="technique-item p-4 bg-base-100 dark:bg-base-800 rounded border border-base-200 dark:border-base-600">
                            <h5 class="font-semibold text-base-800 dark:text-base-100 mb-2">${technique.technique}</h5>
                            <p class="text-sm text-base-600 dark:text-base-300 mb-3">${technique.description}</p>
                            <div class="code-block-container relative">
                                <pre><code class="language-sql">${technique.example}</code></pre>
                                <button class="copy-btn" aria-label="Copy code"><i class="fa-solid fa-copy"></i></button>
                            </div>
                        </div>
                    `).join('');

                    return `
                        <div class="optimization-strategy p-6 bg-base-50 dark:bg-base-700 rounded-lg border border-base-200 dark:border-base-600">
                            <h4 class="text-xl font-bold text-orange-600 dark:text-orange-300 mb-2">${strategyData.name}</h4>
                            <p class="text-base-600 dark:text-base-300 mb-4">${strategyData.description}</p>
                            <div class="space-y-4">
                                ${techniquesHtml}
                            </div>
                        </div>
                    `;
                }


                function renderIssuePage(key) {
                    const category = knowledgeBaseData[key];
                    filterContainer.classList.remove('hidden');
                    contentArea.innerHTML = `<div class="space-y-6">
                        <div class="p-6 bg-white dark:bg-base-800 rounded-lg shadow-sm">
                            <h2 class="text-2xl font-bold text-base-900 dark:text-white mb-2">${category.title}</h2>
                            <p class="text-base-600 dark:text-base-300">${category.intro}</p>
                        </div>
                        <div class="flex justify-end gap-4 mb-4">
                            <button id="expand-all" class="bg-primary-600 text-white px-4 py-2 rounded-lg shadow hover:bg-primary-700 transition-colors"><i class="fa-solid fa-expand-arrows-alt mr-2"></i>Expand All</button>
                            <button id="collapse-all" class="bg-base-400 dark:bg-base-600 text-white px-4 py-2 rounded-lg shadow hover:bg-base-500 transition-colors"><i class="fa-solid fa-compress-arrows-alt mr-2"></i>Collapse All</button>
                        </div>
                        <div id="accordion-container" class="space-y-4"></div>
                        <div id="no-results" class="text-center p-8 text-base-500 hidden">
                            <h3 class="text-xl font-semibold">No Results Found</h3>
                            <p>Try adjusting your search or filter.</p>
                        </div>
                    </div>`;
                    contentArea.scrollTop = 0;
                    
                    setupFuse(key);
                    renderAccordionContent(key);
                    document.getElementById('expand-all').addEventListener('click', () => toggleAll(true));
                    document.getElementById('collapse-all').addEventListener('click', () => toggleAll(false));
                }
                
                function updateBreadcrumb(key) {
                    const category = knowledgeBaseData[key];
                    breadcrumb.innerHTML = key === 'dashboard'
                        ? `<span class="font-semibold">Dashboard</span>`
                        : `<a href="#" data-key="dashboard" class="hover:underline breadcrumb-link">Dashboard</a> <span class="mx-2">/</span> <span class="font-semibold">${category.title}</span>`;
                }
                
                function setupFuse(categoryKey) {
                    try {
                        const category = knowledgeBaseData[categoryKey];
                        if (!category || !category.issues || !Array.isArray(category.issues)) {
                            console.warn('Invalid category or issues data for Fuse setup:', categoryKey);
                            fuse = null;
                            return;
                        }
                        fuse = new Fuse(category.issues, { 
                            includeScore: true, 
                            keys: [
                                { name: 'title', weight: 0.7 },
                                { name: 'errorCode', weight: 0.6 },
                                { name: 'solution', weight: 0.4 },
                                { name: 'remediation', weight: 0.3 },
                                { name: 'severity', weight: 0.2 }
                            ],
                            threshold: 0.4,
                            minMatchCharLength: 2,
                            shouldSort: true,
                            ignoreLocation: true,
                            useExtendedSearch: true
                        });
                    } catch (error) {
                        console.error('Error setting up Fuse search for category:', categoryKey, error);
                        fuse = null;
                    }
                }

                function setupGlobalFuse() {
                    try {
                        const allIssues = [];
                        Object.keys(knowledgeBaseData).forEach(key => {
                            const category = knowledgeBaseData[key];
                            if (category.issues && Array.isArray(category.issues)) {
                                category.issues.forEach(issue => {
                                    allIssues.push({
                                        ...issue,
                                        categoryKey: key,
                                        categoryTitle: category.title
                                    });
                                });
                            }
                        });
                        
                        globalFuse = new Fuse(allIssues, {
                            includeScore: true,
                            keys: [
                                { name: 'title', weight: 0.7 },
                                { name: 'errorCode', weight: 0.6 },
                                { name: 'solution', weight: 0.4 },
                                { name: 'remediation', weight: 0.3 },
                                { name: 'categoryTitle', weight: 0.2 }
                            ],
                            threshold: 0.4,
                            minMatchCharLength: 2,
                            shouldSort: true,
                            ignoreLocation: true,
                            useExtendedSearch: true
                        });
                    } catch (error) {
                        console.error('Error setting up global Fuse search:', error);
                        globalFuse = null;
                    }
                }

                function renderAccordionContent(categoryKey) {
                    try {
                        const container = document.getElementById('accordion-container');
                        if (!container) {
                            console.warn('Accordion container not found');
                            return;
                        }

                        const searchTerm = searchInput ? searchInput.value : '';
                        const category = knowledgeBaseData[categoryKey];
                        if (!category || !category.issues) {
                            console.warn('Invalid category or no issues found for:', categoryKey);
                            container.innerHTML = '<div class="text-center py-8 text-base-500">No issues found for this category.</div>';
                            return;
                        }

                        let issues = category.issues || [];
                        
                        // Apply search filter with better error handling
                        if (searchTerm.trim() !== '' && fuse) {
                            try {
                                const searchResults = fuse.search(searchTerm);
                                issues = searchResults
                                    .filter(result => result.item && result.score < 0.8) // Better quality results
                                    .map(result => result.item);
                            } catch (error) {
                                console.error('Error during search:', error);
                                issues = category.issues || [];
                            }
                        }

                        // Apply severity filter with validation
                        const severity = severityFilter ? severityFilter.value : 'all';
                        const filteredIssues = issues.filter(issue => {
                            if (!issue || typeof issue !== 'object') return false;
                            return severity === 'all' || issue.severity === severity;
                        });

                        // Show/hide no results message
                        const noResultsEl = document.getElementById('no-results');
                        if (filteredIssues.length === 0) {
                            container.innerHTML = '';
                            if (noResultsEl) {
                                noResultsEl.style.display = 'block';
                                // Update no results message based on whether it's a search or filter issue
                                const messageEl = noResultsEl.querySelector('p');
                                if (messageEl) {
                                    if (searchTerm.trim() !== '') {
                                        messageEl.textContent = `No results found for "${searchTerm}". Try different keywords or check spelling.`;
                                    } else if (severity !== 'all') {
                                        messageEl.textContent = `No ${severity} severity issues found. Try a different severity level.`;
                                    } else {
                                        messageEl.textContent = 'No issues found in this category.';
                                    }
                                }
                            }
                            return;
                        }
                        
                        if (noResultsEl) noResultsEl.style.display = 'none';
                        
                        // Render filtered issues
                        container.innerHTML = filteredIssues.map((issue, index) => generateIssueHTML(issue, index)).join('');
                        attachAllListeners();
                        
                        // Highlight search terms if present
                        if (searchTerm.trim() !== '') {
                            highlightSearchTerms(container, searchTerm);
                        }
                        
                    } catch (error) {
                        console.error('Error rendering accordion content:', error);
                        const container = document.getElementById('accordion-container');
                        if (container) {
                            container.innerHTML = '<div class="text-center p-8 text-red-500">Error loading content. Please refresh the page.</div>';
                        }
                    }
                }

                function highlightSearchTerms(container, searchTerm) {
                    if (!container || !searchTerm) return;
                    
                    const terms = searchTerm.toLowerCase().split(' ').filter(term => term.length > 1);
                    const walker = document.createTreeWalker(
                        container,
                        NodeFilter.SHOW_TEXT,
                        null,
                        false
                    );

                    const textNodes = [];
                    let node;
                    while (node = walker.nextNode()) {
                        textNodes.push(node);
                    }

                    textNodes.forEach(textNode => {
                        const text = textNode.textContent;
                        let highlightedText = text;
                        
                        terms.forEach(term => {
                            const regex = new RegExp(`(${term})`, 'gi');
                            highlightedText = highlightedText.replace(regex, '<mark class="bg-yellow-200 dark:bg-yellow-800 px-1 rounded">$1</mark>');
                        });

                        if (highlightedText !== text) {
                            const span = document.createElement('span');
                            span.innerHTML = highlightedText;
                            textNode.parentNode.replaceChild(span, textNode);
                        }
                    });
                }

                function debouncedSearch(categoryKey) {
                    if (searchDebounceTimer) {
                        clearTimeout(searchDebounceTimer);
                    }
                    
                    // Add loading indicator with improved UX
                    if (searchInput) {
                        searchInput.classList.add('search-loading');
                        searchInput.setAttribute('aria-busy', 'true');
                    }
                    
                    searchDebounceTimer = setTimeout(() => {
                        try {
                            renderAccordionContent(categoryKey);
                        } catch (error) {
                            console.error('Error during search:', error);
                        } finally {
                            // Remove loading indicator
                            if (searchInput) {
                                searchInput.classList.remove('search-loading');
                                searchInput.setAttribute('aria-busy', 'false');
                            }
                        }
                    }, 300); // 300ms delay
                }
                
                function generateIssueHTML(issue, index) {
                    try {
                        if (!issue || typeof issue !== 'object') {
                            console.warn('Invalid issue data provided to generateIssueHTML:', issue);
                            return '<div class="accordion-item bg-white dark:bg-base-800 rounded-lg"><div class="p-4 text-yellow-600">âš ï¸ Invalid issue data</div></div>';
                        }
                        
                        if (!issue.id || !issue.title) {
                            console.warn('Issue missing required fields (id, title):', issue);
                            return '<div class="accordion-item bg-white dark:bg-base-800 rounded-lg"><div class="p-4 text-yellow-600">âš ï¸ Issue missing required fields</div></div>';
                        }
                        
                    const sevConfig = severityConfig[issue.severity] || { color: 'text-base-500', icon: 'fa-solid fa-question-circle' };
                    
                    const remediationHtml = `<div class="code-block-container mt-4">
                        <div class="text-sm font-semibold text-base-600 dark:text-base-300 mb-2">Remediation Steps</div>
                        <div class="relative"><pre class="language-bash"><code>${issue.remediation}</code></pre><button class="copy-btn" aria-label="Copy code"><i class="fa-solid fa-copy"></i></button></div>
                    </div>`;

                    const troubleshootingHtml = issue.troubleshooting_code ? `<div class="code-block-container mt-4">
                        <div class="text-sm font-semibold text-base-700 dark:text-base-200 mb-2">Troubleshooting Code</div>
                        <div class="relative"><pre class="language-sql"><code>${issue.troubleshooting_code}</code></pre><button class="copy-btn" aria-label="Copy code"><i class="fa-solid fa-copy"></i></button></div>
                    </div>` : '';
                    
                    const commentsHtml = `<div class="mt-6">
                        <h4 class="text-lg font-semibold text-base-800 dark:text-white mb-2">Comments</h4>
                        <div class="comment-list space-y-4" data-issue-id="${issue.id}">${renderComments(issue.comments)}</div>
                        <form class="comment-form mt-4 space-y-2" data-issue-id="${issue.id}">
                            <input type="text" placeholder="Your name" class="w-full p-2 border border-base-300 dark:border-base-600 rounded-md bg-white dark:bg-base-700" required>
                            <textarea placeholder="Add a comment..." class="w-full p-2 border border-base-300 dark:border-base-600 rounded-md bg-white dark:bg-base-700" required></textarea>
                            <button type="submit" class="bg-primary-600 text-white px-3 py-1 rounded-md text-sm font-semibold hover:bg-primary-700 transition-colors">Post Comment</button>
                        </form>
                    </div>`;

                    const feedbackHtml = `<div class="mt-6 pt-4 border-t border-base-200 dark:border-base-700">
                        <div class="flex justify-between items-center mb-3">
                            <p class="text-sm font-semibold">Was this helpful?</p>
                            <button onclick="exportSolutionToPDF('${issue.id}')" class="export-solution-btn bg-blue-100 hover:bg-blue-200 dark:bg-blue-900 dark:hover:bg-blue-800 text-blue-700 dark:text-blue-300 px-3 py-1 rounded-md text-xs font-medium transition-colors">
                                <i class="fa-solid fa-file-pdf mr-1"></i>Export PDF
                            </button>
                        </div>
                        <div class="flex gap-4">
                            <button class="feedback-btn yes-btn bg-base-200 hover:bg-green-200 dark:bg-base-600 dark:hover:bg-green-700 px-3 py-1 rounded-md">Yes</button>
                            <button class="feedback-btn no-btn bg-base-200 hover:bg-red-200 dark:bg-base-600 dark:hover:bg-red-700 px-3 py-1 rounded-md">No</button>
                        </div>
                    </div>`;

                    return `<div class="accordion-item bg-white dark:bg-base-800 rounded-lg" style="--delay: ${index * 0.05}s;" data-id="${issue.id}">
                        <button class="accordion-header w-full flex justify-between items-center p-4 text-left font-semibold text-base-700 dark:text-base-200 hover:bg-base-50 dark:hover:bg-base-700/50 rounded-t-lg transition-colors">
                            <div class="flex items-center flex-1 min-w-0">
                                <i class="${sevConfig.icon} ${sevConfig.color} mr-4 text-xl w-6 text-center" aria-hidden="true"></i>
                                <span class="flex-1 truncate"><span class="pro-tip-tag tag-fix">[FIX]</span>${issue.title}</span>
                            </div>
                            <div class="flex items-center flex-shrink-0">
                                <span class="text-xs font-mono bg-base-200 dark:bg-base-600 px-2 py-1 rounded-md mx-4">#${issue.errorCode}</span>
                                <div class="accordion-icon-container w-6 h-6 flex items-center justify-center">
                                   <i class="fa-solid fa-plus accordion-icon transform transition-transform"></i>
                                </div>
                            </div>
                        </button>
                        <div class="solution">
                            <div class="p-4 border-t border-base-200 dark:border-base-700 text-base-600 dark:text-base-300">
                                ${issue.solution}${remediationHtml}${troubleshootingHtml}${feedbackHtml}${commentsHtml}
                            </div>
                        </div>
                    </div>`;
                } catch (error) {
                    console.error('Error generating issue HTML:', error);
                    return '<div class="accordion-item bg-white dark:bg-base-800 rounded-lg"><div class="p-4 text-red-500">Error loading issue content</div></div>';
                }
                }

                function renderComments(comments = []) {
                    if (!comments || comments.length === 0) {
                        return '<p class="text-sm text-base-500">No comments yet. Be the first!</p>';
                    }
                    return comments.map(comment => {
                        // Enhanced XSS protection
                        const sanitizedName = String(comment.name || '').replace(/[<>]/g, (match) => match === '<' ? '&lt;' : '&gt;');
                        const sanitizedText = String(comment.text || '').replace(/[<>]/g, (match) => match === '<' ? '&lt;' : '&gt;');
                        const sanitizedDate = String(comment.date || '').replace(/[<>]/g, (match) => match === '<' ? '&lt;' : '&gt;');
                        return `<div class="bg-base-100 dark:bg-base-700 p-3 rounded-lg">
                                <div class="flex justify-between items-center">
                                    <p class="font-semibold text-sm text-base-800 dark:text-base-100">${sanitizedName}</p>
                                    <p class="text-xs text-base-400">${sanitizedDate}</p>
                                </div>
                                <p class="text-sm text-base-600 dark:text-base-300 mt-1">${sanitizedText}</p>
                            </div>`;
                    }).join('');
                }

                function renderDashboard() {
                    filterContainer.classList.add('hidden');
                    contentArea.innerHTML = knowledgeBaseData.dashboard.content;
                    
                    // Use setTimeout to ensure DOM elements are ready before initialization
                    setTimeout(() => {
                        // Initialize dashboard tabs
                        initializeDashboardTabs();
                        
                        // Render dashboard components
                        renderDashboardChart();
                        renderDashboardSummary();
                        renderMostViewed();
                        renderSolutionOfTheWeek();
                        renderCategoryOverview();
                        renderAnalytics();
                    }, 10);
                }

                function initializeDashboardTabs() {
                    const tabButtons = document.querySelectorAll('.tab-button');
                    const tabContents = document.querySelectorAll('.tab-content');

                    tabButtons.forEach(button => {
                        button.addEventListener('click', () => {
                            const targetTab = button.dataset.tab;
                            
                            // Remove active class from all buttons and contents
                            tabButtons.forEach(btn => btn.classList.remove('active'));
                            tabContents.forEach(content => content.classList.remove('active'));
                            
                            // Add active class to clicked button and corresponding content
                            button.classList.add('active');
                            document.getElementById(`${targetTab}-tab`).classList.add('active');
                        });
                    });
                }

                function renderCategoryOverview() {
                    const container = document.getElementById('category-overview');
                    if (!container) return;

                    const categories = Object.keys(knowledgeBaseData).filter(key => 
                        key !== 'dashboard' && knowledgeBaseData[key].title
                    );

                    container.innerHTML = categories.map(key => {
                        const category = knowledgeBaseData[key];
                        const issueCount = category.issues ? category.issues.length : 0;
                        const hasContent = category.content || category.intro;

                        return `
                            <div class="category-card" onclick="renderPage('${key}')">
                                <div class="category-icon">
                                    <i class="${category.icon || 'fa-solid fa-book'}"></i>
                                </div>
                                <h3 class="category-title">${category.title}</h3>
                                <p class="category-description">
                                    ${category.intro || 'Comprehensive guide and troubleshooting information.'}
                                </p>
                                <div class="category-stats">
                                    <span class="text-sm text-base-500 dark:text-base-400">
                                        ${issueCount > 0 ? `${issueCount} Issues` : 'Reference Guide'}
                                    </span>
                                    <i class="fa-solid fa-arrow-right text-primary-600 dark:text-primary-400"></i>
                                </div>
                            </div>
                        `;
                    }).join('');
                }

                function renderAnalytics() {
                    // Popular searches simulation
                    const popularSearches = document.getElementById('popular-searches');
                    if (popularSearches) {
                        const searches = [
                            'Connection timeout',
                            'Performance tuning',
                            'Index optimization',
                            'Backup strategies',
                            'Query optimization'
                        ];
                        
                        popularSearches.innerHTML = searches.map(search => 
                            `<div class="flex justify-between items-center">
                                <span class="text-sm">${search}</span>
                                <span class="text-xs text-base-500">${Math.floor(Math.random() * 100)}%</span>
                            </div>`
                        ).join('');
                    }

                    // Recent activity simulation
                    const recentActivity = document.getElementById('recent-activity');
                    if (recentActivity) {
                        const activities = [
                            'New performance guide added',
                            'Security update published',
                            'Monitoring template updated',
                            'Error guide enhanced',
                            'Community feedback integrated'
                        ];
                        
                        recentActivity.innerHTML = activities.map(activity => 
                            `<div class="text-sm text-base-700 dark:text-base-300">${activity}</div>`
                        ).join('');
                    }
                }
                
                function renderSolutionOfTheWeek() {
                    const container = document.getElementById('solution-of-the-week');
                    if (!container) return;
                    const issue = findIssueById("conn_critical_1");
                    const categoryKey = 'conn_auth';
                    if (issue) {
                        container.innerHTML = `<h3 class="text-lg font-semibold text-base-800 dark:text-white mb-4">Solution of the Week</h3>
                            <div class="bg-primary-50 dark:bg-primary-900/50 p-4 rounded-lg">
                                <p class="font-bold text-sm text-primary-800 dark:text-primary-200">${issue.title}</p>
                                <p class="text-xs text-primary-600 dark:text-primary-300 mt-1">${issue.solution.split('</p>')[0].replace('<p>', '')}</p>
                                <a href="#" data-id="${issue.id}" data-category="${categoryKey}" class="most-viewed-link text-sm font-semibold text-primary-600 dark:text-primary-400 hover:underline mt-2 inline-block">View Solution &rarr;</a>
                            </div>`;
                    }
                }

                function renderMostViewed() {
                    const container = document.getElementById('most-viewed-container');
                    if (!container) return;
                    let allIssues = [];
                    Object.keys(knowledgeBaseData).forEach(key => {
                        if (knowledgeBaseData[key].issues) {
                            allIssues.push(...knowledgeBaseData[key].issues.map(issue => ({...issue, categoryKey: key})));
                        }
                    });
                    allIssues.sort((a, b) => b.views - a.views);
                    const top5 = allIssues.slice(0, 5);
                    container.innerHTML = `<h3 class="text-lg font-semibold text-base-800 dark:text-white mb-4">Most Viewed Errors</h3><div class="space-y-2">
                        ${top5.map(issue => `<a href="#" data-id="${issue.id}" data-category="${issue.categoryKey}" class="most-viewed-link block p-2 rounded-md hover:bg-base-100 dark:hover:bg-base-700">${issue.title}</a>`).join('')}
                    </div>`;
                }

                function renderDashboardSummary() {
                    const container = document.getElementById('dashboard-stats');
                    if(!container) return;
                    const totalIssues = Object.values(knowledgeBaseData).reduce((acc, cat) => acc + (cat.issues?.length || 0), 0);
                    const totalCategories = Object.keys(knowledgeBaseData).filter(key => knowledgeBaseData[key].issues).length;
                    const severities = { Critical: 0, High: 0, Medium: 0, Low: 0 };
                    Object.values(knowledgeBaseData).forEach(cat => {
                        if (cat.issues) cat.issues.forEach(issue => severities[issue.severity]++);
                    });
                    container.className = "grid grid-cols-1 lg:grid-cols-3 gap-6";
                    container.innerHTML = `<div class="stat-card bg-white dark:bg-base-800 p-6 rounded-xl shadow-lg border border-base-200 dark:border-base-700 flex items-center space-x-4 hover:shadow-xl transition-all duration-300" style="--delay: 0s">
                            <div class="p-4 rounded-full bg-gradient-to-br from-primary-500 via-primary-600 to-primary-700 text-white shadow-lg"><i class="fa-solid fa-list-check text-3xl"></i></div>
                            <div><p class="text-sm font-medium text-base-600 dark:text-base-400">Total Issues</p><p class="text-3xl font-bold bg-gradient-to-r from-primary-600 to-primary-800 bg-clip-text text-transparent dark:from-primary-400 dark:to-primary-200">${totalIssues}</p></div>
                        </div>
                        <div class="stat-card bg-white dark:bg-base-800 p-6 rounded-xl shadow-lg border border-base-200 dark:border-base-700 flex items-center space-x-4 hover:shadow-xl transition-all duration-300" style="--delay: 0.1s">
                            <div class="p-4 rounded-full bg-gradient-to-br from-success-500 via-success-600 to-success-700 text-white shadow-lg"><i class="fa-solid fa-folder-tree text-3xl"></i></div>
                            <div><p class="text-sm font-medium text-base-600 dark:text-base-400">Categories</p><p class="text-3xl font-bold bg-gradient-to-r from-success-600 to-success-800 bg-clip-text text-transparent dark:from-success-400 dark:to-success-200">${totalCategories}</p></div>
                        </div>
                        <div class="stat-card bg-white dark:bg-base-800 p-6 rounded-xl shadow-lg border border-base-200 dark:border-base-700 hover:shadow-xl transition-all duration-300" style="--delay: 0.2s">
                            <h3 class="text-lg font-semibold text-base-800 dark:text-white mb-4 flex items-center gap-2">
                                <i class="fa-solid fa-chart-pie text-primary-600 dark:text-primary-400"></i>
                                Errors by Severity
                            </h3>
                            <div class="grid grid-cols-2 gap-4">
                                <div class="flex items-center space-x-3 p-3 rounded-lg bg-gradient-to-r from-danger-50 to-danger-100 dark:from-danger-900/20 dark:to-danger-800/20 border border-danger-200 dark:border-danger-700/50">
                                    <div class="p-2 rounded-lg bg-danger-500 text-white shadow-md"><i class="fa-solid fa-exclamation-triangle text-lg"></i></div>
                                    <div><p class="text-sm font-medium text-danger-700 dark:text-danger-300">Critical</p><p class="font-bold text-xl text-danger-800 dark:text-danger-200">${severities.Critical}</p></div>
                                </div>
                                <div class="flex items-center space-x-3 p-3 rounded-lg bg-gradient-to-r from-warning-50 to-warning-100 dark:from-warning-900/20 dark:to-warning-800/20 border border-warning-200 dark:border-warning-700/50">
                                    <div class="p-2 rounded-lg bg-warning-500 text-white shadow-md"><i class="fa-solid fa-exclamation-circle text-lg"></i></div>
                                    <div><p class="text-sm font-medium text-warning-700 dark:text-warning-300">High</p><p class="font-bold text-xl text-warning-800 dark:text-warning-200">${severities.High}</p></div>
                                </div>
                                <div class="flex items-center space-x-3 p-3 rounded-lg bg-gradient-to-r from-primary-50 to-primary-100 dark:from-primary-900/20 dark:to-primary-800/20 border border-primary-200 dark:border-primary-700/50">
                                    <div class="p-2 rounded-lg bg-primary-500 text-white shadow-md"><i class="fa-solid fa-info-circle text-lg"></i></div>
                                    <div><p class="text-sm font-medium text-primary-700 dark:text-primary-300">Medium</p><p class="font-bold text-xl text-primary-800 dark:text-primary-200">${severities.Medium}</p></div>
                                </div>
                                <div class="flex items-center space-x-3 p-3 rounded-lg bg-gradient-to-r from-success-50 to-success-100 dark:from-success-900/20 dark:to-success-800/20 border border-success-200 dark:border-success-700/50">
                                    <div class="p-2 rounded-lg bg-success-500 text-white shadow-md"><i class="fa-solid fa-check-circle text-lg"></i></div>
                                    <div><p class="text-sm font-medium text-success-700 dark:text-success-300">Low</p><p class="font-bold text-xl text-success-800 dark:text-success-200">${severities.Low}</p></div>
                                </div>
                            </div>
                        </div>`;
                }
                
                function renderDashboardChart() {
                    try {
                        const canvas = document.getElementById('overviewChart');
                        if (!canvas) {
                            console.warn('Chart canvas element not found');
                            return;
                        }
                        
                        const ctx = canvas.getContext('2d');
                        if (!ctx) {
                            console.error('Could not get 2D context for chart canvas');
                            return;
                        }
                        
                        // Properly destroy previous chart instance to prevent memory leaks
                        if (chartInstance) {
                            try {
                                chartInstance.destroy();
                                chartInstance = null;
                            } catch (err) {
                                console.warn('Error destroying previous chart instance:', err);
                            }
                        }

                    const categories = Object.keys(knowledgeBaseData).filter(k => knowledgeBaseData[k]?.issues);
                    if (categories.length === 0) {
                        console.warn('No categories with issues found for chart');
                        return;
                    }
                    
                    const data = categories.map(k => knowledgeBaseData[k].issues?.length || 0);
                    const labels = categories.map(k => knowledgeBaseData[k]?.title || 'Unknown');
                    const totalIssues = data.reduce((a, b) => a + b, 0);
                    
                    if (totalIssues === 0) {
                        console.warn('No issues found for chart');
                        return;
                    }
                    
                    const isDarkMode = document.documentElement.classList.contains('dark');
                    const textColor = isDarkMode ? '#f1f5f9' : '#334155';
                    
                    // Define theme-specific color palettes - use highly contrasting colors for dark mode
                    const lightModeColors = [
                        '#0284c7', '#0ea5e9', '#38bdf8', '#7dd3fc', '#bae6fd',  // Blues
                        '#3b82f6', '#60a5fa', '#93c5fd',                         // Indigos
                        '#8b5cf6', '#a78bfa', '#c4b5fd',                         // Purples
                        '#06b6d4', '#22d3ee', '#67e8f9',                         // Cyans
                        '#10b981', '#34d399', '#6ee7b7',                         // Emeralds
                        '#059669', '#10b981', '#34d399'                          // Greens
                    ];
                    
                    const darkModeColors = [
                        '#38bdf8', '#60a5fa', '#93c5fd', '#3b82f6', '#2563eb',   // Blues/Indigos (brighter)
                        '#c084fc', '#a855f7', '#d8b4fe', '#e9d5ff', '#8b5cf6',   // Purples (brighter)
                        '#67e8f9', '#22d3ee', '#0ea5e9', '#0284c7', '#0369a1',   // Cyans/Blues (brighter)
                        '#4ade80', '#34d399', '#10b981', '#059669', '#047857',   // Greens (brighter)
                        '#fb923c', '#f97316', '#ea580c', '#facc15', '#eab308'    // Oranges/Yellows (warm contrasting)
                    ];
                    
                    // Choose palette based on current theme
                    const colorPalette = isDarkMode ? darkModeColors : lightModeColors;
                    
                    // Ensure we have enough colors by repeating the palette if needed
                    const chartColors = [];
                    for (let i = 0; i < data.length; i++) {
                        chartColors.push(colorPalette[i % colorPalette.length]);
                    }

                    const centerTextPlugin = {
                        id: 'centerText',
                        beforeDraw: (chart) => {
                            try {
                                const { ctx, chartArea: { width, height } } = chart;
                                ctx.save();
                                ctx.font = `bold 2.5rem ${getComputedStyle(document.body).fontFamily}`;
                                ctx.textAlign = 'center';
                                ctx.textBaseline = 'middle';
                                ctx.fillStyle = textColor;
                                ctx.fillText(totalIssues, width / 2, height / 2 - 10);
                                ctx.font = `500 1rem ${getComputedStyle(document.body).fontFamily}`;
                                ctx.fillText('Total Issues', width / 2, height / 2 + 20);
                                ctx.restore();
                            } catch (textError) {
                                console.warn('Error rendering center text:', textError);
                            }
                        }
                    };

                    chartInstance = new Chart(ctx, {
                        type: 'doughnut',
                        data: {
                            labels: labels,
                            datasets: [{
                                label: '# of Issues',
                                data: data,
                                backgroundColor: chartColors,
                                borderColor: isDarkMode ? '#1e293b' : '#fff',
                                borderWidth: 4,
                                hoverOffset: 15,
                                hoverBorderColor: isDarkMode ? '#334155' : '#e2e8f0'
                            }]
                        },
                        options: {
                            responsive: true,
                            maintainAspectRatio: false,
                            cutout: '70%',
                            plugins: {
                                legend: { position: 'right', labels: { usePointStyle: true, pointStyle: 'circle', padding: 20, color: textColor, font: { size: 14 } } },
                                tooltip: { callbacks: { label: (c) => `${c.label || ''}: ${c.raw || 0} issues (${totalIssues > 0 ? ((c.raw / totalIssues) * 100).toFixed(2) + '%' : '0.00%'})` } }
                            },
                            onClick: (evt, elements) => {
                                if (elements.length > 0) {
                                    const categoryKey = categories[elements[0].index];
                                    if (categoryKey) renderPage(categoryKey);
                                }
                            }
                        },
                        plugins: [centerTextPlugin]
                    });
                } catch (error) {
                    console.error('Error rendering dashboard chart:', error);
                }
                }
                
                function attachAllListeners() {
                    document.querySelectorAll('.accordion-header').forEach(button => button.addEventListener('click', handleAccordionToggle));
                    document.querySelectorAll('.copy-btn').forEach(button => button.addEventListener('click', handleCopyClick));
                    document.querySelectorAll('.feedback-btn').forEach(button => button.addEventListener('click', handleFeedbackClick));
                    
                    // Mobile menu toggle functionality
                    const mobileMenuToggle = document.getElementById('mobile-menu-toggle');
                    const mobileMenuToggleHeader = document.getElementById('mobile-menu-toggle-header');
                    const mobileMenuOverlay = document.getElementById('mobile-menu-overlay');
                    const sidebar = document.getElementById('sidebar');
                    const mobileSearchToggle = document.getElementById('mobile-search-toggle');
                    const mobileSearchContainer = document.getElementById('mobile-search-container');
                    
                    if (mobileMenuToggle) {
                        mobileMenuToggle.classList.remove('hidden');
                        mobileMenuToggle.addEventListener('click', toggleMobileMenu);
                    }
                    
                    if (mobileMenuToggleHeader) {
                        mobileMenuToggleHeader.addEventListener('click', toggleMobileMenu);
                    }
                    
                    if (mobileMenuOverlay) {
                        mobileMenuOverlay.addEventListener('click', closeMobileMenu);
                    }
                    
                    if (mobileSearchToggle) {
                        mobileSearchToggle.addEventListener('click', () => {
                            mobileSearchContainer.classList.toggle('hidden');
                            if (!mobileSearchContainer.classList.contains('hidden')) {
                                document.getElementById('mobile-search-input').focus();
                            }
                        });
                    }
                    
                    // Mobile theme toggle
                    const mobileThemeToggle = document.getElementById('mobile-theme-toggle');
                    if (mobileThemeToggle) {
                        mobileThemeToggle.addEventListener('click', () => {
                            // Use the theme manager to toggle theme properly
                            if (window.themeManager) {
                                window.themeManager.toggleTheme();
                            } else {
                                // Fallback if theme manager not available
                                const isDark = document.documentElement.classList.contains('dark');
                                const newTheme = isDark ? 'light' : 'dark';
                                document.documentElement.classList.toggle('dark');
                                localStorage.setItem('theme', newTheme);
                                
                                // Force re-render any charts
                                if (typeof renderDashboardChart === 'function' && document.getElementById('overviewChart')) {
                                    setTimeout(renderDashboardChart, 100);
                                }
                            }
                        });
                    }
                    
                    // Handle window resize for responsive behavior
                    window.addEventListener('resize', handleWindowResize);
                    handleWindowResize(); // Call once on init
                }
                
                function toggleMobileMenu() {
                    const sidebar = document.getElementById('sidebar');
                    const mobileMenuOverlay = document.getElementById('mobile-menu-overlay');
                    
                    if (sidebar.classList.contains('-translate-x-full')) {
                        // Open menu
                        sidebar.classList.remove('-translate-x-full');
                        mobileMenuOverlay.classList.remove('hidden');
                        document.body.classList.add('overflow-hidden'); // Prevent scrolling
                    } else {
                        // Close menu
                        closeMobileMenu();
                    }
                }
                
                function closeMobileMenu() {
                    const sidebar = document.getElementById('sidebar');
                    const mobileMenuOverlay = document.getElementById('mobile-menu-overlay');
                    
                    sidebar.classList.add('-translate-x-full');
                    mobileMenuOverlay.classList.add('hidden');
                    document.body.classList.remove('overflow-hidden'); // Enable scrolling
                }
                
                function handleWindowResize() {
                    // Handle responsive layout adjustments on resize
                    const isMobile = window.innerWidth < 640;
                    const sidebar = document.getElementById('sidebar');
                    const mobileMenuOverlay = document.getElementById('mobile-menu-overlay');
                    const chatWidget = document.getElementById('chat-widget');
                    
                    if (!isMobile) {
                        // On desktop/tablet, ensure sidebar is visible
                        sidebar.classList.remove('-translate-x-full');
                        mobileMenuOverlay.classList.add('hidden');
                        document.body.classList.remove('overflow-hidden');
                        
                        // Hide mobile search if open
                        const mobileSearchContainer = document.getElementById('mobile-search-container');
                        if (mobileSearchContainer) {
                            mobileSearchContainer.classList.add('hidden');
                        }
                        
                        // Adjust chat widget position for desktop
                        if (chatWidget && !chatWidget.classList.contains('hidden')) {
                            chatWidget.style.height = 'auto';
                            chatWidget.style.maxHeight = '80vh';
                        }
                    } else {
                        // On mobile, hide sidebar by default
                        if (!mobileMenuOverlay.classList.contains('hidden')) {
                            // Only if overlay is visible (menu is open)
                            sidebar.classList.add('-translate-x-full');
                            mobileMenuOverlay.classList.add('hidden');
                        }
                        
                        // Adjust chat widget position for mobile
                        if (chatWidget && !chatWidget.classList.contains('hidden')) {
                            chatWidget.style.height = '70vh';
                            
                            // Make sure chat widget doesn't extend beyond viewport
                            const viewportHeight = window.innerHeight;
                            const chatBottom = chatWidget.getBoundingClientRect().bottom;
                            
                            if (chatBottom > viewportHeight) {
                                chatWidget.style.bottom = '0';
                                chatWidget.style.maxHeight = '70vh';
                            }
                        }
                        
                        // Fix any overflowing elements
                        document.querySelectorAll('.overflow-x-auto').forEach(el => {
                            if (el.scrollWidth > el.clientWidth) {
                                el.style.webkitOverflowScrolling = 'touch';
                            }
                        });
                    }
                    
                    // Adjust code blocks to prevent horizontal overflow
                    document.querySelectorAll('pre').forEach(pre => {
                        if (pre.scrollWidth > pre.clientWidth) {
                            pre.style.whiteSpace = isMobile ? 'pre-wrap' : 'pre';
                            pre.style.wordBreak = isMobile ? 'break-word' : 'normal';
                        }
                    });
                }
                
                function handleAccordionToggle(e) {
                    const button = e.currentTarget;
                    const content = button.nextElementSibling;
                    const icon = button.querySelector('.accordion-icon');
                    const isOpen = content.classList.toggle('open');
                    icon.classList.toggle('fa-plus', !isOpen);
                    icon.classList.toggle('fa-minus', isOpen);
                    
                    if(isOpen) {
                        const issueId = button.closest('.accordion-item').dataset.id;
                        updateUserData(issueId, 'view');
                        window.location.hash = issueId;
                        Prism.highlightAll();
                    }
                }

                function handleCopyClick(e) {
                    e.stopPropagation();
                    const button = e.currentTarget;
                    const codeElement = button.previousElementSibling;
                    if (!codeElement) {
                        console.error('Code element not found for copy operation');
                        return;
                    }
                    
                    const code = codeElement.innerText || codeElement.textContent;
                    if (!code) {
                        console.error('No code content found to copy');
                        return;
                    }
                    
                    if (navigator.clipboard && navigator.clipboard.writeText) {
                    navigator.clipboard.writeText(code).then(() => {
                        button.innerHTML = '<i class="fa-solid fa-check text-green-400"></i>';
                        setTimeout(() => { button.innerHTML = '<i class="fa-solid fa-copy"></i>'; }, 2000);
                        }).catch(err => {
                            console.error('Failed to copy to clipboard:', err);
                            // Fallback for older browsers
                            fallbackCopyTextToClipboard(code, button);
                        });
                    } else {
                        // Fallback for browsers without clipboard API
                        fallbackCopyTextToClipboard(code, button);
                    }
                }
                
                function fallbackCopyTextToClipboard(text, button) {
                    const textArea = document.createElement('textarea');
                    textArea.value = text;
                    textArea.style.position = 'fixed';
                    textArea.style.left = '-999999px';
                    textArea.style.top = '-999999px';
                    document.body.appendChild(textArea);
                    textArea.focus();
                    textArea.select();
                    
                    try {
                        const successful = document.execCommand('copy');
                        if (successful) {
                            button.innerHTML = '<i class="fa-solid fa-check text-green-400"></i>';
                            setTimeout(() => { button.innerHTML = '<i class="fa-solid fa-copy"></i>'; }, 2000);
                        } else {
                            console.error('Fallback copy command failed');
                        }
                    } catch (err) {
                        console.error('Fallback copy failed:', err);
                    }
                    
                    document.body.removeChild(textArea);
                }

                function handleFeedbackClick(e) {
                    const button = e.currentTarget;
                    const container = button.closest('.feedback-container');
                    const issueId = button.closest('.accordion-item').dataset.id;
                    const type = button.classList.contains('yes-btn') ? 'feedback_yes' : 'feedback_no';
                    updateUserData(issueId, type);
                    container.innerHTML = `<p class="text-sm font-semibold text-green-600">Thank you for your feedback!</p>`;
                }

                function toggleAll(open) {
                    document.querySelectorAll('.accordion-header').forEach(header => {
                        const isCurrentlyOpen = header.nextElementSibling.classList.contains('open');
                        if ((open && !isCurrentlyOpen) || (!open && isCurrentlyOpen)) {
                            header.click();
                        }
                    });
                }

                // --- ENHANCED CHATBOT LOGIC WITH SUPERIOR AI ---
                
                // Enhanced Chatbot Variables
                const chatWidget = document.getElementById('chat-widget');
                const chatButton = document.getElementById('chat-button');
                const chatCloseButton = document.getElementById('chat-close-button');
                const chatMinimizeBtn = document.getElementById('chat-minimize-btn');
                const chatSettingsBtn = document.getElementById('chat-settings-btn');
                const chatForm = document.getElementById('chat-form');
                const chatInput = document.getElementById('chat-input');
                const chatSendBtn = document.getElementById('chat-send-btn');
                const chatVoiceBtn = document.getElementById('chat-voice-btn');
                const chatMessages = document.getElementById('chat-messages');
                const quickRepliesContainer = document.getElementById('chat-quick-replies');
                const quickActionsContainer = document.getElementById('chat-quick-actions');
                const chatStatus = document.getElementById('chat-status');
                const chatInputCounter = document.getElementById('chat-input-counter');
                const chatAiIndicator = document.getElementById('chat-ai-indicator');

                let chatHistory = [];
                let isTyping = false;
                let chatContext = [];
                let voiceRecognition = null;
                let isMinimized = false;
                let currentSessionId = Date.now();

                // Advanced PostgreSQL Knowledge Base for AI responses
                const postgresKnowledgeBase = {
                    errors: {
                        'connection refused': {
                            solutions: ['Check if PostgreSQL is running', 'Verify connection parameters', 'Check firewall settings', 'Ensure correct port (default 5432)'],
                            examples: ['sudo systemctl start postgresql', 'netstat -an | grep 5432'],
                            severity: 'high'
                        },
                        'permission denied': {
                            solutions: ['Check user permissions', 'Review pg_hba.conf', 'Verify role privileges', 'Check database ownership'],
                            examples: ['GRANT ALL PRIVILEGES ON DATABASE mydb TO user;', 'ALTER USER user CREATEDB;'],
                            severity: 'medium'
                        },
                        'syntax error': {
                            solutions: ['Review SQL syntax', 'Check for missing semicolons', 'Verify keyword spelling', 'Use proper quoting'],
                            examples: ['SELECT * FROM "table_name";', 'CREATE TABLE users (id SERIAL PRIMARY KEY);'],
                            severity: 'low'
                        },
                        'deadlock detected': {
                            solutions: ['Implement retry logic', 'Order lock acquisition', 'Reduce transaction time', 'Use explicit locking'],
                            examples: ['LOCK TABLE table1, table2 IN ACCESS EXCLUSIVE MODE;', 'SET deadlock_timeout = 1s;'],
                            severity: 'high'
                        }
                    },
                    performance: {
                        'slow query': {
                            solutions: ['Add appropriate indexes', 'Analyze query plan', 'Update table statistics', 'Optimize WHERE clauses'],
                            examples: ['EXPLAIN ANALYZE SELECT...', 'CREATE INDEX idx_name ON table(column);'],
                            monitoring: ['pg_stat_statements', 'log_min_duration_statement']
                        },
                        'high cpu': {
                            solutions: ['Identify expensive queries', 'Check for missing indexes', 'Optimize complex joins', 'Consider query rewriting'],
                            examples: ['SELECT * FROM pg_stat_activity;', 'VACUUM ANALYZE;'],
                            monitoring: ['pg_top', 'pg_stat_activity']
                        }
                    },
                    concepts: {
                        'vacuum': {
                            purpose: 'Reclaim storage and update statistics',
                            types: ['VACUUM', 'VACUUM FULL', 'VACUUM ANALYZE'],
                            best_practices: ['Regular scheduling', 'Monitor table bloat', 'Use autovacuum'],
                            examples: ['VACUUM VERBOSE table_name;', 'SELECT * FROM pg_stat_user_tables;']
                        },
                        'replication': {
                            types: ['Streaming replication', 'Logical replication', 'Physical replication'],
                            setup: ['Configure primary', 'Set up standby', 'Monitor lag'],
                            examples: ['SELECT * FROM pg_stat_replication;', 'pg_basebackup -D /var/lib/postgresql/standby']
                        }
                    }
                };

                // Initialize enhanced chat
                chatToggleButton.addEventListener('click', () => openChat());
                chatCloseButton.addEventListener('click', closeChat);
                chatMinimizeBtn.addEventListener('click', toggleMinimize);
                chatSettingsBtn.addEventListener('click', showChatSettings);
                chatForm.addEventListener('submit', handleUserChatInput);
                chatInput.addEventListener('input', updateInputCounter);
                chatVoiceBtn.addEventListener('click', toggleVoiceInput);

                // Enhanced quick actions
                document.addEventListener('click', (e) => {
                    if (e.target.classList.contains('quick-action-btn')) {
                        const action = e.target.dataset.action;
                        handleQuickAction(action);
                    }
                });

                function openChat() {
                    chatWidget.classList.remove('hidden');
                    chatWidget.style.transform = 'translateY(0)';
                    chatWidget.style.opacity = '1';
                    isMinimized = false;
                    
                    // Show enhanced welcome message if first time
                    if (chatHistory.length === 0) {
                        addMessageToChat("ðŸ‘‹ Hello! I'm your **PostgreSQL Assistant** powered by advanced AI. I can help you with:", 'bot');
                        setTimeout(() => {
                            addMessageToChat(`
                                ðŸ” **Error Diagnosis** - Analyze and solve database errors<br>
                                âš¡ **Performance Optimization** - Speed up your queries<br>
                                ðŸ“š **Concept Explanations** - Learn PostgreSQL features<br>
                                ðŸ› ï¸ **Best Practices** - Get expert recommendations<br><br>
                                What would you like to explore today?
                            `, 'bot');
                            showQuickReplies([
                                'Diagnose a database error',
                                'Optimize slow queries',
                                'Explain PostgreSQL concepts',
                                'Best practices guide'
                            ]);
                        }, 1000);
                    }
                }

                function closeChat() {
                    chatWidget.style.transform = 'translateY(8px)';
                    chatWidget.style.opacity = '0';
                    setTimeout(() => {
                        chatWidget.classList.add('hidden');
                    }, 200);
                }

                function toggleMinimize() {
                    isMinimized = !isMinimized;
                    const messagesArea = document.getElementById('chat-messages');
                    const quickReplies = document.getElementById('chat-quick-replies');
                    const quickActions = document.getElementById('chat-quick-actions');
                    const chatForm = document.getElementById('chat-form');
                    
                    if (isMinimized) {
                        messagesArea.style.display = 'none';
                        quickReplies.style.display = 'none';
                        quickActions.style.display = 'none';
                        chatForm.style.display = 'none';
                        chatMinimizeBtn.innerHTML = '<i class="fa-solid fa-plus text-sm"></i>';
                        chatStatus.textContent = 'Minimized';
                    } else {
                        messagesArea.style.display = 'block';
                        quickReplies.style.display = 'block';
                        quickActions.style.display = 'block';
                        chatForm.style.display = 'block';
                        chatMinimizeBtn.innerHTML = '<i class="fa-solid fa-minus text-sm"></i>';
                        chatStatus.textContent = 'AI-powered database help';
                    }
                }

                function updateInputCounter() {
                    const length = chatInput.value.length;
                    chatInputCounter.textContent = `${length}/500`;
                    chatSendBtn.disabled = length === 0;
                    
                    if (length > 450) {
                        chatInputCounter.classList.add('text-red-500');
                    } else {
                        chatInputCounter.classList.remove('text-red-500');
                    }
                }

                function handleQuickAction(action) {
                    const prompts = {
                        'diagnose': 'I have a database error that needs diagnosis. Can you help me troubleshoot it?',
                        'optimize': 'My PostgreSQL queries are running slowly. Can you help me optimize them?',
                        'explain': 'I need help understanding a PostgreSQL concept or feature.'
                    };
                    
                    if (prompts[action]) {
                        chatInput.value = prompts[action];
                        handleUserChatInput({ preventDefault: () => {} });
                    }
                }

                function handleUserChatInput(e) {
                    e.preventDefault();
                    const message = chatInput.value.trim();
                    if (!message || isTyping) return;

                    addMessageToChat(message, 'user');
                    chatInput.value = '';
                    updateInputCounter();
                    clearQuickReplies();
                    
                    // Add to context for better AI responses
                    chatContext.push({ role: 'user', content: message, timestamp: Date.now() });
                    
                    showTypingIndicator();
                    showAiThinking();
                    
                    setTimeout(() => {
                        processUserMessageWithAI(message);
                    }, 1500 + Math.random() * 1500);
                }

                function addMessageToChat(message, sender) {
                    const messageDiv = document.createElement('div');
                    messageDiv.className = `flex ${sender === 'user' ? 'justify-end' : 'justify-start'} mb-3`;
                    
                    const messageBubble = document.createElement('div');
                    messageBubble.className = `max-w-xs lg:max-w-md px-4 py-3 rounded-2xl shadow-sm ${
                        sender === 'user' 
                            ? 'bg-gradient-to-r from-primary-500 to-primary-600 text-white' 
                            : 'bg-white dark:bg-base-700 text-base-800 dark:text-base-200 border border-base-200 dark:border-base-600'
                    }`;
                    
                    // Enhanced message rendering with markdown support
                    if (sender === 'bot') {
                        messageBubble.innerHTML = message.replace(/\*\*(.*?)\*\*/g, '<strong>$1</strong>');
                    } else {
                        messageBubble.textContent = message;
                    }
                    
                    messageDiv.appendChild(messageBubble);
                    
                    // Add timestamp for bot messages
                    if (sender === 'bot') {
                        const timestamp = document.createElement('div');
                        timestamp.className = 'text-xs text-base-400 mt-1 px-1';
                        timestamp.textContent = new Date().toLocaleTimeString([], { hour: '2-digit', minute: '2-digit' });
                        messageDiv.appendChild(timestamp);
                    }
                    
                    chatMessages.appendChild(messageDiv);
                    chatMessages.scrollTop = chatMessages.scrollHeight;
                    
                    chatHistory.push({ message, sender, timestamp: Date.now() });
                }

                function showTypingIndicator() {
                    isTyping = true;
                    const typingDiv = document.createElement('div');
                    typingDiv.className = 'flex justify-start mb-3';
                    typingDiv.id = 'typing-indicator';
                    
                    const typingBubble = document.createElement('div');
                    typingBubble.className = 'bg-white dark:bg-base-700 px-4 py-3 rounded-2xl flex items-center space-x-2 border border-base-200 dark:border-base-600';
                    typingBubble.innerHTML = `
                        <div class="flex space-x-1">
                            <div class="w-2 h-2 bg-primary-400 rounded-full animate-bounce"></div>
                            <div class="w-2 h-2 bg-primary-400 rounded-full animate-bounce" style="animation-delay: 0.2s"></div>
                            <div class="w-2 h-2 bg-primary-400 rounded-full animate-bounce" style="animation-delay: 0.4s"></div>
                        </div>
                        <span class="text-sm text-base-500">AI is analyzing...</span>
                    `;
                    
                    typingDiv.appendChild(typingBubble);
                    chatMessages.appendChild(typingDiv);
                    chatMessages.scrollTop = chatMessages.scrollHeight;
                }

                function hideTypingIndicator() {
                    isTyping = false;
                    const typingIndicator = document.getElementById('typing-indicator');
                    if (typingIndicator) {
                        typingIndicator.remove();
                    }
                }

                function showAiThinking() {
                    chatAiIndicator.style.opacity = '1';
                    chatStatus.textContent = 'Analyzing your request...';
                }

                function hideAiThinking() {
                    chatAiIndicator.style.opacity = '0';
                    chatStatus.textContent = 'AI-powered database help';
                }

                function processUserMessageWithAI(message) {
                    hideTypingIndicator();
                    hideAiThinking();
                    
                    const analysis = analyzeUserMessage(message);
                    const response = generateIntelligentResponse(message, analysis);
                    
                    addMessageToChat(response.text, 'bot');
                    
                    // Add to context for conversation continuity
                    chatContext.push({ role: 'assistant', content: response.text, timestamp: Date.now() });
                    
                    // Show contextual quick replies
                    if (response.quickReplies.length > 0) {
                        showQuickReplies(response.quickReplies);
                    }
                }

                function analyzeUserMessage(message) {
                    const lowercaseMessage = message.toLowerCase();
                    
                    return {
                        intent: detectIntent(lowercaseMessage),
                        keywords: extractKeywords(lowercaseMessage),
                        sentiment: detectSentiment(lowercaseMessage),
                        complexity: assessComplexity(message),
                        hasCode: /\b(select|insert|update|delete|create|alter|drop)\b/i.test(message)
                    };
                }

                function detectIntent(message) {
                    const intents = {
                        'error_diagnosis': ['error', 'fail', 'broken', 'not working', 'issue', 'problem', 'exception'],
                        'performance': ['slow', 'fast', 'optimize', 'performance', 'speed', 'lag', 'timeout'],
                        'explanation': ['what is', 'how does', 'explain', 'understand', 'learn', 'tutorial'],
                        'best_practices': ['best', 'recommend', 'should', 'practice', 'advice', 'guide'],
                        'configuration': ['config', 'setting', 'setup', 'install', 'configure']
                    };
                    
                    for (const [intent, keywords] of Object.entries(intents)) {
                        if (keywords.some(keyword => message.includes(keyword))) {
                            return intent;
                        }
                    }
                    
                    return 'general';
                }

                function extractKeywords(message) {
                    const postgresKeywords = ['postgresql', 'postgres', 'sql', 'database', 'table', 'index', 'query', 'vacuum', 'backup', 'replication', 'connection', 'permission', 'user', 'role'];
                    return postgresKeywords.filter(keyword => message.includes(keyword));
                }

                function detectSentiment(message) {
                    const urgentWords = ['urgent', 'critical', 'emergency', 'asap', 'immediately'];
                    const frustrationWords = ['frustrated', 'stuck', 'confused', 'lost', 'help'];
                    
                    if (urgentWords.some(word => message.includes(word))) return 'urgent';
                    if (frustrationWords.some(word => message.includes(word))) return 'frustrated';
                    return 'neutral';
                }

                function assessComplexity(message) {
                    if (message.length > 100) return 'high';
                    if (message.split(' ').length > 15) return 'medium';
                    return 'low';
                }

                function generateIntelligentResponse(message, analysis) {
                    let response = '';
                    let quickReplies = [];
                    
                    // Search knowledge base with enhanced matching
                    const searchResults = globalFuse ? globalFuse.search(message) : [];
                    
                    switch (analysis.intent) {
                        case 'error_diagnosis':
                            response = generateErrorDiagnosisResponse(message, searchResults, analysis);
                            quickReplies = ['Show error logs', 'Check configuration', 'Troubleshooting steps', 'Similar issues'];
                            break;
                            
                        case 'performance':
                            response = generatePerformanceResponse(message, searchResults, analysis);
                            quickReplies = ['Query optimization', 'Index analysis', 'Monitoring tools', 'Best practices'];
                            break;
                            
                        case 'explanation':
                            response = generateExplanationResponse(message, searchResults, analysis);
                            quickReplies = ['More details', 'Examples', 'Related concepts', 'Practical guide'];
                            break;
                            
                        case 'best_practices':
                            response = generateBestPracticesResponse(message, searchResults, analysis);
                            quickReplies = ['Security tips', 'Performance tips', 'Maintenance guide', 'Advanced techniques'];
                            break;
                            
                        default:
                            response = generateGeneralResponse(message, searchResults, analysis);
                            quickReplies = ['More details', 'Related topics', 'Examples', 'Get started'];
                    }
                    
                    return { text: response, quickReplies };
                }

                function generateErrorDiagnosisResponse(message, searchResults, analysis) {
                    let response = "ðŸ” **Error Diagnosis**\n\n";
                    
                    // Check for known error patterns
                    for (const [errorType, errorInfo] of Object.entries(postgresKnowledgeBase.errors)) {
                        if (message.toLowerCase().includes(errorType)) {
                            response += `I detected a **${errorType}** issue. Here's how to resolve it:\n\n`;
                            response += `**Solutions:**\n`;
                            errorInfo.solutions.forEach((solution, index) => {
                                response += `${index + 1}. ${solution}\n`;
                            });
                            
                            if (errorInfo.examples.length > 0) {
                                response += `\n**Example commands:**\n`;
                                errorInfo.examples.forEach(example => {
                                    response += `\`${example}\`\n`;
                                });
                            }
                            
                            response += `\n**Severity:** ${errorInfo.severity}\n`;
                            return response;
                        }
                    }
                    
                    // Fallback to search results
                    if (searchResults.length > 0) {
                        const topResult = searchResults[0].item;
                        response += `Based on your error description, I found relevant information:\n\n`;
                        response += `**${topResult.title}**\n`;
                        response += `${topResult.content.substring(0, 300)}...\n\n`;
                        response += `Would you like me to provide more specific troubleshooting steps?`;
                    } else {
                        response += `I need more details to diagnose this error effectively. Please provide:\n\n`;
                        response += `â€¢ The exact error message\n`;
                        response += `â€¢ When the error occurs\n`;
                        response += `â€¢ Your PostgreSQL version\n`;
                        response += `â€¢ Any relevant configuration details`;
                    }
                    
                    return response;
                }

                function generatePerformanceResponse(message, searchResults, analysis) {
                    let response = "âš¡ **Performance Optimization**\n\n";
                    
                    if (message.toLowerCase().includes('slow query')) {
                        const perfInfo = postgresKnowledgeBase.performance['slow query'];
                        response += `For slow query optimization, I recommend:\n\n`;
                        response += `**Immediate Actions:**\n`;
                        perfInfo.solutions.forEach((solution, index) => {
                            response += `${index + 1}. ${solution}\n`;
                        });
                        
                        response += `\n**Diagnostic Commands:**\n`;
                        perfInfo.examples.forEach(example => {
                            response += `\`${example}\`\n`;
                        });
                        
                        response += `\n**Monitoring Tools:**\n`;
                        perfInfo.monitoring.forEach(tool => {
                            response += `â€¢ ${tool}\n`;
                        });
                    } else if (searchResults.length > 0) {
                        const topResult = searchResults[0].item;
                        response += `Here's what I found about performance optimization:\n\n`;
                        response += `**${topResult.title}**\n`;
                        response += `${topResult.content.substring(0, 300)}...\n\n`;
                    } else {
                        response += `To help with performance optimization, I can assist with:\n\n`;
                        response += `â€¢ **Query Analysis** - EXPLAIN plans and optimization\n`;
                        response += `â€¢ **Index Strategy** - Creating effective indexes\n`;
                        response += `â€¢ **Configuration Tuning** - PostgreSQL settings\n`;
                        response += `â€¢ **Monitoring Setup** - Performance tracking tools\n\n`;
                        response += `What specific performance issue are you experiencing?`;
                    }
                    
                    return response;
                }

                function generateExplanationResponse(message, searchResults, analysis) {
                    let response = "ðŸ“š **PostgreSQL Explanation**\n\n";
                    
                    // Check for known concepts
                    for (const [concept, conceptInfo] of Object.entries(postgresKnowledgeBase.concepts)) {
                        if (message.toLowerCase().includes(concept)) {
                            response += `**${concept.toUpperCase()}**\n\n`;
                            response += `**Purpose:** ${conceptInfo.purpose}\n\n`;
                            
                            if (conceptInfo.types) {
                                response += `**Types:**\n`;
                                conceptInfo.types.forEach(type => response += `â€¢ ${type}\n`);
                                response += '\n';
                            }
                            
                            if (conceptInfo.best_practices) {
                                response += `**Best Practices:**\n`;
                                conceptInfo.best_practices.forEach(practice => response += `â€¢ ${practice}\n`);
                                response += '\n';
                            }
                            
                            if (conceptInfo.examples) {
                                response += `**Examples:**\n`;
                                conceptInfo.examples.forEach(example => response += `\`${example}\`\n`);
                            }
                            
                            return response;
                        }
                    }
                    
                    // Fallback to search results
                    if (searchResults.length > 0) {
                        const topResult = searchResults[0].item;
                        response += `Here's an explanation of **${topResult.title}**:\n\n`;
                        response += `${topResult.content.substring(0, 400)}...\n\n`;
                        response += `Would you like me to explain any specific aspect in more detail?`;
                    } else {
                        response += `I'd be happy to explain PostgreSQL concepts! I can help with:\n\n`;
                        response += `â€¢ **Database Fundamentals** - Tables, schemas, relationships\n`;
                        response += `â€¢ **Advanced Features** - Indexes, views, stored procedures\n`;
                        response += `â€¢ **Administration** - User management, backups, monitoring\n`;
                        response += `â€¢ **Performance** - Query optimization, tuning\n\n`;
                        response += `What would you like me to explain?`;
                    }
                    
                    return response;
                }

                function generateBestPracticesResponse(message, searchResults, analysis) {
                    let response = "ðŸ† **PostgreSQL Best Practices**\n\n";
                    
                    if (searchResults.length > 0) {
                        const topResult = searchResults[0].item;
                        response += `Here are best practices for **${topResult.title}**:\n\n`;
                        response += `${topResult.content.substring(0, 300)}...\n\n`;
                    }
                    
                    response += `**General Recommendations:**\n`;
                    response += `â€¢ **Security** - Use strong authentication, limit privileges\n`;
                    response += `â€¢ **Performance** - Regular VACUUM, proper indexing\n`;
                    response += `â€¢ **Backup** - Automated backups, test restores\n`;
                    response += `â€¢ **Monitoring** - Track key metrics, set alerts\n`;
                    response += `â€¢ **Maintenance** - Update statistics, check logs\n\n`;
                    response += `Which area would you like specific best practices for?`;
                    
                    return response;
                }

                function generateGeneralResponse(message, searchResults, analysis) {
                    if (searchResults.length > 0) {
                        const topResult = searchResults[0].item;
                        let response = `I found relevant information about **${topResult.title}**:\n\n`;
                        response += `${topResult.content.substring(0, 350)}...\n\n`;
                        
                        if (searchResults.length > 1) {
                            response += `I also found ${searchResults.length - 1} other related topic(s). `;
                        }
                        
                        response += `Would you like me to provide more specific information?`;
                        return response;
                    } else {
                        return `I understand you're asking about PostgreSQL, but I need more context to provide the best help. Could you:\n\nâ€¢ Be more specific about what you're trying to achieve\nâ€¢ Mention any error messages you're seeing\nâ€¢ Describe the PostgreSQL feature you're interested in\n\nI'm here to help with errors, performance, configuration, and best practices! ðŸš€`;
                    }
                }

                function showQuickReplies(replies) {
                    clearQuickReplies();
                    
                    replies.forEach(reply => {
                        const button = document.createElement('button');
                        button.className = 'px-3 py-2 text-sm bg-primary-50 dark:bg-primary-900 text-primary-700 dark:text-primary-300 rounded-lg hover:bg-primary-100 dark:hover:bg-primary-800 transition-colors border border-primary-200 dark:border-primary-700';
                        button.textContent = reply;
                        button.addEventListener('click', () => {
                            chatInput.value = reply;
                            handleUserChatInput({ preventDefault: () => {} });
                        });
                        quickRepliesContainer.appendChild(button);
                    });
                }

                function clearQuickReplies() {
                    quickRepliesContainer.innerHTML = '';
                }

                function toggleVoiceInput() {
                    if (!('webkitSpeechRecognition' in window) && !('SpeechRecognition' in window)) {
                        alert('Voice input is not supported in your browser. Please use Chrome or Edge.');
                        return;
                    }
                    
                    if (!voiceRecognition) {
                        voiceRecognition = new (window.SpeechRecognition || window.webkitSpeechRecognition)();
                        voiceRecognition.continuous = false;
                        voiceRecognition.interimResults = false;
                        voiceRecognition.lang = 'en-US';
                        
                        voiceRecognition.onstart = () => {
                            chatVoiceBtn.innerHTML = '<i class="fa-solid fa-stop text-sm"></i>';
                            chatVoiceBtn.classList.add('bg-red-500', 'text-white');
                            chatStatus.textContent = 'Listening...';
                        };
                        
                        voiceRecognition.onresult = (event) => {
                            const transcript = event.results[0][0].transcript;
                            chatInput.value = transcript;
                            updateInputCounter();
                        };
                        
                        voiceRecognition.onend = () => {
                            chatVoiceBtn.innerHTML = '<i class="fa-solid fa-microphone text-sm"></i>';
                            chatVoiceBtn.classList.remove('bg-red-500', 'text-white');
                            chatStatus.textContent = 'AI-powered database help';
                        };
                    }
                    
                    if (voiceRecognition.listening) {
                        voiceRecognition.stop();
                    } else {
                        voiceRecognition.start();
                    }
                }

                function showChatSettings() {
                    const settingsModal = document.createElement('div');
                    settingsModal.className = 'fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50';
                    settingsModal.innerHTML = `
                        <div class="bg-white dark:bg-base-800 rounded-lg p-6 max-w-md w-full mx-4">
                            <h3 class="text-lg font-bold mb-4">Chat Settings</h3>
                            <div class="space-y-4">
                                <div>
                                    <label class="flex items-center">
                                        <input type="checkbox" id="enable-voice" class="mr-2">
                                        Enable voice input
                                    </label>
                                </div>
                                <div>
                                    <label class="flex items-center">
                                        <input type="checkbox" id="show-timestamps" class="mr-2" checked>
                                        Show timestamps
                                    </label>
                                </div>
                                <div>
                                    <button id="clear-history" class="w-full bg-red-500 text-white py-2 rounded hover:bg-red-600">
                                        Clear Chat History
                                    </button>
                                </div>
                            </div>
                            <div class="flex justify-end mt-6 space-x-2">
                                <button id="settings-close" class="px-4 py-2 bg-base-300 rounded hover:bg-base-400">Close</button>
                            </div>
                        </div>
                    `;
                    
                    document.body.appendChild(settingsModal);
                    
                    document.getElementById('settings-close').onclick = () => settingsModal.remove();
                    document.getElementById('clear-history').onclick = () => {
                        chatHistory = [];
                        chatContext = [];
                        chatMessages.innerHTML = '';
                        settingsModal.remove();
                        addMessageToChat("Chat history cleared. How can I help you today?", 'bot');
                    };
                }

                // Legacy compatibility with old chatbot functions
                function toggleChat(show) {
                    if (show) {
                        openChat();
                    } else {
                        closeChat();
                    }
                }

                function findSolutionsInAllCategories(query) {
                    try {
                        if (!globalFuse) {
                            console.warn('Global search not initialized');
                            return [];
                        }
                        
                        const results = globalFuse.search(query);
                        return results
                            .filter(result => result.item && result.score < 0.6) // Higher quality results
                            .slice(0, 5) // Limit to top 5 results
                            .map(result => result.item);
                    } catch (error) {
                        console.error('Error in global search:', error);
                        return [];
                    }
                }
                
                function displayQuickReplies() {
                    const replies = ["Slow Queries", "Connection Issues", "Backups"];
                    const chatQuickReplies = document.getElementById('chat-quick-replies');
                    if (chatQuickReplies) {
                        chatQuickReplies.innerHTML = replies.map(reply => `<button class="quick-reply-btn text-sm bg-primary-100 text-primary-700 dark:bg-primary-900 dark:text-primary-200 px-3 py-1 rounded-full hover:bg-primary-200">${reply}</button>`).join('');
                    }
                }

                // Quick replies event delegation
                chatQuickReplies.addEventListener('click', (e) => {
                    if (e.target.classList.contains('quick-reply-btn')) {
                        handleUserChatInput(e.target.innerText);
                    }
                });
                
                contentArea.addEventListener('click', (e) => {
                    if (e.target.classList.contains('most-viewed-link')) {
                        e.preventDefault();
                        handleDeepLink(e.target.dataset.category, e.target.dataset.id);
                    }
                });

                chatMessages.addEventListener('click', (e) => {
                    const button = e.target.closest('.view-solution-btn');
                    if (button) {
                        toggleChat(false);
                        handleDeepLink(button.dataset.category, button.dataset.id);
                    }
                });

                // --- MODAL LOGIC ---
                function openModal() {
                    reportIssueModal.classList.remove('hidden');
                    reportIssueModal.classList.add('flex');
                    setTimeout(() => {
                        reportIssueModal.querySelector('.modal-overlay').classList.remove('opacity-0');
                        reportIssueModal.querySelector('.modal-container').classList.remove('scale-95');
                    }, 10);
                }

                function closeModal() {
                    reportIssueModal.querySelector('.modal-container').classList.add('scale-95');
                    reportIssueModal.querySelector('.modal-overlay').classList.add('opacity-0');
                    setTimeout(() => {
                        reportIssueModal.classList.add('hidden');
                        reportIssueModal.classList.remove('flex');
                        reportFormContent.classList.remove('hidden');
                        reportSuccessMessage.classList.add('hidden');
                        issueReportForm.reset();
                    }, 300);
                }

                reportIssueBtn.addEventListener('click', openModal);
                closeModalBtn.addEventListener('click', closeModal);
                closeSuccessModalBtn.addEventListener('click', closeModal);
                reportIssueModal.querySelector('.modal-overlay').addEventListener('click', closeModal);

                issueReportForm.addEventListener('submit', (e) => {
                    e.preventDefault();
                    console.log('Issue Reported:', {
                        title: document.getElementById('error-title').value,
                        code: document.getElementById('error-code').value,
                        severity: document.getElementById('error-severity').value,
                        description: document.getElementById('error-description').value,
                        reproduce: document.getElementById('error-reproduce').value,
                    });
                    reportFormContent.classList.add('hidden');
                    reportSuccessMessage.classList.remove('hidden');
                });

                function handleDeepLink(categoryKey, issueId) {
                    renderPage(categoryKey);
                    setTimeout(() => {
                        const targetAccordion = document.querySelector(`.accordion-item[data-id="${issueId}"]`);
                        if (targetAccordion) {
                            if (!targetAccordion.querySelector('.solution').classList.contains('open')) {
                                targetAccordion.querySelector('.accordion-header').click();
                            }
                            targetAccordion.scrollIntoView({ behavior: 'smooth', block: 'center' });
                        }
                    }, 100);
                }

                function checkHash() {
                    const hash = window.location.hash.substring(1);
                    if (hash) {
                        const issue = findIssueById(hash);
                        if (issue) {
                            const categoryKey = Object.keys(knowledgeBaseData).find(key => knowledgeBaseData[key].issues?.some(i => i.id === hash));
                            if (categoryKey) handleDeepLink(categoryKey, hash);
                        }
                    }
                }


                // --- INITIALIZATION & DELEGATED EVENT LISTENERS ---
                
                Object.keys(knowledgeBaseData).forEach(key => {
                    const category = knowledgeBaseData[key];
                    const item = document.createElement('a');
                    item.href = '#';
                    item.dataset.key = key;
                    item.className = 'sidebar-item flex items-center p-3 text-base-700 dark:text-base-300 rounded-lg hover:bg-base-100 dark:hover:bg-base-700 transition-colors';
                    item.innerHTML = `<span class="w-8 text-center"><i class="${category.icon || 'fa-solid fa-book'}" aria-hidden="true"></i></span><span>${category.title}</span>`;
                    item.addEventListener('click', (e) => {
                        e.preventDefault();
                        renderPage(key);
                        if (window.innerWidth < 640) {
                            sidebar.classList.add('-translate-x-full');
                        }
                    });
                    nav.appendChild(item);
                });
                
                menuToggle.addEventListener('click', () => sidebar.classList.toggle('-translate-x-full'));
                
                // Enhanced search with debouncing and error handling
                if (searchInput) {
                    searchInput.addEventListener('input', () => {
                        try {
                            const currentCategory = knowledgeBaseData[currentCategoryKey];
                            if (currentCategory && currentCategory.issues) {
                                debouncedSearch(currentCategoryKey);
                            }
                        } catch (error) {
                            console.error('Error in search input handler:', error);
                        }
                    });

                    // Clear search on escape key
                    searchInput.addEventListener('keydown', (e) => {
                        if (e.key === 'Escape') {
                            searchInput.value = '';
                            debouncedSearch(currentCategoryKey);
                        }
                    });
                }

                if (severityFilter) {
                    severityFilter.addEventListener('change', () => {
                        try {
                            const currentCategory = knowledgeBaseData[currentCategoryKey];
                            if (currentCategory && currentCategory.issues) {
                                renderAccordionContent(currentCategoryKey);
                            }
                        } catch (error) {
                            console.error('Error in severity filter handler:', error);
                        }
                    });
                }

                breadcrumb.addEventListener('click', (e) => {
                    if (e.target.classList.contains('breadcrumb-link')) {
                        e.preventDefault();
                        renderPage(e.target.dataset.key);
                    }
                });

                contentArea.addEventListener('submit', (e) => {
                    if (e.target && e.target.classList.contains('comment-form')) {
                        e.preventDefault();
                        const form = e.target;
                        const issueId = form.dataset.issueId;
                        const nameInput = form.querySelector('input[type="text"]');
                        const commentInput = form.querySelector('textarea');
                        
                        const name = nameInput.value.trim();
                        const text = commentInput.value.trim();

                        if (!name || !text) return;

                        updateUserData(issueId, 'comment', { name, text });
                        
                        const commentList = form.previousElementSibling;
                        const issue = findIssueById(issueId);
                        commentList.innerHTML = renderComments(issue.comments);
                        
                        form.reset();
                    }
                });
                
                // Back to Top Button Logic
                contentArea.addEventListener('scroll', () => {
                    if (contentArea.scrollTop > 200) {
                        backToTopBtn.classList.remove('opacity-0', 'translate-y-4');
                    } else {
                        backToTopBtn.classList.add('opacity-0', 'translate-y-4');
                    }
                });

                backToTopBtn.addEventListener('click', () => {
                    contentArea.scrollTo({ top: 0, behavior: 'smooth' });
                });
                
                // Initialize global search
                setupGlobalFuse();
                
                // Initialize keyboard shortcuts
                initializeKeyboardShortcuts();
                
                // Initialize lazy loading for new elements
                requestAnimationFrame(() => {
                    if (typeof initLazyLoading === 'function') {
                        initLazyLoading();
                    }
                    attachAllListeners();
                });
                
                renderPage('dashboard');
                checkHash();
            }

            function initializeKeyboardShortcuts() {
                const keyboardIndicator = document.getElementById('keyboard-shortcuts');
                let shortcutTimeout;

                // Show shortcuts indicator temporarily
                function showShortcutsIndicator() {
                    keyboardIndicator.classList.add('show');
                    clearTimeout(shortcutTimeout);
                    shortcutTimeout = setTimeout(() => {
                        keyboardIndicator.classList.remove('show');
                    }, 3000);
                }

                // Handle keyboard shortcuts
                document.addEventListener('keydown', (e) => {
                    // Show shortcuts help
                    if (e.key === '?' && !e.ctrlKey && !e.metaKey) {
                        e.preventDefault();
                        showShortcutsIndicator();
                        return;
                    }

                    // Focus search (Ctrl+K or Ctrl+F)
                    if ((e.ctrlKey || e.metaKey) && (e.key === 'k' || e.key === 'f')) {
                        e.preventDefault();
                        const searchInput = document.getElementById('search-input');
                        if (searchInput) {
                            searchInput.focus();
                        }
                        return;
                    }

                    // Toggle chat (Ctrl+?)
                    if ((e.ctrlKey || e.metaKey) && e.key === '/') {
                        e.preventDefault();
                        const chatToggle = document.getElementById('chat-toggle-button');
                        if (chatToggle) {
                            chatToggle.click();
                        }
                        return;
                    }

                    // Back to top (Ctrl+Home)
                    if ((e.ctrlKey || e.metaKey) && e.key === 'Home') {
                        e.preventDefault();
                        window.scrollTo({ top: 0, behavior: 'smooth' });
                        return;
                    }

                    // Toggle theme (Ctrl+Shift+T)
                    if ((e.ctrlKey || e.metaKey) && e.shiftKey && e.key === 'T') {
                        e.preventDefault();
                        const themeToggle = document.getElementById('theme-toggle');
                        if (themeToggle) {
                            themeToggle.click();
                        }
                        return;
                    }

                    // Navigate tabs (Ctrl+1-9)
                    if ((e.ctrlKey || e.metaKey) && e.key >= '1' && e.key <= '9') {
                        e.preventDefault();
                        const tabIndex = parseInt(e.key) - 1;
                        const navItems = document.querySelectorAll('.sidebar-item');
                        if (navItems[tabIndex]) {
                            navItems[tabIndex].click();
                        }
                        return;
                    }

                    // Escape to clear search
                    if (e.key === 'Escape') {
                        const searchInput = document.getElementById('search-input');
                        if (searchInput && searchInput.value) {
                            searchInput.value = '';
                            searchInput.dispatchEvent(new Event('input'));
                        }
                        return;
                    }
                });

                // Show indicator on initial load
                setTimeout(() => {
                    showShortcutsIndicator();
                }, 2000);
            }

            // --- PDF EXPORT FUNCTIONALITY ---
            function exportDiagramToPDF() {
                try {
                    // Check if jsPDF is available
                    if (!window.jspdf) {
                        console.error('jsPDF library not loaded');
                        alert('PDF export functionality is not available. Please refresh the page and try again.');
                        return;
                    }

                    const { jsPDF } = window.jspdf;
                    const pdf = new jsPDF('l', 'mm', 'a4'); // Landscape orientation
                    
                    // Get all diagram containers
                    const diagrams = document.querySelectorAll('#architecture-diagrams .diagram-container');
                    
                    if (diagrams.length === 0) {
                        alert('No diagrams found to export');
                        return;
                    }

                    // PDF title
                    pdf.setFontSize(20);
                    pdf.text('PostgreSQL Architecture Diagrams', 20, 25);
                    pdf.setFontSize(12);
                    pdf.text('Generated from PostgreSQL Knowledge Base', 20, 35);
                    pdf.text(`Date: ${new Date().toLocaleDateString()}`, 20, 45);

                    let currentY = 60;
                    let pageHeight = pdf.internal.pageSize.height;
                    let diagramIndex = 0;

                    const addDiagramToPDF = () => {
                        if (diagramIndex >= diagrams.length) {
                            // Save the PDF
                            pdf.save('PostgreSQL_Architecture_Diagrams.pdf');
                            console.log('Diagrams PDF exported successfully');
                            return;
                        }

                        const diagram = diagrams[diagramIndex];
                        const title = diagram.querySelector('h4').textContent;
                        const svg = diagram.querySelector('svg');

                        // Add diagram title
                        if (currentY > pageHeight - 100) {
                            pdf.addPage();
                            currentY = 25;
                        }

                        pdf.setFontSize(16);
                        pdf.text(title, 20, currentY);
                        currentY += 15;

                        // Convert SVG to canvas and then to image
                        const canvas = document.createElement('canvas');
                        const ctx = canvas.getContext('2d');
                        const svgData = new XMLSerializer().serializeToString(svg);
                        const svgBlob = new Blob([svgData], { type: 'image/svg+xml;charset=utf-8' });
                        const svgUrl = URL.createObjectURL(svgBlob);
                        
                        const img = new Image();
                        img.onload = function() {
                            try {
                                // Set canvas size
                                canvas.width = 800;
                                canvas.height = 600;
                                
                                // Draw white background
                                ctx.fillStyle = 'white';
                                ctx.fillRect(0, 0, canvas.width, canvas.height);
                        
                                // Draw the SVG
                                ctx.drawImage(img, 0, 0, canvas.width, canvas.height);
                                
                                // Convert canvas to image data
                                const imgData = canvas.toDataURL('image/png');
                                
                                // Add image to PDF
                                const imgWidth = 250; // Width in mm
                                const imgHeight = (canvas.height * imgWidth) / canvas.width;
                                
                                // Check if we need a new page
                                if (currentY + imgHeight > pageHeight - 20) {
                                    pdf.addPage();
                                    currentY = 25;
                                }
                                
                                pdf.addImage(imgData, 'PNG', 20, currentY, imgWidth, imgHeight);
                                currentY += imgHeight + 20;
                                
                                URL.revokeObjectURL(svgUrl);
                                diagramIndex++;
                                
                                // Process next diagram
                                setTimeout(addDiagramToPDF, 100);
                            } catch (error) {
                                console.error('Error processing diagram:', error);
                                URL.revokeObjectURL(svgUrl);
                                diagramIndex++;
                                setTimeout(addDiagramToPDF, 100);
                            }
                        };
                        
                        img.onerror = function() {
                            console.error('Failed to load diagram:', title);
                            URL.revokeObjectURL(svgUrl);
                            diagramIndex++;
                            setTimeout(addDiagramToPDF, 100);
                        };
                        
                        img.src = svgUrl;
                    };

                    addDiagramToPDF();
                } catch (error) {
                    console.error('Error exporting diagrams to PDF:', error);
                    alert('Error generating diagrams PDF. Please check the console for details and try again.');
                }
            }

            function exportSolutionToPDF(issueId) {
                try {
                    // Check if jsPDF is available
                    if (!window.jspdf) {
                        console.error('jsPDF library not loaded');
                        alert('PDF export functionality is not available. Please refresh the page and try again.');
                        return;
                    }

                    const { jsPDF } = window.jspdf;
                    const pdf = new jsPDF();
                    
                    // Find the issue
                    let issue = null;
                    let categoryName = '';
                    
                    for (const [key, category] of Object.entries(knowledgeBaseData)) {
                        if (category.issues) {
                            const foundIssue = category.issues.find(i => i.id === issueId);
                            if (foundIssue) {
                                issue = foundIssue;
                                categoryName = category.title;
                                break;
                            }
                        }
                    }
                    
                    if (!issue) {
                        alert('Issue not found');
                        return;
                    }
                    
                    // PDF margins and settings
                    const margin = 20;
                    const pageWidth = pdf.internal.pageSize.width;
                    const pageHeight = pdf.internal.pageSize.height;
                    const contentWidth = pageWidth - (margin * 2);
                    let currentY = margin;
                    
                    // Helper function to add text with word wrapping
                    const addText = (text, fontSize = 12, isBold = false) => {
                        try {
                            pdf.setFontSize(fontSize);
                            pdf.setFont(undefined, isBold ? 'bold' : 'normal');
                            
                            const lines = pdf.splitTextToSize(text, contentWidth);
                            const lineHeight = fontSize * 0.35;
                            
                            lines.forEach(line => {
                                if (currentY + lineHeight > pageHeight - margin) {
                                    pdf.addPage();
                                    currentY = margin;
                                }
                                pdf.text(line, margin, currentY);
                                currentY += lineHeight;
                            });
                            
                            currentY += 5; // Add some spacing
                        } catch (error) {
                            console.error('Error adding text to PDF:', error);
                        }
                    };
                    
                    // Header
                    pdf.setFillColor(59, 130, 246); // Blue background
                    pdf.rect(0, 0, pageWidth, 40, 'F');
                    pdf.setTextColor(255, 255, 255); // White text
                    pdf.setFontSize(18);
                    pdf.text('PostgreSQL Knowledge Base', margin, 25);
                    pdf.setFontSize(12);
                    pdf.text(`Category: ${categoryName}`, margin, 35);
                    
                    currentY = 50;
                    pdf.setTextColor(0, 0, 0); // Black text
                    
                    // Issue title
                    addText(`${issue.title}`, 16, true);
                    
                    // Error code and severity
                    if (issue.errorCode && issue.errorCode !== 'N/A') {
                        addText(`Error Code: ${issue.errorCode}`, 12, true);
                    }
                    addText(`Severity: ${issue.severity}`, 12, true);
                    
                    currentY += 10;
                    
                    // Solution
                    addText('SOLUTION:', 14, true);
                    const solutionText = issue.solution.replace(/<[^>]*>/g, '').replace(/&nbsp;/g, ' ');
                    addText(solutionText, 11);
                    
                    currentY += 10;
                    
                    // Remediation
                    if (issue.remediation) {
                        addText('REMEDIATION STEPS:', 14, true);
                        addText(issue.remediation, 11);
                        currentY += 10;
                    }
                    
                    // Troubleshooting code
                    if (issue.troubleshooting_code) {
                        addText('TROUBLESHOOTING CODE:', 14, true);
                        
                        // Add code block background
                        const codeLines = pdf.splitTextToSize(issue.troubleshooting_code, contentWidth - 10);
                        const codeHeight = codeLines.length * 4 + 10;
                        
                        pdf.setFillColor(248, 250, 252); // Light gray background
                        pdf.rect(margin, currentY, contentWidth, codeHeight, 'F');
                        
                        currentY += 5;
                        pdf.setFont('courier', 'normal');
                        pdf.setFontSize(10);
                        
                        codeLines.forEach(line => {
                            pdf.text(line, margin + 5, currentY);
                            currentY += 4;
                        });
                        
                        currentY += 10;
                        pdf.setFont(undefined, 'normal');
                    }
                    
                    // Footer
                    currentY = pageHeight - 30;
                    pdf.setFontSize(10);
                    pdf.setTextColor(128, 128, 128);
                    pdf.text(`Generated on ${new Date().toLocaleString()}`, margin, currentY);
                    pdf.text(`Issue ID: ${issue.id}`, margin, currentY + 10);
                    
                    // Save the PDF
                    const filename = `PostgreSQL_Solution_${issue.id.replace(/[^a-zA-Z0-9]/g, '_')}.pdf`;
                    pdf.save(filename);
                    
                    // Show success message
                    console.log('PDF exported successfully:', filename);
                    
                } catch (error) {
                    console.error('Error exporting PDF:', error);
                    alert('Error generating PDF. Please check the console for details and try again.');
                }
            }

            // --- MOBILE TOUCH UTILITIES ---
            
            // Initialize touch scrolling for better mobile experience
            function initializeTouchScrolling() {
                // Find all elements that might need horizontal scrolling on mobile
                const scrollableElements = document.querySelectorAll('pre, table, .diagram-container, .visual-content');
                
                scrollableElements.forEach(element => {
                    let isScrolling = false;
                    let startX;
                    let scrollLeft;
                    
                    // Only apply touch handling if element content exceeds its width
                    if (element.scrollWidth > element.clientWidth) {
                        element.style.cursor = 'grab';
                        
                        element.addEventListener('touchstart', (e) => {
                            isScrolling = true;
                            startX = e.touches[0].pageX - element.offsetLeft;
                            scrollLeft = element.scrollLeft;
                        });
                        
                        element.addEventListener('touchmove', (e) => {
                            if (!isScrolling) return;
                            e.preventDefault();
                            const x = e.touches[0].pageX - element.offsetLeft;
                            const walk = (x - startX) * 1.5; // Scroll speed multiplier
                            element.scrollLeft = scrollLeft - walk;
                        });
                        
                        element.addEventListener('touchend', () => {
                            isScrolling = false;
                            element.style.cursor = 'grab';
                        });
                        
                        // Add visual indicator for scrollable content
                        const scrollIndicator = document.createElement('div');
                        scrollIndicator.className = 'scroll-indicator text-xs text-base-500 dark:text-base-400 mt-1 text-center';
                        scrollIndicator.innerHTML = '<i class="fa-solid fa-arrows-left-right mr-1"></i> Swipe to scroll';
                        
                        // Only add the indicator once
                        if (!element.parentNode.querySelector('.scroll-indicator')) {
                            element.parentNode.appendChild(scrollIndicator);
                            
                            // Hide indicator after 5 seconds
                            setTimeout(() => {
                                scrollIndicator.style.opacity = '0';
                                setTimeout(() => {
                                    scrollIndicator.style.display = 'none';
                                }, 500);
                            }, 5000);
                        }
                    }
                });
            }
            
            // --- PERFORMANCE UTILITIES ---
            
            // Intersection Observer for lazy loading
            function initLazyLoading() {
                if (!('IntersectionObserver' in window)) {
                    // Fallback for older browsers
                    document.querySelectorAll('.lazy-fade-in').forEach(el => {
                        el.classList.add('visible');
                    });
                    return;
                }
                
                const observer = new IntersectionObserver((entries) => {
                    entries.forEach(entry => {
                        if (entry.isIntersecting) {
                            entry.target.classList.add('visible');
                            observer.unobserve(entry.target);
                        }
                    });
                }, {
                    threshold: 0.1,
                    rootMargin: '50px'
                });
                
                document.querySelectorAll('.lazy-fade-in').forEach(el => {
                    observer.observe(el);
                });
            }
            
            // Debounced resize handler
            function initResizeHandler() {
                let resizeTimer;
                const debouncedResize = () => {
                    clearTimeout(resizeTimer);
                    resizeTimer = setTimeout(() => {
                        // Trigger chart resize if visible
                        if (chartInstance && document.getElementById('overviewChart')) {
                            try {
                                chartInstance.resize();
                            } catch (error) {
                                console.warn('Error resizing chart:', error);
                            }
                        }
                        
                        // Update mobile navigation state
                        if (window.innerWidth >= 640) {
                            const sidebar = document.getElementById('sidebar');
                            if (sidebar) {
                                sidebar.classList.remove('-translate-x-full');
                            }
                        }
                        
                        // Call mobile-specific window resize handler
                        if (typeof handleWindowResize === 'function') {
                            handleWindowResize();
                        }
                        
                        // Fix any layout issues with content
                        recalculateMobileLayout();
                    }, 250);
                };
                
                // Handle orientation change specifically
                const handleOrientationChange = () => {
                    // Add a class to prevent unwanted transitions during orientation change
                    document.body.classList.add('orientation-change');
                    
                    // Force recalculation after orientation change
                    setTimeout(() => {
                        debouncedResize();
                        // Remove the class after adjustments are complete
                        setTimeout(() => {
                            document.body.classList.remove('orientation-change');
                        }, 300);
                    }, 200);
                };
                
                // Function to fix common mobile layout issues
                const recalculateMobileLayout = () => {
                    if (window.innerWidth < 768) {
                        // Fix scrollable containers
                        document.querySelectorAll('pre, .overflow-x-auto').forEach(el => {
                            if (el.scrollWidth > el.clientWidth) {
                                el.style.webkitOverflowScrolling = 'touch';
                            }
                        });
                        
                        // Ensure chat widget fits on screen
                        const chatWidget = document.getElementById('chat-widget');
                        if (chatWidget && !chatWidget.classList.contains('hidden')) {
                            chatWidget.style.maxHeight = '70vh';
                            chatWidget.style.bottom = '16px';
                        }
                    }
                };
                
                window.addEventListener('resize', debouncedResize, { passive: true });
                window.addEventListener('orientationchange', handleOrientationChange);
            }
            
            // Performance monitoring
            function logPerformanceMetrics() {
                if ('performance' in window) {
                    const navigation = performance.getEntriesByType('navigation')[0];
                    if (navigation) {
                        console.log('Page Load Performance:', {
                            'DOM Content Loaded': Math.round(navigation.domContentLoadedEventEnd - navigation.domContentLoadedEventStart),
                            'Load Complete': Math.round(navigation.loadEventEnd - navigation.loadEventStart),
                            'Total Load Time': Math.round(navigation.loadEventEnd - navigation.navigationStart)
                        });
                    }
                }
            }
            
            // Memory management utility
            function setupMemoryManagement() {
                // Clean up event listeners on page unload
                window.addEventListener('beforeunload', () => {
                    if (chartInstance) {
                        try {
                            chartInstance.destroy();
                            chartInstance = null;
                        } catch (error) {
                            console.warn('Error cleaning up chart:', error);
                        }
                    }
                    
                    // Clear timeouts
                    if (searchDebounceTimer) {
                        clearTimeout(searchDebounceTimer);
                    }
                });
            }

            // --- MAIN ENTRY POINT ---
            
            // Make export functions globally accessible
            window.exportDiagramToPDF = exportDiagramToPDF;
            window.exportSolutionToPDF = exportSolutionToPDF;
            
            // Initialize performance utilities
            document.addEventListener('DOMContentLoaded', () => {
                setupMemoryManagement();
                initResizeHandler();
                
                // Log performance metrics after a short delay
                setTimeout(logPerformanceMetrics, 1000);
                
                // Initialize touch scrolling for mobile devices after content is loaded
                setTimeout(initializeTouchScrolling, 1500);
            });
            
            startApp();
        });
    </script>
</body>
</html>
